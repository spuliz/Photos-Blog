!function(t,e,o,i){t.fn.extend({scrollspy:function(o){var i={min:0,max:0,mode:"vertical",namespace:"scrollspy",buffer:0,container:e,onEnter:o.onEnter?o.onEnter:[],onLeave:o.onLeave?o.onLeave:[],onTick:o.onTick?o.onTick:[]},o=t.extend({},i,o);return this.each(function(e){var i=this,r=o,n=t(r.container),s=r.mode,a=r.buffer,l=leaves=0,u=!1;n.bind("scroll."+r.namespace,function(e){var o={top:t(this).scrollTop(),left:t(this).scrollLeft()},p="vertical"==s?o.top+a:o.left+a,c=r.max,h=r.min;t.isFunction(r.max)&&(c=r.max()),t.isFunction(r.min)&&(h=r.min()),0==c&&(c="vertical"==s?n.height():n.outerWidth()+t(i).outerWidth()),p>=h&&c>=p?(u||(u=!0,l++,t(i).trigger("scrollEnter",{position:o}),t.isFunction(r.onEnter)&&r.onEnter(i,o)),t(i).trigger("scrollTick",{position:o,inside:u,enters:l,leaves:leaves}),t.isFunction(r.onTick)&&r.onTick(i,o,u,l,leaves)):u&&(u=!1,leaves++,t(i).trigger("scrollLeave",{position:o,leaves:leaves}),t.isFunction(r.onLeave)&&r.onLeave(i,o))})})}})}(jQuery,window,document,void 0),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Models"),t.Photo=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(){return o.__super__.initialize.apply(this,arguments),this.imagesDownloadPromises={},this.imagesDownloaded={}},o.prototype.url=function(){return"https://api.500px.com/v1/photos/"+this.id},o.prototype._imageDownloadKey=function(t){return"size:"+t.size+"-https:"+t.https},o.prototype.prefetchImage=function(t){var e;return _.defaults(t,{size:4,https:!0}),e=this._imageDownloadKey(t),this.imagesDownloaded[e]||null!=this.imagesDownloadPromises[e]?void 0:this.downloadImage(t)},o.prototype.isImageDownloaded=function(t){return _.defaults(t,{size:4,https:!0}),this.imagesDownloaded[this._imageDownloadKey(t)]},o.prototype.downloadImage=function(t){var e,o,i,r;return _.defaults(t,{size:4,https:!0}),i=this._imageDownloadKey(t),this.imagesDownloadPromises[i]?this.imagesDownloadPromises[i]:(e=$.Deferred(),r=this.imagesDownloadPromises[i]=e.promise(),o=new Image,o.onload=function(r){return function(){return r.imagesDownloaded[i]=!0,e.resolve(o.src,t),r.imagesDownloadPromises[i]=null}}(this),o.onerror=function(o){return function(){return e.reject(t),o.imagesDownloadPromises[i]=null}}(this),o.src=this.getImagePath(t),r)},o.prototype.addDownloadedImageSize=function(t){var e;return _.defaults(t,{size:4,https:!0}),e=this._imageDownloadKey(t),this.imagesDownloaded[e]=!0},o.prototype.getImagePathAndSize=function(t){var e,o;return _.defaults(t,{size:4,https:!0,ignoresConverting:!0}),e=this.getInternalImagePathAndSize(t),null==e&&(3===(o=t.size)||600===o?3!==t.size&&(t.size=3,e=this.getInternalImagePathAndSize(t)):4!==t.size&&(t.size=4,e=this.getInternalImagePathAndSize(t))),null==e&&(t.size=null,e=this.getInternalImagePathAndSize(t)),e},o.prototype.getInternalImagePathAndSize=function(t){var e,o,i,r,n,s;r=this.get("images");for(e in r)if(o=r[e],t.size===o.size||null==t.size)return i=t.https?null!=(n=o.https_url)?n:o.secure_url:o.url,s=o.size,t.ignoresConverting&&i.match(/\/placeholder\//)?null:{path:i,size:s};return null},o.prototype.getImagePath=function(t){var e;return e=this.getImagePathAndSize(t),null!=e?e.path:void 0},o.prototype.getInternalImagePath=function(t){var e;return e=this.getInternalImagePathAndSize(t),null!=e?e.path:void 0},o.prototype.parse=function(t){var e;return null!=(e=t.photo)?e:t},o.prototype.isPublic=function(){return this.get("privacy")===!1},o.prototype.isPrivate=function(){return this.get("privacy")===!0},o.prototype.imageUrl=function(){var t,e;return e=this.getInternalImagePath({size:4,https:!0}),null==e&&(e=this.getInternalImagePath({size:34,https:!0})),null==e&&(e=this.get("images")[0].secure_url),null!=e?e:null!=(t=this.get("images")[0])?t.url:void 0},o.prototype.isConverting=function(){return null!=this.get("converted")&&0===this.get("converted")||this.imageUrl().indexOf("/placeholder/")>=0},o.prototype.dimensionsForImageSize=function(t){var e,o,i,r,n,s;return s=this.get("width"),n=this.get("height"),null!=s&&null!=n?(r={14:900,34:1e3,35:1500,36:2e3},e=r[t],null==e&&(e=t),s>n?(i=Math.min(s,e),o=Math.round(n*i/s)):(o=Math.min(n,e),i=Math.round(s*o/n)),{width:i,height:o}):void 0},o.prototype.submitToQuest=function(t){return $.post("https://api.500px.com/v1/quests/"+t+"/entries",{photo_id:this.get("id")})},o}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Models"),t.PhotoForViewer=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.isOwner=function(){return null!=App.currentUser&&App.currentUser.id===this.get("user_id")},o.prototype.getFavoriteState=function(){return!!this.get("favorited")},o.prototype.getFavoriteCount=function(){var t;return null!=(t=this.get("favorites_count"))?t:0},o.prototype.getFormatFavCount=function(){return this._formatNumber(this.getFavoriteCount())},o.prototype.getAbbreviateFavCount=function(){return this.abbreviateNumber(this.getFavoriteCount())},o.prototype.favorite=function(t){var e;return e=$.post("https://api.500px.com/v1/photos/"+this.id+"/favorite"),e.done(function(e){return function(o){return e.set({favorites_count:e.get("favorites_count")+1,favorited:!0,rating:o.photo.rating,highest_rating:o.photo.highest_rating,highest_rating_date:o.photo.highest_rating_date}),"function"==typeof t?t(null,e.getFavoriteState()):void 0}}(this)).fail(function(e){return function(o,i,r){var n,s;return n=(s=App.Helpers.API).parseError.apply(s,arguments),"function"==typeof t?t(n,e.getFavoriteState()):void 0}}(this))},o.prototype.unfavorite=function(t){var e;return e=$.ajax({type:"DELETE",url:"https://api.500px.com/v1/photos/"+this.id+"/favorite"}),e.done(function(e){return function(o){return e.set({favorites_count:e.get("favorites_count")-1,favorited:!1,rating:o.photo.rating,highest_rating:o.photo.highest_rating,highest_rating_date:o.photo.highest_rating_date}),"function"==typeof t?t(null,e.getFavoriteState()):void 0}}(this)).fail(function(e){return function(o,i,r){var n,s;return n=(s=App.Helpers.API).parseError.apply(s,arguments),"function"==typeof t?t(n,e.getFavoriteState()):void 0}}(this))},o.prototype.getLikeState=function(){return!!this.get("liked")},o.prototype.getLikeCount=function(){var t;return null!=(t=this.get("votes_count"))?t:0},o.prototype.getFormatLikeCount=function(){return this._formatNumber(this.getLikeCount())},o.prototype.getAbbreviateLikeCount=function(){return this.abbreviateNumber(this.getLikeCount())},o.prototype.like=function(t){var e;return e=$.post("https://api.500px.com/v1/photos/"+this.id+"/vote?"+$.param({vote:1})),e.done(function(e){return function(o){var i;return e.set({votes_count:(null!=(i=e.get("votes_count"))?i:0)+1,liked:!0,rating:o.photo.rating,highest_rating:o.photo.highest_rating,highest_rating_date:o.photo.highest_rating_date}),"function"==typeof t?t(null,e.getLikeState()):void 0}}(this)).fail(function(e){return function(o,i,r){var n,s;return n=(s=App.Helpers.API).parseError.apply(s,arguments),"function"==typeof t?t(n,e.getLikeState()):void 0}}(this))},o.prototype.unlike=function(t){var e;return e=$.ajax({type:"DELETE",url:"https://api.500px.com/v1/photos/"+this.id+"/vote"}),e.done(function(e){return function(o){var i;return e.set({votes_count:(null!=(i=e.get("votes_count"))?i:0)-1,liked:!1,rating:o.photo.rating,highest_rating:o.photo.highest_rating,highest_rating_date:o.photo.highest_rating_date}),"function"==typeof t?t(null,e.getLikeState()):void 0}}(this)).fail(function(e){return function(o,i,r){var n,s;return n=(s=App.Helpers.API).parseError.apply(s,arguments),"function"==typeof t?t(n,e.getLikeState()):void 0}}(this))},o.prototype.getUrl=function(){return this.getCanonicalUrl()},o.prototype.getCanonicalUrl=function(){return"https://500px.com"+this.get("url")},o.prototype._formatNumber=function(t){var e,o;for(e=t.toString(),o=/(\d+)(\d{3})/;o.test(e);)e=e.replace(o,"$1,$2");return e},o.prototype.abbreviateNumber=function(t,e){var o,i,r;if(null==e&&(e=1e3),r=["","k","m","b","t"],i=0>t?"-":"",t=Math.abs(t),e>t)return""+t;for(o=0;t>=1e3&&null!=r[o+1];)t/=1e3,o+=1;return t=parseInt(10*t+.5,10)/10,""+i+t+r[o]},o}(App.Models.Photo)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Models"),t.LicenseSelection=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.instance=function(){var t;return this._instance?this._instance:(t=$.cookie("user_license_selection"),null==t&&(t="print_ready"),this._instance=new App.Models.LicenseSelection({selection:t.split(",")}))},o.prototype.fetch=function(){return this.get("selection")},o.prototype.fetchForPhoto=function(t){var e;return e=_.intersection(this.get("selection"),t.getAllLicenseNames()),0===e.length?["print_ready"]:e},o.prototype.select=function(t){return this.set("selection",t),$.cookie("user_license_selection",t.join(","))},o}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos"),t.Router=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.appRoutes={"photo/(:photo_id)(/:photo_slug)":"show"},o.prototype.navigate=function(t,e){var i;return null==e&&(e={}),i=App.currentPath(),t.replace(/(\?|&)page=\d+\b/,"")===i.replace(/(\?|&)page=\d+\b/,"")&&null==e.replace&&(e.replace=!0),o.__super__.navigate.call(this,t,e),this._trackPageview()},o.prototype.initialize=function(){return this.bind("route",this._trackPageview)},o.prototype._trackPageview=function(){var t;return t=Backbone.history.getFragment(),PxApp.GA.pageview(t)},o}(Backbone.Marionette.AppRouter)}.call(this),function(){App.module("Photos",function(t){return t.addInitializer(function(){return null!=window.standalonePhotoPage?(null!=("undefined"!=typeof PxCurrentUser&&null!==PxCurrentUser?PxCurrentUser.user:void 0)&&null==App.currentUser&&(App.currentUser=new App.Models.User(JSON.parse(PxCurrentUser.user))),$(function(){return $("body").toggleClass("logged_in",null!=App.currentUser),PxApp.GA.set_member_type_and_user_id(PxCurrentUser.type,PxCurrentUser.id)}),App.controller=new t.Controller,App.router=App.controller.router=new t.Router({controller:App.controller})):void 0})})}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var r in o)e.call(o,r)&&(t[r]=o[r]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},e={}.hasOwnProperty;PxApp.Model=function(e){function o(){o.__super__.constructor.apply(this,arguments),this.original_attributes=_.extend({},this.attributes)}return t(o,e),o.prototype.fetch=function(t){var e,i,r;return null==t&&(t={}),console.log("Fetching model..."),e=$.Deferred(),r=t.success,i=t.error,t.success=function(t){return function(t,o,i){return e.resolve(t,o,i),"function"==typeof r&&r(t,o,i),console.log("Fetching success!")}}(this),t.error=function(t){return function(t,o,r){return e.reject(t,o,r),"function"==typeof i&&i(t,o,r),console.log("Fetching ERROR!")}}(this),o.__super__.fetch.call(this,t),e.promise()},o.prototype.save=function(t,e){var i,r,n,s;return null==e&&(e={}),i=$.Deferred(),s=e.success,r=e.error,e.success=function(t){return function(e,o,r){return t.original_attributes=_.extend({},t.attributes),i.resolve(e,o,r),"function"==typeof s?s(e,o,r):void 0}}(this),e.error=function(t){return function(t,e,o){return i.reject(t,e,o),"function"==typeof r?r(t,e,o):void 0}}(this),n=o.__super__.save.call(this,t,e),!1===n&&i.reject(this.validationError),i.promise()},o.prototype.reload=function(){return this.set(this.original_attributes),this.validationError=null},o.prototype.destroy=function(t){var e,i,r,n;return null==t&&(t={}),e=$.Deferred(),n=t.success,i=t.error,t.success=function(t){return function(t,o,i){return e.resolve(t,o,i),"function"==typeof n?n(t,o,i):void 0}}(this),t.error=function(t){return function(t,o,r){return e.reject(t,o,r),"function"==typeof i?i(t,o,r):void 0}}(this),r=o.__super__.destroy.call(this,t),!1===r&&e.reject(),e.promise()},o.prototype.errors=function(){var t;return null!=(t=this.validationError)?t:{}},o.prototype.validate=function(t,e){var o,i,r,n,s,a;if(null==this.get("id")&&t.id)return!1;r={},i=0;for(o in t)a=t[o],s="function"==typeof this[n="validate_"+o]?this[n](a,t):void 0,s&&(r[o]=s,i++);return i>0?r:void 0},o}(Backbone.Model)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;PxApp.Models.User=function(o){function i(){return this.is_active=t(this.is_active,this),this.get_comments=t(this.get_comments,this),this.user_link=t(this.user_link,this),this.is_free=t(this.is_free,this),this.avatar_url=t(this.avatar_url,this),this.membership_name=t(this.membership_name,this),this.url=t(this.url,this),i.__super__.constructor.apply(this,arguments)}return e(i,o),i.MEMBER={FREE:0,PLUS:1,AWESOME:2,PARTNER:3,EDITOR:8},i.prototype.AVATAR_NUMBERS={"default":1,large:2,medium:2,small:3,tiny:4},i.prototype.AVATAR_NUMBERS_RETINA={"default":1,large:1,medium:1,small:2,tiny:3},i.prototype.AVATAR_SIZES={tiny:30,small:50,medium:64,large:100,"default":300},i.USER_AVATAR_DIRECTIVES={"class":function(){var t;return t=["user_avatar"],this.user_avatar.user&&t.push("user_"+this.user_avatar.user.membership_name()),t.push("size_"+this.user_avatar.size),this.user_avatar.user&&!this.user_avatar.user.is_active()&&t.push("deactivated"),t.join(" ")},"data-user-id":function(){return this.user_avatar.user?this.user_avatar.user.id:void 0},tooltip:{"class":function(){var t;return t=["tooltip"],this.user&&this.tooltip&&this.user.is_active()&&this.user.id&&t.push("display"),t.join(" ")},text:function(){return this.user&&this.user.id?this.user.get("fullname"):void 0}},link:{href:function(){return this.user&&this.user.id&&this.user.is_active()?PxAppUrl+"/"+this.user.get("username"):null}},image:{src:function(){return this.user?this.user.avatar_url(this.size):PxAppUrl+"/graphics/userpic.png"}},membership_icon:{"class":function(){var t;return t=["membership_tag"],this.user?t.push(""+this.user.membership_name()):t.push("free"),t.join(" ")},href:function(){var t;return this.user&&(t=function(){switch(this.user.membership_name()){case"staff":return"/team";case"editor":return"/editors";case"plus":return"/upgrade";case"awesome":return"/upgrade"}}.call(this))?""+PxAppUrl+t:void 0},text:function(){var t;return this.user?t=function(){switch(this.user.membership_name()){case"staff":return"500px";case"editor":return"Editor";case"plus":return"Plus";case"awesome":return"Awesome";case"partner":return"Partner"}}.call(this):void 0}}},i.prototype.url=function(){return"/users/"+this.id},i.prototype.membership_name=function(){if(this.get("admin"))return"staff";if(this.get("usertype")===this.constructor.MEMBER.PARTNER)return"partner";if(this.get("usertype")===this.constructor.MEMBER.EDITOR)return"editor";switch(this.get("upgrade_status")){case 0:return"free";case 1:return"plus";case 2:return"awesome"}},i.prototype.membership_text=function(){var t;return t=function(){switch(this.membership_name()){case"staff":return"500px";case"editor":return"Editor";case"plus":return"Plus";case"awesome":return"Awesome";case"partner":return"Partner"}}.call(this)},i.prototype.avatar_url=function(t){var e,o;return o=this.get("userpic_url"),e=PxInitialData.avatar_cdn_url.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1"),o.match(new RegExp("^"+e))&&(o=window.devicePixelRatio>1?o.replace(/\d+(?=\.jpg(?:\?\d+)?$)/,this.AVATAR_NUMBERS_RETINA[t]):o.replace(/\d+(?=\.jpg(?:\?\d+)?$)/,this.AVATAR_NUMBERS[t])),o},i.prototype.is_free=function(){return this.get("upgrade_status")===this.constructor.MEMBER.FREE},i.prototype.is_plus=function(){return this.get("upgrade_status")===this.constructor.MEMBER.PLUS},i.prototype.hasGATrackingEnabled=function(){return this.get("upgrade_status")>0},i.prototype.user_link=function(){return this.is_active()?$(_.template('<a href="%{url}" class="user_profile_link">%{fullname}</a>',{url:PxAppUrl+"/"+this.get("username"),fullname:this.get("fullname")})):$(_.template('<a class="user_profile_link inactive">%{fullname}</a>',{fullname:this.get("fullname")}))},i.prototype.get_comments=function(t){var e;return e=PxApp.api.get("/users/"+this.id+"/comments?sort=created_at&nested=1&include_flagged=1"),e.success(function(e){return function(o){return e.comments=new PxApp.Collections.User.Comments(o.comments,{target:e}),null!=t(e)}}(this))},i.prototype.parse=function(t){var e;return null!=(e=t.user)?e:t},i.prototype.is_active=function(){return!this.get("banned")&&!this.get("deactivated")&&!this.get("not_active")},i.prototype.isRolledOut=function(t){var e;return!!(null!=(e=this.get("rollout"))?e[t]:void 0)},i}(PxApp.Model)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Models"),t.User=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.STATUS_ACTIVE=1,o.prototype.MARKETPLACE_PHOTO_FILTER=0,o.prototype.IMMEDIATELY_LICENSABLE_PHOTO_FILTER=1,o.prototype.COMMUNITY_PHOTO_FILTER=2,o.prototype.initialize=function(){return App.vent.on("photo_deleted",function(t){return function(e){var o,i,r;return e.get("status")===t.STATUS_ACTIVE&&null!=t.get("upload_limit")&&t.get("upload_limit")<20&&(i=new Date,i.setDate(i.getDate()+1),o=new Date,o.setDate(i.getDate()-7),r=new Date(e.get("created_at")),r>o)?t.set("upload_limit",t.get("upload_limit")+1):void 0}}(this))},o.prototype.isRegisteredAfter=function(t){if(null==t)throw new Error("must provide cutOffDate");return moment(this.get("registration_date")).isAfter(t)},o.prototype.hasLocation=function(){return""!==this.get("city")||""!==this.get("state")||""!==this.get("country")},o.prototype.retinaAwareAvatarSmall=function(){var t,e,o,i;return window.devicePixelRatio>1?null!=(t=this.get("avatars"))&&null!=(e=t.small)?e.https:void 0:null!=(o=this.get("avatars"))&&null!=(i=o.tiny)?i.https:void 0},o.prototype.isBuyer=function(){return this.isRolledOut("unification")&&this.get("buyer")},o.prototype.isViewingLicensablePhotos=function(){return this.isViewingMarketplacePhotos()||this.isViewingImmediatelyLicensablePhotos()},o.prototype.isViewingMarketplacePhotos=function(){return this.get("photo_availability_filter")===this.MARKETPLACE_PHOTO_FILTER},o.prototype.isViewingImmediatelyLicensablePhotos=function(){return this.get("photo_availability_filter")===this.IMMEDIATELY_LICENSABLE_PHOTO_FILTER},o.prototype.isAdmin=function(){return this.get("admin")},o}(PxApp.Models.User)}.call(this),function(){var t,e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;e=App.module("Photos.Models"),e.UserMembership=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.initialize=function(t,o){var i,r,n;null==o&&(o={}),r={id:t.id};for(i in t)n=t[i],/^membership\_attr\_/.test(i)&&(r[i]=n);for(i in r)n=r[i],"id"!==i&&delete t[i];return this.user=App.Photos.Models.UserManager.createOrUpdateModel(t),e.__super__.initialize.call(this,r,o)},e.prototype.toJSON=function(){return this.user.toJSON()},e.prototype.getUser=function(){return this.user},e}(Backbone.Model),e.User=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.initialize=function(t,o){if(null==o&&(o={}),this.fromCacheManager=o.fromCacheManager,!this.fromCacheManager)throw new Error("User objects should be managed by App.Photos.Models.UserManager");return e.__super__.initialize.apply(this,arguments)},e.prototype.getFollowState=function(){return!!this.get("following")},e.prototype.isSelf=function(){var t;return(null!=(t=App.currentUser)?t.id:void 0)===this.id},e.prototype.follow=function(t){return $.post("/"+this.get("username")+"/follow").done(function(e){return function(){return e.set({followers_count:e.get("followers_count")+1,following:!0}),"function"==typeof t?t(null,!0):void 0}}(this)).fail(function(e){return function(o,i,r){var n,s;return n=(s=App.Helpers.API).parseError.apply(s,arguments),"function"==typeof t?t(n,e.getFollowState()):void 0}}(this))},e.prototype.unfollow=function(t){return $.post("/"+this.get("username")+"/unfollow").done(function(e){return function(){return e.set({followers_count:e.get("followers_count")-1,following:!1}),"function"==typeof t?t(null,!1):void 0}}(this)).fail(function(e){return function(o,i,r){var n,s;return n=(s=App.Helpers.API).parseError.apply(s,arguments),"function"==typeof t?t(n,e.getFollowState()):void 0}}(this))},e}(App.Models.User),t=function(){function t(){}return t.prototype.cache={},t.prototype.fetchingPromises={},t.prototype.createOrUpdateModel=function(t){var e,o;return e=t.id,o=this.cache[e],null==o&&(o=this.cache[e]=new App.Photos.Models.User({},{fromCacheManager:!0})),this._updateModelAttributes(o,t),o},t.prototype._updateModelAttributes=function(t,e){return t.set(e)},t.prototype._shouldFetch=function(t,e){var o;return null==e&&(e={}),o=null==t,e.followingStates&&(o||(o=null==t.get("following"))),e.viewCount&&(o||(o=null==t.get("view_count"))),o},t.prototype.getModelById=function(t,e){var o,i,r,n;return null==e&&(e={}),n=this.cache[t],e.noFetch?n:(this._shouldFetch(n,e)?null!=this.fetchingPromises[t]?r=this.fetchingPromises[t]:(o=$.Deferred(),r=this.fetchingPromises[t]=o.promise(),i={},e.viewCount&&(i.include_view_count=!0),$.get("https://api.500px.com/v1/users/"+t+"?"+$.param(i)).done(function(e){return function(i){var r;return(r=null!=i?i.user:void 0)?(n=e.createOrUpdateModel(r),o.resolve(n)):o.reject("__error::error"),delete e.fetchingPromises[t]}}(this)).fail(function(e){return function(){var i,r;return i=(r=App.Helpers.API).parseError.apply(r,arguments),o.reject(i),delete e.fetchingPromises[t]}}(this))):r=$.Deferred().resolve(n).promise(),r)},t}(),null==e.UserManager&&(e.UserManager=new t)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),$(function(){return $(".mobile_app_banner").length>0?this.mobileAppBanner=new t.MobileAppBanner:void 0}),t.MobileAppBanner=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".mobile_app_banner",o.prototype.ui={title:".text h4",button:"a.button"},o.prototype.behaviors={HasButtons:{".close":"onClose"}},o.prototype.initialize=function(t){var e;return this.bindUIElements(),e=App.Helpers.deviceType(),null!=e?(this.ui.button.prop("href",App.Helpers.appLink(e)),this.ui.title.i18n(App.Helpers.mobileOS(e)),this.$el.addClass("mobile_app_banner--show")):void 0},o.prototype.onClose=function(){return null!=App.currentUser&&$.cookie("dismiss_tooltip_mobile_app_banner_"+App.currentUser.id,1,{expires:365,path:"/"}),this.$el.hide(),App.vent.trigger("resize_header")},o}(Marionette.ItemView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("Collections"),t.InfiniteCollection=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.page=null,o.prototype.rpp=20,o.prototype.fetching=function(){return this._inProgress===!0},o.prototype.initialize=function(t,e){return null==t&&(t=[]),null==e&&(e={}),this.cursorPagination=!!this.cursorPagination,this.cursorPagination?(null==e.page&&(e.page=null),this.page=e.page):(null==e.page&&(e.page=1),null!=e.page&&(this.page=0|e.page)),null!=e.rpp&&(this.rpp=0|e.rpp),this._firstPage=this.page},o.prototype._resetState=function(){return this.page=null,this.totalPages=null,this.nextPageCursor=null,this._done=!1,this._singlePage=!1,this._inProgress=!1},o.prototype.reset=function(t,e){var i,r;return null==t&&(t=[]),null==e&&(e={}),this.trigger("before:reset"),this._resetState(),this.cursorPagination?this.page=null!=(i=e.page)?i:null:this.page=null!=(r=e.page)?r:1,t.length>0&&(this.cursorPagination||(this.page=1),t.length<this.rpp&&(this.totalPages=1,this._done=!0,this._singlePage=!0)),o.__super__.reset.apply(this,arguments)},o.prototype.getFirstPage=function(){return this._firstPage},o.prototype.fetch=function(t){var e,r,n,s,a;if(null==t&&(t={}),this.cursorPagination&&t.previousPage)throw new Error("Attempted to fetch previous page using cursor pagination");return this.cursorPagination?null==this.page&&(this.page=null):null==this.page&&(this.page=1),a=$.isFunction(this.url)?this.url():this.url,s=i.call(a,"?")>=0?"&":"?",n=null,this.cursorPagination?null!=this.nextPageCursor&&(n="next_page="+this.nextPageCursor):(r=t.previousPage?this._firstPage:this.page,n="page="+r),a=null!=n?""+a+s+n+"&rpp="+this.rpp:""+a+s+"rpp="+this.rpp,this._inProgress=!0,e=_.extend({},{url:a,remove:!1},_.omit(t,"page")),o.__super__.fetch.call(this,e).done(function(t){return function(e){return!t.cursorPagination&&t.totalPages>0&&t._firstPage>t.totalPages?(t._firstPage=t.page=t.totalPages,App.vent.trigger("pagination:overflow",t.totalPages),t.trigger("pagination:overflow",t.totalPages),t.fetch().done(function(){return t.trigger("pagination:overflow:refetched",t.totalPages)})):t._inProgress=!1}}(this))},o.prototype.nextPage=function(){var t;return t=$.Deferred(),this._inProgress||this._done?t.resolve(this.page,this._done).promise():(this._inProgress=!0,!this.cursorPagination&&(null==this.totalPages||this.page<this.totalPages)&&(this.page+=1),this.fetch().done(function(e){return function(){return t.resolve(e.page,e._done)}}(this)),t.promise())},o.prototype.previousPage=function(){var t;if(this.cursorPagination)throw new Error("Attempted to fetch previous page using cursor pagination");return t=$.Deferred(),this._inProgress||1===this._firstPage?t.resolve(this._firstPage,1===this._firstPage).promise():(this._inProgress=!0,this._firstPage-=1,this.fetch({previousPage:!0}).done(function(e){return function(){return t.resolve(e._firstPage,1===e._firstPage)}}(this)),t.promise())},o.prototype._extractModels=function(t){var e,o,r;o=["meta","total_pages","current_page","feature","total_items","total_pages","pagination","next_page"];for(e in t)if(r=t[e],i.call(o,e)<0)return r},o.prototype.finished=function(){return this._done===!0},o.prototype.singlePage=function(){return this._singlePage===!0},o.prototype.parse=function(t){return this.cursorPagination?(this._just_parsed_page=this.page=this.nextPageCursor,this.nextPageCursor=t.pagination.next_page,null==this.totalPages&&(this.totalPages=1),null!=this.nextPageCursor?this.totalPages+=1:(this._done=!0,this.trigger("pagination:end"))):(null!=t.meta?(this._just_parsed_page=t.meta.pagination.page,this.totalPages!==t.meta.pagination.total_pages&&(this.totalPages=t.meta.pagination.total_pages,this.trigger("pagination:page_count_update",this.totalPages)),this.totalItems!==t.meta.pagination.total_items&&(this.totalItems=t.meta.pagination.total_items,this.trigger("pagination:item_count_update",this.totalItems))):(this._just_parsed_page=t.current_page,this.totalPages!==t.total_pages&&(this.totalPages=t.total_pages,this.trigger("pagination:page_count_update",this.totalPages)),this.totalItems!==t.total_items&&(this.totalItems=t.total_items,this.trigger("pagination:item_count_update",this.totalItems))),this._just_parsed_page>this.page&&(this.page=this._just_parsed_page),this.page>=this.totalPages&&(this._done=!0,this.trigger("pagination:end"))),this._extractModels(t)},o}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Models"),t.Comment=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.isOwner=function(){var t;return(null!=(t=App.currentUser)?t.id:void 0)===this.get("user_id")||null==this.get("user_id")},o.prototype.clone=function(){var t;return t=o.__super__.clone.apply(this,arguments),t.original=this,t},o.prototype._loadId=function(){return this.isNew()&&null!=this.original?this.set("id",this.original.id):void 0},o.prototype.displayBody=function(){return this.get("translated")?this._translatedCopy:this.get("body")},o.prototype.translate=function(){return null!=this._translatedCopy?void this.set("translated",!0):App.Helpers.Translator.translate(this.get("body"),function(t){return function(e){return e?(t._translatedCopy=e,t.set("translated",!0)):t.trigger("change:translated")}}(this))},o.prototype.showOriginal=function(){return this.set("translated",!1)},o.prototype.reportContent=function(t){return this._loadId(),$.post("https://api.500px.com/v1/comments/"+this.id+"/flag").done(function(e){return function(){return e.set("flagged",!0),"function"==typeof t?t(null):void 0}}(this)).fail(function(e){return function(){var e,o;return e=(o=App.Helpers.API).parseError.apply(o,arguments),"function"==typeof t?t(e):void 0}}(this))},o.prototype.destroy=function(t){return null==t&&(t={}),this._loadId(),t.url="https://api.500px.com/v1/comments/"+this.id,o.__super__.destroy.call(this,t)},o.prototype.parse=function(t,e){return t.status?o.__super__.parse.call(this,t.comment,e):o.__super__.parse.apply(this,arguments)},o}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=function(t,e){return function(){return t.apply(e,arguments)}};t=App.module("Photos.Collections"),t.CommentAndReplies=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.model=App.Photos.Models.Comment,o.prototype.initialize=function(t,e){return null==e&&(e={}),this.parent=e.parent,o.__super__.initialize.apply(this,arguments)},o.prototype.url=function(){return"https://api.500px.com/v1/comments/"+this.parent.id+"/comments"},o}(Backbone.Collection),t.Comments=function(t){function o(){return this.url=i(this.url,this),o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.rpp=30,o.prototype.model=App.Photos.Models.Comment,o.prototype.initialize=function(t,e){return null==t&&(t=!1),null==e&&(e={}),this.photo=e.photo},o.prototype.url=function(){return"https://api.500px.com/v1/photos/"+this.photo.id+"/comments?"+$.param({sort:"created_at",include_subscription:1,include_flagged:1,nested:1})},o.prototype.parse=function(t){var e;return e={comments:t.comments,meta:{pagination:{page:t.current_page,total_items:t.total_items,total_pages:t.total_pages}}},o.__super__.parse.call(this,e)},o}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Collections"),t.FavoritedByUsers=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.model=App.Photos.Models.UserMembership,o.prototype.rpp=8,o.prototype.initialize=function(t,e){return this.photo=e.photo},o.prototype.url=function(){var t;return t={sort:"friends"},"https://api.500px.com/v1/photos/"+this.photo.id+"/favorites?"+$.param(t)},o.prototype.parse=function(t){var e;return e={users:t.users,meta:{pagination:{page:t.current_page,total_items:t.total_items,total_pages:t.total_pages}}},o.__super__.parse.call(this,e)},o}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t;
}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Collections"),t.LikedByUsers=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.model=App.Photos.Models.UserMembership,o.prototype.rpp=8,o.prototype.initialize=function(t,e){return this.photo=e.photo},o.prototype.url=function(){var t;return t={include_following:!0},"https://api.500px.com/v1/photos/"+this.photo.id+"/votes?"+$.param(t)},o.prototype.parse=function(t){var e;return e={users:t.users,meta:{pagination:{page:t.current_page,total_items:t.total_items,total_pages:t.total_pages}}},o.__super__.parse.call(this,e)},o}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty,r=function(t,e){return function(){return t.apply(e,arguments)}},n=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};e=App.module("Photos.Models"),e.PhotoMembership=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.initialize=function(t,o){var i,r,n;null==o&&(o={}),r={id:t.id};for(i in t)n=t[i],/^membership\_attr\_/.test(i)&&(r[i]=n);for(i in r)n=r[i],"id"!==i&&delete t[i];return this.photo=App.Photos.Models.PhotoManager.createOrUpdateModel(t),e.__super__.initialize.call(this,r,o)},e.prototype.toJSON=function(){return this.photo.toJSON()},e.prototype.getPhoto=function(){return this.photo},e}(Backbone.Model),e.Photo=function(t){function e(){return this.reportContent=r(this.reportContent,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.SHARELIZER_IMAGE_SIZE=2048,e.prototype.CATEGORIES={10:"Abstract",11:"Animals",5:"Black and White",1:"Celebrities",9:"City & Architecture",15:"Commercial",16:"Concert",20:"Family",14:"Fashion",2:"Film",24:"Fine Art",23:"Food",3:"Journalism",8:"Landscapes",12:"Macro",18:"Nature",4:"Nude",7:"People",19:"Performing Arts",17:"Sport",6:"Still Life",21:"Street",26:"Transportation",13:"Travel",22:"Underwater",27:"Urban Exploration",25:"Wedding",0:"Uncategorized"},e.prototype.LICENSE_URLS={0:"https://500px.com/terms",1:"https://creativecommons.org/licenses/by-nc/3.0/",2:"https://creativecommons.org/licenses/by-nc-nd/3.0/",3:"https://creativecommons.org/licenses/by-nc-sa/3.0/",4:"https://creativecommons.org/licenses/by/3.0/",5:"https://creativecommons.org/licenses/by-nd/3.0/",6:"https://creativecommons.org/licenses/by-sa/3.0/",7:"http://creativecommons.org/publicdomain/mark/1.0/",8:"http://creativecommons.org/publicdomain/zero/1.0/"},e.prototype.LICENSE_NAMES={0:"Standard 500px License",1:"Attribution-NonCommercial 3.0",2:"Attribution-NonCommercial-NoDerivs 3.0",3:"Attribution-NonCommercial-ShareAlike 3.0",4:"Attribution 3.0",5:"Attribution-NoDerivs 3.0",6:"Attribution-ShareAlike 3.0",7:"Public Domain Mark 1.0",8:"Public Domain Dedication"},e.prototype.LICENSING_STATUS={PRIME:3,EDITORIAL:6,SUBPRIME:5,SUBEDITORIAL:7,SUBMITTED:2,PRESUBMITTED:9,NONE:0,ILLEGAL:8,PENDING:4,RIGHTS_MANAGED:10,REMOVED:1},e.prototype.WEB_READY_LONGEST_EDGE=1500,e.prototype.url=function(){return"https://webapi.500px.com/photos/"+this.id},e.prototype.initialize=function(t,o){if(null==o&&(o={}),this._commentsData=o.commentsData,this.fromCacheManager=o.fromCacheManager,!this.fromCacheManager)throw new Error("Photo objects should be managed by App.Photos.Models.PhotoManager");return e.__super__.initialize.apply(this,arguments)},e.prototype.hasGeoCoords=function(){return!0},e.prototype.geoCoords=function(){var t,e;return null!=(e=this.get("longitude"))&&null!=(t=this.get("latitude"))?{longitude:e,latitude:t}:null},e.prototype.setAsCover=function(){var t,e,o;if(!this._settingCover)return this._settingCover=!0,this.trigger("cover:setting"),o="https://media.500px.com/upload/user/cover",o+="?"+$.param({user_id:App.currentUser.id,authenticity_token:PxApp.csrf_token}),t=new FormData,t.append("source_photo_id",this.id),e=$.ajax({type:"POST",url:o,data:t,processData:!1,contentType:!1,cache:!1}),e.done(function(t){return function(){return t.set("is_cover",!0),t.trigger("cover:succeeded")}}(this)).fail(function(t){return function(e,o,i){return t.trigger("cover:failed")}}(this)).always(function(t){return function(){return t._settingCover=!1}}(this)),e},e.prototype.canBeCover=function(){var t,e;return null==(e=this.get("width"))||null==(t=this.get("height"))?!1:e>=2e3&&t>=1e3},e.prototype.reportContent=function(t,e){var o,i;return null==e&&(e=""),i={reason:t},"0"===t&&(i.reason_details=e),o=$.post("https://api.500px.com/v1/photos/"+this.id+"/report",i),o.done(function(e){return function(){return e._contentReported=!0,e._contentReportReason=t,$.cookie("reported-this-photo-"+e.id,"1"),e.trigger("contentReported",t)}}(this)),o},e.prototype.contentReported=function(){var t;return!!(null!=(t=this._contentReported)?t:"1"===$.cookie("reported-this-photo-"+this.id))},e.prototype.contentReportReason=function(){return this._contentReportReason},e.prototype.isEditorsChoice=function(){return!!this.get("editors_choice")},e.prototype.canBeEditorsChoice=function(){return App.currentUser?App.currentUser.id!==this.get("user_id")&&!this.get("nsfw"):!1},e.prototype.submitLicensingRequest=function(t){var e;return null==t&&(t={}),App.currentUser?(e=t.suggest?$.post("https://api.500px.com/v1/photos/"+this.id+"/licensing_suggest"):$.post("https://api.500px.com/v1/photos/"+this.id+"/licensing_request"),e.done(function(e){return function(){return t.suggest?e.set({licensing_suggested:!0}):e.set({licensing_requested:!0})}}(this)),e):void 0},e.prototype.submitEditorsChoice=function(){var t;if(App.currentUser&&!this.isEditorsChoice())return t=$.post("https://api.500px.com/v1/editors/photos/"+this.id+"/editors_choice"),t.done(function(t){return function(){return t.set({editors_choice:!0,editors_choice_date:Date.now(),editored_by:{fullname:App.currentUser.get("fullname"),user_id:App.currentUser.id}})}}(this)),t},e.prototype.removeEditorsChoice=function(){var t;if(App.currentUser&&this.isEditorsChoice())return t=$.ajax({type:"DELETE",url:"https://api.500px.com/v1/editors/photos/"+this.id+"/editors_choice"}),t.done(function(t){return function(){return t.set({editors_choice:!1,editors_choice_date:null,editored_by:null})}}(this)),t},e.prototype.newResolutionCalculation=function(t){var e,o,i,r,n,s,a,l;return a=this.get("store_width")||this.get("width"),s=this.get("store_height")||this.get("height"),n=[a,s],l=n[0],o=n[1],null!=t.resize_max&&t.resize_max>0&&(a>=s?(l=Math.min(a,t.resize_max),o=Math.round(s*l/a)):(o=Math.min(s,t.resize_max),l=Math.round(a*o/s))),e=t.resize_dpi,r=Math.floor(l/e*10)/10,i=Math.floor(o/e*10)/10,{width:l,height:o,printWidth:r,printHeight:i}},e.prototype.isAvailableForImmediatePurchase=function(){var t;return t=this.get("licensing_status"),null==t?!1:_.contains([this.LICENSING_STATUS.PRIME,this.LICENSING_STATUS.SUBPRIME,this.LICENSING_STATUS.EDITORIAL,this.LICENSING_STATUS.SUBEDITORIAL],t)},e.prototype.isSubmitted=function(){return _.contains([this.LICENSING_STATUS.SUBMITTED,this.LICENSING_STATUS.PRESUBMITTED],this.get("licensing_status"))},e.prototype.isUnderSubmission=function(){var t;return t=this.get("licensing_status"),null==t?!1:_.contains([this.LICENSING_STATUS.SUBMITTED,this.LICENSING_STATUS.PRESUBMITTED,this.LICENSING_STATUS.PENDING],t)},e.prototype.getMarketplaceLicenses=function(){var t,e;return e="https://api.500px.com/v1/photos/"+this.id+"/licenses",t=$.ajax({url:e,dataType:"json"}),t.done(function(t){return function(e){var o,i,r,n;return n=e,i=new Backbone.Model(e.currency),o=_.each(n.basic_licenses,function(e){return e.resolution=t.newResolutionCalculation(e),e.currency=i}),r=_.each(n.extended_licenses,function(e){return e.resolution=t.newResolutionCalculation(e),e.currency=i}),t.set({basic_licenses:o,extended_licenses:r,currency:i})}}(this))},e.prototype.getLicenseName=function(){var t;return t=this.get("license_type"),this.LICENSE_NAMES[t]},e.prototype.getAllLicenseNames=function(){var t,e,o;return o=[],(t=this.get("basic_licenses"))&&o.push.apply(o,t.map(function(t){return t.license_name})),(e=this.get("extended_licenses"))&&o.push.apply(o,e.map(function(t){return t.license_name})),o},e.prototype.isContributorCollection=function(){return!this.isCuratedCollection()},e.prototype.isCuratedCollection=function(){var t;return(t=this.get("licensing_status"))===this.LICENSING_STATUS.PRIME||t===this.LICENSING_STATUS.EDITORIAL},e.prototype.deprecatedLicenseUrl=function(t,e){var o;return null==e&&(e=""),o={utm_source:"500px",utm_content:this.LICENSES[t].utmContent,utm_term:e,utm_medium:"referral",utm_campaign:"photo page",license_type:t},"https://marketplace.500px.com/checkout/"+this.id+"?"+$.param(o)},e.prototype.marketplaceLicenseUrl=function(t,e){var o;return null==e&&(e=""),o={utm_source:"500px",utm_term:e,utm_medium:"referral",utm_campaign:"photo page",licenses:t},"https://marketplace.500px.com/checkout/"+this.id+"?"+$.param(o)},e.prototype.compUrl=function(){return"https://marketplace.500px.com/photos/"+this.id+"/comp"},e.prototype.isExclusive=function(){var t;return t=this.get("licensing_status"),null==t?!1:_.contains([this.LICENSING_STATUS.NONE,this.LICENSING_STATUS.REMOVED,this.LICENSING_STATUS.ILLEGAL,this.LICENSING_STATUS.PENDING,this.LICENSING_STATUS.RIGHTS_MANAGED],t)?!1:"exclusive"===this.get("licensing_type")},e.prototype.isEditorial=function(){return _.contains([this.LICENSING_STATUS.EDITORIAL,this.LICENSING_STATUS.SUBEDITORIAL],this.get("licensing_status"))},e.prototype.isModelReleased=function(){var t;return t=this.get("releases"),null==t?!1:!!_.find(t,function(t){return"model"===t.type})},e.prototype.isLocationReleased=function(){var t;return t=this.get("releases"),null==t?!1:!!_.find(t,function(t){return"location"===t.type})},e.prototype.isPurchasable=function(){var t;return t=this.get("licensing_status"),null==t?!0:!_.contains([this.LICENSING_STATUS.REMOVED,this.LICENSING_STATUS.ILLEGAL],t)},e.prototype.isSubmittable=function(){var t;return t=this.get("licensing_status"),null==t?!0:!_.contains([this.LICENSING_STATUS.ILLEGAL],t)},e.prototype.isRequestable=function(){return this.get("license_requests_enabled")},e.prototype.isStoreEnabled=function(){var t;return!!(null!=(t=this.getUser())?t.get("store_on"):void 0)},e.prototype.isRightsManaged=function(){return this.get("licensing_status")===this.LICENSING_STATUS.RIGHTS_MANAGED},e.prototype.isIllegal=function(){return this.get("licensing_status")===this.LICENSING_STATUS.ILLEGAL},e.prototype.isLicenseable=function(){return this.isStoreEnabled()?this.isOwner()?this.isSubmittable():this.isCreativeCommonsCompatible()?!0:this.isAvailableForImmediatePurchase()?!0:this.isRequestable()?this.isPurchasable():this.isUnderSubmission():!1},e.prototype.isFreePhoto=function(){return this.get("is_free_photo")},e.prototype.freePhotoUrl=function(){return"https://marketplace.500px.com/freephoto/download"},e.prototype.isCreativeCommonsCompatible=function(){var t;return t=this.get("license_type"),null!=t&&0!==t},e.prototype.getCreativeCommonsLicenseUrl=function(){var t;return this.isCreativeCommonsCompatible()?(t=this.get("license_type"),this.LICENSE_URLS[t]):void 0},e.prototype.getCreativeCommonsPhotoUrl=function(){return this.isCreativeCommonsCompatible()?this.imageUrl():void 0},e.prototype.getComments=function(){var t;return null!=this._comments?this._comments:this._comments=new App.Photos.Collections.Comments(null!=(t=this._commentsData)?t:!1,{photo:this})},e.prototype.like=function(){var t;return t=e.__super__.like.apply(this,arguments),t.done(function(t){return function(){var e,o;return e=t.getLikedByUsers(),null!=e.totalItems?(o=$.Deferred().resolve(),e.totalItems+=1,App.Photos.Models.UserManager.getModelById(App.currentUser.id,{noFetch:!0})||App.Photos.Models.UserManager.createOrUpdateModel(App.currentUser.toJSON()),e.add(new App.Photos.Models.UserMembership({id:App.currentUser.id}),{at:0})):o=e.fetch(),o.done(function(){return t.trigger("change:likedByCurrentUser")})}}(this))},e.prototype.unlike=function(){var t;return t=e.__super__.unlike.apply(this,arguments),t.done(function(t){return function(){var e,o;return e=t.getLikedByUsers(),null!=e.totalItems?(e.totalItems-=1,o=e.findWhere({id:App.currentUser.id}),null!=o&&e.remove(o),t.trigger("change:likedByCurrentUser")):void 0}}(this))},e.prototype.favorite=function(){var t;return t=e.__super__.favorite.apply(this,arguments),t.done(function(t){return function(){var e,o;return e=t.getFavoritedByUsers(),null!=e.totalItems?(o=$.Deferred().resolve(),e.totalItems+=1,App.Photos.Models.UserManager.getModelById(App.currentUser.id,{noFetch:!0})||App.Photos.Models.UserManager.createOrUpdateModel(App.currentUser.toJSON()),e.add(new App.Photos.Models.UserMembership({id:App.currentUser.id}),{at:0})):o=e.fetch(),o.done(function(){return t.trigger("change:favoritedByCurrentUser")})}}(this))},e.prototype.unfavorite=function(){var t;return t=e.__super__.unfavorite.apply(this,arguments),t.done(function(t){return function(){var e,o;return e=t.getFavoritedByUsers(),null!=e.totalItems?(e.totalItems-=1,o=e.findWhere({id:App.currentUser.id}),null!=o&&e.remove(o),t.trigger("change:favoritedByCurrentUser")):void 0}}(this))},e.prototype.getFavoritedByUsers=function(){return null!=this._favoritedByUsers?this._favoritedByUsers:this._favoritedByUsers=new App.Photos.Collections.FavoritedByUsers(!1,{photo:this})},e.prototype.getLikedByUsers=function(){return null!=this._likedByUsers?this._likedByUsers:this._likedByUsers=new App.Photos.Collections.LikedByUsers(!1,{photo:this})},e.prototype.getRelatedPhotos=function(){return null!=this._relatedPhotos?this._relatedPhotos:this._relatedPhotos=new App.Photos.Collections.RelatedPhotos(!1,{photoId:this.id})},e.prototype.getUser=function(){return null!=this._user?this._user:this._user=App.Photos.Models.UserManager.getModelById(this.get("user_id"),{noFetch:!0})},e.prototype.getCamera=function(){var t,e;return t=$.Deferred(),null==this.get("camera")?t.resolve(!1):null!=this._camera?t.resolve(this._camera):(e=$.get("https://webapi.500px.com/camera/lookup/"+this.get("camera")),e.done(function(e){return function(o){return o.cameras.length>0?(e._camera=new Backbone.Model(o.cameras[0]),t.resolve(e._camera)):(e._camera=!1,t.resolve(e._camera))}}(this))),t},e.prototype.toJSON=function(t){var o;return _.extend(e.__super__.toJSON.apply(this,arguments),{user:null!=(o=this.getUser())?o.toJSON():void 0})},e.prototype.share=function(t){return null==this.popup&&(this.popup=new App.Lib.Sharelizer({url:this.getCanonicalUrl(),category:"Photo Page"})),this[t]()},e.prototype.google=function(t){return this.popup.google()},e.prototype.facebook=function(){return this.popup.facebook()},e.prototype.vk=function(){return this.popup.vk()},e.prototype._pinterestShareData=function(){return{media:this.getImagePath({size:this.SHARELIZER_IMAGE_SIZE}),description:this.get("name")+" - "+this.get("description")}},e.prototype.pinterest=function(){var t;if(t=this._pinterestShareData(),!t.media||!t.description)throw"This view doesn't know how to share with pinterest";return this.popup.pinterest(t.media,t.description)},e.prototype._twitterShareData=function(){var t,e,o,i;return e=this.get("name"),i=null!=(o=this.getUser().get("contacts"))?o.twitter:void 0,t=this.getUser().get("fullname"),i?{text:'"'+e+'" by @'+i+"."}:{text:'"'+e+'" by '+t+"."}},e.prototype.twitter=function(){var t;if(t=this._twitterShareData(),!t.text)throw"This view doesn't know how to share with twitter";return this.popup.twitter(t.text)},e.prototype._stumbleuponShareData=function(){return{title:'Photo "'+this.get("name")+'" by '+this.getUser().get("fullname")}},e.prototype.stumbleupon=function(){var t;if(t=this._stumbleuponShareData(),!t.title)throw"This view doesn't know how to share with StumbleUpon";return this.popup.stumbleupon(t)},e.prototype.getCategoryText=function(){return this.CATEGORIES[this.get("category")]},e}(App.Models.PhotoForViewer),t=function(){function t(){}return t.prototype.MAX_BATCH_SIZE=50,t.prototype.BATCH_INTERVAL=200,t.prototype.cache={},t.prototype.fetchingPromises={},t.prototype.createOrUpdateModel=function(t){var e,o;return e=t.id,o=this.cache[e],null==o&&(o=this.cache[e]=new App.Photos.Models.Photo({},{fromCacheManager:!0})),this._updateModelAttributes(o,t),o},t.prototype._updateModelAttributes=function(t,e){var o,i,r,n,s,a,l,u;if(e.user&&(u=e.user,l=App.Photos.Models.UserManager.createOrUpdateModel(u),t.set("user",l)),e.images){for(o=null!=(s=t.get("images"))?s:[],a=e.images,i=0,n=a.length;n>i;i++)r=a[i],null==t.getInternalImagePath({size:r.size,ignoresConverting:!0})&&o.push(r);t.set("images",o)}return t.set(_.omit(e,"user","images"))},t.prototype._apiParams=function(){return{image_size:["1","2","32","31","33","34","35","36","2048","4","14"],include_tags:!0,include_licensing:!0,include_releases:!0,expanded_user_info:!0,is_following:!0}},t.prototype.prefetchModels=function(t,e){var o,i,r,n,s;for(null==e&&(e={}),s=[],o=0,r=t.length;r>o;o++)i=t[o],n=this.cache[i],this._shouldFetch(n,e)&&(this.fetchingPromises[i]||s.push(i));return s.length>0?e.batchable?this._startBatchedPrefetch(s):this._internalPrefetchModels(s):void 0},t.prototype._startBatchedPrefetch=function(t){return null==this.batchedPhotoIds&&(this.batchedPhotoIds=[]),this.batchedPhotoIds=this.batchedPhotoIds.concat(t),this.batchedPhotoIds.length>=this.MAX_BATCH_SIZE?this._processQueuedPrefetch():(null==this._throtted&&(this._throtted=_.throttle(function(t){return function(){return t._processQueuedPrefetch()}}(this),this.BATCH_INTERVAL,{leading:!1,trailing:!0})),this._throtted())},t.prototype._processQueuedPrefetch=function(){var t,e,o,i,r;if(this.batchedPhotoIds.length){for(r=[],i=this.batchedPhotoIds,t=0,o=i.length;o>t;t++)e=i[t],n.call(r,e)<0&&(this.fetchingPromises[e]||r.push(e));return this.batchedPhotoIds=[],this._internalPrefetchModels(r)}},t.prototype._internalPrefetchModels=function(t){var e,o,i,r,n,s;for(o={},i=0,n=t.length;n>i;i++){if(r=t[i],null!=this.fetchingPromises[r])throw new Error("Found an existing promise object for photo-"+r);e=$.Deferred(),this.fetchingPromises[r]=e.promise(),o[r]=e}return s=_.extend(this._apiParams(),{ids:t.join(",")}),$.get("https://api.500px.com/v1/photos?"+$.param(s)).done(function(t){return function(i){var n,s,a,l;l=[];for(r in o)e=o[r],null!=(n=null!=i&&null!=(a=i.photos)?a[r]:void 0)?(s=t.createOrUpdateModel(n),e.resolve(s)):e.reject("__error::error"),l.push(delete t.fetchingPromises[r]);return l}}(this)).fail(function(t){return function(){var i,n,s;i=(n=App.Helpers.API).parseError.apply(n,arguments),s=[];for(r in o)e=o[r],e.reject(i),s.push(delete t.fetchingPromises[r]);return s}}(this))},t.prototype._shouldFetch=function(t,e){var o,i;return null==e&&(e={}),o=null==t,e.favoriteAndLikeStates&&(o||(o=null==t.get("favorited")||null==t.get("liked"))),e.licensingStates&&(o||(o=null==t.get("licensing_status"))),e.userFollowingStates&&(o||(o=null==(i=t.getUser())),o||(o=!i.isSelf()&&null==i.get("following"))),o},t.prototype.getCachedModelById=function(t){return this.cache[t]},t.prototype.getModelById=function(t,e){var o,i,r,n;return null==e&&(e={}),r=this.cache[t],e.noFetch?$.Deferred().resolve(r).promise():(this._shouldFetch(r,e)?null!=this.fetchingPromises[t]?n=this.fetchingPromises[t]:(o=$.Deferred(),n=this.fetchingPromises[t]=o.promise(),i=_.extend(this._apiParams(),{ids:t}),$.get("https://api.500px.com/v1/photos?"+$.param(i)).done(function(e){return function(i){var n,s;return null!=(n=null!=i&&null!=(s=i.photos)?s[t]:void 0)?(r=e.createOrUpdateModel(n),o.resolve(r)):o.reject("__error::error"),delete e.fetchingPromises[t]}}(this)).fail(function(e){return function(){var i,r;return i=(r=App.Helpers.API).parseError.apply(r,arguments),o.reject(i),delete e.fetchingPromises[t]}}(this))):n=$.Deferred().resolve(r).promise(),n)},t}(),null==e.PhotoManager&&(e.PhotoManager=new t)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("Photos.Collections"),t.NavigationalInfiniteCollection=function(t){function o(t,e){var i;null==e&&(e={}),this.navigationDisabled=null!=(i=e.navigationDisabled)?i:!1,this.navigationDisabled||(this.comparator="membership_attr_nav_offset"),o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.FETCH_MORE_THRESHOLD=5,o.prototype.photoAt=function(t){throw new Error("Not implemented!")},o.prototype._getPhotoIds=function(){throw new Error("Not implemented!")},o.prototype._contextUrlParams=function(){throw new Error("Not implemented!")},o.prototype._extractPhotoIdFromItem=function(t){throw new Error("Not implemented!")},o.prototype._buildDisplayedItemData=function(t){throw new Error("Not implemented!")},o.prototype.shouldHideRelatedPhotos=function(){throw new Error("Not implemented!")},o.parseBrowserUrlParams=function(t){var e,o,i;return e={contextName:t},o=null!=(i=App.controller.tidyIntParam("ctx_page"))?i:1,0>=o&&(o=1),e.page=o,e},o.prototype.initialize=function(t,e){return null==e&&(e={}),o.__super__.initialize.apply(this,arguments),this.navigationDisabled?void 0:(e.contextHash&&(this._selectedPhotoPage=this._firstPage=this.page=e.contextHash.page,this._displayedPhoto=e.contextHash.displayedPhoto),this.listenToOnce(this,"pagination:overflow:refetched",function(t){return function(e){var o,i;if(null!=t._displayedPhotoId){if(i=t._getPhotoIds().indexOf(t._displayedPhotoId),null==i)throw new Error("Cannot find the injected photo in nav context!");return o=t.at(i),o.set({membership_attr_nav_page:e,membership_attr_nav_intra_page_offset:0,membership_attr_nav_offset:(e-1)*(t.rpp+1)},{silient:!0}),1!==e?t.previousPage():void 0}}}(this)))},o.prototype.buildBrowserUrlParams=function(){if(this.navigationDisabled)throw new Error("navigation is disabled");return _.extend({ctx_page:this._selectedPhotoPage},this._contextUrlParams())},o.prototype.selectedPhotoOffset=function(){if(this.navigationDisabled)throw new Error("navigation is disabled");return this._selectedPhotoId?this._getPhotoIds().indexOf(this._selectedPhotoId):-1},o.prototype.selectPhoto=function(t){var e;if(this.navigationDisabled)throw new Error("navigation is disabled");switch(e=this._internalSelectPhoto(t)){case 1:return this.nextPage();case-1:return this.previousPage()}},o.prototype.getLength=function(){return this.length},o.prototype._internalSelectPhoto=function(t){var e,o,i,r,n;if(this._selectedPhotoId!==t.id){if(i=this._getPhotoIds(),e=i.indexOf(t.id),null==e)throw new Error("Cannot find the newly selected photo in nav context!");return this._selectedPhotoId=t.id,r=this.at(e),this._selectedPhotoPage=r.get("membership_attr_nav_page"),n=r.get("membership_attr_nav_intra_page_offset"),n<=this.FETCH_MORE_THRESHOLD?(o=this.getFirstPage(),1===o?!1:this._selectedPhotoPage-1>=o?!1:-1):n>this.rpp-this.FETCH_MORE_THRESHOLD?this.finished()?!1:this._selectedPhotoPage+1<=this.page?!1:1:!1}},o.prototype.parse=function(t){var e,r,n,s,a,l,u,p,c;return t=o.__super__.parse.call(this,t),this.navigationDisabled?t:(n=null!=(c=this._displayedPhoto)?c.id:void 0,a=null==n,r=(this._just_parsed_page-1)*(2*this.rpp+1),s=this._getPhotoIds(),e=function(){var e,o,c;for(c=[],l=e=0,o=t.length;o>e;l=++e)u=t[l],p=this._extractPhotoIdFromItem(u),i.call(s,p)>=0||(s.unshift(p),u.membership_attr_nav_page=this._just_parsed_page,u.membership_attr_nav_intra_page_offset=l+1,u.membership_attr_nav_offset=r+u.membership_attr_nav_intra_page_offset,a||(a=p===n),c.push(u));return c}.call(this),a||(u=this._buildDisplayedItemData(this._displayedPhoto),u.membership_attr_nav_page=this._just_parsed_page,u.membership_attr_nav_intra_page_offset=0,u.membership_attr_nav_offset=r,e.unshift(u),this._displayedPhotoId=this._displayedPhoto.id),this._displayedPhoto=null,e)},o}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("Photos.Collections"),t.PhotoNavigation=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.model=App.Photos.Models.PhotoMembership,o.prototype.FETCH_MORE_THRESHOLD=5,o.prototype.DEFAULT_CONTEXT="user",o.prototype.HIDE_RELATED_PHOTOS_CONTEXTS=["user"],o.parseBrowserUrlParams=function(t){var e,o,i;switch(e={contextName:t},t){case"user_favorites":if(e.userId=null!=(o=App.controller.tidyIntParam("user_id"))?o:-1,!(e.userId>0))return null;break;case"set":if(e.setId=null!=(i=App.controller.tidyIntParam("set_id"))?i:-1,!(e.setId>0))return null}return e.categoryFilter=App.controller._loadPageVar("only"),e},o.prototype.initialize=function(t,e){if(!e.contextHash)throw new Error("contextHash is missing");return this.contextHash=e.contextHash},o.prototype.buildBrowserUrlParams=function(){var t,e;switch(e={},t=this.contextHash.contextName,t!==this.DEFAULT_CONTEXT&&(e.from=t),t){case"user_favorites":e.user_id=this.contextHash.userId;break;case"set":e.set_id=this.contextHash.setId}return e},o.prototype.url=function(){var t,e,o;return t={},o="/photos/"+this.contextHash.photoId+"/navigation",e=this.contextHash.contextName,t.from=e,"user_favorites"===e&&(t.user_id=this.contextHash.userId),"set"===e&&(t.set_id=this.contextHash.setId),this.contextHash.categoryFilter&&(t.only=this.contextHash.categoryFilter),t.formats="jpeg,lytro",t.image_size=["1","2","32","31","33","34","35","36","2048","4","14"],"https://api.500px.com/v1"+o+"?"+$.param(t)},o.prototype.parse=function(t){return t.photos},o.prototype.shouldHideRelatedPhotos=function(){var t;return t=this.contextHash.contextName,i.call(this.HIDE_RELATED_PHOTOS_CONTEXTS,t)>=0},o.prototype.getLength=function(){return this.length},o.prototype.photoAt=function(t){return this.at(t).getPhoto()},o.prototype.selectedPhotoOffset=function(){var t;return t=this.pluck("id"),t.indexOf(this.contextHash.photoId)},o.prototype.selectPhoto=function(t){var e;return e=this._internalSelectPhoto(t),e?this.fetch():void 0},o.prototype._internalSelectPhoto=function(t){var e,o,i,r,n,s;if(r=this.pluck("id"),n=r.indexOf(this.contextHash.photoId),o=r.indexOf(t.id),this.contextHash.photoId=t.id,n===o)return!1;if(o>n){if(o+this.FETCH_MORE_THRESHOLD<r.length)return!1;if(i=r[r.length-1],this.prevRightmostPhotoId===i)return!1}else{if(o-this.FETCH_MORE_THRESHOLD>=0)return!1;if("popular"!==(s=this.contextName)&&"fresh"!==s&&"upcoming"!==s&&(e=r[0],this.prevLeftmostPhotoId===e))return!1}return!0},o.prototype.fetch=function(){var t;return this.length&&(t=this.pluck("id"),this.prevLeftmostPhotoId=t[0],this.prevRightmostPhotoId=t[t.length-1]),o.__super__.fetch.apply(this,arguments)},o}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Groups.Models"),t.Post=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.urlRoot=function(){return"https://api.500px.com/v1/groups/"+this.get("group_id")+"/posts"},o.prototype.url=function(){var t,e;return t=this.urlRoot(),e=this.get("id")?t+"/"+this.get("id"):this.get("parent_post_id")?t+"/"+this.get("parent_post_id")+"/replies":t,e+"?"+$.param(this._urlParams())},o.prototype._urlParams=function(){var t;return t={thumbnail_sizes:[3,600],attachment_sizes:[4,2048],include_top_replies:!0,include_attribution:!0,include_attachments:!0}},o.prototype.defaults={topic:"",body:"",translated:!1},o.prototype.exportable=["isPostOwner","canDelete","canBan","displayedBody","thumbnailPhotoUrl","thumbnailPhoto2xUrl"],o.prototype.viewOnlyAttrs=["group","created_by"],o.prototype.toJSON=function(t){return _.has(null!=t?t:{},"emulateHTTP")&&this.viewOnlyAttrs?_.omit(this.attributes,this.viewOnlyAttrs):o.__super__.toJSON.apply(this,arguments)},o.prototype.validate=function(t){var e;return e=[],"photo"===t.discussion_type?t.attachments.length>0||e.push(["attachments","blank"]):(null==t.parent_post_id&&(t.topic.trim().length>0||e.push(["topic","blank"])),t.body.trim().length>0||e.push(["body","blank"])),e.length>0?_.object(e):void 0},o.prototype.isOwnedBy=function(t){return t.id===this.get("created_by").id},o.prototype.slug=function(){return this.get("topic").toLowerCase().replace(/[^a-z0-9\s]/g,"").trim().replace(/\s+/g,"-")},o.prototype.score=function(){return this.get("votes_count")>=0?2*this.get("positive_votes_count")-this.get("votes_count"):""},o.prototype.isPostOwner=function(){return null!=App.currentUser&&this.postOwnerId()===App.currentUser.id},o.prototype.postOwnerId=function(){return null!=this.get("created_by")?this.get("created_by").id:this.get("user_id")},o.prototype.isGroupAdmin=function(){return null!=App.currentUser&&this.get("group_admin")},o.prototype.canFlag=function(){return null!=App.currentUser&&!this.isPostOwner()&&!this.isGroupAdmin()&&!App.currentUser.get("admin")},o.prototype.canDelete=function(){return null!=App.currentUser&&(this.isPostOwner()||this.isGroupAdmin()||App.currentUser.get("admin"))},o.prototype.canBan=function(){return null!=App.currentUser&&(this.isGroupAdmin()||App.currentUser.get("admin"))&&App.currentUser.id!==this.postOwnerId()},o.prototype.thumbnailPhotoUrl=function(){var t,e;return null!=(t=this.get("thumbnail_photo"))&&null!=(e=t[3])?e.secure_url:void 0},o.prototype.thumbnailPhoto2xUrl=function(){var t,e;return null!=(t=this.get("thumbnail_photo"))&&null!=(e=t[600])?e.secure_url:void 0},o.prototype.buildReply=function(t){var e;return null==t&&(t={}),e=new o,e.set({parent_post_id:this.id,group_id:this.get("group_id"),created_by:App.currentUser,replies_count:this.get("replies_count")}),e.set(t),e},o.prototype.getAttachments=function(){var t;return new App.Collections.Attachments(null!=(t=this.get("attachments"))?t:!1,{postId:this.id})},o.prototype.getActiveAttachments=function(){var t;return new App.Collections.Attachments(null!=(t=_.filter(this.get("attachments"),function(t){return!t.deleted}))?t:[],{postId:this.id})},o.prototype.getActiveAttachmentsCount=function(){var t,e,o,i,r;if(null!=this.get("attachments")){for(e=0,r=this.get("attachments"),o=0,i=r.length;i>o;o++)t=r[o],t.deleted||(e+=1);return e}return this.get("attachments_count")},o.prototype.getTopReplies=function(t){var e;return null==t&&(t=2),null!=this._topReplies?this._topReplies:this._topReplies=new App.Groups.Collections.Posts(null!=(e=_.first(this.get("top_replies"),t))?e:!1,{groupId:this.get("group_id"),postId:this.id,nested:!0})},o.prototype.getReplies=function(t){var e,o;return null==t&&(t={}),null!=this._replies?this._replies:this._replies=new App.Groups.Collections.Posts(null!=(e=this.get("replies"))?e:!1,{groupId:this.get("group_id"),postId:this.id,page:null!=(o=t.page)?o:1,include:t.highlightReply,nested:null!=this.get("parent_post_id")})},o.prototype.getUser=function(){return this.get("created_by")?null!=this._user?this._user:this._user=new App.Groups.Models.User(this.get("created_by")):void 0},o.prototype.getGroup=function(){return null!=this._group?this._group:this._group=new App.Groups.Models.Group({id:this.get("group_id"),slug:this.get("group_slug")})},o.prototype.upvoted=function(){return this.get("liked")===!0},o.prototype.downvoted=function(){return this.get("disliked")===!0},o.prototype.toggleUpVote=function(){return this.downvoted()?this._unvote():this._voteUp()},o.prototype.toggleDownVote=function(){return this.upvoted()?this._unvote():this._voteDown()},o.prototype._voteUp=function(){return this.set("positive_votes_count",this.get("positive_votes_count")+1),this.get("voted")||this.set("votes_count",this.get("votes_count")+1),this.set({voted:!0,liked:!0,disliked:!1}),$.post("https://api.500px.com/v1/groups/"+this.get("group_id")+"/posts/"+this.id+"/vote?"+$.param(this._urlParams()),{vote:1}).done(function(t){return function(e){var o,i,r,n,s,a,l;if(t.set(t.parse(e)),"photo"===t.get("discussion_type")&&!t.isPostOwner()){for(i=t.getActiveAttachments(),a=i.models,l=[],r=0,n=a.length;n>r;r++)o=a[r],s=o.getModel(),s.get("favorited")?l.push(void 0):l.push(s.favorite());return l}}}(this))},o.prototype._voteDown=function(){return this.upvoted()&&this.set("positive_votes_count",this.get("positive_votes_count")-1),
this.get("voted")||this.set("votes_count",this.get("votes_count")+1),this.set({voted:!0,liked:!1,disliked:!0}),$.post("https://api.500px.com/v1/groups/"+this.get("group_id")+"/posts/"+this.id+"/vote?"+$.param(this._urlParams()),{vote:0}).done(function(t){return function(e){return t.set(t.parse(e))}}(this))},o.prototype._unvote=function(){return this.upvoted()&&this.set("positive_votes_count",this.get("positive_votes_count")-1),this.set("votes_count",this.get("votes_count")-1),this.set({voted:!1,liked:!1,disliked:!1}),$.post("https://api.500px.com/v1/groups/"+this.get("group_id")+"/posts/"+this.id+"/unvote?"+$.param(this._urlParams())).done(function(t){return function(e){var o,i,r,n,s,a,l;if(t.set(t.parse(e)),"photo"===t.get("discussion_type")&&!t.isPostOwner()){for(i=t.getActiveAttachments(),a=i.models,l=[],r=0,n=a.length;n>r;r++)o=a[r],s=o.getModel(),s.get("favorited")?l.push(s.unfavorite()):l.push(void 0);return l}}}(this))},o.prototype["delete"]=function(){return this.canDelete()?$.ajax({type:"DELETE",url:"https://api.500px.com/v1/groups/"+this.get("group_id")+"/posts/"+this.id+"/"}).done(function(t){return function(){return t.set("deleted",!0)}}(this)).fail(function(t){return function(){return t.trigger("change:deleted")}}(this)):void 0},o.prototype.undelete=function(){!this.canDelete()},o.prototype.parse=function(t){var e,o;return e=null!=(o=t.post)?o:t,null==e.top_replies&&(e.top_replies=this.get("top_replies")),null==e.replies&&(e.replies=this.get("replies")),e.score=e.positive_votes_count-(e.votes_count-e.positive_votes_count),e},o.prototype.flag=function(){return console.log($.cookie("reported-groups-post-"+this.id,!0)),this.set({flagged:!0}),$.post("https://api.500px.com/v1/groups/"+this.get("group_id")+"/posts/"+this.id+"/flag")},o.prototype.isFlagged=function(){return null!=$.cookie("reported-groups-post-"+this.id)},o.prototype.translateText=function(){return null!=this._translatedCopy?this.set("translated",!0):App.Helpers.Translator.translate(this.get("body"),function(t){return function(e){return e?(t._translatedCopy=e,t.set("translated",!0)):t.trigger("change:translated")}}(this))},o.prototype.showOriginalText=function(){return this.set("translated",!1)},o.prototype.displayedBody=function(){return this.get("deleted")?"The content has been deleted.":this.get("translated")?this._translatedCopy:this.get("body")},o}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Groups.Collections"),t.Posts=function(t){function o(t,e){null==e&&(e={}),e.contextHash?(e.groupId=e.contextHash.groupId,e.sortCriterion=e.contextHash.groupSort,e.discussionType="photo"):e.navigationDisabled="photo"!==e.discussionType,o.__super__.constructor.call(this,t,e)}return e(o,t),o.prototype.model=App.Groups.Models.Post,o.prototype.rpp=10,o.prototype.initialize=function(t,e){var i;return null==e&&(e={}),o.__super__.initialize.call(this,t,e),i={includeTopReplies:!0,includeAttribution:!0,includeAttachments:!0,includeThumbnail:!1,includeGroup:!1},e=_.extend({},i,e),this.groupId=e.groupId,this.postId=e.postId,this.withAttachments=e.withAttachments,this.sortCriterion=e.sortCriterion,this.includePost=e.include,this.includeTopReplies=e.includeTopReplies,this.includeAttribution=e.includeAttribution,this.includeThumbnail=e.includeThumbnail,this.includeAttachments=e.includeAttachments,this.includeGroup=e.includeGroup,null!=e.rpp&&(this.rpp=e.rpp),this.discussionType=e.discussionType||"text",this.nested=e.nested,this.nested&&(this.rpp=1e3),"photo"===this.discussionType?this.includeThumbnail=!0:void 0},o.prototype.parse=function(t,e){var i,r;return"photo"===this.discussionType&&(i=function(){var e,o,i,n;for(i=t.posts,n=[],e=0,o=i.length;o>e;e++)r=i[e],r.attachments[0]&&!r.attachments[0].deleted&&n.push(r);return n}(),t.posts=i),o.__super__.parse.call(this,t,e)},o.prototype.url=function(){var t;return t="https://api.500px.com/v1/groups/",null!=this.source?t+="posts":(t+=this.groupId+"/posts",this.postId&&(t+="/"+this.postId+"/replies")),t+"?"+$.param(this.buildQueryParams())},o.prototype.buildQueryParams=function(){var t,e;return t={},this.includeThumbnail&&(t.include_thumbnail=1,t.thumbnail_sizes=[3,600]),this.includeTopReplies&&(t.include_top_replies=1),this.includeAttribution&&(t.include_attribution=1),this.includeGroup&&(t.include_group=1),this.includeAttachments&&(t.include_attachments=1,t.attachment_sizes=["1","2","32","31","33","34","35","36","2048","4","14"]),this.includePost&&(t.include=this.includePost),this.withAttachments&&(t.with_attachments=1),t.discussion_type=this.discussionType,t.sort=this._sortParam(),("my_discussions"===(e=this.source)||"my_comments"===e)&&(t.source=this.source,t.include_group=1),t},o.prototype._sortParam=function(){if(this.nested)return"created_at";switch(this.sortCriterion){case"trending":return"trending";case"date":return"reverse_created_at";default:return"photos"===this.discussionType?"reverse_created_at":"rating"}},o.parseBrowserUrlParams=function(t){var e,i;return e=o.__super__.constructor.parseBrowserUrlParams.apply(this,arguments),e.groupId=null!=(i=App.controller.tidyIntParam("group_id"))?i:-1,e.groupId>0?(e.groupSort=App.controller._loadPageVar("group_sort"),e):null},o.prototype._contextUrlParams=function(){var t;return t={from:"groups",group_id:this.groupId},this.sortCriterion&&(t.group_sort=this.sortCriterion),t},o.prototype.photoAt=function(t){return new App.Photos.Models.Photo(this.at(t).get("attachments")[0])},o.prototype._getPhotoIds=function(){var t,e,o,i,r;for(i=this.models,r=[],t=0,e=i.length;e>t;t++)o=i[t],r.push(o.get("attachments")[0].id);return r},o.prototype._buildDisplayedItemData=function(t){return{attachments:[t.toJSON()]}},o.prototype._extractPhotoIdFromItem=function(t){var e;return null!=(e=_.first(t.attachments))?e.id:void 0},o.prototype.shouldHideRelatedPhotos=function(){return!1},o}(App.Photos.Collections.NavigationalInfiniteCollection),t.UserFeedPosts=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(t,e){var i,r;return i={includeTopReplies:!0,includeAttribution:!0,includeAttachments:!1,includeThumbnail:!1,includeGroup:!0},e=_.extend({},i,e),this.userId=null!=(null!=e?e.userId:void 0)?e.userId:null!=(r=App.currentUser)?r.id:void 0,o.__super__.initialize.call(this,t,e)},o.prototype.url=function(){var t;return t="https://api.500px.com/v1/users/"+this.userId+"/discussions",t+"?"+$.param(this.buildQueryParams())},o}(t.Posts),t.TopPosts=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.rpp=3,o.prototype.initialize=function(t,e){var i;return i={includeTopReplies:!0,includeAttribution:!1,includeAttachments:!1,includeThumbnail:!1,includeGroup:!0},e=_.extend({},i,e),o.__super__.initialize.call(this,t,e)},o.prototype.url=function(){return"https://api.500px.com/v1/groups/top_posts?"+$.param(this.buildQueryParams())},o}(t.Posts)}.call(this),function(){var t,e=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t="undefined"!=typeof App&&null!==App?App:window,t.currentPath=function(){return window.location.href.replace(/^https?:\/\/.*?(\/.*)$/,"$1")},t.updatePaginationParam=function(o,i){return o=0|o,null==i&&(i=t.currentPath()),i.match(/\bpage=\d+\b/)?1>=o?(i=i.replace(/\?page=\d+$/,""),i=i.replace(/\?page=\d+&/,"?"),i.replace(/&page=\d+\b/,"")):i.replace(/([?&])page=\d+/,"$1page="+o):1===o?i:""+i+(e.call(i,"?")>=0?"&":"?")+"page="+o}}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Search"),t.Controller=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.VALID_OPTIONS={orientation:["any","vertical","horizontal","square","panorama"],people:["any","people","no-people"],location:["any","indoor","outdoor"],collection:["any","curated","contributor"],usage:["any","commercial","editorial"],exclusivity:["any","exclusive","non-exclusive"],ccLicense:["none","zero","public-domain","by","by-nc","by-sa","by-nd","by-nc-sa","by-nc-nd"],sort:["relevance","pulse","newest","most-recent","most-popular"],supplier:function(){var t;return(null!=(t=App.currentUser)?t.isAdmin():void 0)?["any","nosuppliers","only","low","high"]:["any"]},type:function(){var t,e;return PxCurrentUser.isRolledOut("unification")&&(null!=(t=App.currentUser)?t.isBuyer():void 0)?(null!=(e=App.currentUser)?e.isViewingLicensablePhotos():void 0)?["market","people"]:["photos","people"]:["photos","market","people"]},availability:function(){var t,e;return PxCurrentUser.isRolledOut("unification")&&(null!=(t=App.currentUser)?t.isBuyer():void 0)&&(null!=(e=App.currentUser)?e.isViewingImmediatelyLicensablePhotos():void 0)?["immediately"]:["any","immediately","submitted"]}},o.prototype.index=function(){return App.Photos.executeActionWithPhotoModal(function(t){return function(){return t.showSearch()}}(this))},o.prototype.showSearch=function(){return this.render(App.Search.Views.SearchLayout,{queryParams:this._sanitizeQueryParams()})},o.prototype.showPhoto=function(t){return App.Photos.showPhotoControllerAction(t)},o.prototype._sanitizeQueryParams=function(){var t,e,o,i,r,n,s,a,l;o={},r=this.VALID_OPTIONS;for(e in r)l=r[e],l=_.result(this.VALID_OPTIONS,e),a="type"===e||"availability"===e?null!=(n=this.tidyEnumParam(e,l))?n:_.first(l):this.tidyEnumParam(e,l),null!=a&&(o[e]=a);return i=null!=(s=this._loadPageVar("q"))?s:this._loadPageVar("tag"),o.q=null!=i?i.replace(/\+/g," "):void 0,t=this._loadPageVar("categories"),t&&(o.categories=t.split(",")),o},o}(Marionette.AppController)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Search.Collections"),t.Photos=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.rpp=50,o.prototype.model=App.Photos.Models.PhotoMembership,o.prototype.STREAM="stream",o.prototype.SEARCH="search",o.prototype.urls={market:{stream:"https://webapi.500px.com/discovery/stock-photos",search:"https://webapi.500px.com/licensing"},photos:{stream:"https://api.500px.com/v1/photos",search:"https://api.500px.com/v1/photos/search"}},o.prototype.WEB_BFF_FEATURES=["market"],o.prototype.ADDITIONAL_PARAMS={image_size:["1","2","32","31","33","34","35","36","2048","4","14"],include_states:!0,formats:"jpeg,lytro",include_tags:!0},o.prototype.ALL_AVAILABILITIES=["prime","subprime","editorial","subeditorial","presubmitted","submitted"],o.prototype.initialize=function(t,e){if(null==e&&(e={}),o.__super__.initialize.apply(this,arguments),e.contextHash?this.queryParams=e.contextHash.queryParams:this.queryParams=e.queryParams,null==this.queryParams)throw new Error("queryParams is missing!");if(null==this.queryParams.type)throw new Error("queryParams.type is missing!")},o.prototype.url=function(){var t,e,o,i;return i=this._shouldUseStream(this.queryParams)?this.STREAM:this.SEARCH,t=this.pickUrl(this.queryParams.type,i),e=this._generateCollectionParams(this.queryParams),_.extend(e,this.ADDITIONAL_PARAMS),e.exclude_nude=!(null!=(o=App.currentUser)?o.get("show_nude"):void 0),i===this.STREAM&&(e.feature="popular"),t+"?"+$.param(e)},o.prototype._generateCollectionParams=function(t){var e,o,i,r,n,s,a,l;switch(n={filters:[],type:t.type},r=function(t,e){return t in e?n.filters.push(e[t]):n.filters.push(t)},r(t.orientation,{vertical:"portrait",horizontal:"landscape"}),n.type){case"market":n.q=t.q,t.sort&&(n.sort=t.sort),t.supplier&&(n.supplier=t.supplier),null!=t.categories&&t.categories.length>0&&(n.categories=function(){var e,i,r,n;for(r=t.categories,n=[],e=0,i=r.length;i>e;e++)o=r[e],n.push(o.replace(/\+/g," "));return n}().join(",")),n.availability="submitted"===t.availability?["presubmitted","submitted"].join(","):(l=function(){switch(t.usage){case"editorial":return["editorial","subeditorial"];case"commercial":return["prime","subprime"];default:return this.ALL_AVAILABILITIES}}.call(this),i=function(){switch(t.collection){case"prime":return["editorial","prime"];case"core":return["subprime","subeditorial","presubmitted","submitted"];default:return this.ALL_AVAILABILITIES}}.call(this),e=function(){switch(t.availability){case"immediately":return["prime","subprime","editorial","subeditorial"];default:return this.ALL_AVAILABILITIES}}.call(this),_.intersection(l,i,e).join(",")),n.filters.push(t.location),r(t.people,{people:"people_present","no-people":"people_absent"}),r(t.exclusivity,{exclusive:"license_type_exclusive","non-exclusive":"license_type_non_exclusive"});break;case"photos":switch(n.term=t.q,null!=t.categories&&t.categories.length>0&&(n.only=function(){var e,i,r,n;for(r=t.categories,n=[],e=0,i=r.length;i>e;e++)o=r[e],n.push(o.replace(/\+/g," "));return n}().join(",")),s=["by-nc","by-nc-nd","by-nc-sa","by","by-nd","by-sa","public-domain","zero"].indexOf(t.ccLicense),s>=0&&(n.license_type=s+1),t.sort){case"pulse":n.sort="highest_rating";break;case"newest":n.sort="created_at"}}return n.filters=_.compact(_.reject(n.filters,function(t){return"any"===t||"none"===t})).join(","),a={},_.each(n,function(t,e){return t&&0!==t.length?a[e]=t:void 0}),a},o.prototype._shouldUseStream=function(t){return!t.q},o.prototype.pickUrl=function(t,e){return this.urls[t][e]},o.prototype.parse=function(t){var e;return e={photos:t.photos,meta:{pagination:{page:t.current_page,total_items:t.total_items,total_pages:t.total_pages}}},1===t.current_page&&App.vent.trigger("search:got-photos",t),o.__super__.parse.call(this,e)},o.parseBrowserUrlParams=function(t){var e,i,r,n,s,a,l,u;i=o.__super__.constructor.parseBrowserUrlParams.apply(this,arguments),n=i.queryParams={},s=App.Search.Controller.prototype.VALID_OPTIONS;for(r in s)u=s[r],u=_.result(App.Search.Controller.prototype.VALID_OPTIONS,r),l=App.controller.tidyEnumParam("ctx_"+r,u,{"default":_.first(u)}),null!=l&&(n[r]=l);return n.q=null!=(a=App.controller._loadPageVar("ctx_q"))?a.replace(/\+/g," "):void 0,e=App.controller._loadPageVar("ctx_categories"),e&&(n.categories=e.split(",")),i},o.prototype.photoAt=function(t){return this.at(t).getPhoto()},o.prototype._getPhotoIds=function(){return this.pluck("id")},o.prototype._buildDisplayedItemData=function(t){return t.toJSON()},o.prototype._extractPhotoIdFromItem=function(t){return t.id},o.prototype._contextUrlParams=function(){var t,e,o,i;e={},o=this.queryParams;for(t in o)i=o[t],i&&"any"!==i&&"none"!==i&&(e["ctx_"+t]=function(){switch(t){case"categories":return i.join(",");default:return i}}());return _.extend({from:"search"},e)},o.prototype.shouldHideRelatedPhotos=function(){return!1},o}(App.Photos.Collections.NavigationalInfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Galleries.Collections"),t.GalleryPhotos=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.rpp=50,o.prototype.model=App.Photos.Models.PhotoMembership,o.prototype.initialize=function(t,e){return o.__super__.initialize.apply(this,arguments),e.contextHash?(this.galleryPath=e.contextHash.galleryPath,this.userId=e.contextHash.userId):(this.galleryPath=e.galleryPath,this.userId=e.userId)},o.prototype.url=function(){var t,e,o;return t={rpp:this.rpp,image_size:["1","2","32","31","33","34","35","36","2048","4","14"],include_licensing:PxCurrentUser.isRolledOut("unification")&&(!App.currentUser||App.currentUser.isBuyer()),formats:"jpeg,lytro",sort:"position",sort_direction:"asc"},PxCurrentUser.isRolledOut("unification")&&(null!=(e=App.currentUser)?e.get("buyer"):void 0)&&_.extend(t,{photo_availability_filter:null!=(o=App.currentUser)?o.get("photo_availability_filter"):void 0}),"https://api.500px.com/v1/users/"+this.userId+"/galleries/"+this.galleryPath+"/items?"+$.param(t)},o.prototype.parse=function(t){var e;return e={photos:t.photos,meta:{pagination:{page:t.current_page,total_items:t.total_items,total_pages:t.total_pages}}},o.__super__.parse.call(this,e)},o.prototype.photoAt=function(t){return this.at(t).getPhoto()},o.prototype.reorder=function(t,e){var o,i;return i="https://api.500px.com/v1/users/"+this.userId+"/galleries/"+this.galleryPath+"/items",o={add:{after:{id:e},photos:[t]}},$.ajax({url:i,type:"PUT",data:o})},o.prototype._getPhotoIds=function(){return this.pluck("id")},o.prototype._buildDisplayedItemData=function(t){return t.toJSON()},o.prototype._extractPhotoIdFromItem=function(t){return t.id},o.parseBrowserUrlParams=function(t){var e,i;return e=o.__super__.constructor.parseBrowserUrlParams.apply(this,arguments),e.galleryPath=App.controller._loadPageVar("galleryPath"),e.userId=null!=(i=App.controller.tidyIntParam("user_id"))?i:-1,null!=e.galleryPath&&e.userId>0?e:null},o.prototype._contextUrlParams=function(){return{from:"gallery",galleryPath:this.galleryPath,user_id:this.userId}},o.prototype.shouldHideRelatedPhotos=function(){return!1},o}(App.Photos.Collections.NavigationalInfiniteCollection)}.call(this),function(){var t;t=App.module("LoggedInHome.Constants"),t.Activity={ACTION:{FOLLOW:1,LIKED:2,PUBLISH:3,COMMENT:4,ADD:5},ACTIVITY_TYPES:{PHOTO:1,USER:7,COMMENT:8,FOLDER:13,GALLERY:14,QUEST:16}}}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("LoggedInHome.Models"),t.Activity=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.ACTION=App.LoggedInHome.Constants.Activity.ACTION,o.prototype.ACTIVITY_TYPES=App.LoggedInHome.Constants.Activity.ACTIVITY_TYPES,o.prototype.initialize=function(){var t;return this.isObjectTypePhoto()&&this.set("object",App.Photos.Models.PhotoManager.createOrUpdateModel(this.get("object"))),this.isGalleryPublishAction()?(t=this.get("object"),t.user=App.Photos.Models.UserManager.createOrUpdateModel(t.user)):void 0},o.prototype.isPhotoUploadAction=function(){return this.get("action")===this.ACTION.PUBLISH&&this.get("object_type")===this.ACTIVITY_TYPES.PHOTO},o.prototype.isGalleryPublishAction=function(){return this.get("action")===this.ACTION.PUBLISH&&this.get("object_type")===this.ACTIVITY_TYPES.GALLERY},o.prototype.isObjectTypePhoto=function(){return this.get("object_type")===this.ACTIVITY_TYPES.PHOTO},o}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("LoggedInHome.Collections"),t.Activities=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.rpp=10,o.prototype.model=App.LoggedInHome.Models.Activity,o.prototype.url="https://webapi.500px.com/home/following",o.prototype.cursorPagination=!0,o.prototype.FETCH_MORE_THRESHOLD=3,o.prototype.initialize=function(t,e){var i,r,n;return null==e&&(e={}),this.navigationDisabled=null!=(i=e.navigationDisabled)?i:!1,o.__super__.initialize.apply(this,arguments),this.navigationDisabled?void 0:(null!=(null!=(r=e.contextHash)?r.currentPageCursor:void 0)&&(this.nextPageCursor=null!=(n=e.contextHash)?n.currentPageCursor:void 0),this.photos=[],this.listenTo(this,"add",function(t){return function(e,o,i){return t._onAddActivity(e,o,i)}}(this)))},o.prototype.photoAt=function(t){return this.photos[t]},o.prototype.shouldHideRelatedPhotos=function(){return!1},o.prototype.buildBrowserUrlParams=function(){var t,e;if(this.navigationDisabled)throw new Error("navigation is disabled");return t=this.photoAt(this._selectedPhotoOffset).get("page_cursor"),e={},t&&(e.current_page=t),_.extend(e,this._contextUrlParams())},o.parseBrowserUrlParams=function(t){var e;return e={contextName:t,currentPageCursor:App.Helpers.getQueryParam("current_page")}},o.prototype._contextUrlParams=function(){var t;return{from:"following",user_id:null!=(t=App.currentUser)?t.id:void 0}},o.prototype._getPhotoIds=function(){return this.map(function(t){var e;return t.isPhotoUploadAction()&&null!=(e=t.get("object"))?e.get("id"):void 0})},o.prototype._buildDisplayedItemData=function(t){return t.toJSON()},o.prototype._extractPhotoIdFromItem=function(t){return t.object.id},o.prototype.selectedPhotoOffset=function(){if(this.navigationDisabled)throw new Error("navigation is disabled");return this._selectedPhotoOffset},o.prototype.selectPhoto=function(t){var e;if(this.navigationDisabled)throw new Error("navigation is disabled");return e=this._selectedPhotoOffset,this._selectedPhotoOffset=this._getPhotoIndex(t.id),(null==e||this._selectedPhotoOffset>e)&&this.photos.length-this._selectedPhotoOffset<=this.FETCH_MORE_THRESHOLD&&!this.finished()?this.nextPage():void 0},o.prototype.getLength=function(){return this.photos.length},o.prototype._onAddActivity=function(t,e,o){return t.isObjectTypePhoto()?this.photos.push(t.get("object")):void 0},o.prototype._getPhotoIndex=function(t){var e,o,i,r,n;for(n=this.photos,e=o=0,i=n.length;i>o;e=++o)if(r=n[e],r.id===t)return e;throw new Error("Could not find photo in activity collection")},o.prototype.parse=function(t){var e,r,n,s,a,l,u,p;return t=o.__super__.parse.call(this,t),this.navigationDisabled?t:(r=null!=(p=this._displayedPhoto)?p.id:void 0,s=null==r,n=this._getPhotoIds(),e=function(){var e,o,p;for(p=[],a=e=0,o=t.length;o>e;a=++e)l=t[a],u=this._extractPhotoIdFromItem(l),i.call(n,u)>=0||(n.unshift(u),l.object.page_cursor=this.page,s||(s=u===r),p.push(l));return p}.call(this),s||(l=this._buildDisplayedItemData(this._displayedPhoto),e.unshift(l),this._displayedPhotoId=this._displayedPhoto.id),this._displayedPhoto=null,e)},o}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Quests.Collections"),t.QuestEntries=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.rpp=50,o.prototype.model=App.Photos.Models.PhotoMembership,o.prototype.initialize=function(t,e){return o.__super__.initialize.apply(this,arguments),e.contextHash?this.questId=e.contextHash.questId:(this.questId=e.questId,this.marketplaceOnly=e.marketplaceOnly,e)},o.prototype.url=function(){var t;return t={rpp:this.rpp,image_size:["1","2","32","31","33","34","35","36","2048","4","14"]},this.marketplaceOnly&&(t.filter="marketplace"),"https://api.500px.com/v1/quests/"+this.questId+"/entries?"+$.param(t)},o.prototype.photoAt=function(t){return this.at(t).getPhoto()},o.prototype._getPhotoIds=function(){return this.pluck("id")},o.prototype._contextUrlParams=function(){return{from:"quest_entries",quest_id:this.questId}},o.prototype._extractPhotoIdFromItem=function(t){return t.id},o.prototype._buildDisplayedItemData=function(t){return t.toJSON()},o.prototype.shouldHideRelatedPhotos=function(){return!1},o.parseBrowserUrlParams=function(t){var e,i;return e=o.__super__.constructor.parseBrowserUrlParams.apply(this,arguments),e.questId=null!=(i=App.controller.tidyIntParam("quest_id"))?i:-1,e.questId>0?e:{}},o}(App.Photos.Collections.NavigationalInfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Quests.Collections"),t.QuestWinners=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.model=App.Photos.Models.PhotoMembership,o.prototype.initialize=function(t,e){var i;return null==e&&(e={}),this.navigationDisabled=null!=(i=e.navigationDisabled)?i:!1,o.__super__.initialize.apply(this,arguments),this.navigationDisabled?void 0:e.contextHash?this.questId=e.contextHash.questId:(this.questId=e.questId,e)},o.prototype.url=function(){var t;return t={cover_size:["1","2","32","31","33","34","35","36","2048","4","14"],image_size:["1","2","32","31","33","34","35","36","2048","4","14"]},"https://api.500px.com/v1/quests/"+this.questId+"?"+$.param(t)},o.prototype.parse=function(t){return this.navigationDisabled?t:t.quest.winners},o.prototype.photoAt=function(t){return this.at(t).getPhoto()},o.prototype._getPhotoIds=function(){return this.pluck("id")},o.prototype._contextUrlParams=function(){return{from:"quest_winners",quest_id:this.questId}},o.prototype._extractPhotoIdFromItem=function(t){return t.id},o.prototype._buildDisplayedItemData=function(t){return t.toJSON()},o.prototype.shouldHideRelatedPhotos=function(){return!1},o.prototype.buildBrowserUrlParams=function(){if(this.navigationDisabled)throw new Error("navigation is disabled");return this._contextUrlParams()},o.parseBrowserUrlParams=function(t){var e,o;return e={},e.questId=null!=(o=App.controller.tidyIntParam("quest_id"))?o:-1,e.questId>0?e:{}},o.prototype.selectedPhotoOffset=function(){if(this.navigationDisabled)throw new Error("navigation is disabled");return this._selectedPhotoOffset},o.prototype.selectPhoto=function(t){var e;if(this.navigationDisabled)throw new Error("navigation is disabled");return e=this._getPhotoIds(),this._selectedPhotoOffset=e.indexOf(t.id)},o.prototype.getLength=function(){return this.length},o}(Backbone.Collection)}.call(this),function(){var t,e=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("Photos.Collections"),t.PhotoNavigationFactory=function(){function t(){}return t.prototype.SURROUNDED_NAVIGATION_CONTEXTS=["user","user_favorites","set","popular","fresh","upcoming","editors"],t.prototype.PAGINATED_NAVIGATION_CONTEXTS=["groups","related_photos","search","gallery","following","quest_entries","quest_winners"],t.prototype.GA_ENABLED_CONTEXTS=["following","activity","popular","fresh","upcoming","editors"],t.build=function(t,o,i){var r,n,s;if(s=$.trim(App.controller._loadPageVar("from")).toLowerCase(),"user_library"===s&&(s="user"),e.call(this.prototype.SURROUNDED_NAVIGATION_CONTEXTS,s)>=0?r=App.Photos.Collections.PhotoNavigation:e.call(this.prototype.PAGINATED_NAVIGATION_CONTEXTS,s)>=0&&(r=function(){var t;switch(s){case"groups":return App.Groups.Collections.Posts;case"related_photos":return App.Photos.Collections.RelatedPhotos;case"search":return App.Search.Collections.Photos;case"gallery":return App.Galleries.Collections.GalleryPhotos;case"quest_entries":return App.Quests.Collections.QuestEntries;case"quest_winners":return App.Quests.Collections.QuestWinners;case"following":if(App.controller.tidyIntParam("user_id")===(null!=(t=App.currentUser)?t.id:void 0))return App.LoggedInHome.Collections.Activities}}()),null==(n=null!=r?r.parseBrowserUrlParams(s):void 0)&&(r=App.Photos.Collections.PhotoNavigation,s=App.Photos.Collections.PhotoNavigation.prototype.DEFAULT_CONTEXT,n=App.Photos.Collections.PhotoNavigation.parseBrowserUrlParams(s)),e.call(this.prototype.SURROUNDED_NAVIGATION_CONTEXTS,s)>=0?n.photoId=t.id:e.call(this.prototype.PAGINATED_NAVIGATION_CONTEXTS,s)>=0&&(n.displayedPhoto=t),!$.isFunction(r.prototype.photoAt))throw new Error("Not implemented!");if(!$.isFunction(r.prototype.selectedPhotoOffset))throw new Error("Not implemented!");if(!$.isFunction(r.prototype.selectPhoto))throw new Error("Not implemented!");if(!$.isFunction(r.prototype.buildBrowserUrlParams))throw new Error("Not implemented!");return i.contextHash=n,new r(o,i)},t.buildGALabel=function(t){var e;if(_.include(this.prototype.GA_ENABLED_CONTEXTS,t))return e=function(){switch(t){case"following":return"V4 Home Following";case"activity":return"V4 Home Activity";default:return"V4 Discover - "+t}}()},t}()}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Models"),t.Gallery=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.GALLERY_KINDS={KIND_GENERAL:0,KIND_LIGHTBOX:4,KIND_LICENSING_GALLERY:4,KIND_PORTFOLIO:4,KIND_PROFILE:3},o.prototype.isEmpty=function(){return 0===this.get("items_count")},o.prototype.containsOwnerPhotosOnly=function(){var t;return(t=this.get("kind"))===this.GALLERY_KINDS.KIND_PROFILE||t===this.GALLERY_KINDS.KIND_PORTFOLIO},o.prototype.isPrivate=function(){return this.get("privacy")},o.prototype.markPhotoMembership=function(t,e){return null==e&&(e={}),null==this._memberPhotoIds&&(this._memberPhotoIds={}),this._memberPhotoIds[t]=!0,e.silent?void 0:this.trigger("change:photoMembership",t,!0)},o.prototype.containsPhoto=function(t){return null==this._memberPhotoIds&&(this._memberPhotoIds={}),t.id in this._memberPhotoIds},o.prototype.getCoverPhotoId=function(){var t;return null!=(t=this.getCoverPhoto())?t.id:void 0},o.prototype.getCoverPhoto=function(){var t;return null!=(t=this.get("cover_photo"))?t[0]:void 0},o.prototype.setCover=function(t){var e;return e={_method:"put",cover_photo_id:t,cover_size:2048},$.post("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id"),e).done(function(t){return function(e){return t.set("cover_photo",e.gallery.cover_photo)}}(this))},o.prototype.addPhotos=function(t){var e,o;return o={_method:"put",add:{photos:function(){var o,i,r;for(r=[],o=0,i=t.length;i>o;o++)e=t[o],r.push(e.id);return r}()}},$.post("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id")+"/items",o).done(function(o){return function(i){var r,n,s;for(r=0,n=t.length;n>r;r++)e=t[r],"added"===(null!=(s=i[e.id])?s.result:void 0)&&(null==o._memberPhotoIds&&(o._memberPhotoIds={}),o._memberPhotoIds[e.id]=!0,o.trigger("change:photoMembership",e.id,!0),o._lastAddedPhotoHistory=_.reject(o._lastAddedPhotoHistory,function(t){return t.id===e.id}),o._lastAddedPhotoHistory.push(e));return o.set("updated_at",(new Date).toISOString())}}(this))},o.prototype.removePhotos=function(t){var e,o;return o={_method:"put",remove:{photos:function(){var o,i,r;for(r=[],o=0,i=t.length;i>o;o++)e=t[o],r.push(e.id);return r}()}},$.post("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id")+"/items",o).done(function(o){return function(i){var r,n,s;for(r=0,n=t.length;n>r;r++)e=t[r],"removed"===(null!=(s=i[e.id])?s.result:void 0)&&(null==o._memberPhotoIds&&(o._memberPhotoIds={}),delete o._memberPhotoIds[e.id],o.trigger("change:photoMembership",e.id,!1),o._lastAddedPhotoHistory=_.reject(o._lastAddedPhotoHistory,function(t){return t.id===e.id}));return o.set("updated_at",(new Date).toISOString())}}(this))},o.prototype.getLastAddedPhoto=function(){var t;return null==this._lastAddedPhotoHistory&&(this._lastAddedPhotoHistory=[],t=this.get("last_added_photo"),null!=t&&this._lastAddedPhotoHistory.push(new App.Models.Photo(t))),_.last(this._lastAddedPhotoHistory)},o.prototype.getPrivateShareUrl=function(){return null==this.privateUrlDfd&&(this.privateUrlDfd=$.Deferred(),$.get("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id")+"/share_url").done(function(t){return function(e){return t.privateUrlDfd.resolve("https://500px.com/"+e.share_url)}}(this)).fail(function(t){return function(e,o,i){var r;return(r=t.privateUrlDfd).reject.apply(r,arguments)}}(this))),this.privateUrlDfd.promise()},o.prototype.getCanonicalPath=function(){var t,e,o,i;return this.isPrivate()?"/g/"+this.get("token"):(e=null!=(t=this.galleryPath)?t:this.get("custom_path"),null==e&&(e=this.id),o=this.get("user"),i=_.isFunction(o.get)?o.get("username"):o.username,"/"+i+"/galleries/"+e)},o.prototype.getCanonicalUrl=function(){var t;return t=this.getCanonicalPath(),"https://500px.com"+t},o.prototype.getUrl=function(){var t,e;return t=this.get("user"),e=_.isFunction(t.get)?t.get("username"):t.username,"https://500px.com/"+e+"/galleries/"+this.get("custom_path")},o.prototype.isOwnedByCurrentUser=function(){var t;return this.get("user_id")===(null!=(t=App.currentUser)?t.get("id"):void 0)},o.prototype.getApiIdentifier=function(){var t;return t=this.isPrivate()&&!this.isOwnedByCurrentUser()?this.galleryPath:this.id;
},o.prototype.share=function(t,e){return null==this.popup&&(this.popup=new App.Lib.Sharelizer({url:this.getCanonicalUrl(),category:"Gallery Page"})),this[t](e)},o.prototype.google=function(t){return this.popup.google()},o.prototype.facebook=function(t){return this.popup.facebook()},o.prototype.vk=function(t){return this.popup.vk()},o.prototype._pinterestShareData=function(){var t;return{media:null!=(t=this.get("cover_photo"))?t[0].url:void 0,description:this.get("description")}},o.prototype.pinterest=function(t){var e;if(e=this._pinterestShareData(),!e.media)throw"This view doesn't know how to share with pinterest";return this.popup.pinterest(e.media,e.description)},o.prototype._twitterShareData=function(){return{text:'Gallery "'+this.get("name")+'" by '+this.get("user").fullname+" #500px"}},o.prototype.twitter=function(t){var e;if(e=this._twitterShareData(),!e.text)throw"This view doesn't know how to share with twitter";return this.popup.twitter(e.text)},o.prototype._stumbleuponShareData=function(){return{title:'Gallery "'+this.get("name")+'" by '+this.get("user").fullname+" #500px"}},o.prototype.stumbleupon=function(t){var e;if(e=this._stumbleuponShareData(),!e.title)throw"This view doesn't know how to share with StumbleUpon";return this.popup.stumbleupon(e)},o.prototype.isFeatured=function(){return!!this.get("editors_choice")},o.prototype.feature=function(){var t,e;if(!App.currentUser)throw new Error("feature requires current user");if(this.isFeatured())throw new Error("gallery is already featured");return e="https://api.500px.com/v1/users/"+this.userId+"/galleries/"+this.galleryPath+"/editors_choice/add",t={method:"PUT"},$.ajax(e,t).done(function(t){return function(){return t.set({editors_choice:!0})}}(this))},o.prototype.unfeature=function(){var t,e;if(!App.currentUser)throw new Error("feature requires current user");if(!this.isFeatured())throw new Error("gallery is not featured");return e="https://api.500px.com/v1/users/"+this.userId+"/galleries/"+this.galleryPath+"/editors_choice/remove",t={method:"PUT"},$.ajax(e,t).done(function(t){return function(){return t.set({editors_choice:!1})}}(this))},o.prototype.reportContent=function(t,e){var o,i,r;return null==e&&(e=""),o=this.getApiIdentifier(),r="https://api.500px.com/v1/users/"+this.userId+"/galleries/"+o+"/report",i={reason:t},0===Number(t)&&(i.reason_details=e),$.post(r,i).done(function(e){return function(){return e.trigger("contentReported",t)}}(this))},o}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Collections"),t.RelatedGalleries=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.model=App.Models.Gallery,o.prototype.initialize=function(t,e){return null==t&&(t=[]),null==e&&(e={}),this.photo=e.photo,o.__super__.initialize.apply(this,arguments)},o.prototype.url=function(){var t;return t={sort:"user_id",include_cover:!0,cover_size:440,include_user:!0,kinds:"0,4",exclude_private:!0},"https://api.500px.com/v1/photos/"+this.photo.id+"/galleries?"+$.param(t)},o.prototype.parse=function(t){var e;return e={galleries:t.galleries,meta:{pagination:{page:t.current_page,total_items:t.total_items,total_pages:t.total_pages}}},o.__super__.parse.call(this,e)},o}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Collections"),t.RelatedPhotos=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.model=App.Photos.Models.PhotoMembership,o.prototype.rpp=30,o.prototype.initialize=function(t,e){if(null==e&&(e={}),o.__super__.initialize.apply(this,arguments),e.contextHash)return this.photoId=e.contextHash.photoId;if(!e.photoId)throw new Error("photoId is missing");return this.photoId=e.photoId},o.prototype.url=function(){var t,e,o;return t={},t.exclude_nude=!(null!=(e=App.currentUser)?e.get("show_nude"):void 0),(null!=(o=App.currentUser)?o.isBuyer():void 0)&&(t.photo_availability_filter=App.currentUser.get("photo_availability_filter")),"https://webapi.500px.com/photos/"+this.photoId+"/related?"+$.param(t)},o.parseBrowserUrlParams=function(t){var e,i;return e=o.__super__.constructor.parseBrowserUrlParams.apply(this,arguments),e.photoId=null!=(i=App.controller.tidyIntParam("photo_id"))?i:-1,e.photoId>0?e:null},o.prototype._contextUrlParams=function(){return{from:"related_photos",photo_id:this.photoId}},o.prototype.photoAt=function(t){return this.at(t).getPhoto()},o.prototype._getPhotoIds=function(){return this.pluck("id")},o.prototype._buildDisplayedItemData=function(t){return t.toJSON()},o.prototype._extractPhotoIdFromItem=function(t){return t.id},o.prototype.shouldHideRelatedPhotos=function(){return!1},o}(App.Photos.Collections.NavigationalInfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos"),t.Controller=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.show=function(t){return null!=("undefined"!=typeof PxPreloadedData&&null!==PxPreloadedData?PxPreloadedData.photo:void 0)&&(App.Photos.Models.PhotoManager.createOrUpdateModel(PxPreloadedData.photo),PxPreloadedData.photo=null),this.render(App.Photos.Views.PhotosLayout,{photoId:t})},o}(Marionette.AppController)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),t.ActionConfirmationModal=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.className="action_modal action_confirmation_modal",o.prototype.template="action_confirmation_modal",o.prototype.ui={ok:".button.submit",cancel:".close",message:".content .message",title:"h3.dark"},o.prototype.behaviors={ModalDialog:{wrapperClass:"comment-action-modal-wrapper"},HasButtons:{"@ui.ok":"_onConfirmClicked","@ui.cancel":"destroyModal"}},o.prototype.resize=function(){var t;return t=$(window),t.width()<=360?this.$el.width(t.width()-20):this.$el.width(360),this.trigger("resize")},o.prototype.initialize=function(t){var e;if(null==t&&(t={}),this.callback=t.callback,this.title=t.title,this.message=t.message,this.buttonText=t.buttonText,!this.title||!this.message)throw new Error("Both title and message are mandatory!");return this.destructiveButton=null!=(e=t.destructiveButton)?e:!1},o.prototype.onRender=function(){return this.ui.title.html(this.title),this.ui.message.html(this.message),this.buttonText&&this.ui.ok.html(this.buttonText),this.destructiveButton?this.ui.ok.addClass("delete"):void 0},o.prototype._onConfirmClicked=function(){var t;return t="function"==typeof this.callback?this.callback():void 0,$.isFunction(null!=t?t.always:void 0)?t.done(function(t){return function(){return t.destroyModal()}}(this)):(this.destroyModal(),!1)},o}(Marionette.ItemView)}.call(this),window.PxLocale={groups:{messages:{photo_added:"Great! Your photo has been added to the group. Now everybody can see it."}},flow:{one_and_n_more_photos:"%{raw_one_title} and %{n} more photos",actions:{liked:"%{raw_user} liked %{raw_linebreak} %{raw_photos_with_attribution}",favorited:"%{raw_user} favorited %{raw_linebreak} %{raw_photos_with_attribution}",commented:"%{raw_user} commented %{raw_linebreak} %{raw_photos_with_attribution}",uploaded:"%{raw_user} uploaded %{raw_linebreak} %{raw_photos_with_attribution}"}},lytro:{living_photo:"Living Picture",ad:{buy:"Buy Now",preorder:"Pre-order Now",discount:"How to claim your $250 discount",title:"Tell a Story with Depth and Dimension",description_html:"Order the %{order_link} before August 23rd for a $250 discount, exclusive to 500px members."}},picks:{email_cta:{email_desc:"Enter your email address to be notified when you can group and organize your favorite photos into a Collection like this one.",enter_email:"Email address",invalid_email:"Invalid email",submitted:"Submitted"},download_app_cta_desktop:{download:"Amazing photos, anywhere.",download_desc:"Discover more amazing photos on the 500px app for iPhone."},download_app_cta_ipad:{download:"Amazing photos, anywhere.",download_desc:"Discover more amazing photos on the 500px app for iPad."},download_app_cta_iphone:{download:"500px for iPhone",get_the_app:"Get the app",already_got_it:"I already have it"}},licenses:{any:"Any License",0:"500px License",4:"Attribution 3.0",5:"Attribution-NoDerivs 3.0",6:"Attribution-ShareAlike 3.0",1:"Attribution-NonCommercial 3.0",2:"Attribution-NonCommercial-NoDerivs 3.0",3:"Attribution-NonCommercial-ShareAlike 3.0"},licenses_short:{any:"Any",0:"500px",4:"BY",5:"BY-ND",6:"BY-SA",1:"BY-NC",2:"BY-NC-ND",3:"BY-NC-SA"},categories:{10:"Abstract",11:"Animals",5:"Black and White",1:"Celebrities",9:"City & Architecture",15:"Commercial",16:"Concert",20:"Family",14:"Fashion",2:"Film",24:"Fine Art",23:"Food",3:"Journalism",8:"Landscapes",28:"Light Field",12:"Macro",18:"Nature",4:"Nude",7:"People",19:"Performing Arts",17:"Sport",6:"Still Life",21:"Street",26:"Transportation",13:"Travel",22:"Underwater",27:"Urban Exploration",25:"Wedding",0:"Uncategorized"},tooltips:{got_it:"Got it!",onboarding_favorite_photo:{title:"Collect your favorites",body:"Compile your favorite photos and revisit them later on your %{raw_profile}.",body_mobile:"Compile your favorite photos and revisit them later.",profile:"Profile"},onboarding_follow_user:{title:"Get inspired",body:"Follow photographers that inspire you and keep up with their uploads, likes, favorites, and comments in your %{raw_flow}.",flow:"Flow"},organizer_multiselect:{title:"Select Multiple Photos",body:"You can now select and move multiple photos in the organizer. Either drag your cursor to create a selection, or select multiple photos by command/control-clicking."},upload_callout:{title:"Upload your first photo!",body:"500px is a simple way to share photos with other photography enthusiasts. Your photos belong here!"}},flash:{photos_presubmitted_to_prime:"Your eligible photos have been submitted to 500px Marketplace!"},ui:{login:{facebook:"Login with Facebook",twitter:"Login with Twitter"},signup:{facebook:"Sign up with Facebook",twitter:"Sign up with Twitter",google:"Sign up with Google",email:"Sign up with email"},copyright_tooltip:{message_html:"Hey, this photo is &copy; <span>USERNAME</span>"},sharelizers:{group:{twitter:{message:"Check out the group %{group_name} on @500px"},pinterest:{message:"Check out the group %{group_name} at %{group_url}"},email:{subject:"Check out group %{group_name} on 500px",body:"Check out the group %{group_name} at %{group_url}",share_by_email:"Email Group",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Check out the group %{group_name} on 500px"}}}}},discussion:{twitter:{message:"Check out discussion %{discussion_name} on @500px"},pinterest:{message:"Check out discussion %{discussion_name} at %{discussion_url}"},email:{subject:"Check out discussion %{discussion_name} on 500px",body:"Check out discussion %{discussion_name} at %{discussion_url}",share_by_email:"Email Group",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Check out the group %{group_name} on 500px"}}}}},user:{twitter:{message:"Check out the amazing profile of %{raw_fullname}%{raw_twitter_mention} on @500px"},pinterest:{message:"%{raw_about}"},email:{share_by_email:"Email User Profile",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Check out amazing portfolio of "}}}}},twitter:{message:"Photo \u201c%{raw_name}\u201d by %{raw_user_fullname}%{raw_twitter_mention} #500px"},stumbleupon:{message:"\u201c%{name}\u201d by %{user_fullname}"},email:{share_by_email:"Send an Email",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Your message"}}}}},modals:{alert:{cancel:"Cancel",try_again:"Try Again",ok:"OK",yes:"Yes",skip:"Skip","delete":"Delete",create_set:"Create Set",discard:"Discard",revisit_photos:"Revisit Photos",finish_upload:"Finish Upload",go_back:"Go Back",low_discoverability:"<h3>Low Discoverability</h3><p>Give your photos a title, a category, and 3 tags to see them featured in the <b>Fresh</b> feed.</p>"}}},sets:{create:"Create A Set"},layout:{description:"500px lets you create stunning professional photo portfolios, find friends, express yourself and connect with people like you.",keywords:"photos, photographers, photo portfolio, online photo portfolio, photo digest, web photo portfolio, online photo gallery, share pictures, professional photography, social photography, upload photographs, share photo, outstanding photo portfolio, photo community, fresh photos, portfolio in seconds, models vs photographers, commercial photography, architectural photography, professional portfolio management"},favorites:{favorited_by:"FAVORITED BY"},comments:{index:{comments:"COMMENTS",top_comments:"TOP COMMENTS",load_more:"Load More",you_need_to_login_to_post_html:"You need to <a href='%{login_path}'>Login</a> or <a href='%{signup_path}'>Signup</a> to post comments.",subscribe:"Subscribe to this thread"},comment:{confirm_flag:"Are you sure you want to flag this comment for review by a moderator?",confirm_delete:"Are you sure you want to delete this comment?",this_comment_is_flagged_html:"This comment has been flagged. <a href='#'>View comment.</a>",likes:{zero:"Like",one:"%{count} Like",other:"%{count} Likes"},reply:"Reply",flag:"Flag","delete":"Delete",translate:"Translate",translated:"Translated by Bing",translating:"Translating...",show_original:"Show Original"},"new":{fields:{comment:{body:{required:"Whoops, your comment cannot be blank.",placeholder:"Provide feedback and share your comments..."}}},"new":"Post Comment",reply:"Post Reply"},wall_index:{comments:"COMMENTS",top_comments:"TOP COMMENTS",load_more:"Load More",you_need_to_login_to_post_html:"You need to <a href='%{login_path}'>Login</a> or <a href='%{signup_path}'>Signup</a> to post comments.",subscribe:"Subscribe to this thread"},wall_new:{"new":"Leave message",fields:{comment:{body:{required:"Whoops, your message cannot be blank.",placeholder:"Leave a message for this user..."}}}}},shared:{common:{new_feature:"New",next_page:"Next",previous_page:"Previous",one_and_another:"%{raw_one} and %{raw_another}",one_or_another:"%{raw_one} or %{raw_another}",attribution:"%{raw_content} by %{raw_author}",attribution_title_first:"%{raw_content} by %{raw_author}",attribution_category:"%{raw_category} photo by %{raw_author}",attribution_with_company:"%{raw_content} by %{raw_author} on 500px"},signup_login_form:{signup:{title:"Sign Up",benefits:{"default":"Keep track of your favorite photos on 500px!",upload:"Upload and share your photos with the 500px community.",follow:"Follow %{firstname}, and create your own profile."},permissions:"We won't spam your account. Set your permissions during sign up or any time afterward.",notifications:"We won't spam or sell your address. Update your notifications preferences any time.",with_qq:"Sign up with QQ",with_facebook:"Sign up with Facebook",with_twitter:"Sign up with Twitter",with_google:"Sign up with Google",with_social:"Sign up with social media",with_email:"Sign up with email",terms:"By registering, you agree to our %{terms_link}",terms_link_text:"Terms of Service",action:"Sign Up",have_acount:"Already have an account?",placeholders:{email:"Email",password:"Password"},email_form:{title:"Complete Authentication",email_needed:"You need to provide an e-mail address for your account to complete the registration.",email_needed_with_name:"Hi %{nickname}, please provide an e-mail address for your account to complete the registration.",existing_account:{single:"Is this your account?",plural:"Are any of these accounts yours?"},email_matched:{title:"The e-mail you entered is in use",single:"This isn't me. I'd like to enter a different email.",plural:"None of these are mine. I'd like to enter a different email."},email_not_matched:{title:"You might already have a 500px account",single:"This isn't me. I'd like to create a new account.",plural:"None of these are mine. I'd like to create a new account."},this_is_me:"This is me"}},login:{title:"Log In",with_qq:"Log in with QQ",with_facebook:"Log in with Facebook",with_twitter:"Log in with Twitter",with_google:"Log in with Google",with_social:"Log in with social media",with_email:"Log in with email",action:"Log In",forgot_password:"Forgot your password?",have_no_account:"Don't have an account?",placeholders:{email:"Email or Username",password:"Password"}},errors:{connection:"Cannot connect to the server.",server:"Oops, something went wrong on our end :(",oauth:"Failed to contact the third-party service.",password_empty:"Please enter a password.",password_too_short:"Please enter a password with at least %{num} characters.",password_incorrect:"Oops! We didn\u2019t recognize that log in. Please try your marketplace.500px.com log in or reset your password.",password_too_long:"Please enter a password with a maximum of %{num} characters.",email_not_found:"The email or username you entered is incorrect.",email_empty:"Please enter an email.",email_username_empty:"Please enter an email or username.",username_url_empty:"Please enter a username.",username_taken:"Sorry, username has already been taken, please choose another.",username_length:"Sorry, username must be between 4 and 35 characters",username_characters:"Sorry, username can only contain letters, numbers, _ and -",email_invalid:"Please enter a valid email.",email_taken:"Email has already been taken.",invalid_avatar_file:"Sorry, but you uploaded a wrong file type for avatar. Please select a JPG image file.",avatar_too_big:"Sorry, the avatar file is too big. Please ensure it is 50MB or less."}},errors:{server:"Oops, something went wrong on our end :(",groups:{banned:"Looks like you've been banned from this group. You can still see the content but cannot participate.",not_admin:"This action is allowed to group moderators only",no_post:"No post found.",invalid:"Invalid data."}},editor:{editors_choice_modal:{confirm:"Add photo to Editors' Choice?",remove:"Remove photo from Editors' Choice?",error_editors:"Failed to add photo to Editors' Choice",error_uneditors:"Failed to remove photo from Editors' Choice",ok:"ok",cancel:"cancel"}},licensing_request:{licensing_request_modal:{confirm:"Request licensing?",error:"Failed to request licensing",ok:"ok",cancel:"cancel"}}},registrations:{signup_profile:{"continue":"Continue",complete_profile:"Complete profile",avatar_upload_success:"Your avatar has been uploaded successfully",gravatar_loaded:"Congratulations, your Gravatar has been successfully loaded!"},signup_form:{sign_up:"Sign Up",benefits:"Keep track of your favorite photos on 500px!",permissions:"We won't spam your account. Set your permissions during sign up or any time afterward.",notifications:"We won't spam or sell your address. Update your notifications preferences any time.",with_facebok:"Sign up with Facebook",with_twitter:"Sign up with Twitter",with_google:"Sign up with Google",with_social:"Sign up with social media",with_email:"Sign up with email",have_acount:"Already have an account?",terms:"By registering, you agree to our %{terms_link}",terms_link_text:"Terms of Service",fields:{placeholder:{email:"Email",password:"Password",submit:"Sign Up"}}},signup_banner:{discover_collection_share:"Discover, collect, and share more amazing photos.",create_a_free_account:"Create a free account and join the premier photo community."},welcome:{welcome_to_500px:"Welcome to 500px!",collect_photos:"Collect your favorite photos",collect_photos_desc:"Compile the amazing photos you discover on 500px by adding them to your favorites. Access them later through your profile.",upload_new_photos:"Upload your best photos",upload_new_photos_desc:"Share your work with our awesome community. Increase your photo's discoverability by adding tags, location data, and more.",follow_photographers:"Follow amazing photographers",follow_photographers_desc:"Be inspired by some of the world's greatest photographers. Keep up to date with their activity by following them.",go_to_popular:"Go to Popular",set_up_your_flow:"Set up your Flow",upload:"Upload Your First Photo"}},sessions:{redirect:{welcome_back:"Welcome back, %{fullname}!",already_logged_in:"You are already logged in."},"new":{sign_in:"Sign In",or:"Or",sign_up:"Sign Up",submit:"Login",welcome_back_html:"Welcome back <span data-bind='name'></span>",fields:{session:{email:{label:"Email",placeholder:"Email"},password:{label:"Password",placeholder:"Password"}}}},login_modal:{sign_in:"Sign In",or:"Or",sign_up:"Sign Up",submit:"Login",welcome_back_html:"Welcome back <span data-bind='name'></span>",fields:{session:{email:{label:"Email",placeholder:"Email"},password:{label:"Password",placeholder:"Password"}}}}},photos:{focus:{photo_by:"%{photo_name} by %{raw_user_link}",like:"Like",liked:"Liked",share:"Share",nude_placeholder:"Show me the photo"},user_avatar_modal:{user:{this_user_is_inactive:"Account deleted",this_user_is_not_activated:"Account not confirmed",followers:"Followers",affection:"Affection"}},edit:{crop_size:"Click and drag anywhere on your photo to set a crop size!","delete":"Delete Photo",cancel:"Cancel",save:"Save Changes",error_saving:"There was an error saving your photo. Make sure you are connected to the internet.",delete_confirmation:"Are you sure you want to delete this photo? It will be removed from your profile, collections and stories.",delete_prime_warning:"Warning: This photo is for sale on 500px Marketplace. If you delete it, it will also be removed from Marketplace.",error_deleting:"There was an error deleting your photo. Make sure you are connected to the internet.",delete_success:"Your photo has been deleted successfully."},carousel:{titles:{popular:"Popular Photos",fresh:"Fresh Photos",fresh_today:"Fresh Photos",fresh_yesterday:"Fresh Yesterday Photos",fresh_week:"Fresh This Week Photos",editors:"Editors' Choice Photos",upcoming:"Upcoming Photos",set:"Photos from %{set_name}",favorites:"%{name}'s Favorites",user:"%{name}'s Photos"}},admin_actions:{nsfw:"Mark as NSFW",unnsfw:"Unmark as NSFW","private":"Mark as Private",editors:"Add to Editors' Choice",already_a_member:"Already in Editors' Choice",add_to_market_set:"Add to Market Set"},request_to_license:{this_photo_is_not_to_license:"This photo is not available to license",instructions:"Enter your email and we'll notify you if this photo is put up to license. We'll also let the author know someone is interested in buying the photo.",submit:"Submit",fields:{sale_lead:{email:{invalid:"Enter a valid email.",placeholder:"Your email address"}}},errors:{request_failed:"Oops, Something went wrong :( Please try again later."}},report:{submit:"Submit",reasons:{6:"Should be tagged as adult content",1:"Offensive (rude, obscene)",2:"Spam (ads, self-promotion)",3:"Offtopic (trolling)",4:"Copyright (plagiarism, stealing)",5:"Wrong content (illustration, 3D)"}},embed_prompt:{embed_photo:"Embed Photo",copy_this:"Copy this code to your website",by:"by <a data-bind='author_link'></a>"},dislike_prompt:{ok:"OK",cancel:"Cancel"},show:{pulse:"Pulse",current_value:"Current",highest_value:"Highest",highest:"Highest Pulse",views:"Views",share:"Share",votes:"Likes",faves:"Faves",embed:"Embed",buy_print:"Buy Print",download:"Download",set_cover:"Set As Cover",setting_cover:"Setting",is_cover:"Photo is cover",disliked:"Disliked",liked:"Liked",report_this_photo:"Report this photo",already_reported:"You have reported this photo",meta_description:"%{description} %{tags} %{photo_meta_data}",tags:"Tags",description:"Description",liked_by:"Likes",liked_by_with_count:"Likes (%{count})",see_all:"See all",favorited_by:"Favorites",favorited_by_with_count:"Favorites (%{count})",cannot_like_own_photo:"You cannot like your own photo.",cannot_favorite_own_photo:"You cannot favorite your own photo.",cannot_editors_own_photo:"You cannot mark your own photo as editors choice.",photographer:"Photographer",dislike:"I don't like this photo",confirm_dislike:"Are you sure you want to dislike this photo?",followers:"Followers",affection:"Affections",like:"Like",favorites:"Favorites",editors:"Editors' Choice",licensing_request:"licensing request",licensing_requested:"licensing requested",nude_placeholder:"Show me the photo",scroll_to_top:"Scroll to top",feature:{popular:"Popular",fresh:"Fresh",upcoming:"Upcoming"},meta_data:{camera:"Camera",lens:"Lens",focal_length:"Focal Length",shutter_speed:"Shutter Speed",aperture:"Aperture",iso:"ISO/Film"},shortcuts:{title:"Keyboard Shortcuts",like:"Like",favorite:"Favorite",maximize:"Maximize",focus:"Focus",previous:"Previous",next:"Next",dismiss:"Dismiss",close:"Close"},category:"Category",uploaded:"Uploaded",taken:"Taken",license:"License",not_available:"N/A",image_alt:"Photograph %{title} by %{user} on 500px",details:"Details",location:"Location",enable_in_store:"Enable Store",edit_photo:"Edit Photo",you_requested_to_buy:"Request has been received",request_to_license:"Request to License",requested_to_license:"Requested to License",request:"Request",submit_for_licensing:"Submit for Licensing",buy_now:"Buy Now",license_photo:"License Photo",download_photo:"Download Photo",license_resolution:"%{width} x %{height}px @%{dpi}dpi",low_resolution:"Resolution not supported",contact_us:"Contact Us",buy_photo:{rights_managed:"Rights Managed License",royalty_free:"Royalty Free License",web_social:"Web/Social License",variable_price:"Price based on usage",fixed_price:"For only %{price}"},current_pulse:"Current Pulse",highest_pulse:"Highest Pulse",highest_pulse_date:"on %{date}",likes:"Likes",comments:"Comments",show_more:"More",download_app_discover_more:"Discover more inspiring photos like this one.",download_app_button:"Download the FREE 500px app",open_app_button:"Open in app",setting:"Setting"}},upload:{crop_size:"Click and drag anywhere on your photo to set a crop size!",drag_photos:"Drag and drop photos",drag_photos_short:"Drag and drop photos",transfer_photos:"Transfer your photos from another service to 500px.",drag_and_drop:"Drag and Drop",import_photos_from_services:"Import photos from other services",choose_photos:"Choose photos",import_photos:"Import photos","import":"Import",from_services_such_as:"from services such as",remove:"Remove",save_and_continue:"Save & Continue",finish_upload:"Finish Upload",upload_error:{connection:"Photo(s) could not be uploaded as there was a problem connecting to the server. Try the upload again or visit <a href='https://support.500px.com/customer/portal/articles/381102-i-m-having-trouble-uploading'>our support page</a>.",server:"Photo(s) could not be uploaded. Try the upload again or visit <a href='https://support.500px.com/customer/portal/articles/381102-i-m-having-trouble-uploading'>our support page</a>.",badformat:"Photo(s) could not be uploaded. Please ensure all of your images are valid JPEGs."},file_too_large_dimensions_error:{dimensions_are_too_large:"These files could not be loaded because their dimensions are too big. The limit for files in the uploader is 15,000px on either side."},file_too_large_error:{these_files_are_too_large:"These files could not be loaded because they are too large. The maximum size for a file is 49 megabytes."},file_type_error:{these_files_could_not_be_loaded:"These files could not be loaded because they are not JPEGs."},file_duplicate_error:{these_files_are_duplicates:"These files were not added as they are already in the uploader."},file_invalid_error:{these_files_are_invalid:"These files could not be loaded because they could not be rendered. Are you sure they are JPEGs?"},over_free_limit_error:{would_go_over_limit_html:'These files could not be loaded because uploading them would put you over your limit of photos for the week. To have unlimited uploads <a href="/upgrade" target="_blank">upgrade your account</a>.'},simple:{select:"Select a photo to upload.",for_a_better_experience_html:'For a better experience, please download\n<a href="https://www.mozilla.org/en-US/firefox/fx/#desktop" target="_blank">Mozilla Firefox</a>\nor\n<a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Google Chrome</a>.\n',your_photo_is_uploading:"Your photo is uploading..."},no_file_reader:{file_is_loading:"Your image is processing..."},index:{upload_limit_left_many:"You have %{amount} photos remaining to upload. <a href='/upgrade' target='_blank'>Upgrade now</a>.",upload_limit_left_one:"You have %{amount} photo remaining to upload. <a href='/upgrade' target='_blank'>Upgrade now</a>.",confirm_low_discoverability:"This photo has low discoverability. Are you sure you want to continue?",confirm_remove:"Are you sure you want to remove this photo?",some_photos_have_low_discoverability:"Some of your photos have low discoverability. We recommend filling out more details about your photos. Would you like to review the photos with low discoverability?",max_files:"You have reached the maximum number of files you can upload at once ({{number}}). Please upload your current set of photos before trying to add more.",some_photos_not_for_fresh:"Some of your photos have low discoverability. If you give your photo a <strong>title, category, and add 3 tags</strong>, it will be featured in the <strong>Fresh</strong> photos feed.  Would you like to revisit those photos?",are_you_sure_want_to_leave:"You will lose any changes you made to files that were not uploaded."},photo_details:{agree_to_terms:"By clicking Enable In Store you agree to the %{terms_link}",too_small:"This photo is too small. Only photos larger than 3000px on a side are eligible for the store.",description:"Description",tags:"Tags",tag_autocompletion:{popular_tags:"Popular Tags"},lytro_path:"Lytro Path",lytro_path_placeholder:"e.g: https://pictures.lytro.com/lytroweb/pictures/1/embed",discoverability:"Discoverability",add_metadata:"Add metadata to improve your photo's discoverability.",map:"Map",adult_content:"Adult Content",fresh_qualification:{headline:"Publish to Fresh",title:"Title",three_tags:"3 Tags",category:"Category",tooltip:"Fresh is where newly uploaded photos are displayed. To see your photo in this feed, be sure to add a title, category, and at least three tags to improve discoverability."},not_discoverable:"This photo will be private.",title:"Title",license:"License",edit:"edit",exif:"Exif",set_default:"Use these as default",is_default:"Current default",set_creation:{placeholder:"Name your new set here...",create_new_set:"Create New Set",confirm_new_set:"Create",cancel_new_set:"Cancel",create_set_alert:"Your set creation is incomplete - would you like to create the set?",errors:{path_taken:"This set name already exists",server:"Internal error",connection:"Cannot connect to Internet"}},category:"Category",place_photo_in:"Place Photo In",enable_in_store:"Enable In Store",fields:{tags:{placeholder:"Tag to make your photo easier to find...",short_placeholder:"Tag more...",remaining:"tags remaining",none_remaining:"No tags remaining"},photo:{description:{placeholder:"Enter a description for your beautiful photo"},place_in:{library:"Library (private)",profile:"Profile (public)",set:"Set",portfolio:"Portfolio"},lens:{label:"Lens",placeholder:"Set Lens"},shutter_speed:{label:"Shutter Speed",placeholder:"Set Shutter Speed"},camera:{label:"Camera",placeholder:"Set Camera"},focal_length:{
label:"Focal Length",placeholder:"Set Focal Length"},aperture:{label:"Aperture",placeholder:"Set Aperture"},iso:{label:"ISO",placeholder:"Set ISO"},taken_at:{label:"Taken",placeholder:"Set Date (dd/mm/yyyy)"},name:{placeholder:"Untitled Image"}}}}},organizer:{no_photos:"You don't have any photos in your library.",empty_filter:"No photos match your current filters.",start_uploading:"Start by <a id='open_upload_library'>uploading</a> your best photos.",upload_to_set:"Upload to Set",upload_to_library:"Upload to Library",upload_to_profile:"Upload to Profile",upload_to_portfolio:"Upload to Portfolio",sort:{sort_by:"Sort By",date_uploaded:"Date Uploaded",views:"Views",likes:"Likes",favorites:"Favorites",pulse:"Highest Pulse"},filter:{filter:"Filter",reset:"Reset",uploaded:"Uploaded","3_days":"in the last 3 days",last_week:"in the last week",last_month:"in the last month",last_year:"in the last year",sets:"Sets",categories:"Categories",license:"License"},sidebar:{"new":"New",library:"Library",all_photos:"All Photos",public_profile:"Public Profile",sets:"Sets",portfolios:"Portfolios"},photo:{"delete":"Delete",edit:"Edit"},partner:{messages:{added:"Photo(s) are submitted for consideration.",incorrect_orientation:"Photo orientation should be horizontal (landscape).",existed_already:"Photo(s) have already been submitted before."},tos:{title:"Promotional Archive Terms of Service",body:{intro:"500px is creating an archive (\u201cPromotional Archive\u201d) of high quality photos to be used for special promotional activities. In addition to being published on the 500px Site, photos from the Promotional Archive will be licensed for display on third party web-sites (\u201cPartner Sites\u201d) to promote the contributing photographer, the photos they take and 500px as the primary source of these photos on the internet. This will enable community photographers who contribute photos to the Promotional Archive to reach a much larger audience than can be achieved solely through the 500px Site. If you wish all or part of your portfolio to participate in the Promotional Archive, the terms and conditions below will specifically apply in addition to 500px's Terms posted on the Site. All capitalized words not otherwise defined herein, have the meanings given to them in 500px's Terms.",term_1:"By posting Content to the Promotional Archive you hereby grant to 500px a non-exclusive, transferable, fully paid, worldwide license to use, transmit, distribute, reproduce, modify, adapt, publicly perform, publicly display and sublicense the Content for promotional purposes (the \u201cLicense\u201d). \u2018Promotional purposes' means promoting the Content to the public via the 500px Site and Partner Sites in association with your 500px username as the creator of the Content, and in association with 500px and/or the 500px Site as the primary publication source of the Content on the internet. In addition to your username, 500px may, at its discretion, include such other details about the Content as submitted by you on the Site.",term_2:"The License includes the right to modify the Content for formatting, navigational or promotional purposes, or for use with particular audio-visual formats, but does not include the right to materially alter the Content, or exhibit the Content with third party materials in any manner that either materially distorts its meaning or implies that another person created the Content.",term_3:"500px will not authorize Partner Sites to sell copies of the Content. However, you acknowledge and agree that 500px will not have control over the resolution at which Content will be displayed or whether users will be permitted to make low resolution and/or high resolution copies of the Content. You hereby expressly authorize 500px to permit Partner Sites to allow their users to make low resolution and/or high resolution copies of the Content and acknowledge and agree that 500px shall not be responsible or liable, directly or indirectly, for any damage or loss caused by the display or copying of your Content on Partner Sites.",term_4:"The License will automatically terminate upon the removal of the Content from the Promotional Archive. However, the termination of the License will not invalidate or terminate any sublicense of Content granted by 500px to Partner Sites prior to the removal of the Content from the Promotional Archive, and all such Partner Sites shall continue to have the rights granted to  them with respect to the Content for the duration of the period provided for by each sublicense agreement.",bottom_line:"If you wish to post Content to the Promotional Archive you must indicate your acceptance of the foregoing terms where indicated below. If you do not wish to post Content to the Promotional Archive, you must decline the terms where indicated, or exit this page."},actions:{accept:"Accept",decline:"Decline"},messages:{accepted:"Welcome to your new exposure opportunities! You've made the right choice.",error:"Sorry, an error occurred. Please reload the page and try again.",declined_optional:"Sorry to hear your declining %{term}.",declined_mandatory:"Sorry, you need to accept %{term} first!"}}}},time_distance:{less_than_x_minutes:{one:"less than a minute ago",other:"less than {{count}} minutes ago"},x_minutes:{one:"1 minute ago",other:"{{count}} minutes ago"},about_x_hours:{one:"about 1 hour ago",other:"about {{count}} hours ago"},x_days:{one:"1 day ago",other:"{{count}} days ago"},about_x_months:{one:"about 1 month ago"},x_months:{other:"{{count}} months ago"},about_x_years:{one:"about 1 year ago",other:"about {{count}} years ago"},over_x_years:{one:"over 1 year ago",other:"over {{count}} years ago"},almost_x_years:{one:"almost 1 year ago",other:"almost {{count}} years ago"}},user:{verified:"Verified User",more:"More",scroll_to:"Scroll to",top:"top",report:"REPORT USER",tell_friend:"Tell a friend!",portfolio_upgrade:"You need to <a href='/upgrade'>upgrade</a> to use Portfolios.",group:{members_count:"%{count} Members"},sets:{no_longer_active:"Sets are a premium feature.",membership_expired:"Upgrade to organize your photos in unlimited public and private sets."},change_cover:{drag_photos:"Drag and drop or <a href='#' class='browse_files'>browse</a> for a photo on your computer.",select_recommended:"Or select a recommended photo below.",recommended:"Recommended Photos","delete":"<a href='#' class='remove_cover'>You can also remove your current cover photo.</a>"},empty:{no_favorites:"%{name} doesn't have any favorite photos.",favorites_prompt:"Follow %{name} to see which photos they love.",no_photos:"%{name} hasn't uploaded a photo.",photos_prompt:"Follow %{name} to stay in touch.",no_sets:"%{name} hasn't created a set.",sets_prompt:"Follow %{name} to stay in touch.",no_store:"%{name} doesn't have any photos for sale.",store_prompt:"Follow %{name} to find out when photos are added.",no_stories:"%{name} has not written any stories.",stories_prompt:"Follow %{name} to find out when stories are written.",no_flow:"%{name} has not discovered any photos.",flow_prompt:"Follow %{name} to find out when they do.",inactive_to_show_photos:"To make your photos visible on this page, please verify your email.",inactive_to_create_stories:"To create stories, please verify your email.",inactive_to_show_store:"To be able to show your photos for sale, please verify your email.",inactive_to_create_sets:"To be able to create sets, please verify your email.",inactive_your_photos_all_private:"Upload public photos or set your current",inactive_your_photos_all_private2:"photos to public to see them here.",enabled_store_but_no_photos:"Your store is enabled but you have no photos uploaded.",enabled_store_but_no_photos2:"Please upload photos to start selling in your store.",your_photos_empty:"Upload your photos and ",your_photos_empty_2:"share them with your friends.",your_sets_empty:"Create a Set to group photos",your_sets_empty_2:"together and share awesome stories.",your_favorites_empty:"Add photos to your favorites to",your_favorites_empty_2:"bookmark them for viewing later.",your_store_empty:"Start selling your photos as canvas",your_store_empty_2:"prints and downloads with ease.",your_stories_empty:"Share one of your journeys",your_stories_empty_2:"or adventures with the world.",your_flow_empty:"See the photos you like and favorite.",upload:"Upload",enable_store:"Enable Store",tell_story:"An update on Stories",discover:"Discover Photos"},sidebar_sets:{create_new_set:"Create a new Set"},cover:{change:"Change Cover",choose:"Choose Cover",pick_any_photo:"Don't see the photo you want to use? Navigate to the photo and make it your cover!",errors:{do_not_have_cover_to_remove:"You do not have a cover photo to remove. Please set a cover photo first.",unable_to_remove:"Could not remove cover, please try again",unable_to_remove_connection:"Your cover photo could not be removed as there was a problem connecting to the server. Check your internet connection and try again.",corrupted_file:"Could not read dimensions of the photo, please try another",dimensions_too_big:"Dimensions of the photo are too big, please reduce it and try again.",dimensions_too_low:"Dimensions of the photo are too low, please try again with bigger photo. Minimum width 2000px and height 1000px",vertical_orientation:"Please try again with a landscape orientation photo.",connection:"Your cover photo could not be uploaded as there was a problem connecting to the server. Check your internet connection and try the upload again.",server:"Your cover photo could not be uploaded. Please try the again in a few minutes."}},show:{more:"More"},about:{stats:{affection:"Affection",views:"Views",likes:"Likes",favorites:"Favorites",comments:"Comments"},biography:"Biography",no_biography:"No Biography",add_biography:"Tell the world about yourself",contact:"Contact",no_contacts:"No Contacts",connect_with_social_networks:"Connect with social networks",gear:"Gear",no_gear:"No Gear",what_is_your_gear:"What gear do you use?",no_location:"No Location",missing_location:"Oops, we can't find that place",update_missing_location:"Please update your location",where_are_you_from:"Where do you call home?",following:"Following",no_following:"Not Following Anyone",follow_others:"Follow other photographers to stay up to date with their uploads and activity.",find_friends:"Find your friends",followers:"Followers",following_you:"Tell your friends about your 500px profile.",share_your_profile:"Share your profile and tell your friends that you're on 500px",no_followers:"No Followers",share_on_facebook:"Share on Facebook",send_a_message:"Send a message",check_messages:"Check your messages",actions:{edit:"Settings",upload:"Upload",organize:"Manage Photos",organize_short:"Manage"}},embed_prompt:{tell_friend:"Tell Friend",copy_this:"Copy This"}},users:{share_email_message:"Check out %{raw_fullname}'s amazing Profile.",embed_prompt:{embed_badge:"Embed Badge",copy_this:"Copy the code to your website"},you:"You",follow_user:{follow:"Follow",unfollow:"Unfollow",following:"Following",edit_profile:"Edit Profile",you:"You"},about:{send_a_message:"Send A Message"}},about:{index:{heading:"The Premier Photography Community",heading_desc:"500px is a photo community for discovering, sharing, buying and selling inspiring photography powered by creative people worldwide.",sharing:"Sharing",sharing_desc:"Our platform is centered around sharing. Like a photo, add it to your favorites, share it with your friends on your social networks, or give the photographer feedback in the comments.",flow:"Flow",flow_desc:"A beautifully curated feed of photographers you follow and your friend's activity: photos that they like, favorite, comment on, and upload.",apps:"Apps",apps_desc:"Get lost in an endless stream of high-resolution, edge-to-edge photographs. Enjoy the seamless 500px desktop experience, anywhere you go. If you simply want to enjoy the image, the interface fades away with a tap.",history:"Company History",launch:"500px launches",first_office:"500px moves to first office",release_flow:"500px releases Flow",acquire_pulpfingers:"500px acquires Pulpfingers",release_iphone:"500px releases iPhone app",palo_alto_office:"500px opens an office in the Bay Area",second_office:"500px moves into second office in Toronto",ryerson_dmz:"500px joins Ryerson DMZ incubator",seed_round:"500px gets seed round funding from ffVC",public_api:"500px releases public API",release_ipad:"500px releases iPad app",release_android:"500px releases Android app",release_portfolio:"500px releases Portfolios",series_a:"500px gets series A round funding from A16Z, Harrison Metal",get_in_touch:"Get In Touch",support:"Support Center",email:"Email",team:"The Team",team_desc:"The faces behind the platform",team_button:"Get to know us better",jobs:"Jobs",jobs_desc:"Love photography & technology? Join our team!",jobs_button:"Check out 500px Jobs",outro:"We love photography, join us.",outro_desc:"Connect with fellow photographers, inspire others, contribute, and immerse yourself in the world's best photography.",sign_up:"Sign Up"}},grid:{empty:{title:"No photos",category:"Unfortunately, there are no photos in the %{category} category. Please try again later"}},activities:{focus:{nude_placeholder:"Show me the photo"}}},window.PxLocaleDefault={groups:{messages:{photo_added:"Great! Your photo has been added to the group. Now everybody can see it."}},flow:{one_and_n_more_photos:"%{raw_one_title} and %{n} more photos",actions:{liked:"%{raw_user} liked %{raw_linebreak} %{raw_photos_with_attribution}",favorited:"%{raw_user} favorited %{raw_linebreak} %{raw_photos_with_attribution}",commented:"%{raw_user} commented %{raw_linebreak} %{raw_photos_with_attribution}",uploaded:"%{raw_user} uploaded %{raw_linebreak} %{raw_photos_with_attribution}"}},lytro:{living_photo:"Living Picture",ad:{buy:"Buy Now",preorder:"Pre-order Now",discount:"How to claim your $250 discount",title:"Tell a Story with Depth and Dimension",description_html:"Order the %{order_link} before August 23rd for a $250 discount, exclusive to 500px members."}},picks:{email_cta:{email_desc:"Enter your email address to be notified when you can group and organize your favorite photos into a Collection like this one.",enter_email:"Email address",invalid_email:"Invalid email",submitted:"Submitted"},download_app_cta_desktop:{download:"Amazing photos, anywhere.",download_desc:"Discover more amazing photos on the 500px app for iPhone."},download_app_cta_ipad:{download:"Amazing photos, anywhere.",download_desc:"Discover more amazing photos on the 500px app for iPad."},download_app_cta_iphone:{download:"500px for iPhone",get_the_app:"Get the app",already_got_it:"I already have it"}},licenses:{any:"Any License",0:"500px License",4:"Attribution 3.0",5:"Attribution-NoDerivs 3.0",6:"Attribution-ShareAlike 3.0",1:"Attribution-NonCommercial 3.0",2:"Attribution-NonCommercial-NoDerivs 3.0",3:"Attribution-NonCommercial-ShareAlike 3.0"},licenses_short:{any:"Any",0:"500px",4:"BY",5:"BY-ND",6:"BY-SA",1:"BY-NC",2:"BY-NC-ND",3:"BY-NC-SA"},categories:{10:"Abstract",11:"Animals",5:"Black and White",1:"Celebrities",9:"City & Architecture",15:"Commercial",16:"Concert",20:"Family",14:"Fashion",2:"Film",24:"Fine Art",23:"Food",3:"Journalism",8:"Landscapes",28:"Light Field",12:"Macro",18:"Nature",4:"Nude",7:"People",19:"Performing Arts",17:"Sport",6:"Still Life",21:"Street",26:"Transportation",13:"Travel",22:"Underwater",27:"Urban Exploration",25:"Wedding",0:"Uncategorized"},tooltips:{got_it:"Got it!",onboarding_favorite_photo:{title:"Collect your favorites",body:"Compile your favorite photos and revisit them later on your %{raw_profile}.",body_mobile:"Compile your favorite photos and revisit them later.",profile:"Profile"},onboarding_follow_user:{title:"Get inspired",body:"Follow photographers that inspire you and keep up with their uploads, likes, favorites, and comments in your %{raw_flow}.",flow:"Flow"},organizer_multiselect:{title:"Select Multiple Photos",body:"You can now select and move multiple photos in the organizer. Either drag your cursor to create a selection, or select multiple photos by command/control-clicking."},upload_callout:{title:"Upload your first photo!",body:"500px is a simple way to share photos with other photography enthusiasts. Your photos belong here!"}},flash:{photos_presubmitted_to_prime:"Your eligible photos have been submitted to 500px Marketplace!"},ui:{login:{facebook:"Login with Facebook",twitter:"Login with Twitter"},signup:{facebook:"Sign up with Facebook",twitter:"Sign up with Twitter",google:"Sign up with Google",email:"Sign up with email"},copyright_tooltip:{message_html:"Hey, this photo is &copy; <span>USERNAME</span>"},sharelizers:{group:{twitter:{message:"Check out the group %{group_name} on @500px"},pinterest:{message:"Check out the group %{group_name} at %{group_url}"},email:{subject:"Check out group %{group_name} on 500px",body:"Check out the group %{group_name} at %{group_url}",share_by_email:"Email Group",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Check out the group %{group_name} on 500px"}}}}},discussion:{twitter:{message:"Check out discussion %{discussion_name} on @500px"},pinterest:{message:"Check out discussion %{discussion_name} at %{discussion_url}"},email:{subject:"Check out discussion %{discussion_name} on 500px",body:"Check out discussion %{discussion_name} at %{discussion_url}",share_by_email:"Email Group",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Check out the group %{group_name} on 500px"}}}}},user:{twitter:{message:"Check out the amazing profile of %{raw_fullname}%{raw_twitter_mention} on @500px"},pinterest:{message:"%{raw_about}"},email:{share_by_email:"Email User Profile",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Check out amazing portfolio of "}}}}},twitter:{message:"Photo \u201c%{raw_name}\u201d by %{raw_user_fullname}%{raw_twitter_mention} #500px"},stumbleupon:{message:"\u201c%{name}\u201d by %{user_fullname}"},email:{share_by_email:"Send an Email",submit:"Send",to:"To",from:"From",fields:{email:{from:{required:"You must enter your email.",invalid:"Enter a valid email.",placeholder:"Your email"},to:{invalid:"Enter a valid email.",required:"You must enter the recipient's email.",placeholder:"Recipient email"},message:{placeholder:"Your message"}}}}},modals:{alert:{cancel:"Cancel",try_again:"Try Again",ok:"OK",yes:"Yes",skip:"Skip","delete":"Delete",create_set:"Create Set",discard:"Discard",revisit_photos:"Revisit Photos",finish_upload:"Finish Upload",go_back:"Go Back",low_discoverability:"<h3>Low Discoverability</h3><p>Give your photos a title, a category, and 3 tags to see them featured in the <b>Fresh</b> feed.</p>"}}},sets:{create:"Create A Set"},layout:{description:"500px lets you create stunning professional photo portfolios, find friends, express yourself and connect with people like you.",keywords:"photos, photographers, photo portfolio, online photo portfolio, photo digest, web photo portfolio, online photo gallery, share pictures, professional photography, social photography, upload photographs, share photo, outstanding photo portfolio, photo community, fresh photos, portfolio in seconds, models vs photographers, commercial photography, architectural photography, professional portfolio management"},favorites:{favorited_by:"FAVORITED BY"},comments:{index:{comments:"COMMENTS",top_comments:"TOP COMMENTS",load_more:"Load More",you_need_to_login_to_post_html:"You need to <a href='%{login_path}'>Login</a> or <a href='%{signup_path}'>Signup</a> to post comments.",subscribe:"Subscribe to this thread"},comment:{confirm_flag:"Are you sure you want to flag this comment for review by a moderator?",confirm_delete:"Are you sure you want to delete this comment?",this_comment_is_flagged_html:"This comment has been flagged. <a href='#'>View comment.</a>",likes:{zero:"Like",one:"%{count} Like",other:"%{count} Likes"},reply:"Reply",flag:"Flag","delete":"Delete",translate:"Translate",translated:"Translated by Bing",translating:"Translating...",show_original:"Show Original"},"new":{fields:{comment:{body:{required:"Whoops, your comment cannot be blank.",placeholder:"Provide feedback and share your comments..."}}},"new":"Post Comment",reply:"Post Reply"},wall_index:{comments:"COMMENTS",top_comments:"TOP COMMENTS",load_more:"Load More",you_need_to_login_to_post_html:"You need to <a href='%{login_path}'>Login</a> or <a href='%{signup_path}'>Signup</a> to post comments.",subscribe:"Subscribe to this thread"},wall_new:{"new":"Leave message",fields:{comment:{body:{required:"Whoops, your message cannot be blank.",placeholder:"Leave a message for this user..."}}}}},shared:{common:{new_feature:"New",next_page:"Next",previous_page:"Previous",one_and_another:"%{raw_one} and %{raw_another}",one_or_another:"%{raw_one} or %{raw_another}",attribution:"%{raw_content} by %{raw_author}",attribution_title_first:"%{raw_content} by %{raw_author}",attribution_category:"%{raw_category} photo by %{raw_author}",attribution_with_company:"%{raw_content} by %{raw_author} on 500px"},signup_login_form:{signup:{title:"Sign Up",benefits:{"default":"Keep track of your favorite photos on 500px!",upload:"Upload and share your photos with the 500px community.",follow:"Follow %{firstname}, and create your own profile."},permissions:"We won't spam your account. Set your permissions during sign up or any time afterward.",notifications:"We won't spam or sell your address. Update your notifications preferences any time.",with_qq:"Sign up with QQ",with_facebook:"Sign up with Facebook",with_twitter:"Sign up with Twitter",with_google:"Sign up with Google",with_social:"Sign up with social media",with_email:"Sign up with email",terms:"By registering, you agree to our %{terms_link}",terms_link_text:"Terms of Service",action:"Sign Up",have_acount:"Already have an account?",placeholders:{email:"Email",password:"Password"},email_form:{title:"Complete Authentication",email_needed:"You need to provide an e-mail address for your account to complete the registration.",email_needed_with_name:"Hi %{nickname}, please provide an e-mail address for your account to complete the registration.",existing_account:{single:"Is this your account?",plural:"Are any of these accounts yours?"},email_matched:{title:"The e-mail you entered is in use",single:"This isn't me. I'd like to enter a different email.",plural:"None of these are mine. I'd like to enter a different email."},email_not_matched:{title:"You might already have a 500px account",single:"This isn't me. I'd like to create a new account.",plural:"None of these are mine. I'd like to create a new account."},this_is_me:"This is me"}},login:{title:"Log In",with_qq:"Log in with QQ",with_facebook:"Log in with Facebook",with_twitter:"Log in with Twitter",with_google:"Log in with Google",with_social:"Log in with social media",with_email:"Log in with email",action:"Log In",forgot_password:"Forgot your password?",have_no_account:"Don't have an account?",placeholders:{email:"Email or Username",password:"Password"}},errors:{connection:"Cannot connect to the server.",server:"Oops, something went wrong on our end :(",oauth:"Failed to contact the third-party service.",password_empty:"Please enter a password.",password_too_short:"Please enter a password with at least %{num} characters.",password_incorrect:"Oops! We didn\u2019t recognize that log in. Please try your marketplace.500px.com log in or reset your password.",password_too_long:"Please enter a password with a maximum of %{num} characters.",email_not_found:"The email or username you entered is incorrect.",email_empty:"Please enter an email.",email_username_empty:"Please enter an email or username.",username_url_empty:"Please enter a username.",username_taken:"Sorry, username has already been taken, please choose another.",username_length:"Sorry, username must be between 4 and 35 characters",username_characters:"Sorry, username can only contain letters, numbers, _ and -",email_invalid:"Please enter a valid email.",email_taken:"Email has already been taken.",invalid_avatar_file:"Sorry, but you uploaded a wrong file type for avatar. Please select a JPG image file.",avatar_too_big:"Sorry, the avatar file is too big. Please ensure it is 50MB or less."}},errors:{server:"Oops, something went wrong on our end :(",groups:{banned:"Looks like you've been banned from this group. You can still see the content but cannot participate.",not_admin:"This action is allowed to group moderators only",no_post:"No post found.",invalid:"Invalid data."}},editor:{editors_choice_modal:{confirm:"Add photo to Editors' Choice?",remove:"Remove photo from Editors' Choice?",error_editors:"Failed to add photo to Editors' Choice",error_uneditors:"Failed to remove photo from Editors' Choice",ok:"ok",cancel:"cancel"}},licensing_request:{licensing_request_modal:{confirm:"Request licensing?",error:"Failed to request licensing",ok:"ok",cancel:"cancel"}}},registrations:{signup_profile:{"continue":"Continue",complete_profile:"Complete profile",avatar_upload_success:"Your avatar has been uploaded successfully",gravatar_loaded:"Congratulations, your Gravatar has been successfully loaded!"},signup_form:{sign_up:"Sign Up",benefits:"Keep track of your favorite photos on 500px!",permissions:"We won't spam your account. Set your permissions during sign up or any time afterward.",notifications:"We won't spam or sell your address. Update your notifications preferences any time.",with_facebok:"Sign up with Facebook",with_twitter:"Sign up with Twitter",with_google:"Sign up with Google",with_social:"Sign up with social media",with_email:"Sign up with email",have_acount:"Already have an account?",terms:"By registering, you agree to our %{terms_link}",terms_link_text:"Terms of Service",fields:{placeholder:{email:"Email",password:"Password",submit:"Sign Up"}}},signup_banner:{discover_collection_share:"Discover, collect, and share more amazing photos.",create_a_free_account:"Create a free account and join the premier photo community."},welcome:{welcome_to_500px:"Welcome to 500px!",collect_photos:"Collect your favorite photos",collect_photos_desc:"Compile the amazing photos you discover on 500px by adding them to your favorites. Access them later through your profile.",upload_new_photos:"Upload your best photos",upload_new_photos_desc:"Share your work with our awesome community. Increase your photo's discoverability by adding tags, location data, and more.",follow_photographers:"Follow amazing photographers",follow_photographers_desc:"Be inspired by some of the world's greatest photographers. Keep up to date with their activity by following them.",go_to_popular:"Go to Popular",set_up_your_flow:"Set up your Flow",upload:"Upload Your First Photo"}},sessions:{redirect:{welcome_back:"Welcome back, %{fullname}!",already_logged_in:"You are already logged in."},"new":{sign_in:"Sign In",or:"Or",sign_up:"Sign Up",submit:"Login",welcome_back_html:"Welcome back <span data-bind='name'></span>",fields:{session:{email:{label:"Email",placeholder:"Email"},password:{label:"Password",placeholder:"Password"}}}},login_modal:{sign_in:"Sign In",or:"Or",sign_up:"Sign Up",submit:"Login",welcome_back_html:"Welcome back <span data-bind='name'></span>",fields:{session:{email:{label:"Email",placeholder:"Email"},password:{label:"Password",placeholder:"Password"}}}}},photos:{focus:{photo_by:"%{photo_name} by %{raw_user_link}",like:"Like",liked:"Liked",share:"Share",nude_placeholder:"Show me the photo"},user_avatar_modal:{user:{this_user_is_inactive:"Account deleted",this_user_is_not_activated:"Account not confirmed",followers:"Followers",affection:"Affection"}},edit:{crop_size:"Click and drag anywhere on your photo to set a crop size!","delete":"Delete Photo",cancel:"Cancel",save:"Save Changes",error_saving:"There was an error saving your photo. Make sure you are connected to the internet.",delete_confirmation:"Are you sure you want to delete this photo? It will be removed from your profile, collections and stories.",delete_prime_warning:"Warning: This photo is for sale on 500px Marketplace. If you delete it, it will also be removed from Marketplace.",error_deleting:"There was an error deleting your photo. Make sure you are connected to the internet.",delete_success:"Your photo has been deleted successfully."},carousel:{titles:{popular:"Popular Photos",fresh:"Fresh Photos",fresh_today:"Fresh Photos",fresh_yesterday:"Fresh Yesterday Photos",fresh_week:"Fresh This Week Photos",editors:"Editors' Choice Photos",upcoming:"Upcoming Photos",set:"Photos from %{set_name}",favorites:"%{name}'s Favorites",user:"%{name}'s Photos"}},admin_actions:{nsfw:"Mark as NSFW",unnsfw:"Unmark as NSFW","private":"Mark as Private",editors:"Add to Editors' Choice",already_a_member:"Already in Editors' Choice",add_to_market_set:"Add to Market Set"},request_to_license:{this_photo_is_not_to_license:"This photo is not available to license",instructions:"Enter your email and we'll notify you if this photo is put up to license. We'll also let the author know someone is interested in buying the photo.",submit:"Submit",fields:{sale_lead:{email:{invalid:"Enter a valid email.",placeholder:"Your email address"}}},errors:{request_failed:"Oops, Something went wrong :( Please try again later."}},report:{submit:"Submit",reasons:{6:"Should be tagged as adult content",1:"Offensive (rude, obscene)",2:"Spam (ads, self-promotion)",3:"Offtopic (trolling)",4:"Copyright (plagiarism, stealing)",5:"Wrong content (illustration, 3D)"}},embed_prompt:{embed_photo:"Embed Photo",copy_this:"Copy this code to your website",by:"by <a data-bind='author_link'></a>"},dislike_prompt:{ok:"OK",cancel:"Cancel"},show:{pulse:"Pulse",current_value:"Current",highest_value:"Highest",highest:"Highest Pulse",views:"Views",share:"Share",votes:"Likes",faves:"Faves",embed:"Embed",buy_print:"Buy Print",download:"Download",set_cover:"Set As Cover",setting_cover:"Setting",is_cover:"Photo is cover",disliked:"Disliked",liked:"Liked",report_this_photo:"Report this photo",already_reported:"You have reported this photo",meta_description:"%{description} %{tags} %{photo_meta_data}",tags:"Tags",description:"Description",liked_by:"Likes",liked_by_with_count:"Likes (%{count})",see_all:"See all",favorited_by:"Favorites",favorited_by_with_count:"Favorites (%{count})",cannot_like_own_photo:"You cannot like your own photo.",cannot_favorite_own_photo:"You cannot favorite your own photo.",cannot_editors_own_photo:"You cannot mark your own photo as editors choice.",photographer:"Photographer",dislike:"I don't like this photo",confirm_dislike:"Are you sure you want to dislike this photo?",followers:"Followers",affection:"Affections",like:"Like",favorites:"Favorites",editors:"Editors' Choice",licensing_request:"licensing request",licensing_requested:"licensing requested",nude_placeholder:"Show me the photo",scroll_to_top:"Scroll to top",feature:{popular:"Popular",fresh:"Fresh",upcoming:"Upcoming"},meta_data:{camera:"Camera",lens:"Lens",focal_length:"Focal Length",shutter_speed:"Shutter Speed",aperture:"Aperture",iso:"ISO/Film"},shortcuts:{title:"Keyboard Shortcuts",like:"Like",favorite:"Favorite",maximize:"Maximize",focus:"Focus",previous:"Previous",next:"Next",dismiss:"Dismiss",close:"Close"},category:"Category",uploaded:"Uploaded",taken:"Taken",license:"License",not_available:"N/A",image_alt:"Photograph %{title} by %{user} on 500px",details:"Details",location:"Location",enable_in_store:"Enable Store",edit_photo:"Edit Photo",you_requested_to_buy:"Request has been received",request_to_license:"Request to License",requested_to_license:"Requested to License",request:"Request",submit_for_licensing:"Submit for Licensing",buy_now:"Buy Now",license_photo:"License Photo",download_photo:"Download Photo",license_resolution:"%{width} x %{height}px @%{dpi}dpi",low_resolution:"Resolution not supported",contact_us:"Contact Us",buy_photo:{rights_managed:"Rights Managed License",royalty_free:"Royalty Free License",web_social:"Web/Social License",variable_price:"Price based on usage",fixed_price:"For only %{price}"
},current_pulse:"Current Pulse",highest_pulse:"Highest Pulse",highest_pulse_date:"on %{date}",likes:"Likes",comments:"Comments",show_more:"More",download_app_discover_more:"Discover more inspiring photos like this one.",download_app_button:"Download the FREE 500px app",open_app_button:"Open in app",setting:"Setting"}},upload:{crop_size:"Click and drag anywhere on your photo to set a crop size!",drag_photos:"Drag and drop photos",drag_photos_short:"Drag and drop photos",transfer_photos:"Transfer your photos from another service to 500px.",drag_and_drop:"Drag and Drop",import_photos_from_services:"Import photos from other services",choose_photos:"Choose photos",import_photos:"Import photos","import":"Import",from_services_such_as:"from services such as",remove:"Remove",save_and_continue:"Save & Continue",finish_upload:"Finish Upload",upload_error:{connection:"Photo(s) could not be uploaded as there was a problem connecting to the server. Try the upload again or visit <a href='https://support.500px.com/customer/portal/articles/381102-i-m-having-trouble-uploading'>our support page</a>.",server:"Photo(s) could not be uploaded. Try the upload again or visit <a href='https://support.500px.com/customer/portal/articles/381102-i-m-having-trouble-uploading'>our support page</a>.",badformat:"Photo(s) could not be uploaded. Please ensure all of your images are valid JPEGs."},file_too_large_dimensions_error:{dimensions_are_too_large:"These files could not be loaded because their dimensions are too big. The limit for files in the uploader is 15,000px on either side."},file_too_large_error:{these_files_are_too_large:"These files could not be loaded because they are too large. The maximum size for a file is 49 megabytes."},file_type_error:{these_files_could_not_be_loaded:"These files could not be loaded because they are not JPEGs."},file_duplicate_error:{these_files_are_duplicates:"These files were not added as they are already in the uploader."},file_invalid_error:{these_files_are_invalid:"These files could not be loaded because they could not be rendered. Are you sure they are JPEGs?"},over_free_limit_error:{would_go_over_limit_html:'These files could not be loaded because uploading them would put you over your limit of photos for the week. To have unlimited uploads <a href="/upgrade" target="_blank">upgrade your account</a>.'},simple:{select:"Select a photo to upload.",for_a_better_experience_html:'For a better experience, please download\n<a href="https://www.mozilla.org/en-US/firefox/fx/#desktop" target="_blank">Mozilla Firefox</a>\nor\n<a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Google Chrome</a>.\n',your_photo_is_uploading:"Your photo is uploading..."},no_file_reader:{file_is_loading:"Your image is processing..."},index:{upload_limit_left_many:"You have %{amount} photos remaining to upload. <a href='/upgrade' target='_blank'>Upgrade now</a>.",upload_limit_left_one:"You have %{amount} photo remaining to upload. <a href='/upgrade' target='_blank'>Upgrade now</a>.",confirm_low_discoverability:"This photo has low discoverability. Are you sure you want to continue?",confirm_remove:"Are you sure you want to remove this photo?",some_photos_have_low_discoverability:"Some of your photos have low discoverability. We recommend filling out more details about your photos. Would you like to review the photos with low discoverability?",max_files:"You have reached the maximum number of files you can upload at once ({{number}}). Please upload your current set of photos before trying to add more.",some_photos_not_for_fresh:"Some of your photos have low discoverability. If you give your photo a <strong>title, category, and add 3 tags</strong>, it will be featured in the <strong>Fresh</strong> photos feed.  Would you like to revisit those photos?",are_you_sure_want_to_leave:"You will lose any changes you made to files that were not uploaded."},photo_details:{agree_to_terms:"By clicking Enable In Store you agree to the %{terms_link}",too_small:"This photo is too small. Only photos larger than 3000px on a side are eligible for the store.",description:"Description",tags:"Tags",tag_autocompletion:{popular_tags:"Popular Tags"},lytro_path:"Lytro Path",lytro_path_placeholder:"e.g: https://pictures.lytro.com/lytroweb/pictures/1/embed",discoverability:"Discoverability",add_metadata:"Add metadata to improve your photo's discoverability.",map:"Map",adult_content:"Adult Content",fresh_qualification:{headline:"Publish to Fresh",title:"Title",three_tags:"3 Tags",category:"Category",tooltip:"Fresh is where newly uploaded photos are displayed. To see your photo in this feed, be sure to add a title, category, and at least three tags to improve discoverability."},not_discoverable:"This photo will be private.",title:"Title",license:"License",edit:"edit",exif:"Exif",set_default:"Use these as default",is_default:"Current default",set_creation:{placeholder:"Name your new set here...",create_new_set:"Create New Set",confirm_new_set:"Create",cancel_new_set:"Cancel",create_set_alert:"Your set creation is incomplete - would you like to create the set?",errors:{path_taken:"This set name already exists",server:"Internal error",connection:"Cannot connect to Internet"}},category:"Category",place_photo_in:"Place Photo In",enable_in_store:"Enable In Store",fields:{tags:{placeholder:"Tag to make your photo easier to find...",short_placeholder:"Tag more...",remaining:"tags remaining",none_remaining:"No tags remaining"},photo:{description:{placeholder:"Enter a description for your beautiful photo"},place_in:{library:"Library (private)",profile:"Profile (public)",set:"Set",portfolio:"Portfolio"},lens:{label:"Lens",placeholder:"Set Lens"},shutter_speed:{label:"Shutter Speed",placeholder:"Set Shutter Speed"},camera:{label:"Camera",placeholder:"Set Camera"},focal_length:{label:"Focal Length",placeholder:"Set Focal Length"},aperture:{label:"Aperture",placeholder:"Set Aperture"},iso:{label:"ISO",placeholder:"Set ISO"},taken_at:{label:"Taken",placeholder:"Set Date (dd/mm/yyyy)"},name:{placeholder:"Untitled Image"}}}}},organizer:{no_photos:"You don't have any photos in your library.",empty_filter:"No photos match your current filters.",start_uploading:"Start by <a id='open_upload_library'>uploading</a> your best photos.",upload_to_set:"Upload to Set",upload_to_library:"Upload to Library",upload_to_profile:"Upload to Profile",upload_to_portfolio:"Upload to Portfolio",sort:{sort_by:"Sort By",date_uploaded:"Date Uploaded",views:"Views",likes:"Likes",favorites:"Favorites",pulse:"Highest Pulse"},filter:{filter:"Filter",reset:"Reset",uploaded:"Uploaded","3_days":"in the last 3 days",last_week:"in the last week",last_month:"in the last month",last_year:"in the last year",sets:"Sets",categories:"Categories",license:"License"},sidebar:{"new":"New",library:"Library",all_photos:"All Photos",public_profile:"Public Profile",sets:"Sets",portfolios:"Portfolios"},photo:{"delete":"Delete",edit:"Edit"},partner:{messages:{added:"Photo(s) are submitted for consideration.",incorrect_orientation:"Photo orientation should be horizontal (landscape).",existed_already:"Photo(s) have already been submitted before."},tos:{title:"Promotional Archive Terms of Service",body:{intro:"500px is creating an archive (\u201cPromotional Archive\u201d) of high quality photos to be used for special promotional activities. In addition to being published on the 500px Site, photos from the Promotional Archive will be licensed for display on third party web-sites (\u201cPartner Sites\u201d) to promote the contributing photographer, the photos they take and 500px as the primary source of these photos on the internet. This will enable community photographers who contribute photos to the Promotional Archive to reach a much larger audience than can be achieved solely through the 500px Site. If you wish all or part of your portfolio to participate in the Promotional Archive, the terms and conditions below will specifically apply in addition to 500px's Terms posted on the Site. All capitalized words not otherwise defined herein, have the meanings given to them in 500px's Terms.",term_1:"By posting Content to the Promotional Archive you hereby grant to 500px a non-exclusive, transferable, fully paid, worldwide license to use, transmit, distribute, reproduce, modify, adapt, publicly perform, publicly display and sublicense the Content for promotional purposes (the \u201cLicense\u201d). \u2018Promotional purposes' means promoting the Content to the public via the 500px Site and Partner Sites in association with your 500px username as the creator of the Content, and in association with 500px and/or the 500px Site as the primary publication source of the Content on the internet. In addition to your username, 500px may, at its discretion, include such other details about the Content as submitted by you on the Site.",term_2:"The License includes the right to modify the Content for formatting, navigational or promotional purposes, or for use with particular audio-visual formats, but does not include the right to materially alter the Content, or exhibit the Content with third party materials in any manner that either materially distorts its meaning or implies that another person created the Content.",term_3:"500px will not authorize Partner Sites to sell copies of the Content. However, you acknowledge and agree that 500px will not have control over the resolution at which Content will be displayed or whether users will be permitted to make low resolution and/or high resolution copies of the Content. You hereby expressly authorize 500px to permit Partner Sites to allow their users to make low resolution and/or high resolution copies of the Content and acknowledge and agree that 500px shall not be responsible or liable, directly or indirectly, for any damage or loss caused by the display or copying of your Content on Partner Sites.",term_4:"The License will automatically terminate upon the removal of the Content from the Promotional Archive. However, the termination of the License will not invalidate or terminate any sublicense of Content granted by 500px to Partner Sites prior to the removal of the Content from the Promotional Archive, and all such Partner Sites shall continue to have the rights granted to  them with respect to the Content for the duration of the period provided for by each sublicense agreement.",bottom_line:"If you wish to post Content to the Promotional Archive you must indicate your acceptance of the foregoing terms where indicated below. If you do not wish to post Content to the Promotional Archive, you must decline the terms where indicated, or exit this page."},actions:{accept:"Accept",decline:"Decline"},messages:{accepted:"Welcome to your new exposure opportunities! You've made the right choice.",error:"Sorry, an error occurred. Please reload the page and try again.",declined_optional:"Sorry to hear your declining %{term}.",declined_mandatory:"Sorry, you need to accept %{term} first!"}}}},time_distance:{less_than_x_minutes:{one:"less than a minute ago",other:"less than {{count}} minutes ago"},x_minutes:{one:"1 minute ago",other:"{{count}} minutes ago"},about_x_hours:{one:"about 1 hour ago",other:"about {{count}} hours ago"},x_days:{one:"1 day ago",other:"{{count}} days ago"},about_x_months:{one:"about 1 month ago"},x_months:{other:"{{count}} months ago"},about_x_years:{one:"about 1 year ago",other:"about {{count}} years ago"},over_x_years:{one:"over 1 year ago",other:"over {{count}} years ago"},almost_x_years:{one:"almost 1 year ago",other:"almost {{count}} years ago"}},user:{verified:"Verified User",more:"More",scroll_to:"Scroll to",top:"top",report:"REPORT USER",tell_friend:"Tell a friend!",portfolio_upgrade:"You need to <a href='/upgrade'>upgrade</a> to use Portfolios.",group:{members_count:"%{count} Members"},sets:{no_longer_active:"Sets are a premium feature.",membership_expired:"Upgrade to organize your photos in unlimited public and private sets."},change_cover:{drag_photos:"Drag and drop or <a href='#' class='browse_files'>browse</a> for a photo on your computer.",select_recommended:"Or select a recommended photo below.",recommended:"Recommended Photos","delete":"<a href='#' class='remove_cover'>You can also remove your current cover photo.</a>"},empty:{no_favorites:"%{name} doesn't have any favorite photos.",favorites_prompt:"Follow %{name} to see which photos they love.",no_photos:"%{name} hasn't uploaded a photo.",photos_prompt:"Follow %{name} to stay in touch.",no_sets:"%{name} hasn't created a set.",sets_prompt:"Follow %{name} to stay in touch.",no_store:"%{name} doesn't have any photos for sale.",store_prompt:"Follow %{name} to find out when photos are added.",no_stories:"%{name} has not written any stories.",stories_prompt:"Follow %{name} to find out when stories are written.",no_flow:"%{name} has not discovered any photos.",flow_prompt:"Follow %{name} to find out when they do.",inactive_to_show_photos:"To make your photos visible on this page, please verify your email.",inactive_to_create_stories:"To create stories, please verify your email.",inactive_to_show_store:"To be able to show your photos for sale, please verify your email.",inactive_to_create_sets:"To be able to create sets, please verify your email.",inactive_your_photos_all_private:"Upload public photos or set your current",inactive_your_photos_all_private2:"photos to public to see them here.",enabled_store_but_no_photos:"Your store is enabled but you have no photos uploaded.",enabled_store_but_no_photos2:"Please upload photos to start selling in your store.",your_photos_empty:"Upload your photos and ",your_photos_empty_2:"share them with your friends.",your_sets_empty:"Create a Set to group photos",your_sets_empty_2:"together and share awesome stories.",your_favorites_empty:"Add photos to your favorites to",your_favorites_empty_2:"bookmark them for viewing later.",your_store_empty:"Start selling your photos as canvas",your_store_empty_2:"prints and downloads with ease.",your_stories_empty:"Share one of your journeys",your_stories_empty_2:"or adventures with the world.",your_flow_empty:"See the photos you like and favorite.",upload:"Upload",enable_store:"Enable Store",tell_story:"An update on Stories",discover:"Discover Photos"},sidebar_sets:{create_new_set:"Create a new Set"},cover:{change:"Change Cover",choose:"Choose Cover",pick_any_photo:"Don't see the photo you want to use? Navigate to the photo and make it your cover!",errors:{do_not_have_cover_to_remove:"You do not have a cover photo to remove. Please set a cover photo first.",unable_to_remove:"Could not remove cover, please try again",unable_to_remove_connection:"Your cover photo could not be removed as there was a problem connecting to the server. Check your internet connection and try again.",corrupted_file:"Could not read dimensions of the photo, please try another",dimensions_too_big:"Dimensions of the photo are too big, please reduce it and try again.",dimensions_too_low:"Dimensions of the photo are too low, please try again with bigger photo. Minimum width 2000px and height 1000px",vertical_orientation:"Please try again with a landscape orientation photo.",connection:"Your cover photo could not be uploaded as there was a problem connecting to the server. Check your internet connection and try the upload again.",server:"Your cover photo could not be uploaded. Please try the again in a few minutes."}},show:{more:"More"},about:{stats:{affection:"Affection",views:"Views",likes:"Likes",favorites:"Favorites",comments:"Comments"},biography:"Biography",no_biography:"No Biography",add_biography:"Tell the world about yourself",contact:"Contact",no_contacts:"No Contacts",connect_with_social_networks:"Connect with social networks",gear:"Gear",no_gear:"No Gear",what_is_your_gear:"What gear do you use?",no_location:"No Location",missing_location:"Oops, we can't find that place",update_missing_location:"Please update your location",where_are_you_from:"Where do you call home?",following:"Following",no_following:"Not Following Anyone",follow_others:"Follow other photographers to stay up to date with their uploads and activity.",find_friends:"Find your friends",followers:"Followers",following_you:"Tell your friends about your 500px profile.",share_your_profile:"Share your profile and tell your friends that you're on 500px",no_followers:"No Followers",share_on_facebook:"Share on Facebook",send_a_message:"Send a message",check_messages:"Check your messages",actions:{edit:"Settings",upload:"Upload",organize:"Manage Photos",organize_short:"Manage"}},embed_prompt:{tell_friend:"Tell Friend",copy_this:"Copy This"}},users:{share_email_message:"Check out %{raw_fullname}'s amazing Profile.",embed_prompt:{embed_badge:"Embed Badge",copy_this:"Copy the code to your website"},you:"You",follow_user:{follow:"Follow",unfollow:"Unfollow",following:"Following",edit_profile:"Edit Profile",you:"You"},about:{send_a_message:"Send A Message"}},about:{index:{heading:"The Premier Photography Community",heading_desc:"500px is a photo community for discovering, sharing, buying and selling inspiring photography powered by creative people worldwide.",sharing:"Sharing",sharing_desc:"Our platform is centered around sharing. Like a photo, add it to your favorites, share it with your friends on your social networks, or give the photographer feedback in the comments.",flow:"Flow",flow_desc:"A beautifully curated feed of photographers you follow and your friend's activity: photos that they like, favorite, comment on, and upload.",apps:"Apps",apps_desc:"Get lost in an endless stream of high-resolution, edge-to-edge photographs. Enjoy the seamless 500px desktop experience, anywhere you go. If you simply want to enjoy the image, the interface fades away with a tap.",history:"Company History",launch:"500px launches",first_office:"500px moves to first office",release_flow:"500px releases Flow",acquire_pulpfingers:"500px acquires Pulpfingers",release_iphone:"500px releases iPhone app",palo_alto_office:"500px opens an office in the Bay Area",second_office:"500px moves into second office in Toronto",ryerson_dmz:"500px joins Ryerson DMZ incubator",seed_round:"500px gets seed round funding from ffVC",public_api:"500px releases public API",release_ipad:"500px releases iPad app",release_android:"500px releases Android app",release_portfolio:"500px releases Portfolios",series_a:"500px gets series A round funding from A16Z, Harrison Metal",get_in_touch:"Get In Touch",support:"Support Center",email:"Email",team:"The Team",team_desc:"The faces behind the platform",team_button:"Get to know us better",jobs:"Jobs",jobs_desc:"Love photography & technology? Join our team!",jobs_button:"Check out 500px Jobs",outro:"We love photography, join us.",outro_desc:"Connect with fellow photographers, inspire others, contribute, and immerse yourself in the world's best photography.",sign_up:"Sign Up"}},grid:{empty:{title:"No photos",category:"Unfortunately, there are no photos in the %{category} category. Please try again later"}},activities:{focus:{nude_placeholder:"Show me the photo"}}},function(){window.t=function(t,e){var o,i,r,n,s,a,l,u;for(null==e&&(e={}),s=window.PxLocale,i=window.PxLocaleDefault,a=t.split("."),r=0,n=a.length;n>r&&(l=a[r],i=null!=i&&i.hasOwnProperty(l)?i[l]:null,s=null!=s&&s.hasOwnProperty(l)?s[l]:null,null!=i);r++);return o=s||i||"Missing copy!!!","string"==typeof o?(u=_.template(o))(e):void 0}}.call(this),function(){var e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;e=App.module("Views"),e.SignupLoginModal=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return o(i,e),i.prototype.MIN_PASSWORD_LEN=6,i.prototype.MAX_PASSWORD_LEN=64,i.prototype.template="signup_login_modal",i.prototype.className="signup_login_modal",i.prototype.ui={form:".signup_login_form",fields:".fields",email:"form input.email",password:"form input.password",toggleSignup:"a.have_account",toggleLogin:"a.have_no_account"},i.prototype.behaviors={ModalDialog:!0,HasButtons:{"@ui.toggleSignup":"_toggleSignupLoginMode","@ui.toggleLogin":"_toggleSignupLoginMode"}},i.prototype.events={"focus .signup_login_form .field":"_handleFieldFocus","submit form":"_submitForm","keyup @ui.email":"_handleEmailChange","blur @ui.email":"_handleEmailBlur"},i.prototype.initialize=function(t){var e;return null==t&&(t={}),e={startWithSignup:!0,oauthRedirect:"/"},t=_.extend(e,t),this.startWithSignup=t.startWithSignup,this.startWithSocial=t.startWithSocial,this.oAuthRedirect=t.oAuthRedirect,this.action=t.action,this.oauthRedirect=t.oauthRedirect,this.benefits=t.benefits,this.errors={},this.ui.emailChanged=!0},i.prototype.updateFormHeight=function(){var t,e,o,i,r;return this._isSignupMode()&&(r=this.$(".fields").children(),t=function(){var t,e,o;for(o=[],t=0,e=r.length;e>t;t++)i=r[t],o.push($(i).height());return o}(),o=Math.max.apply(Math,t),this.$(".fields").height(o)),this._isSignupMode()?(e=Math.max(this.$(".fields .permissions").height(),this.$(".fields .notifications").height()),this.$(".fields h3").height(e)):void 0},i.prototype._tidyEmailValue=function(){return $.trim(this.ui.email.val()).toLowerCase()},i.prototype._handleEmailChange=function(t){var e;return e=this._tidyEmailValue(),this.ui.emailChanged=e!==this.cached_email,this.cached_email=e},i.prototype._handleEmailBlur=function(t){return this.ui.emailChanged?(this.ui.emailChanged=!1,this._checkLoginExistence()):void 0},i.prototype._checkLoginExistence=function(t){return this._isSignupMode()?(this._loginExistenceXhr&&this._loginExistenceXhr.abort(),delete this._loginExists,this._loginExistenceXhr=PxApp.api.post("/session/verify",{login:this._tidyEmailValue()}),this._loginExistenceXhr.success(function(e){return function(o){return e._loginExists=!!o.sign_in,"function"==typeof t?t():void 0}}(this)),this._loginExistenceXhr.error(function(e){return function(o){return e._loginExists=!1,"function"==typeof t?t():void 0}}(this))):(this._loginExists=!0,"function"==typeof t?t():void 0)},i.prototype._submitForm=function(t){return null!=t&&(t.preventDefault(),this._lockFormFields()),null==this._loginExists?void this._checkLoginExistence(function(t){return function(){return t._submitForm()}}(this)):this._loginExists?this._tryLogin():this._validateAndSignup()},i.prototype._tryLogin=function(){var e;if(this._isSignupMode()||this._validateEmailAndPassword())return e=PxApp.api.post("/session",{session:{email:this._tidyEmailValue(),password:this.ui.password.val()}}),e.error(function(e){return function(o){var i,r,n;return e._isSignupMode()?e._validateAndSignup():(e._clearErrors(),4===o.readyState?(o.responseText&&(i=JSON.parse(o.responseText),(null!=i&&null!=(r=i.error)?r.email:void 0)&&(e.errors.email=t("shared.signup_login_form.errors.email_not_found"),e._highlightField(e.ui.email,"error")),(null!=i&&null!=(n=i.error)?n.password:void 0)&&(e.errors.password=t("shared.signup_login_form.errors.password_incorrect"),e._highlightField(e.ui.password,"error"))),e.errors.email||e.errors.password||(e.errors.other=t("shared.signup_login_form.errors.server"))):e.errors.other=t("shared.signup_login_form.errors.connection"),e._showErrors())}}(this)),e.success(function(t){return function(e){var o,i;return App.currentUser=null!=(o=App.Groups)&&null!=(i=o.Models)&&"function"==typeof i.User?new i.User(e.user):void 0,t.trigger("login:success"),t.destroyModal()}}(this))},i.prototype._validateAndSignup=function(){var e;if(this._validateEmailAndPassword())return e=PxApp.api.post("/users",{email:this._tidyEmailValue(),password:this.ui.password.val(),auto_username:"yes"}),e.success(function(t){return function(e){var o,i;return App.currentUser=null!=(o=App.Groups)&&null!=(i=o.Models)&&"function"==typeof i.User?new i.User(e.user):void 0,t.trigger("signup:success"),PxApp.GA.event({category:"Groups",action:"Signup"}),PxApp.GA.pageview("/signup/ga_success"),t.destroyModal()}}(this)),e.error(function(e){return function(o){var i,r,n;return e._clearErrors(),4===o.readyState?(o.responseText&&(i=JSON.parse(o.responseText),(null!=i&&null!=(r=i.error)?r.email:void 0)&&(/taken/.test(i.error.email[0])?e.errors.email=t("shared.signup_login_form.errors.email_taken"):e.errors.email=t("shared.signup_login_form.signup.placeholders.email")+" "+i.error.email[0],e._highlightField(e.ui.email,"error")),(null!=i&&null!=(n=i.error)?n.password:void 0)&&(e.errors.password=t("shared.signup_login_form.signup.placeholders.password")+" "+i.error.password[0],e._highlightField(e.ui.password,"error"))),e.errors.email||e.errors.password||(e.errors.other=t("shared.signup_login_form.errors.server"))):e.errors.other=t("shared.signup_login_form.errors.connection"),e._showErrors()}}(this))},i.prototype._handleOauthSuccess=function(e,o){var i,r,n;return o?(this._lockFormFields(),App.currentUser=null!=(i=App.Groups)&&null!=(r=i.Models)&&"function"==typeof r.User?new r.User(o):void 0,null!=(n=App.currentUser)&&n.fetch(),o.was_created?this.trigger("signup:success"):this.trigger("login:success"),this.destroyModal()):(this._clearErrors(),this.errors.other=t("shared.signup_login_form.errors.oauth"),this._showErrors())},i.prototype._handleOauthError=function(e){return this._clearErrors(),this.errors.other=t("shared.signup_login_form.errors.oauth"),this._showErrors()},i.prototype.onShow=function(){var t;return this.$focused=this.ui.email,null!=this.benefits&&this.$(".top_wrap h2.benefits").text(this.benefits),this.startWithSignup||this._toggleSignupLoginMode(),_.defer(function(t){return function(){return t.updateFormHeight()}}(this)),this.$("a[data-oauth-provider-login]").on("oauth:loggedIn",function(t){return function(e){return t._handleOauthSuccess(e.provider,e.user)}}(this)).on("oauth:loginFailed",function(t){return function(e){return t._handleOauthError(e.provider)}}(this)).on("oauth:loginCancelled",function(t){return function(e){return t._handleOauthError(e.provider)}}(this)),this.oauthRedirect&&this.$("a[data-oauth-provider-login]").data("oauth-redirect",this.oauthRedirect),this._updateOauthAction(),t={},null!=this.action&&(t.action=this.action),t.from=window.location.pathname,this},i.prototype.resize=function(){return $(window).width()<=360?this.$el.width($(window).width()-20):$(window).width()<=767?this.$el.width(360):this.$el.width(767),this.trigger("resize")},i.prototype._validateEmailAndPassword=function(){return this._clearErrors(),this.errors.email=this._checkEmail(this.ui.email),this.errors.email&&this._highlightField(this.ui.email,"error"),this.errors.password=this._checkPassword(this.ui.password.val()),this.errors.password&&this._highlightField(this.ui.password,"error"),this.errors.email||this.errors.password?(this._showErrors(),!1):!0},i.prototype._clearErrors=function(){return this.errors={},this._unhighlightField(this.ui.email),this._unhighlightField(this.ui.password)},i.prototype._showErrors=function(){var t;return t=_.compact(_.values(this.errors)).join(" "),new PxApp.Shared.FlashMessage({type:"error",message:t}).render(),this.trigger("signup:error"),this._unlockFormFields()},i.prototype._checkEmail=function(e){var o;return e=this._tidyEmailValue(),o=this._isSignupMode(),""===e?o?t("shared.signup_login_form.errors.email_empty"):t("shared.signup_login_form.errors.email_username_empty"):o&&!this._isValidEmail(e)?t("shared.signup_login_form.errors.email_invalid"):void 0},i.prototype._isValidEmail=function(t){return PxApp.email_regexp.test(t)},i.prototype._checkPassword=function(e){var o;if(o=this._isSignupMode(),""===e)return t("shared.signup_login_form.errors.password_empty");if(o){if(e.length<this.MIN_PASSWORD_LEN)return t("shared.signup_login_form.errors.password_too_short",{num:this.MIN_PASSWORD_LEN});if(e.length>this.MAX_PASSWORD_LEN)return t("shared.signup_login_form.errors.password_too_long",{num:this.MAX_PASSWORD_LEN})}},i.prototype._isSignupMode=function(){return this.ui.form.hasClass("show_signup")},i.prototype._getModeName=function(){return this._isSignupMode()?"Sign Up Form":"Log In Form"},i.prototype._toggleSignupLoginMode=function(){var e;return this.ui.form.toggleClass("show_signup show_login"),e=this._isSignupMode()?"shared.signup_login_form.signup":"shared.signup_login_form.login",this.$(".header_wrap h1").text(t(e+".title")),this.$(".v3_social_login_button.facebook span.label").text(t(e+".with_facebook")),this.$(".v3_social_login_button.twitter span.label").text(t(e+".with_twitter")),this.$(".v3_social_login_button.google span.label").text(t(e+".with_google")),this.ui.email.attr("placeholder",t(e+".placeholders.email")),this.$("form input.submit").val(t(e+".action")),this.$(".login_button_toggle span.show_on_social").text(t(e+".with_email")),this.$(".login_button_toggle span.show_on_email").text(t(e+".with_social")),this._updateOauthAction(),this.trigger("resize")},i.prototype._updateOauthAction=function(){var t;return t=this._isSignupMode()?"signup":"login",this.$("a[data-oauth-provider-login]").data("oauth-action",t)},i.prototype._handleFieldFocus=function(t){var e;return e=$(t.target),this.$focused=e,this._unhighlightField(e)},i.prototype._lockFormFields=function(){return this.ui.form.addClass("loading"),this.$(".field").prop("disabled",!0)},i.prototype._unlockFormFields=function(){return this.ui.form.removeClass("loading"),this.$(".field").prop("disabled",!1)},i.prototype._highlightField=function(t,e){return t.addClass(e).data("status",e)},i.prototype._unhighlightField=function(t){var e;return e=t.data("status"),e?t.removeClass(e):void 0},i}(Marionette.LayoutView)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Behaviors"),t.IsDismissible=function(i){function r(){return this.dismiss=e(this.dismiss,this),r.__super__.constructor.apply(this,arguments)}return o(r,i),r.shouldShow=function(t,e){var o,i;if(o=t.$(".is_dismissible__should_show_"+e),!(o.length>0))throw new Error("IsDismissible behavior requires is_dismissible partial to be rendered in the view with matching name parameter");return!!o.data("should-show")&&!$.cookie("dismiss_tooltip_"+e+"_"+(null!=(i=App.currentUser)?i.id:void 0))},r.setShouldShowToFalse=function(t,e){return t.$(".is_dismissible__should_show_"+e).data("should-show",!1)},r.writeCookie=function(t){var e;return $.cookie("dismiss_tooltip_"+t+"_"+(null!=(e=App.currentUser)?e.id:void 0),1,{expires:365,path:"/"})},r.prototype.initialize=function(t){if(null==t&&(t={}),this.options=t,null==this.options.name)throw new Error("IsDismissible behavior requires name option")},r.prototype.onRender=function(){var e;return e=t.IsDismissible.shouldShow(this.view,this.options.name),this.view.dismiss=this.dismiss,e?this.options.selector?(this.$dismissEl=this.view.$(this.options.selector),this.$dismissEl.on("click",function(t){return function(){return t.dismiss()}}(this))):void 0:this._hideView()},r.prototype.onDestroy=function(){var t;return null!=(t=this.$dismissEl)?t.off("click"):void 0},r.prototype.dismiss=function(){return t.IsDismissible.writeCookie(this.options.name),t.IsDismissible.setShouldShowToFalse(this.view,this.options.name),this._hideView()},r.prototype._hideView=function(){return this.view.$el.hide()},r}(Marionette.Behavior)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),t.PublicActionModal=function(o){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,o),i.prototype.template="public_action_modal",i.prototype.NAME="public_action",i.prototype.ui={confirm:".confirm",cancel:".cancel",noPopup:".checkbox"},i.prototype.events={"click @ui.noPopup":function(){return this.ui.noPopup.toggleClass("checked")}},i.prototype.behaviors={ModalDialog:{closeButton:".close",closeOnEsc:!0},IsDismissible:{name:i.prototype.NAME},HasButtons:{"@ui.confirm":"onClickConfirm","@ui.cancel":"onClickCancel"}},i.shouldShow=function(){var t,e;return(null!=(t=App.currentUser)?t.isRolledOut("unification"):void 0)&&(null!=(e=App.currentUser)?e.get("buyer"):void 0)&&App.Behaviors.IsDismissible.shouldShow(window,this.prototype.NAME)},i.setShouldShowToFalse=function(){return App.Behaviors.IsDismissible.setShouldShowToFalse(window,this.prototype.NAME)},i.prototype.initialize=function(t){return null==t&&(t={}),this.callback=t.callback},i.prototype.onClickConfirm=function(){return this.ui.noPopup.hasClass("checked")&&(this.dismiss(),
t.PublicActionModal.setShouldShowToFalse()),"function"==typeof this.callback&&this.callback(),this.destroyModal()},i.prototype.onClickCancel=function(){return this.destroyModal()},i.prototype.resize=function(){return this.$el.width(600),this.trigger("resize")},i}(Marionette.ItemView)}.call(this),function(){var e,o=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},r={}.hasOwnProperty;e=App.module("Views"),e.UnifiedSignupLoginModal=function(e){function r(t){var e,i;null==t&&(t={}),this._toggleBuyerMode=o(this._toggleBuyerMode,this),null==this.behaviors&&(this.behaviors={}),e={isModalEnabled:!0},i=_.extend(e,t),this.isModalEnabled=i.isModalEnabled,this.isModalEnabled?this.behaviors.ModalDialog=!0:delete this.behaviors.ModalDialog,r.__super__.constructor.apply(this,arguments)}return i(r,e),r.prototype.MIN_PASSWORD_LEN=6,r.prototype.MAX_PASSWORD_LEN=64,r.prototype.PRIME_UPDATE_USER_URL="https://marketplace.500px.com/api/users",r.prototype.template="unified_signup_login_modal",r.prototype.className="unified_signup_login_modal",r.prototype.className=function(){return this.isModalEnabled?"unified_signup_login_modal":"unified_signup_login_full"},r.prototype.ui={container:".unified_signup",form:".unified_signup__form",fields:".fields",email:"form input.email",password:"form input.password",emailLabel:"unified_signup__email_label",passwordLabel:"unified_signup__password_label",submitButton:".unified_signup__submit_button",toggleSignup:"a.have_account",toggleLogin:"a.have_no_account",buyerModeFields:".buyer_mode__container",socialLoginFields:".unified_signup__social",phone_number:"#phone_number",company:"#company"},r.prototype.events={"focus @ui.container .field":"_handleFieldFocus","submit @ui.form":"_submitForm","change .checkbox_input":"_toggleBuyerMode","click @ui.toggleSignup":"_toggleSignupLoginMode","click @ui.toggleLogin":"_toggleSignupLoginMode"},r.prototype.templateHelpers=function(){return{isSignupMode:this._isSignupMode(),oAuthAction:this._isSignupMode()?"signup":"login",isFullPage:!this.isModalEnabled}},r.prototype.initialize=function(t){var e;return null==t&&(t={}),e={isSignupMode:!0,oauthRedirect:"/"},t=_.extend(e,t),this.isSignupMode=t.isSignupMode,this.oauthRedirect=t.oauthRedirect,this.errors={}},r.prototype._tidyEmailValue=function(){return $.trim(this.ui.email.val()).toLowerCase()},r.prototype._tidyPhoneNumber=function(){return $.trim(this.ui.phone_number.val())},r.prototype._tidyCompany=function(){return $.trim(this.ui.company.val())},r.prototype._checkLoginExistence=function(){var t;return t=this._isSignupMode()?$.post("https://api.500px.com/v1/session/verify",{login:this._tidyEmailValue()}):$.when({sign_in:!0})},r.prototype._isBuyerModeChecked=function(){return this.$(".checkbox_input").prop("checked")},r.prototype._toggleBuyerMode=function(){var t,e;return this._isBuyerModeChecked()?(t=this.ui.submitButton.data("buyer"),this.ui.submitButton.val(t),this.ui.buyerModeFields.slideDown(200).removeClass("hide_me"),this.ui.socialLoginFields.slideUp(200).addClass("hide_me")):(e=this.ui.submitButton.data("normal"),this.ui.submitButton.val(e),this.ui.phone_number.val(""),this.ui.company.val(""),this.ui.buyerModeFields.slideUp(200).addClass("hide_me"),this.ui.socialLoginFields.slideDown(200).removeClass("hide_me")),!0},r.prototype._submitForm=function(t){return t.preventDefault(),this._lockFormFields(),this._checkLoginExistence().done(function(t){return function(e){return t._loginExists=!!e.sign_in,t._loginExists?t._tryLogin():t._validateAndSignup()}}(this)).fail(function(t){return function(e){return t._loginExists=!1,t._validateAndSignup()}}(this))},r.prototype._tryLogin=function(){var e;if(this._isSignupMode()||this._validateEmailAndPassword())return e=PxApp.api.post("/session",{session:{email:this._tidyEmailValue(),password:this.ui.password.val()}}),e.error(function(e){return function(o){var i,r,n;return e._isSignupMode()?e._validateAndSignup():(e._clearErrors(),4===o.readyState?(o.responseText&&(i=JSON.parse(o.responseText),(null!=i&&null!=(r=i.error)?r.email:void 0)&&(e.errors.email=t("shared.signup_login_form.errors.email_not_found")),(null!=i&&null!=(n=i.error)?n.password:void 0)&&(e.errors.password=t("shared.signup_login_form.errors.password_incorrect"))),e.errors.email||e.errors.password||(e.errors.other=t("shared.signup_login_form.errors.server"))):e.errors.other=t("shared.signup_login_form.errors.connection"),e._showErrors())}}(this)),e.success(function(t){return function(e){return App.currentUser=new App.Models.User(e.user),t.trigger("login:success"),t.isModalEnabled?t.destroyModal():void 0}}(this))},r.prototype._updateMarketplaceBuyerSettings=function(t,e){var o,i;return o={},t&&(o.company=t),e&&(o.phone=e),i={method:"PUT",data:o},$.ajax(this.PRIME_UPDATE_USER_URL+"/"+App.currentUser.id,i)},r.prototype._postSignupActions=function(){return this.trigger("signup:success"),PxApp.GA.event({category:"Groups",action:"Signup"}),PxApp.GA.pageview("/signup/ga_success"),this.isModalEnabled?this.destroyModal():void 0},r.prototype._validateAndSignup=function(){var e;if(this._validateEmailAndPassword())return e=PxApp.api.post("/users",{email:this._tidyEmailValue(),password:this.ui.password.val(),auto_username:"yes",buyer_mode_enabled:this._isBuyerModeChecked(),phone_number:this._tidyPhoneNumber(),company:this._tidyCompany()}),e.success(function(t){return function(e){var o,i,r;return o=t._tidyCompany(),r=t._tidyPhoneNumber(),i=o||r,App.currentUser=new App.Models.User(e.user),t._isBuyerModeChecked()&&i?t._updateMarketplaceBuyerSettings(o,r).always(function(){return t._postSignupActions()}):t._postSignupActions()}}(this)),e.error(function(e){return function(o){var i,r,n;return e._clearErrors(),4===o.readyState?(o.responseText&&(i=JSON.parse(o.responseText),(null!=i&&null!=(r=i.error)?r.email:void 0)&&(/taken/.test(i.error.email[0])?e.errors.email=t("shared.signup_login_form.errors.email_taken"):e.errors.email=t("shared.signup_login_form.signup.placeholders.email")+" "+i.error.email[0]),(null!=i&&null!=(n=i.error)?n.password:void 0)&&(e.errors.password=t("shared.signup_login_form.signup.placeholders.password")+" "+i.error.password[0])),e.errors.email||e.errors.password||(e.errors.other=t("shared.signup_login_form.errors.server"))):e.errors.other=t("shared.signup_login_form.errors.connection"),e._showErrors()}}(this))},r.prototype._handleOauthSuccess=function(e,o){var i;return o?(this._lockFormFields(),App.currentUser=new App.Models.User(o),null!=(i=App.currentUser)&&i.fetch(),o.was_created?this.trigger("signup:success"):this.trigger("login:success"),this.isModalEnabled?this.destroyModal():void 0):(this._clearErrors(),this.errors.other=t("shared.signup_login_form.errors.oauth"),this._showErrors())},r.prototype._handleOauthError=function(e){return this._clearErrors(),this.errors.other=t("shared.signup_login_form.errors.oauth"),this._showErrors()},r.prototype.onShow=function(){return this.$("a[data-oauth-provider-login]").on("oauth:loggedIn",function(t){return function(e){return t._handleOauthSuccess(e.provider,e.user)}}(this)).on("oauth:loginFailed",function(t){return function(e){return t._handleOauthError(e.provider)}}(this)).on("oauth:loginCancelled",function(t){return function(e){return t._handleOauthError(e.provider)}}(this)),this.oauthRedirect&&this.$("a[data-oauth-provider-login]").data("oauth-redirect",this.oauthRedirect),this},r.prototype.resize=function(){return this.$el.width(400),this.trigger("resize")},r.prototype._validateEmailAndPassword=function(){return this._clearErrors(),this.errors.email=this._checkEmail(this.ui.email),this.errors.password=this._checkPassword(this.ui.password.val()),this.errors.email||this.errors.password?(this._showErrors(),!1):!0},r.prototype._clearErrors=function(){return this.errors={},this._markErrorElements(this.errors)},r.prototype._showErrors=function(){var t;return t=_.compact(_.values(this.errors)).join(" "),new PxApp.Shared.FlashMessage({type:"error",message:t}).render(),this._markErrorElements(this.errors),this.trigger("signup:error"),this._unlockFormFields()},r.prototype._checkEmail=function(e){var o;return e=this._tidyEmailValue(),o=this._isSignupMode(),""===e?o?t("shared.signup_login_form.errors.email_empty"):t("shared.signup_login_form.errors.email_username_empty"):o&&!this._isValidEmail(e)?t("shared.signup_login_form.errors.email_invalid"):void 0},r.prototype._isValidEmail=function(t){return PxApp.email_regexp.test(t)},r.prototype._checkPassword=function(e){var o;if(o=this._isSignupMode(),""===e)return t("shared.signup_login_form.errors.password_empty");if(o){if(e.length<this.MIN_PASSWORD_LEN)return t("shared.signup_login_form.errors.password_too_short",{num:this.MIN_PASSWORD_LEN});if(e.length>this.MAX_PASSWORD_LEN)return t("shared.signup_login_form.errors.password_too_long",{num:this.MAX_PASSWORD_LEN})}},r.prototype._isSignupMode=function(){return this.isSignupMode},r.prototype._getModeName=function(){return this._isSignupMode()?"Sign Up Form":"Log In Form"},r.prototype._toggleSignupLoginMode=function(){return this.isModalEnabled?(this.isSignupMode=!this.isSignupMode,this.render(),this.trigger("resize"),!1):!0},r.prototype._handleFieldFocus=function(t){return this.errors={},this._markErrorElements(this.errors)},r.prototype._lockFormFields=function(){return this.ui.container.addClass("loading"),this.$(".field").prop("disabled",!0)},r.prototype._unlockFormFields=function(){return this.ui.container.removeClass("loading"),this.$(".field").prop("disabled",!1)},r.prototype._markErrorElements=function(t){var e;return this.$("[data-field-for-error]").removeClass("error"),e=_.filter(_.keys(t),function(e){return null!=t[e]}),_.each(e,function(t){return this.$("[data-field-for-error="+t+"]").addClass("error")})},r}(Marionette.LayoutView)}.call(this),function(){var t,e,o,i=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},r={}.hasOwnProperty;o=App.module("Behaviors"),t=$(window),o.HasExtraActionsDropdown=function(o){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,o),r.prototype.onRender=function(){var t,e,o,i;this.dropdowns={},e=this.options,i=[];for(o in e)t=e[o],i.push(this._createExtraActionDropdown(o,t));return i},r.prototype._createExtraActionDropdown=function(o,i){var r,n,s,a,l,u,p,c,h,d,m,g,f;if(m=this.view[o],null==m)throw new Error("Cannot find region "+o);if(n=this.view.$(m.el),n.data("i18n-button-default")&&(s=n.i18n("button-default",{"return":!0})),f=_.extend(_.clone(i),{buttonText:s}),g=new e(f),m.show(g),h={style:{classes:"extra-actions-qtip-dropdown",def:!1,tip:{width:20,height:10}},position:{my:"top center",at:"bottom center",viewport:$(window),effect:!1,adjust:{method:"flipinvert",y:3}},show:{delay:0,event:"click"},hide:{delay:0,event:"click unfocus"},events:{show:function(e){return function(){return g.$el.addClass("active"),e.trigger("extraActionsDropdown:show",e,o),t.one("scroll",function(){var t,i;return null!=(t=e.dropdowns)&&null!=(i=t[o])?i.qtipApi.hide():void 0}),t.one("resize",function(){var t,i;return null!=(t=e.dropdowns)&&null!=(i=t[o])?i.qtipApi.hide():void 0})}}(this),hide:function(t){return function(){return g.$el.removeClass("active"),t.trigger("extraActionsDropdown:hide",t,o)}}(this)}},$.fn.qtip.zindex=100100,p=g.ui.button.qtip(_.defaults({content:g.$(".extra-actions-dropdown-container").hide()},h)),c=p.qtip("api"),u=$.isFunction(i.dropdownViewClass)?i.dropdownViewClass.call(this.view):i.dropdownViewClass,a=null!=(d=i.compactList)?d:!0,l=new u({model:this.view.model,qtipApi:c,compactList:a}),!$.isFunction(l.handleAction))throw new Error("The implementation of handleAction cannot be found in "+i.dropdownViewClass.name);return l.render(),r=g.$(".extra-actions-dropdown-composite"),a?r.addClass("compact"):r.addClass("list"),r.append(l.$el.addClass("clearfix inside")),this.dropdowns[o]={dropdownView:l,qtipApi:c},l},r.prototype.onDestroy=function(){var t,e,o,i,r;e=this.dropdowns;for(t in e)r=e[t],null!=(o=r.qtipApi)&&o.destroy(!0),null!=(i=r.dropdownView)&&i.destroy();return this.dropdowns=null},r}(Marionette.Behavior),o.HasExtraActionsDropdown.DropdownBase=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.events={"click .extra-action":"_internalHandleAction"},e.prototype.initialize=function(t){return this.qtipApi=t.qtipApi,this.compactList=t.compactList,t},e.prototype._internalHandleAction=function(t){var e,o;if(t.preventDefault(),e=$(t.target).closest(".extra-action"),!e.hasClass("disabled")){if(o=null!=e?e.data("action"):void 0,!o)throw new Error("The action name cannot be found");return this.handleAction(e.data("action"),e),this.qtipApi.hide()}},e}(Marionette.LayoutView),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.template="extra_actions_widget",e.prototype.className="extra-actions-widget",e.prototype.ui={button:".extra-actions-button"},e.prototype.initialize=function(t){return null==t&&(t={}),this.buttonClass=t.buttonClass,this.buttonText=t.buttonText,null!=this.buttonClass?this.buttonClass:this.buttonClass="more"},e.prototype.onRender=function(){return this.ui.button.addClass(this.buttonClass),this.buttonText?this.ui.button.text(this.buttonText):void 0},e}(Marionette.ItemView)}.call(this),function(){var t;t=App.module("Helpers"),t.Moment=function(){function t(){}return t.formatRelativeTime=function(t,e){var o,i,r,n,s;return null==e&&(e={}),o=null!=(r=e.humanReadableThreshold)?r:1728e5,s=null!=(n=e.timestampFormat)?n:"ll",i=Date.now(),t=new Date(t),null!=e.humanReadableThreshold&&i-t.getTime()>e.humanReadableThreshold?moment(t).format(e.timestampFormat):moment(t).fromNow()},t}(),t.customizeMomentRelativeTime=function(t,e){return moment.locale().match(t)?void 0:moment.defineLocale(moment.locale()+"-"+t,{parentLocale:moment.locale(),relativeTime:{future:e.i18n("future",{"return":!0}),past:e.i18n("past",{"return":!0}),s:e.i18n("s",{"return":!0}),m:e.i18n("m",{"return":!0}),mm:e.i18n("mm",{"return":!0}),h:e.i18n("h",{"return":!0}),hh:e.i18n("hh",{"return":!0}),d:e.i18n("d",{"return":!0}),dd:e.i18n("dd",{"return":!0}),M:e.i18n("month",{"return":!0}),MM:e.i18n("months",{"return":!0}),y:e.i18n("y",{"return":!0}),yy:e.i18n("yy",{"return":!0})}})}}.call(this),function(){var t,e,o,i,r,n,s=function(t,e){function o(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=App.module("Photos.Views"),n.ActivitySection=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.template="photo_activity_section",e.prototype.className="photo_activity_section",e.prototype.ui={newCommentInput:".new_comment",newCommentContainer:".new_comment_container",newCommentSignup:".new_comment_container .signup"},e.prototype.events={"keyup @ui.newCommentInput":"onNewCommentKeyup"},e.prototype.behaviors={HasButtons:{"@ui.newCommentSignup":"onSignupClicked"}},e.prototype.regions={commentsRegion:".comments_region"},e.prototype.templateHelpers=function(){var t;return{currentUserAvatars:null!=(t=App.currentUser)?t.get("avatars"):void 0}},e.prototype.initialize=function(t){var e,o;return null==t&&(t={}),o=$.Deferred(),e=this.model.getComments(),null!=e.totalItems?o.resolve():e.fetch().always(function(){return o.resolve()}),this.fetchPromise=o.promise(),this.newComment=t.newComment,this.commenter=t.commenter,t},e.prototype.onRender=function(){return App.Helpers.customizeMomentRelativeTime("comment",this.$(this.commentsRegion.el)),this.ui.newCommentContainer.toggleClass("logged-out",null==App.currentUser),_.defer(function(t){return function(){return autosize(t.ui.newCommentInput)}}(this))},e.prototype.onShow=function(){return this.fetchPromise.always(function(t){return function(){var e;if(!t.isDestroyed)return t.model.has("highlightedComments")&&null!=t.commenter&&(e=_.find(t.model.get("highlightedComments"),function(e){return e.get("user_id")===t.commenter}),t.model.getComments().each(function(t){return t.set("highlighted",!1)}),e.set("highlighted",!0),t.model.getComments().remove(e),t.model.getComments().add(e,{at:0})),t.commentsView=new i({collection:t.model.getComments()}),t.commentsRegion.show(t.commentsView),t.newComment&&($(".photo_sidebar").scrollTop(t.ui.newCommentInput.offset().top),t.ui.newCommentInput.focus()),e?t._scrollToTopComment():void 0}}(this)),$(".photo_sidebar").on("scroll",function(t){return function(){var e;return null==t.sidebarTop&&(t.sidebarTop=$(".photo_sidebar").offset().top+50),e=t.$el.offset().top<=t.sidebarTop,t.ui.newCommentContainer.toggleClass("new_comment_container--fixed",e)}}(this))},e.prototype.recordScrollPosition=function(){return null!=this.commentsRegion.currentView?this.commentsRegion.currentView.$el.scrollTop():void 0},e.prototype.restoreScrollPosition=function(t){return null!=this.commentsRegion.currentView?this.commentsRegion.currentView.$el.scrollTop(t):void 0},e.prototype.onNewCommentKeyup=function(t){return 13!==t.keyCode||t.metaKey||t.ctrlKey||t.shiftKey?void 0:this._submitComment()},e.prototype.onSignupClicked=function(){var t;if(null==App.currentUser)return t=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"photos_comment",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"photos_comment",startWithSignup:!0,benefits:this.ui.newCommentSignup.data("messages-signup-benefits"),oauthRedirect:window.location.href}),this.listenToOnce(t,"signup:success login:success",function(){return window.location.reload()}),t.showModal(),!1},e.prototype._submitComment=function(){var t;return App.Views.PublicActionModal.shouldShow()?(t=new App.Views.PublicActionModal({callback:function(t){return function(){return t._doSubmitComment()}}(this)}),t.showModal()):this._doSubmitComment()},e.prototype._doSubmitComment=function(){var t,e;return PxOptimizely.trackEvent("photo_post_comment_reply"),t=$.trim(this.ui.newCommentInput.val()),this.ui.newCommentInput.val(""),autosize.update(this.ui.newCommentInput),0!==t.length?(e=this.model.getComments().create({body:t,user:App.currentUser,replies:[]},{at:0}),this._scrollToTopComment(),this.listenToOnce(e,"error",function(o){return function(i,r,n){var s;return s=App.Helpers.API.parseError(r,"timeout",null),App.Flash.error(App.Helpers.API.getErrorMessage(s)),e.destroy(),o.ui.newCommentInput.val()||o.ui.newCommentInput.val(t),autosize.update(o.ui.newCommentInput),o.ui.newCommentInput.focus()}}(this))):void 0},e.prototype._scrollToTopComment=function(){return $(".photo_sidebar").scrollTop($(".photo_sidebar").prop("scrollHeight")-this.$el.prop("scrollHeight")-50)},e}(Marionette.LayoutView),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.template="comment_extra_actions_dropdown",e.prototype.className="comment-extra-actions-dropdown",e.prototype.ui={original:".extra-action.show-original",translate:".extra-action.translate",flag:".extra-action.flag","delete":".extra-action.delete"},e.prototype.modelEvents={change:"render"},e.prototype.handleAction=function(t,e){switch(t){case"translate":return this.model.translate();case"showOriginal":return this.model.showOriginal();case"flag":return this.flagComment(e);case"delete":return this.deleteComment(e)}},e.prototype.flagComment=function(t){var e,o;return e=t.find("span"),o=new App.Views.ActionConfirmationModal({message:e.i18n("message",{"return":!0}),title:e.i18n("title",{"return":!0}),callback:function(t){return function(){return t.model.reportContent(function(t){return t?App.Flash.error(App.Helpers.API.getErrorMessage(t)):void 0})}}(this)}),o.showModal()},e.prototype.deleteComment=function(t){var e,o;return e=t.find("span"),o=new App.Views.ActionConfirmationModal({message:e.i18n("message",{"return":!0}),title:e.i18n("title",{"return":!0}),buttonText:e.i18n("title",{"return":!0}),destructiveButton:!0,callback:function(t){return function(){return t.model.destroy().fail(function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))})}}(this)}),o.showModal()},e.prototype._isOwner=function(){return null!=this.isOwner?this.isOwner:this.isOwner=this.model.isOwner()},e.prototype._isAdmin=function(){var t;return!!(null!=(t=App.currentUser)?t.get("admin"):void 0)},e.prototype.onRender=function(){return this.model.get("translated")?this.ui.translate.hide():this.ui.original.hide(),this._isOwner()&&this.ui.translate.hide(),(this._isOwner()||null==App.currentUser||this.model.get("flagged"))&&this.ui.flag.hide(),this._isOwner()||this._isAdmin()?void 0:this.ui["delete"].hide()},e}(App.Behaviors.HasExtraActionsDropdown.DropdownBase),e=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,e),o.prototype.template="comment_reply_view",o.prototype.tagName="li",o.prototype.regions={extraActions:".extra-actions"},o.prototype.behaviors={HasExtraActionsDropdown:{extraActions:{dropdownViewClass:function(){return t}}},HasButtons:{"@ui.reply":"onClickReply"}},o.prototype.ui={replyLine:".reply_line",bodyText:".comment_body .body_text",container:".comment_container",replyContainer:".new_reply_container",replyInput:".new_reply_input",translated:".text .translated",flagged:".text .flagged",reply:"a.reply"},o.prototype.modelEvents={"change:translated":"updateBody","change:flagged":"updateFlagged"},o.prototype.events={"keyup @ui.replyInput":"onNewReplyKeyup","blur @ui.replyInput":"onReplyInputBlurred"},o.prototype.updateFlagged=function(){return this.ui.flagged.toggle(!!this.model.get("flagged"))},o.prototype.updateBody=function(){return this.ui.translated.toggle(this.model.get("translated")),this.ui.bodyText.text(this.model.displayBody())},o.prototype.templateHelpers=function(){var t;return{fullDate:function(t){return function(){return moment(t.model.get("created_at")).format("LLL")}}(this),commentDate:function(t){return function(){var e;return e=moment(t.model.get("created_at")),e.isBefore(moment().subtract(7,"days"))?e.format("MMM D"):e.fromNow(!0)}}(this),displayedBody:function(t){return function(){return t.model.displayBody()}}(this),currentUserAvatars:null!=(t=App.currentUser)?t.get("avatars"):void 0}},o.prototype.initialize=function(){return this.newReplyOpened=!1,this.listenTo(this.model.collection,"reply:start",function(t){return function(e){return null==e&&(e=""),t.model.collection.length===t.model.collection.indexOf(t.model)+1?t._openReplyInput(e):void 0}}(this)),this.listenTo(this.model.collection,"remove",function(t){return function(){return t._updateVerticalLine()}}(this))},o.prototype.onClickReply=function(){return this.model.collection.trigger("reply:start")},o.prototype.onReplyInputBlurred=function(){return this.newReplyOpened?this.ui.replyInput.val()?confirm("Discard your reply?")?this._closeReplyInput():void this.ui.replyInput.focus():this._closeReplyInput():void 0},o.prototype._openReplyInput=function(t){return null==t&&(t=""),this.newReplyOpened=!0,this.ui.replyLine.show(),this.ui.replyContainer.show(),this.ui.replyInput.val()||this.ui.replyInput.val(t),this.ui.replyInput.focus(),autosize.update(this.ui.replyInput)},o.prototype._closeReplyInput=function(){return this.newReplyOpened=!1,this.ui.replyLine.hide(),this.ui.replyContainer.hide(),this.ui.replyInput.val(""),autosize.update(this.ui.replyInput)},o.prototype.onRender=function(){return this.ui.container.toggleClass("mine",this.model.isOwner()),autosize(this.ui.replyInput),null==App.currentUser&&this.ui.reply.hide(),this._updateVerticalLine(),this.updateFlagged()},o.prototype._updateVerticalLine=function(){var t;return t=this.model.collection.indexOf(this.model),-1!==t?this.ui.replyLine.toggle(this.model.collection.length-1!==t):void 0},o.prototype.onNewReplyKeyup=function(t){return 13!==t.keyCode||t.metaKey||t.ctrlKey||t.shiftKey?27===t.keyCode?(this.onReplyInputBlurred(),t.preventDefault(),t.stopPropagation()):void 0:this._submitReply()},o.prototype._submitReply=function(){var t,e;return PxOptimizely.trackEvent("photo_post_comment_reply"),t=$.trim(this.ui.replyInput.val()),0===t.length?void this._closeReplyInput():(e=this.model.collection.create({body:t,user:App.currentUser}),this._closeReplyInput(),this._updateVerticalLine(),this.listenToOnce(e,"error",function(o){return function(i,r,n){var s;return s=App.Helpers.API.parseError(r,"timeout",null),App.Flash.error(App.Helpers.API.getErrorMessage(s)),e.destroy(),o.model.collection.trigger("reply:start",t)}}(this)))},o}(Marionette.LayoutView),o=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype.template="comment_composite_view",o.prototype.tagName="li",o.prototype.childView=e,o.prototype.childViewContainer="ul.replies",o.prototype.className=function(){return this.model.get("highlighted")?"highlighted-comment":void 0},o.prototype.initialize=function(){var t,e;return e=null!=(t=this.model.get("replies"))?t:[],this.collection=new App.Photos.Collections.CommentAndReplies(_.flatten([this.model.clone(),e]),{parent:this.model})},o}(Marionette.CompositeView),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.tagName="li",e.prototype.template="empty_comments_view",e.prototype.className="empty_comments",e}(Marionette.ItemView),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.childView=o,e.prototype.template="comments_view",e.prototype.className="comments_view",e.prototype.childViewContainer="ul.comments",e.prototype.behaviors={InfiniteScroll:{container:function(){return $(".photo_sidebar")}}},e.prototype.onShow=function(){return this.$el.addClass("initial_fetch_complete")},e.prototype.getEmptyView=function(){return r},e}(Marionette.CompositeView)}.call(this),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(t){var e=t.prop("clientWidth"),o=t.prop("offsetWidth"),i=parseInt(t.css("border-right-width"),10),r=parseInt(t.css("border-left-width"),10);return o>e+r+i}var o="onmousewheel"in window?"ActiveXObject"in window?"wheel":"mousewheel":"DOMMouseScroll",i=".scrollLock",r=t.fn.scrollLock;t.fn.scrollLock=function(r,n,s){return"string"!=typeof n&&(n=null),void 0!==r&&!r||"off"===r?this.each(function(){t(this).off(i)}):this.each(function(){t(this).on(o+i,n,function(o){if(!o.ctrlKey){var i=t(this);if(s===!0||e(i)){o.stopPropagation();var r=i.scrollTop(),n=i.prop("scrollHeight"),a=i.prop("clientHeight"),l=o.originalEvent.wheelDelta||-1*o.originalEvent.detail||-1*o.originalEvent.deltaY,u=0;if("wheel"===o.type){var p=i.height()/t(window).height();u=o.originalEvent.deltaY*p}(l>0&&0>=r+u||0>l&&r+u>=n-a)&&(o.preventDefault(),u&&i.scrollTop(r+u))}}})})},t.fn.scrollLock.noConflict=function(){return t.fn.scrollLock=r,this}}),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),null==window.mapScriptDfd&&(window.mapScriptDfd=$.Deferred(),$.getScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyDJFLGCQOjy2vyHzXNxPGOOc8uuKRNzGQc&libraries=places&async=2&callback=initialize_maps")),window.initialize_maps=function(t){return function(){return window.mapScriptDfd.resolve()}}(this),t.Map=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.DEFAULT_LOCATION_ZOOM_LEVEL=1,o.prototype.ZOOM_LEVEL=8,o.prototype.initialize=function(t){var e;return this.mapCache=null!=(e=t.mapCache)?e:{},window.mapScriptDfd.done(function(e){return function(){var o,i,r;if(null==e.mapCache.map?(e.mapCache.mapCanvas=$("<div class='map_canvas' style='width: 100%; height: 100%;'></div>"),e.$el.append(e.mapCache.mapCanvas),e.mapCache.map=new google.maps.Map(e.mapCache.mapCanvas[0])):(e.mapCache.mapCanvas.detach(),e._removeSearch(),e.$el.append(e.mapCache.mapCanvas),e.refresh({zoomLevel:e.ZOOM_LEVEL})),e.map=e.mapCache.map,o={center:new google.maps.LatLng(0,0),zoom:e.ZOOM_LEVEL,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,scrollwheel:null!=(i=t.scroll)?i:!1,draggable:null!=(r=t.enableLocationPicker)?r:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}},e.map.setOptions(o),e._centerMap(),t.enableLocationPicker){if(!$.isFunction(e.model.setGeoCoords))throw new Error("model does not support setGeoCoords");if(google.maps.event.addListener(e.map,"click",function(t){return e._onClick(t)}),google.maps.event.addListener(e.map,"dblclick",function(t){return e._onDblClick()}),null!=t.searchInputEl)return e._setupSearch(t.searchInputEl)}}}(this))},o.prototype._onClick=function(t){return null==this.timeout?this.timeout=setTimeout(function(e){return function(){return e.timeout=null,e._setLocation(t.latLng)}}(this),500):void 0},o.prototype._onDblClick=function(){return null!=this.timeout?(clearTimeout(this.timeout),this.timeout=null):void 0},o.prototype._setupSearch=function(t){return this.mapCache.search=$(t),this.searchBox=new google.maps.places.SearchBox(t),this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(t),this.searchBox.addListener("places_changed",function(t){return function(){return t._searchChanged()}}(this)),this.map.addListener("bounds_changed",function(t){return function(){return t.searchBox.setBounds(t.map.getBounds())}}(this)),this.autocomplete=new google.maps.places.Autocomplete(t),this.autocomplete.bindTo("bounds",this.map),this.autocomplete.addListener("place_changed",function(t){return function(){return t._autocompleteChanged()}}(this)),$("body").on("mousedown",".pac-container",function(t){return t.stopPropagation()})},o.prototype._autocompleteChanged=function(){var t;return t=this.autocomplete.getPlace(),null!=t.geometry?(this._setLocation(t.geometry.location),this.map.setZoom(this.ZOOM_LEVEL)):void 0},o.prototype._searchChanged=function(){var t,e;return e=this.searchBox.getPlaces(),e.length>0?(t=e[0],this._setLocation(t.geometry.location),this.map.setZoom(this.ZOOM_LEVEL)):void 0},o.prototype.onDestroy=function(){return google.maps.event.clearInstanceListeners(this.map),$("body").off("mousedown",".pac-container"),this._removeMarker(),this._removeSearch(),this.mapCache.mapCanvas.detach()},o.prototype.refresh=function(t){return null==t&&(t={}),window.mapScriptDfd.done(function(e){return function(){var o;return null!=e.map&&(o=t.zoomLevel,google.maps.event.trigger(e.map,"resize"),null!=e.mapCache.marker?e.map.setCenter(e.mapCache.marker.position):e._moveToDefaultLocation(),null!=o)?e.map.setZoom(o):void 0}}(this))},o.prototype._removeSearch=function(){return null!=this.mapCache.search?(this.mapCache.search.detach(),delete this.mapCache.search):void 0},o.prototype._centerMap=function(){var t,e,o;return("function"==typeof(t=this.model).hasGeoCoords?t.hasGeoCoords():void 0)?(o=this.model.geoCoords(),null!=o?this._moveToGeoCoords(new google.maps.LatLng(o.latitude,o.longitude)):this._moveToDefaultLocation()):("function"==typeof(e=this.model).hasLocation?e.hasLocation():void 0)?this._moveToAddress([this.model.get("city"),this.model.get("state"),this.model.get("country")].join(",")):null!=("undefined"!=typeof App&&null!==App?App.currentUser:void 0)?this._moveToAddress([App.currentUser.get("city"),App.currentUser.get("state"),App.currentUser.get("country")].join(",")):this._moveToDefaultLocation()},o.prototype._moveToGeoCoords=function(t,e){return null==e&&(e=!0),this.map.setCenter(t),e?this._updateMarker(t):this._removeMarker()},o.prototype._moveToAddress=function(t){var e;return e=new google.maps.Geocoder,e.geocode({address:t},function(t){return function(e,o){return o===google.maps.GeocoderStatus.OK?t._moveToGeoCoords(e[0].geometry.location):t._moveToDefaultLocation()}}(this))},o.prototype._moveToDefaultLocation=function(){return this._moveToGeoCoords(new google.maps.LatLng(25,-25),!1),this.map.setZoom(this.DEFAULT_LOCATION_ZOOM_LEVEL)},o.prototype._updateMarker=function(t){return this._removeMarker(),this.mapCache.marker=new google.maps.Marker({map:this.map,position:t})},o.prototype._removeMarker=function(){return null!=this.mapCache.marker?this.mapCache.marker.setMap(null):void 0},o.prototype._setLocation=function(t){return this._moveToGeoCoords(t),this.model.setGeoCoords({latitude:t.lat(),longitude:t.lng()})},o}(Marionette.ItemView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t;
}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Views"),t.DetailsSection=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.DATE_FORMAT="ll",o.prototype.HUMAN_READABLE_TIME_THRESHOLD=1728e5,o.prototype.template="photo_sidebar_details",o.prototype.className="photo_sidebar_details",o.prototype.regions={descriptionRegion:".description_region",actorsRegion:".actors_region"},o.prototype.ui={mapBox:".location .mapbox",featureSection:".feature",featureIcon:".feature_icon",featureLabel:".feature_label",featureDate:".feature_date",featureTooltip:".feature .badges__tooltip",editoredBy:".editored_by",highestRatingDate:".highest_rating_date",exifSection:".exif",cameraSettings:".camera_settings",cameraLink:".camera_link",ccLicense:".cc_license_value",ownerButtons:".owner_buttons",setAsCover:".owner_buttons .set-as-cover",editPhoto:".owner_buttons .edit-photo",editorsChoice:".editor_buttons .editors-choice",licensingRequest:".licensing_buttons .licensing-request",licensingSuggest:".licensing_buttons .licensing-suggest",reportPhoto:".report",expandableHeader:".sidebar_expandable_header",expandableContent:".sidebar_expandable_content",descriptionRegion:".description_region",actorsRegion:".actors_region"},o.prototype.modelEvents={change:"render",contentReported:"render","cover:setting":"_onSettingCover","cover:failed":"_onSettingCoverFailed","cover:succeeded":"_onSettingCoverSucceeded"},o.prototype.behaviors={HasButtons:{"@ui.setAsCover":"setAsCover","@ui.editorsChoice":"toggleEditorsChoice","@ui.licensingRequest":"confirmLicensingButtonAction","@ui.licensingSuggest":"confirmLicensingButtonAction","@ui.reportPhoto":"reportPhoto","@ui.expandableHeader":"onClickExpand"}},o.prototype.templateHelpers=function(){var t;return t=App.Helpers.Moment.formatRelativeTime(this.model.get("created_at"),{humanReadableThreshold:this.HUMAN_READABLE_TIME_THRESHOLD,timestampFormat:this.DATE_FORMAT}),{localizedTakenAt:moment(this.model.get("taken_at")).format(this.DATE_FORMAT),localizedCreatedAt:t,timesViewed:this._formatNumber(this.model.get("times_viewed")),ccLicense:this._getCCLicense(),formatedHighestRating:Math.round(100*this.model.get("highest_rating"))/100,isOwner:this.model.isOwner(),canBeCover:this.model.canBeCover(),canBeEditorsChoice:this.model.canBeEditorsChoice()&&!this.model.isPrivate(),contentReported:this.model.contentReported(),isCuratedCollection:this.model.isCuratedCollection(),isLicenseable:this.model.isLicenseable(),categoryText:this.model.getCategoryText(),showReport:!this.model.isOwner()&&!this.model.isPrivate(),isPrivate:this.model.isPrivate(),isIllegal:this.model.isIllegal(),submittedOrInMarketplace:this.model.isAvailableForImmediatePurchase()||this.model.isUnderSubmission()}},o.prototype._getCCLicense=function(){var t;if(this.model.isCreativeCommonsCompatible())return t=this.model.get("license_type")},o.prototype._formatNumber=function(t){var e,o;for(e=t.toString(),o=/(\d+)(\d{3})/;o.test(e);)e=e.replace(o,"$1,$2");return e},o.prototype.setAsCover=function(){return this.model.setAsCover()},o.prototype.confirmLicensingButtonAction=function(t){var e,o,i,r,n,s,a;return s=$(t.target).hasClass("licensing-suggest"),o=s?this.ui.licensingSuggest:this.ui.licensingRequest,a=o.i18n("modal-title",{"return":!0}),r=this.model.submitLicensingRequest,n=o.i18n("modal-add-msg",{"return":!0}),i=o.i18n("modal-add-successfully",{"return":!0}),e=new App.Views.ActionConfirmationModal({message:n,title:a,callback:function(t){return function(){return r.call(t.model,{suggest:s}).done(function(){return App.Flash.success(i)}).fail(function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))})}}(this)}),e.showModal()},o.prototype.toggleEditorsChoice=function(){var t,e,o,i,r,n;return this.model.isEditorsChoice()?(r=this.model.removeEditorsChoice,n=this.ui.editorsChoice.i18n("modal-remove-msg",{"return":!0}),e=this.ui.editorsChoice.i18n("modal-remove-button",{"return":!0}),o=!0,i=this.ui.editorsChoice.i18n("modal-remove-successfully",{"return":!0})):(r=this.model.submitEditorsChoice,n=this.ui.editorsChoice.i18n("modal-add-msg",{"return":!0}),i=this.ui.editorsChoice.i18n("modal-add-successfully",{"return":!0})),t=new App.Views.ActionConfirmationModal({message:n,title:this.ui.editorsChoice.i18n("modal-title",{"return":!0}),destructiveButton:o,buttonText:e,callback:function(t){return function(){return r.call(t.model).done(function(){return App.Flash.success(i)}).fail(function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))})}}(this)}),t.showModal()},o.prototype.reportPhoto=function(){var t;return t=new App.Photos.Views.ReportContentModal({model:this.model,type:"photo"}),t.showModal()},o.prototype.hasActorsSnippet=function(){return!!this.options.likePromise},o.prototype.getLikedByUsers=function(){return this.options.likePromise},o.prototype._onSettingCover=function(){return App.Flash.info(this.ui.setAsCover.data("messages-in-progress")),this.ui.setAsCover.i18n("in-progress")},o.prototype._onSettingCoverFailed=function(t,e,o){return App.Flash.error(this.ui.setAsCover.data("messages-failed")),this.ui.setAsCover.i18n("default")},o.prototype._onSettingCoverSucceeded=function(){return App.Flash.success(this.ui.setAsCover.data("messages-succeeded"))},o.prototype.onBeforeRender=function(){return this._removeTooltips()},o.prototype.onRender=function(){var t,e,o,i,r,n,s,a;return this.options.hasDescription?this.descriptionRegion.show(new App.Photos.Views.Description({model:this.model})):this.ui.descriptionRegion.hide(),this.hasActorsSnippet()&&PxCurrentUser.isRolledOut("unification")&&(null!=(n=App.currentUser)?n.isBuyer():void 0)?this.getLikedByUsers().then(function(t){return function(e){var o;if(!t.isDestroyed&&null!=e.totalItems&&(!t.model.isOwner()||e.totalItems>0))return o=new App.Photos.Views.ActorsSnippetView({model:t.model,collection:e}),t.actorsRegion.show(o,{preventDestroy:!0})}}(this)).fail(function(t){return function(){return t.isDestroyed?void 0:t.ui.actorsRegion.hide()}}(this)):this.ui.actorsRegion.hide(),this.expanded="true"===$.cookie("photo_details_expanded")||this.model.isPrivate(),this._toggleExpanded(this.expanded),i=null,this.model.get("editors_choice")?(i="editors-choice",a="editors",r=this.model.get("editors_choice_date"),null!=(null!=(s=this.model.get("editored_by"))?s.fullname:void 0)&&this.ui.editoredBy.i18n({name:this.model.get("editored_by").fullname})):null!=this.model.get("feature")&&(i=this.model.get("feature"),a=i,r=this.model.get("feature_date"),this.ui.editoredBy.hide()),null!==i?(this.ui.featureIcon.addClass(i).attr("href","/"+a),this.ui.featureLabel.i18n(i).attr("href","/"+a),this.ui.featureDate.text(moment(r).format(this.DATE_FORMAT))):this.ui.featureSection.addClass("disabled"),this.model.get("highest_rating_date")?this.ui.highestRatingDate.text(moment(this.model.get("highest_rating_date")).format(this.DATE_FORMAT)):this.ui.highestRatingDate.hide(),t=[],this.model.get("focal_length")&&t.push(this.model.get("focal_length")+"mm"),this.model.get("aperture")&&t.push("&fnof;/"+this.model.get("aperture")),this.model.get("shutter_speed")&&t.push(this.model.get("shutter_speed")+"s"),this.model.get("iso")&&t.push("ISO "+this.model.get("iso")),this.$(".camera_link").length>0&&this.model.getCamera().done(function(t){return function(e){var o;return e?(o=cameraPath(e),t.ui.cameraLink.attr("href",o),t.ui.cameraLink.show()):void 0}}(this)),this.ui.cameraSettings.html(t.join('<div class="separator">/</div>')),this.expanded&&_.defer(function(t){return function(){return t._setupMap(!0)}}(this)),t.length>0||this.model.get("camera")||this.model.get("lens")||this.ui.exifSection.hide(),e=this._getCCLicense(),null!=e&&(o=this.ui.ccLicense.i18n("cc-titles-"+e,{"return":!0}),this.ui.ccLicense.i18n("cc-licenses-"+e).attr("title",o)),this._setupTooltips()},o.prototype.onDestroy=function(){return this._removeTooltips()},o.prototype.onClickExpand=function(){return this.expanded=!this.expanded,this._toggleExpanded(this.expanded),this.expanded?this._setupMap():void 0},o.prototype._toggleExpanded=function(t){return this.ui.expandableHeader.toggleClass("sidebar_expandable_header--expanded",t),this.ui.expandableContent.toggleClass("sidebar_expandable_content--expanded",t),this.model.isPrivate()?void 0:$.cookie("photo_details_expanded",t,{path:"/",expires:365})},o.prototype._setupMap=function(t){return null==t&&(t=!1),null==this.map||t?(null==App.mapCache&&(App.mapCache={}),this.model.get("latitude")&&this.model.get("longitude")?(this.map=new App.Views.Map({model:this.model,el:this.ui.mapBox,scroll:!1,mapCache:App.mapCache}),this.map.refresh()):(this.map=null,this.$(".location").remove())):void 0},o.prototype._removeTooltips=function(){var t;return this.model.get("editors_choice")&&"function"==typeof(t=this.ui.featureSection).qtip?t.qtip("destroy",!0):void 0},o.prototype._setupTooltips=function(){var t;return this.model.get("editors_choice")&&null!=(null!=(t=this.model.get("editored_by"))?t.fullname:void 0)?this.ui.featureSection.qtip({content:this.ui.featureTooltip,style:{classes:"badges__tooltip_container",tip:{width:12,height:6,mimic:"top center",corner:!0,offset:10}},position:{my:"top right",at:"bottom center",adjust:{x:10}},hide:{fixed:!0,delay:300}}):void 0},o.prototype._hasDescription=function(){return this.options.hasDescription},o}(Marionette.LayoutView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Views"),t.ExclusiveUseModal=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="exclusive_use_modal",o.prototype.className="action_modal exclusive_use_modal",o.prototype.ui={closeButton:".close",emailButton:".button",footer:".footer"},o.prototype.behaviors={ModalDialog:!0,HasButtons:{"@ui.closeButton":"onCloseClicked"}},o.prototype.events={"click @ui.emailButton":"onCloseClicked"},o.prototype.resize=function(){return $(window).width()<=685?this.$el.width($(window).width()-20):this.$el.width(685),this.trigger("resize")},o.prototype.onCloseClicked=function(){return this.destroyModal()},o}(Marionette.LayoutView)}.call(this),function(){var t,e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;e=App.module("Photos.Views"),e.PhotoFocus=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return o(i,e),i.prototype.template="photo_focus",i.prototype.className="photo-focus",i.prototype.active=!1,i.prototype.regions={adultContentRegion:".photo-focus__adult-content-region",infoRegion:".photo-focus__info-region"},i.prototype.ui={overlay:".photo-focus__overlay",photo:".photo-focus__photo",close:".photo-focus__close",navLeft:".photo-focus__nav--left",navRight:".photo-focus__nav--right",photoLoadingIndicator:".photo-focus__loading"},i.prototype.behaviors={HasButtons:{"@ui.navLeft":"_onNavigateLeft","@ui.navRight":"_onNavigateRight","@ui.close":"closeFocusView"}},i.prototype.events={"dragstart @ui.photo":function(t){return t.preventDefault()},"mousemove @ui.overlay":"_onMouseMoved","contextmenu @ui.overlay":"_onPhotoRightClicked","click @ui.overlay":"_onOverlayClicked"},i.prototype._onOverlayClicked=function(t){return $.contains(this.infoRegion.el,t.target)?!0:this.closeFocusView()},i.prototype._onPhotoRightClicked=function(t){return null!=this.photo?(App.Photos.Views.PhotoCopyrightTooltip.showTooltip(this.photo,t),t.preventDefault()):void 0},i.prototype._onMouseMoved=function(){var t;return null!=(t=this.infoPanel)?t.showPanel():void 0},i.prototype._onNavigateLeft=function(t){return t.stopPropagation(),this.trigger("focus:nav:left"),!1},i.prototype._onNavigateRight=function(t){return t.stopPropagation(),this.trigger("focus:nav:right"),!1},i.prototype.openFocusView=function(){var t;return this.active=!0,this.$el.fadeIn(200),null!=(t=this.infoPanel)?t.displayShortcutHints():void 0},i.prototype.reset=function(){return this.photo=null,this.ui.photo.hide(),this.infoRegion.reset(),this.ui.photoLoadingIndicator.hide(),_.delay(function(t){return function(){return t.photo?void 0:t.ui.photoLoadingIndicator.show()}}(this),200)},i.prototype.updatePhoto=function(e,o,i){var r,n;return this.photo=e,this.ui.photoLoadingIndicator.hide(),!this.photo.get("nsfw")||(null!=(n=App.currentUser)?n.get("show_nude"):void 0)||this.photo.get(App.Photos.Views.AdultContentPlaceholder.ATTRIBUTE_NAME)?this.adultContentRegion.reset():(this.adultContentRegion.show(new App.Photos.Views.AdultContentPlaceholder({model:this.photo})),this.listenToOnce(this.photo,"change:"+App.Photos.Views.AdultContentPlaceholder.ATTRIBUTE_NAME,function(t){return function(){return t.adultContentRegion.reset()}}(this))),i?(this._updatePhotoSize(i),this.ui.photo.attr("src",o).show()):(r=this.photo.id,this.ui.photo.one("load",function(t){return function(){return t.isDestroyed||r!==t.photo.id?void 0:t._updatePhotoSize()}}(this)),this.ui.photo.attr("src",o).show()),this.infoPanel=new t({model:this.photo}),this.infoRegion.show(this.infoPanel)},i.prototype._updatePhotoSize=function(t){var e,o,i,r,n,s,a;if(this.photo)return null!=t?(o=this.photo.dimensionsForImageSize(t),a=o.width,n=o.height,s=a/n,e=this.$el.width()/this.$el.height(),s>=e?(r=Math.min(a,this.$el.width()),i=Math.floor(r/s)):(i=Math.min(n,this.$el.height()),r=Math.floor(s*i)),this.ui.photo.css({width:r,height:i})):this.ui.photo.css({width:"auto",height:"auto"})},i.prototype.updateNavigationArrows=function(t,e){return this.ui.navLeft.toggleClass("disabled",t),this.ui.navRight.toggleClass("disabled",e)},i.prototype.closeFocusView=function(){return this.active=!1,this.$el.fadeOut(200),this.trigger("focus:close")},i}(Marionette.LayoutView),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.template="photo_focus_info",e.prototype.className="photo-focus-info",e.prototype.DIMISSAL_DELAY=5e3,e.prototype.ui={shortcutHits:".photo-focus-info__shortcut-hits",addToGalleryButton:".add_to_gallery_button"},e.prototype.behaviors={HasLikeButton:{"class":"only_icon"},HasButtons:{"@ui.addToGalleryButton":"_openAddToGalleryPopover"}},e.prototype.templateHelpers=function(){return{showLike:!this.model.isOwner()&&!this.model.isPrivate(),showGallery:!this.model.isPrivate()||this.model.isOwner()}},e.prototype._openAddToGalleryPopover=function(t){var e,o;return null!=App.currentUser?(o=new App.Views.AddToGalleriesPopover({kind:"gallery",photos:[this.model]}),this.listenToOnce(o,"IsPopover:show",function(t){return function(){return t.$el.addClass("active")}}(this)),this.listenToOnce(o,"IsPopover:hide",function(t){return function(){return t.$el.removeClass("active")}}(this)),o.showPopover(t)):(e=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"add_to_gallery",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"add_to_gallery",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(e,"signup:success login:success",function(){return window.location.reload()}),e.showModal()),!1},e.prototype.displayShortcutHints=function(){return $("body").hasClass("smartphone")||$("body").hasClass("tablet")?void 0:(this.ui.shortcutHits.show(),_.delay(function(t){return function(){return t.isDestroyed?void 0:t.ui.shortcutHits.fadeOut(200)}}(this),this.DIMISSAL_DELAY))},e.prototype.onRender=function(){return this.on("like:before like:signup",function(){return PxOptimizely.trackEvent("photo_like")})},e.prototype.onShow=function(){return this.showPanel()},e.prototype.showPanel=function(){return this.$el.show(),null==this._debouncedDismissal&&(this._debouncedDismissal=_.debounce(function(t){return function(){return t.isDestroyed?void 0:t.$el.fadeOut(200)}}(this),this.DIMISSAL_DELAY)),this._debouncedDismissal()},e}(Marionette.LayoutView)}.call(this),function(t,e,o,i){function r(t,e){return t[e]===i?v[e]:t[e]}function n(){var t=e.pageYOffset;return t===i?f.scrollTop:t}function s(t,e){var o=v["on"+t];o&&(P(o)?o.call(e[0]):(o.addClass&&e.addClass(o.addClass),o.removeClass&&e.removeClass(o.removeClass))),e.trigger("lazy"+t,[e]),p()}function a(e){s(e.type,t(this).off(m,a))}function l(o){if(k.length){o=o||v.forceLoad,x=1/0;var i,r,l=n(),u=e.innerHeight||f.clientHeight,p=e.innerWidth||f.clientWidth;for(i=0,r=k.length;r>i;i++){var c,h=k[i],_=h[0],g=h[d],y=!1,w=o;if(S(f,_)){if(o||!g.visibleOnly||_.offsetWidth||_.offsetHeight){if(!w){var b=_.getBoundingClientRect(),A=g.edgeX,C=g.edgeY;c=b.top+l-C-u,w=l>=c&&b.bottom>-C&&b.left<=p+A&&b.right>-A}if(w){s("show",h);var T=g.srcAttr,E=P(T)?T(h):_.getAttribute(T);E&&(h.on(m,a),_.src=E),y=!0}else x>c&&(x=c)}}else y=!0;y&&(k.splice(i--,1),r--)}r||s("complete",t(f))}}function u(){T>1?(T=1,l(),setTimeout(u,v.throttle)):T=0}function p(t){k.length&&(t&&"scroll"===t.type&&t.currentTarget===e&&x>=n()||(T||setTimeout(u,0),T=2))}function c(){b.lazyLoadXT()}function h(){l(!0)}var d="lazyLoadXT",_="lazied",m="load error",g="lazy-hidden",f=o.documentElement||o.body,y=e.onscroll===i||!!e.operamini||!f.getBoundingClientRect,v={autoInit:!0,selector:"img[data-src]",blankImage:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",throttle:99,forceLoad:y,loadEvent:"pageshow",updateEvent:"load orientationchange resize scroll touchmove focus",forceEvent:"",oninit:{removeClass:"lazy"},onshow:{addClass:g},onload:{removeClass:g,addClass:"lazy-loaded"},onerror:{removeClass:g},checkDuplicates:!0},w={srcAttr:"data-src",edgeX:0,edgeY:0,visibleOnly:!0},b=t(e),P=t.isFunction,A=t.extend,C=t.data||function(e,o){return t(e).data(o)},S=t.contains||function(t,e){for(;e=e.parentNode;)if(e===t)return!0;return!1},k=[],x=0,T=0;t[d]=A(v,w,t[d]),t.fn[d]=function(o){o=o||{};var i,n=r(o,"blankImage"),a=r(o,"checkDuplicates"),l=r(o,"scrollContainer"),u={};t(l).on("scroll",p);for(i in w)u[i]=r(o,i);return this.each(function(i,r){if(r===e)t(v.selector).lazyLoadXT(o);else{if(a&&C(r,_))return;var l=t(r).data(_,1);n&&"IMG"===r.tagName&&!r.src&&(r.src=n),l[d]=A({},u),s("init",l),k.push(l),p()}})},t(o).ready(function(){s("start",b),b.on(v.loadEvent,c).on(v.updateEvent,p),v.forceEvent&&b.on(v.forceEvent,h),t(o).on(v.updateEvent,p),v.autoInit&&c()})}(window.jQuery||window.Zepto||window.$,window,document),function(){var t,e,o,i,r,n;for(t=App.module("Flash"),r=["info","error","success"],e=function(t){return App.Flash[t]=function(e,o){return null==o&&(o={}),o.type=t,o.message=e,new PxApp.Shared.FlashMessage(o).render()}},o=0,i=r.length;i>o;o++)n=r[o],e(n)}.call(this),function(){var t,e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;e=App.module("Behaviors"),e.HasLikeButton=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return o(i,e),i.prototype.initialize=function(t){return null==t&&(t={}),this.options=t},i.prototype.onRender=function(){var e,o;if(this.view.$(".like-button").length>0)return null==this.view.likeButton&&this.view.addRegion("likeButton",".like-button"),o=$.isFunction(this.options.model)?this.options.model.call(this.view):this.view.model,e=new t({model:o,options:this.options,parentView:this.view}),this.view.likeButton.show(e)},i}(Marionette.Behavior),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.template="like_button",e.prototype.ui={likeButton:".button"},e.prototype.behaviors={HasButtons:{"@ui.likeButton":"onClick"}},e.prototype.modelEvents={"change:liked":"render"},e.prototype.initialize=function(t){if(null==t&&(t={}),this.options=t.options,this.parentView=t.parentView,!$.isFunction(this.model.isOwner))throw new Error("Model does not define required function: isOwner()");if(!$.isFunction(this.model.getLikeState))throw new Error("Model does not define required function: getLikeState()");if(!$.isFunction(this.model.like))throw new Error("Model does not define required function: like()")},e.prototype.templateHelpers=function(){var t;return t={},this.options.withCount&&(t.count=this.model.getFormatLikeCount()),this.options.withMobileCount&&(t.count=this.model.getAbbreviateLikeCount()),t},e.prototype.onRender=function(){return this.options.withCount&&this.ui.likeButton.addClass("with_count"),null!=this.options["class"]&&this.ui.likeButton.addClass(this.options["class"]),this.model.isOwner()&&this.ui.likeButton.addClass("disabled"),this._changeState(this.model.getLikeState())},e.prototype.onClick=function(){var t;return null!=App.currentUser?!this.likeState&&App.Views.PublicActionModal.shouldShow()?(t=new App.Views.PublicActionModal({callback:function(t){return function(){return t._toggleLike()}}(this)}),t.showModal()):this._toggleLike():this._handleVisitor()},e.prototype._handleVisitor=function(){var t,e,o,i;return this.parentView.trigger("like:signup"),e=App.Helpers.deviceType(),/^ip/.test(e)?(t="px://500px.com/photo/"+this.model.id,i=App.Helpers.appLink(e),App.Helpers.openOrDownloadApp(t,i)):/^android/.test(e)?window.location=App.Helpers.appLink(e):(o=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"photos_like",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"photos_like",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(o,"signup:success login:success",function(t){return function(){return t.model.like(function(t,e){return window.location.reload()})}}(this)),o.showModal())},e.prototype._toggleLike=function(){var t;return t=this.likeState===!1?"like":"unlike",this.parentView.trigger("like:before"),this.model[t].call(this.model,function(t){return function(e,o){return e?(App.Flash.error(App.Helpers.API.getErrorMessage(e)),t.parentView.trigger("like:before")):(t._changeState(o),t.parentView.trigger("like:after",o))}}(this))},e.prototype._changeState=function(t){return this.isDestroyed?void 0:(this.likeState=t,this.ui.likeButton.toggleClass("hearted",this.likeState))},e}(Marionette.ItemView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Behaviors"),t.HasButtons=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(){var t,e,o,i,r;null==(t=this.view).events&&(t.events={}),this.options=this.view.normalizeUIKeys(this.options),e=this.options,o=[];for(i in e)r=e[i],o.push(function(t){return function(e,o){return t.bindClickEvent(e,o)}}(this)(i,r));return o},o.prototype.bindClickEvent=function(t,e){var o,i,r;return i=this,null!=(o=this.view.events)[r="click "+t]?o[r]:o[r]=function(o){var r,n,s,a,l,u,p,c,h;return h=this,a=i._extractOptions(h,e),"#"!==$(o.target).attr("href")&&(o.metaKey||o.ctrlKey||o.shiftKey)?void 0:(r=h.$(t),n=null!=(l=a.disabledClass)?l:"disabled",s=null!=(u=a.loadingClass)?u:"loading",r.hasClass(n)||r.is(":disabled")?i._stopEvent(o,a):i._confirmClick(h,r,o,a)?(p=a.fn.call(h,o),p===!0?!0:(c=i._stopEvent(o,a),$.isFunction(null!=p?p.always:void 0)&&(r.addClass("disabled loading"),p.always(function(){return r.removeClass("disabled loading")})),c)):i._stopEvent(o,a))}},o.prototype._extractOptions=function(t,e){var o;if(o={},$.isPlainObject(e)){if(o=e,null!=e.trigger?o.fn=function(o){return function(){return t.trigger(e.trigger)}}(this):!$.isFunction(o.fn)&&$.isFunction(t[o.fn])&&(o.fn=t[o.fn]),!$.isFunction(o.fn))throw new Error("No callback function specified")}else if($.isFunction(e))o={fn:e};else{if(!$.isFunction(t[e]))throw console.error(e),new Error("HasButton doesn't know how to use this value: "+e);o={fn:t[e]}}return o},o.prototype._stopEvent=function(t,e){if(null==e.stopEvent&&(e.stopEvent=!0),e.stopEvent===!0)return t.preventDefault(),!1;if(t[e.stopEvent]===!1)return!0;if(t[e.stopEvent])return t[e.stopEvent]();throw new Error("Unknown HasButtons value for stopEvent: "+option.stopEvent)},o.prototype._confirmClick=function(t,e,o,i){var r,n,s;return r=null!=(n=i.confirm)?n:e.data("confirm"),null!=r&&r!==!1?$.isFunction(r)?(s=r.apply(t),_.isString(s)?window.confirm(s):s):window.confirm(r):!0},o}(Marionette.Behavior)}.call(this),function(){var t,e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;e=App.module("Behaviors"),t=$(window),e.HasQTipPopovers=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return o(i,e),i.prototype._extractOptions=function(t,e){var o,r;if($.isPlainObject(e))r=_.omit(e,["trigger","fn"]),o=_.omit(r,["popover"]);else if($.isFunction(e))r={popover:e},o={};else{if(!$.isFunction(t[e]))throw new Error("HasQTipPopovers doesn't know how to use hashed value: "+e);r={popover:t[e]},o={}}if(r.view=t,null==r.popover)throw new Error("HasQTipPopovers cannot find popover function");return o.fn=_.partial(this._popoverGenerator,_,r),i.__super__._extractOptions.call(this,t,o)},i.prototype._popoverGenerator=function(e,o){var i,r,n,s,a,l;return n=$(e.target),s=o.classPrefix,r=$("<div></div>").addClass("popover").hide(),i=$("<div></div>").addClass("contain"),r.append(i),null!=s&&(r.addClass(s+"__container"),i.addClass(s+"__composite")),a={overwrite:!1,style:{def:!1,classes:"px_popover "+s,tip:{width:20,height:10}},position:{my:"left center",at:"right center",viewport:t,effect:!1,adjust:{method:"flipinvert shift"}},show:{event:e.type,delay:0,ready:!0},hide:{delay:0,event:"click unfocus"},events:{render:function(t){return function(e,r){var n;return t.$el.addClass("active"),n=o.popover.call(o.view,i,r),n.render()}}(this),show:function(e,i){return t.one("scroll resize",function(){return i.hide()}),o.view.trigger("HasQTipPopovers:show",i)},hide:function(t){return function(e,i){return t.$el.removeClass("active"),o.view.trigger("HasQTipPopovers:hide",i),i.destroy()}}(this)}},null!=o.position&&_.extend(a.position,_.omit(o.position,"effect")),l=_.defaults({content:r},a),n.qtip(l,e),!1},i}(App.Behaviors.HasButtons)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=[].slice;t=App.module("Collections"),t.MyGalleries=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.rpp=20,o.prototype.model=App.Models.Gallery,o.prototype.comparator=function(t){return-Date.parse(t.get("updated_at"))},o.prototype.url=function(){var t;return t={privacy:"both",include_cover:1,cover_size:3,include_last_added:!0,sort:"last_added_to_at",sort_direction:"desc",kinds:"0,1,2,4,5"},"https://api.500px.com/v1/users/"+App.currentUser.id+"/galleries?"+$.param(t)},o.prototype.initialize=function(t,e){if(null==e&&(e={}),o.__super__.initialize.apply(this,arguments),this.on("add",this.onModelAdded),null==App.currentUser)throw new Error("Cannot find currentUser")},o.prototype.reconcileMembershipOfPhoto=function(t){return this._loadMembershipOfPhoto(t)},o.prototype._loadMembershipOfPhoto=function(t,e){var o,r,n,s,a;if(null==e&&(e=1),1===e){null!=(s=this._pendingReconciliationXhr)&&s.abort(),null==this._notLoadedGalleriesInfo&&(this._notLoadedGalleriesInfo={}),a=this._notLoadedGalleriesInfo;for(o in a)r=a[o],delete r[t]}return n={sort:"updated_at",sort_direction:"desc",user_id:App.currentUser.id,rpp:1e3},this._pendingReconciliationXhr=$.get("https://api.500px.com/v1/photos/"+t+"/galleries?"+$.param(n)).done(function(o){return function(i){var r,n,s,a,l,u;for(o._pendingReconciliationXhr=null,u=i.galleries,a=0,l=u.length;l>a;a++)n=u[a],s=n.id,n=o.findWhere({id:s}),null!=n?n.markPhotoMembership(t):(null==(r=o._notLoadedGalleriesInfo)[s]&&(r[s]={}),o._notLoadedGalleriesInfo[s][t]=!0);return e<i.total_pages?o._loadMembershipOfPhoto(t,e+1):void 0}}(this)).fail(function(t){return function(e,o,r){return"abort"!==o?t.trigger.apply(t,["error:reconcileMembershipOfPhoto"].concat(i.call(arguments))):void 0}}(this))},o.prototype.onModelAdded=function(t){var e,o,i,r;if(e=null!=(i=this._notLoadedGalleriesInfo)?i[t.id]:void 0,null!=e){for(o in e)r=e[o],t.markPhotoMembership(o);return delete this._notLoadedGalleriesInfo[t.id]}},o.prototype.parse=function(t){var e,i,r,n,s;for(s=null!=(n=null!=t?t.galleries:void 0)?n:[],i=0,r=s.length;r>i;i++)e=s[i],e.user=App.currentUser.toJSON();return o.__super__.parse.call(this,t)},o}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Galleries.Models"),t.Gallery=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(t){return null==t&&(t={}),this.userId=t.userId,this.galleryPath=t.galleryPath},o.prototype.url=function(){var t,e;return t={include_user:!0,include_cover:1,cover_size:2048},e="https://api.500px.com/v1/users/"+this.userId+"/galleries",null!=this.galleryPath&&(e+="/"+this.galleryPath),e+"?"+$.param(t)},o.prototype.parse=function(t){return t.gallery},o}(App.Models.Gallery)}.call(this),function(){var t,e,o=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},r={}.hasOwnProperty;e=App.module("Behaviors"),t=$(window),e.IsPopover=function(e){function r(){return this.dismiss=o(this.dismiss,this),this.showPopover=o(this.showPopover,this),r.__super__.constructor.apply(this,arguments)}return i(r,e),r.prototype.initialize=function(t){if(this.classPrefix=t.classPrefix,null==this.classPrefix)throw new Error("must provide classPrefix");return this.view.dismiss=this.dismiss,this.view.showPopover=this.showPopover},r.prototype.showPopover=function(e,o){var i,r,n,s,a;if(null==o&&(o={}),null==e)throw new Error("View creator must provide event");return r=$("<div></div>").addClass("popover "+this.classPrefix+"__container").hide(),i=$("<div></div>").addClass("contain "+this.classPrefix+"__composite"),r.append(i),s={overwrite:!1,style:{def:!1,classes:"px_popover "+this.classPrefix,tip:{width:20,height:10}},position:{my:"left center",at:"right center",viewport:t,effect:!1,adjust:{method:"flipinvert shift"}},show:{event:e.type,delay:0,ready:!0},hide:{delay:0,event:"click unfocus"},events:{render:function(t){return function(e,o){return t.view.setElement(i),t.view.render()}}(this),show:function(e){return function(o,i){return t.one("scroll resize",function(){return i.hide()}),e.view.trigger("IsPopover:show",i)}}(this),hide:function(t){return function(e,o){return t.view.trigger("IsPopover:hide",o),t.qtipApi=null,o.destroy()}}(this)}},null!=o.position&&_.extend(s.position,o.position),null!=o.hide&&_.extend(s.hide,o.hide),n=$(o.target||e.target),a=_.defaults({content:r},s),this.qtipApi=n.qtip(a,e).qtip("api")},r.prototype.dismiss=function(){var t;return null!=(t=this.qtipApi)?t.hide():void 0},r}(Marionette.Behavior)}.call(this),function(){var t,e,o,i,r=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;i=App.module("Views"),t=$(window),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.template="add_to_galleries_popover_empty",e.prototype.className="add_to_galleries_popover_empty",e}(Marionette.ItemView),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.template="add_to_galleries_popover_item",e.prototype.tagName="li",e.prototype.className="add_to_galleries_popover__item",e.prototype.ui={thumbnail:".add_to_galleries_popover_item__thumbnail",checkbox:".add_to_galleries_popover_item__checkmark",popoverItem:".add_to_galleries_popover_item__wrap"},e.prototype.triggers={"click @ui.popoverItem":"clicked"},e.prototype.modelEvents={"change:photoMembership":"_updateCheckmark"},e.prototype.onRender=function(){return this._updateCheckmark();
},e.prototype._updateCheckmark=function(){var t,e,o,i,r,n,s;if(this.model.isNew())t=!0,e=!1;else if(this.options.photos)for(t=!0,e=!1,s=this.options.photos,i=0,r=s.length;r>i;i++)n=s[i],this.model.containsPhoto(n)?e=!0:t=!1;else this.options.batchEditablePhoto&&(o=this.options.batchEditablePhoto.checkGalleryMembership(this.model),t=o.containsAllPhotos,e=o.containsSomePhotos);return t?this.select():e?this.selectPartial():this.unselect()},e.prototype.templateHelpers=function(){var t;return{thumbUrl:null!=(t=this.model.getLastAddedPhoto())?t.getImagePath({size:1}):void 0,galleryUrl:this.model.getCanonicalUrl()}},e.prototype.toggleCheckmark=function(){return this._checked=this._partiallyChecked?!0:!this._checked,this._partiallyChecked=!1,this.ui.thumbnail.toggleClass("add_to_galleries_popover_item__thumbnail--checked",this._checked),this.ui.checkbox.toggleClass("add_to_galleries_popover_item__checkmark--checked",this._checked),this.ui.checkbox.removeClass("add_to_galleries_popover_item__checkmark--partial_checked")},e.prototype.selected=function(){return this._checked},e.prototype.select=function(){return this._checked=!0,this._partiallyChecked=!1,this.ui.thumbnail.addClass("add_to_galleries_popover_item__thumbnail--checked"),this.ui.checkbox.addClass("add_to_galleries_popover_item__checkmark--checked")},e.prototype.selectPartial=function(){return this._checked=!0,this._partiallyChecked=!0,this.ui.thumbnail.addClass("add_to_galleries_popover_item__thumbnail--checked"),this.ui.checkbox.addClass("add_to_galleries_popover_item__checkmark--partial_checked")},e.prototype.unselect=function(){return this._checked=!1,this._partiallyChecked=!1,this.ui.thumbnail.removeClass("add_to_galleries_popover_item__thumbnail--checked"),this.ui.checkbox.removeClass("add_to_galleries_popover_item__checkmark--checked"),this.ui.checkbox.removeClass("add_to_galleries_popover_item__checkmark--partial_checked")},e}(Marionette.ItemView),i.AddToGalleriesPopover=function(t){function i(t){null==t&&(t={}),null==App.myGalleries&&(App.myGalleries=new App.Collections.MyGalleries([])),App.myGalleries.sort(),t.collection=App.myGalleries,i.__super__.constructor.call(this,t)}return r(i,t),i.prototype.template="add_to_galleries_popover",i.prototype.childViewContainer="ul",i.prototype.childView=o,i.prototype.emptyView=e,i.prototype.childViewOptions=function(){return{batchEditablePhoto:this.batchEditablePhoto,photos:this.photos}},i.prototype.behaviors={InfiniteScroll:{container:function(){return this.ui.list}},HasButtons:{"@ui.createButton":"onCreateButtonClicked"},IsPopover:{classPrefix:"add_to_galleries_popover"}},i.prototype.ui={title:".add_to_galleries_popover__create_gallery__title",closeButton:".add_to_galleries_popover__close_button",createIcon:".add_to_galleries_popover__create_icon",createInput:".add_to_galleries_popover__title_input",createSection:".add_to_galleries_popover__create_section",privacyCheckbox:".add_to_galleries_popover__checkbox",createButton:".add_to_galleries_popover__create_button",list:".add_to_galleries_popover__galleries_list.scroll"},i.prototype.events={"click @ui.closeButton":"onClickClose","click @ui.createIcon":"onCreateIconClicked","click @ui.createInput":function(){return this.toggleCreateSection(!0)},"input @ui.createInput":function(){return this.toggleCreateSection(!0)},"click @ui.privacyCheckbox":function(){return this.ui.privacyCheckbox.toggleClass("checked")},keyup:"onKeyup"},i.prototype.onClickClose=function(){return this.dismiss()},i.prototype.onCreateIconClicked=function(){return this.toggleCreateSection(!0),this.ui.createInput.focus()},i.prototype.onCreateButtonClicked=function(){var t,e,o,i;return e=(null!=(i=App.currentUser)?i.isBuyer():void 0)?!0:this.ui.privacyCheckbox.hasClass("checked"),t={userId:App.currentUser.id,name:this._getNewTitle(),privacy:e,kind:0,auto_path:!0},o=new App.Galleries.Models.Gallery(t),o.save().done(function(t){return function(e){return o.set({user:App.currentUser.toJSON()},{silent:!0}),t.toggleCreateSection(!1),t._toggleGalleryMembership(o,!0),App.myGalleries.add(o,{at:0})}}(this)).fail(function(t){return function(){var e,o;return e=(o=App.Helpers.API).parseError.apply(o,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(e)),t.ui.createInput.focus()}}(this))},i.prototype.toggleCreateSection=function(t){return this.createMode=t,this.ui.createSection.toggleClass("add_to_galleries_popover__create_section--active",t),t||this.ui.createInput.val(""),this._updateCreateButton(),this.ui.list.height(this.$(".inside").innerHeight()-this.ui.title.outerHeight()-this.ui.createInput.outerHeight()-2-(t?111:0))},i.prototype._updateCreateButton=function(){return this.ui.createButton.toggleClass("disabled",this._getNewTitle().length<1)},i.prototype._getNewTitle=function(){return $.trim(this.ui.createInput.val())},i.prototype.initialize=function(t){var e;if(this.kind=t.kind,this.batchEditablePhoto=t.batchEditablePhoto,this.photos=t.photos,"gallery"!==(e=this.kind)&&"portfolio"!==e&&"profile"!==e)throw new Error("Incorrect kind: "+this.kind);if(null!=this.batchEditablePhoto){if(null!=this.photos)throw new Error("photos should not be used in batch editing mode")}else if(!(null!=this.photos&&this.photos.length>0))throw new Error("photos are missing");return this.createMode=!1,this._checkMembership()},i.prototype._checkMembership=function(){var t,e,o,i;if(null!=this.photos)for(i=this.photos,t=0,e=i.length;e>t;t++)o=i[t],this.collection.reconcileMembershipOfPhoto(o.id);else this.batchEditablePhoto.reconcileGalleryMemberships(this.collection);return this.listenTo(this.collection,"error:reconcileMembershipOfPhoto",function(t){return function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this))},i.prototype.onKeyup=function(t){var e;switch(t.which){case 27:return this.createMode?this.ui.createInput.val()?(e=this.ui.list.i18n("messages-abort-creation",{"return":!0}),confirm(e)?this.toggleCreateSection(!1):this.ui.createInput.focus()):this.toggleCreateSection(!1):this.dismiss();case 13:if(this.createMode&&!this.ui.createButton.hasClass("disabled"))return this.onCreateButtonClicked()}},i.prototype.onRender=function(){return null==this.collection.totalPages&&this.collection.fetch(),this.ui.title.i18n("galleries",{count:1}),this.ui.createInput.attr("placeholder",this.ui.createInput.i18n(this.kind,{"return":!0})),this.ui.list.scrollLock("on",null,!0),_.defer(function(t){return function(){return t.ui.createInput.focus(),t.toggleCreateSection(!1)}}(this))},i.prototype.onChildviewClicked=function(t,e){return t.toggleCheckmark(),this._toggleGalleryMembership(e.model,t.selected(),t)},i.prototype._toggleGalleryMembership=function(t,e,o){var i,r,n,s,a,l;return null!=this.batchEditablePhoto?e?this.batchEditablePhoto.addGallery(t.id):(this.batchEditablePhoto.removeGallery(t.id),null!=o&&o.render(),App.vent.trigger("addToGalleriesPopover:removePhoto",t.id,null!=(n=o.options.photos)&&null!=(s=n[0])?s.id:void 0)):(e?(i=t.addPhotos,r="messages-gallery-add"):(App.vent.trigger("addToGalleriesPopover:removePhoto",t.id,null!=(a=o.options.photos)&&null!=(l=a[0])?l.id:void 0),i=t.removePhotos,r="messages-gallery-remove"),i.call(t,this.photos).done(function(e){return function(){var o,i;return i=$("<a>").text(e.ui.list.i18n("messages-view-gallery",{"return":!0})).attr("href",t.getCanonicalUrl()).attr("target","_blank")[0].outerHTML,o=e.ui.list.i18n(r,{count:e.photos.length,"return":!0})+" "+i,App.Flash.success(o),e.dismiss()}}(this)).fail(function(t){return function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this))),App.vent.trigger("change:gallery_membership")},i}(Marionette.CompositeView)}.call(this),function(){var t,e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;e=App.module("Galleries.Views"),t=$(window),e.GalleryPhotoRequestRemovalModal=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return o(i,e),i.prototype.template="gallery_photo_request_removal_modal",i.prototype.className="gallery_photo_request_removal_modal action_modal report-content-modal",i.prototype.ui={closeButton:".header .close",reasonDetails:".content textarea",submitButton:".content .submit"},i.prototype.behaviors={ModalDialog:{closeButton:!1,wrapperClass:"report-content-modal-wrapper",dialogClass:"report-content-modal-dialog"},HasButtons:{"@ui.closeButton":"onCloseClicked","@ui.submitButton":"onSubmitClicked"}},i.prototype.initialize=function(t){if(null==t&&(t={}),this.photo=t.photo,null==this.photo)throw new Error("Gallery photo is missing!")},i.prototype.onShow=function(){return this.ui.reasonDetails.focus()},i.prototype.resize=function(){return t.width()<=360?this.$el.width(t.width()-20):this.$el.width(360),this.trigger("resize")},i.prototype.onCloseClicked=function(){return this.destroyModal()},i.prototype.onSubmitClicked=function(){var t;return t="[RR:"+this.photo.id+"]"+this.ui.reasonDetails.val(),this.model.reportContent(0,t).done(function(t){return function(){return App.Flash.success(t.ui.submitButton.i18n("success",{"return":!0})),t.destroyModal()}}(this))},i}(Marionette.LayoutView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),t.UserHoverCard=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="user_hover_card",o.prototype.className="user_hover_card",o.prototype.behaviors={IsPopover:{classPrefix:"user_hover_card"},HasFollowButton:{"class":"mini_follow"}},o.prototype.templateHelpers=function(){return{path:userPath(this.model)}},o}(Marionette.LayoutView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),t.AddToGalleryButton=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template=!1,o.prototype.initialize=function(t){return null==t&&(t={}),null!=t.onOpenGA?this.onOpenGA=t.onOpenGA:void 0},o.prototype.events={click:"_openAddToGalleryPopover"},o.prototype._openAddToGalleryPopover=function(t){var e,o,i;return null!=this.onOpenGA&&null!=this.onOpenGA.category&&PxApp.GA.event(this.onOpenGA),null!=App.currentUser?(i=new App.Views.AddToGalleriesPopover({kind:"gallery",photos:[this.model]}),e=function(){return i.dismiss()},this.listenToOnce(i,"IsPopover:show",function(t){return function(){return $(".photo_sidebar").one("scroll",e)}}(this)),this.listenToOnce(i,"IsPopover:hide",function(t){return function(){return $(".photo_sidebar").off("scroll",e)}}(this)),i.showPopover(t)):(o=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"photos_like",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"photos_like",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(o,"signup:success login:success",function(){return window.location.reload()}),o.showModal()),!1},o}(Marionette.ItemView)}.call(this),function(){var t,e,o,i,r,n,s=function(t,e){function o(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},a={}.hasOwnProperty;$.lazyLoadXT.autoInit=!1,r=App.module("Photos.Views"),t=$(window),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.template="quest_more_button_popover",e.prototype.ui={removeFromQuest:".remove_from_quest"},e.prototype.initialize=function(t){return this.qtip=t.qtip,this.quest=t.quest,this.photo=t.photo,this.qtipApi=this.qtip},e.prototype.handleAction=function(t,e){switch(t){case"remove_photo":return this._removePhotoFromQuest()}},e.prototype._removePhotoFromQuest=function(){return this.quest.removePhoto(this.photo).done(function(t){return function(){return App.Flash.success("Removed photo from quest"),t.photo.trigger("removePhoto")}}(this)).fail(function(t){return function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this))},e}(App.Behaviors.HasExtraActionsDropdown.DropdownBase),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.template="galleries_more_button_popover",e.prototype.ui={setAsCover:".set_as_cover",requestRemoval:".request_removal",removeFromGallery:".remove_from_gallery"},e.prototype.initialize=function(t){return this.qtip=t.qtip,this.gallery=t.gallery,this.photo=t.photo,this.qtipApi=this.qtip},e.prototype.templateHelpers=function(){return{isGalleryOwnedByCurrentUser:this.gallery.isOwnedByCurrentUser(),isGalleryCoverPhoto:this.gallery.getCoverPhotoId()===this.photo.id,isPhotoOwnedByCurrentUser:this.photo.isOwner()}},e.prototype.handleAction=function(t,e){switch(t){case"request_removal":return this._requestRemoval();case"set_as_cover":return this._setAsGalleryCoverPhoto();case"remove_from_gallery":return this._removePhotoFromGallery()}},e.prototype._requestRemoval=function(){var t;return t=new App.Galleries.Views.GalleryPhotoRequestRemovalModal({model:this.gallery,photo:this.photo}),t.showModal(),this.qtip.destroy()},e.prototype._setAsGalleryCoverPhoto=function(){return this.gallery.setCover(this.photo.id).done(function(t){return function(){var e;return e=t.ui.setAsCover.i18n("flash-success",{"return":!0}),App.Flash.success(e)}}(this)).fail(function(t){return function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this)),this.qtip.destroy()},e.prototype._removePhotoFromGallery=function(){return this.gallery.removePhotos([this.photo]).done(function(t){return function(){var e;return e=t.ui.removeFromGallery.i18n("flash-success",{"return":!0}),App.Flash.success(e),t.photo.trigger("removePhoto")}}(this)).fail(function(t){return function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this)),this.qtip.destroy()},e}(App.Behaviors.HasExtraActionsDropdown.DropdownBase),o=function(o){function r(t){var e,o;if(this.maxRowHeight=t.maxRowHeight,this.eventName=t.eventName,this.hasHoverState=t.hasHoverState,this.waitThumbnailsLoad=t.waitThumbnailsLoad,this.showTitle=t.showTitle,this.scrollContainer=t.scrollContainer,this.hasVisibleCredits=t.hasVisibleCredits,this.showPulse=t.showPulse,this.gallery=t.gallery,this.quest=t.quest,this.GA=t.GA,this.commenter=t.commenter,this.fixedWidth=t.fixedWidth,null==this.maxRowHeight)throw new Error("maxRowHeight is missing");if(null==this.eventName)throw new Error("eventName is missing");if(null==this.hasHoverState)throw new Error("hasHoverState is missing");if(null==this.waitThumbnailsLoad)throw new Error("waitThumbnailsLoad is missing");if(null==this.showTitle)throw new Error("showTitle is missing");if(null==this.hasVisibleCredits)throw new Error("hasVisibleCredits is missing");if(null==this.showPulse)throw new Error("showPulse is missing");e=t.model.getPhoto(),null==this.GA&&(this.GA={}),null==this.behaviors&&(this.behaviors={}),!this.hasHoverState||e.isOwner()||PxCurrentUser.isRolledOut("unification")&&(null!=(o=App.currentUser)?o.isBuyer():void 0)?delete this.behaviors.HasLikeButton:this.behaviors.HasLikeButton={"class":"only_icon",model:function(){return e}},this.hasHoverState&&App.Photos.Models.PhotoManager.prefetchModels([t.model.id],{favoriteAndLikeStates:null!=this.behaviors.HasLikeButton,licensingStates:PxCurrentUser.isRolledOut("unification")&&(!App.currentUser||App.currentUser.isBuyer()),batchable:!0}),this.once("imageSrc::update",function(t){return function(){return t.updateImageSrc()}}(this)),r.__super__.constructor.call(this,t)}return s(r,o),r.prototype.template="photo_item",r.prototype.className="photo_thumbnail",r.prototype.ui={cartButton:".cart_button",addToGalleryButton:".add_to_gallery_button",moreButton:".photo__top_buttons__more_button",photoLink:"a.photo_link",image:".photo_link img"},r.prototype.events={"click .photo_link":"onPhotoClicked","click .photo_title":"onPhotoClicked","click .avatar":"_onClickUserAvatar","click .photographer":"_onClickUserName","contextmenu img":"onImgRightClick","mouseover .photo_info_wrap":"onMouseOverPhotographer","mouseleave .photo_info_wrap":"onMouseLeavePhotographer"},r.prototype.behaviors={HasQTipPopovers:{"@ui.moreButton":{classPrefix:"galleries_more_button_popover",position:{my:"top center",at:"bottom center",adjust:{method:"shift flipinvert"}},popover:function(t,o){var r;return r={el:t,qtip:o,photo:this.model.getPhoto()},this.gallery?new e(_.extend(r,{gallery:this.gallery})):this.quest?new i(_.extend(r,{quest:this.quest})):void 0}}},HasButtons:{"@ui.addToGalleryButton":"_openAddToGalleryPopover","@ui.cartButton":"onPhotoClicked"}},r.prototype._openAddToGalleryPopover=function(t){var e,o;return null!=App.currentUser?(o=new App.Views.AddToGalleriesPopover({kind:"gallery",photos:[this.model.getPhoto()]}),this.listenToOnce(o,"IsPopover:show",function(t){return function(){return t.$el.addClass("active")}}(this)),this.listenToOnce(o,"IsPopover:hide",function(t){return function(){return t.$el.removeClass("active")}}(this)),o.showPopover(t),this._sendGAEvent({action:"Add To Gallery Popover Opened"})):(e=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"add_to_gallery",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"add_to_gallery",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(e,"signup:success login:success",function(){return window.location.reload()}),e.showModal()),!1},r.prototype.LAZYOFFSET=t.height(),r.prototype._shouldShowTopMenuButton=function(){var t,e,o,i;return t=this.model.getPhoto(),o=null!=this.gallery&&(this.gallery.isOwnedByCurrentUser()||t.isOwner()),i=null!=this.quest&&(null!=(e=App.currentUser)?e.get("admin"):void 0),o||i},r.prototype.templateHelpers=function(){var t,e,o,i,r,s;return t=this.model.getPhoto(),e="Untitled"===t.get("name")?"Photo":t.get("name"),s=null!=(o=t.getUser())?o.get("fullname"):void 0,{photoId:t.id,hasHoverState:this.hasHoverState,hasAddToGalleryButton:!(!App.currentUser&&PxCurrentUser.isRolledOut("unification")&&t.isLicenseable()),hasCartButton:PxCurrentUser.isRolledOut("unification")&&t.isLicenseable()&&!t.isOwner()&&(!App.currentUser||App.currentUser.isBuyer()),hasVisibleCredits:this.hasVisibleCredits&&!n(),showTitle:this.showTitle,isOwnedByCurrentUser:t.isOwner(),canShowMenu:this._shouldShowTopMenuButton(),dimensionsAvailable:!this.waitThumbnailsLoad&&(null!=(i=t.get("width"))?i:-1)>0&&(null!=(r=t.get("height"))?r:-1)>0,imgAlt:""+e,showPulse:this.showPulse}},r.prototype.updateImageSrc=function(){var t,e,o,i,r,n,s;for(i=this.model.getPhoto(),s=Math.max(1,null!=(r=window.devicePixelRatio)?r:1),e=[{height:300,size:32},{height:450,size:31},{height:600,size:33}],e.sort(function(t,e){return e.height-t.height}),o=this.$("img"),s=Math.min(s,1.5),n=o.height()*s,t=e.pop();e.length>0&&t.height<n;)t=e.pop();return o.attr("src",i.getImagePath({size:t.size}))},r.prototype.onRender=function(){var t,e,o,i,r;return this.hasHoverState||this.ui.photoLink.attr("href",null),this.fixedWidth&&(this.ui.image.css("width",this.fixedWidth),t=this.fixedWidth*(this.model.getPhoto().get("height")/this.model.getPhoto().get("width")),this.ui.image.css("height",t)),r=null!=(o=null!=(i=App.currentUser)?i.get("show_nude"):void 0)?o:!1,e=this.model.getPhoto().get("nsfw"),r===!1&&e===!0&&this.$el.addClass("nsfw_placeholder"),this.$("img").lazyLoadXT({scrollContainer:this.scrollContainer,edgeY:this.LAZYOFFSET}),this.$el.data("id",this.model.getPhoto().id),this.listenTo(this,"like:after",this._onPhotoLiked)},r.prototype.onShow=function(){return this.listenTo(this.model.getPhoto(),"removePhoto",function(t){return function(){return t.$el.fadeOut(200,function(){return $(".photo_thumbnail").addClass("photo_removal_transition"),t.model.collection.remove(t.model)})}}(this)),this.gallery?this.listenTo(App.vent,"addToGalleriesPopover:removePhoto",function(t){return function(e,o){return o===t.model.getPhoto().id&&e===t.gallery.id?t.$el.fadeOut(200,function(){return $(".photo_thumbnail").addClass("photo_removal_transition"),t.model.collection.remove(t.model)}):void 0}}(this)):void 0},r.prototype.onPhotoClicked=function(t){var e,o,i,r,s;return this._sendGAEvent({action:"Photo Modal Opened"}),r=this.model.getPhoto(),n()||t.metaKey||t.ctrlKey?("function"==typeof(e=this.model.collection).selectPhoto&&e.selectPhoto(r),s="function"==typeof(o=this.model.collection).buildBrowserUrlParams?o.buildBrowserUrlParams():void 0,i=r.get("url"),null!=s&&(i+="?"+$.param(s)),n()?document.location=i:window.open(i,"_blank")):r.has("highlightedComments")&&null!=this.commenter?App.vent.trigger(this.eventName,r,{GA:this.GA,navigationContext:this.model.collection,commenter:this.commenter}):App.vent.trigger(this.eventName,r,{GA:this.GA,navigationContext:this.model.collection}),!1},r.prototype.onMouseOverPhotographer=function(t){var e;if(null!=(e=App.currentUser)?e.isRolledOut("user_hover_card"):void 0)return this.userHoverTimeout=setTimeout(function(e){return function(){return App.Photos.Models.UserManager.getModelById(e.model.get("user").id,{followingStates:!0,viewCount:!0}).done(function(o){var i,r;return i={hide:{fixed:!0,delay:300,event:"mouseleave"}},r=new App.Views.UserHoverCard({model:o}),e.listenToOnce(r,"IsPopover:show",function(){return e.$el.addClass("active")}),e.listenToOnce(r,"IsPopover:hide",function(){return e.$el.removeClass("active")}),r.showPopover(t,i)})}}(this),800)},r.prototype.onMouseLeavePhotographer=function(t){var e;if(null!=(e=App.currentUser)?e.isRolledOut("user_hover_card"):void 0)return this.userHoverTimeout?(clearTimeout(this.userHoverTimeout),this.userHoverTimeout=null):void 0},r.prototype.onImgRightClick=function(t){var e;if(null!=(null!=(e=this.model)?e.getPhoto:void 0))return App.Photos.Views.PhotoCopyrightTooltip.showTooltip(this.model.getPhoto(),t),t.preventDefault()},r.prototype._onPhotoLiked=function(t){return t?this._sendGAEvent({action:"Like Button Clicked"}):this._sendGAEvent({action:"Unlike Button Clicked"})},r.prototype._onClickUserName=function(){return this._sendGAEvent({action:"User Name Clicked"})},r.prototype._onClickUserAvatar=function(){return this._sendGAEvent({action:"User Avatar Clicked"})},r.prototype._sendGAEvent=function(t){var e;return null==t&&(t={}),null!=this.GA&&null!=this.GA.category?(e=_.extend({},this.GA,t),PxApp.GA.event(e)):void 0},r}(Marionette.LayoutView),r.FullAspectRatioPhotoGrid=function(t){function e(t){null==this.behaviors&&(this.behaviors={}),null!=t.emptyView&&(this.emptyView=t.emptyView),this.scrollContainer=t.scrollContainer,this.hasLoadingSpinner=t.hasLoadingSpinner,null==this.hasLoadingSpinner&&(this.hasLoadingSpinner=!0),null!=this.scrollContainer?this.behaviors.InfiniteScroll={container:function(){return this.scrollContainer},queryString:!1}:this.hasLoadingSpinner?this.behaviors.InfiniteScroll=!0:delete this.behaviors.InfiniteScroll,e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.template="full_aspect_ratio_photo_grid",e.prototype.className="full-aspect-ratio-photo-grid",e.prototype.childView=o,e.prototype.childViewContainer=".grid-container",e.prototype.collectionEvents={sync:"refreshGallery",remove:"_recalcLayout"},e.prototype.NUDGE_LEFT_CLASS="photo-thumbnail--nudge-left",e.prototype.NUDGE_RIGHT_CLASS="photo-thumbnail--nudge-right",e.prototype.NUDGE_OFFSET=4,e.prototype.ORIGINAL_WHILE_DRAGGING_CLASS="photo-thumbnail--original-start-drag",e.prototype.HEALING_TRANSITION_DURATION=400,e.prototype.HEALING_TRANSITION_DELAY=600,e.prototype.ui={showMore:".full_aspect_ratio_photo_grid__show_more_container",backToTop:".full_aspect_ratio_photo_grid__back_to_top_container",pageCounter:".full_aspect_ratio_photo_grid__page_counter"},e.prototype.behaviors={HasButtons:{".full_aspect_ratio_photo_grid__show_more":"onClickMorePhotos",".full_aspect_ratio_photo_grid__back_to_top":"onClickBackToTop"}},e.prototype.templateHelpers=function(){return{isPaginated:this.pagination}},e.prototype.initialize=function(t){var e,o;return this.eventName=t.eventName,this.hasHoverState=t.hasHoverState,this.waitThumbnailsLoad=t.waitThumbnailsLoad,this.maxRowHeightPercentage=t.maxRowHeightPercentage,this.showTitle=t.showTitle,this.photoGridPadding=t.photoGridPadding,this.hasVisibleCredits=t.hasVisibleCredits,this.showPulse=t.showPulse,this.isSortable=t.isSortable,this.gallery=t.gallery,this.quest=t.quest,this.hideLastRow=t.hideLastRow,this.pagination=t.pagination,this.GA=t.GA,this.commenter=t.commenter,this.forceRowHeight=t.forceRowHeight,this.useJustifiedGallery=t.useJustifiedGallery,this.fixedWidth=t.fixedWidth,null==this.showTitle&&(this.showTitle=!1),null==this.eventName&&(this.eventName="showPhoto"),null==this.hasHoverState&&(this.hasHoverState=!1),null==this.hasVisibleCredits&&(this.hasVisibleCredits=!1),null==this.waitThumbnailsLoad&&(this.waitThumbnailsLoad=!0),null==this.showPulse&&(this.showPulse=!1),null==this.isSortable&&(this.isSortable=!1),null==this.hideLastRow&&(this.hideLastRow=!1),null==this.pagination&&(this.pagination=!1),null==this.commenter&&(this.commenter=null),null==this.useJustifiedGallery&&(this.useJustifiedGallery=!0),null==this.fixedWidth&&(this.fixedWidth=null),(null!=(o=App.currentUser)?o.isRolledOut("limited_infinite_scroll"):void 0)||(this.pagination=!1),null==this.photoGridPadding&&(this.photoGridPadding=0),null==this.maxRowHeightPercentage&&(this.maxRowHeightPercentage=120),this.forceRowHeight?this.maxRowHeight=this.forceRowHeight:this.maxRowHeight=this._computeMaxRowHeight(this._computeRowHeightForWidth($(window).width()-this.photoGridPadding)),this.pagination&&(e=this._extractUrlParams(),null!=e.page)?this.collection.page=parseInt(e.page):void 0},e.prototype.childViewOptions=function(t,e){return{showTitle:this.showTitle,hasHoverState:this.hasHoverState,eventName:this.eventName,waitThumbnailsLoad:this.waitThumbnailsLoad,maxRowHeight:this.maxRowHeight,scrollContainer:this.scrollContainer,hasVisibleCredits:this.hasVisibleCredits,showPulse:this.showPulse&&!n(),gallery:this.gallery,quest:this.quest,GA:this.GA,commenter:this.commenter,fixedWidth:this.fixedWidth}},e.prototype.onAttach=function(){return this.forceRowHeight?(this.rowHeight=this.forceRowHeight,this.maxRowHeight=this.rowHeight):(this.rowHeight=this._computeRowHeightForWidth(this.$el.width()),this.maxRowHeight=this._computeMaxRowHeight(this.rowHeight)),this.useJustifiedGallery?this.$(this.childViewContainer).on("jg.complete",function(t){return function(){return t._updateImages()}}(this)):this._updateImages(),this.collection.length>0&&this.useJustifiedGallery&&this._setupGallery(),this.$el.toggleClass("infinite_scroll_container--no_content_yet",0===this.collection.length),this.isSortable&&this.initializeSortable(),this.pagination&&(this.ui.showMore.hide(),this.ui.backToTop.hide()),this.hasLoadingSpinner?void 0:this.$(this.childViewContainer).addClass("no-infinite-scroll")},e.prototype.initializeSortable=function(){var t;return t={placeholder:"photo-thumbnail__placeholder",delay:200,tolerance:"pointer",opacity:.8,helper:"clone",items:"> .photo_thumbnail",appendTo:this.childViewContainer,containment:"parent",delay:150,start:this._onStartDragging,stop:function(t){return function(e,o){return t._onStopDragging(e,o)}}(this),change:function(t){return function(e,o){return t._onDraggingOverNewPosition(e,o)}}(this)},this.$(this.childViewContainer).sortable(t)},e.prototype._updateImages=function(){return this.children.each(function(t){return t.trigger("imageSrc::update")})},e.prototype.nudgeRow=function(t){var e,o,i,r,n;return n=t.position().top,i=t.position().left,e=$(".photo_thumbnail").filter(function(t,e){return $(e).position().top===n}),o=e.filter(function(t,e){return $(e).position().left+$(e).width()<i}),r=e.filter(function(t,e){return $(e).position().left>i}),o.addClass(this.NUDGE_LEFT_CLASS),r.addClass(this.NUDGE_RIGHT_CLASS)},e.prototype.unNudge=function(){return $("."+this.NUDGE_LEFT_CLASS).removeClass(this.NUDGE_LEFT_CLASS),$("."+this.NUDGE_RIGHT_CLASS).removeClass(this.NUDGE_RIGHT_CLASS)},e.prototype.onDragDropComplete=function(t,e,o){var i,r;return r=t.data("id"),i=e.data("id"),this._recalcLayout(),this.trigger("change:photoOrder",r,i)},e.prototype._computeRowHeightForWidth=function(t){var e;return e=Math.round(t/6+50),this._rowHeightForMaxHeight(375)>e&&e>this._rowHeightForMaxHeight(300)&&(e=this._rowHeightForMaxHeight(300)),Math.min(e,this._rowHeightForMaxHeight(450))},e.prototype._computeMaxRowHeight=function(t){return t*this.maxRowHeightPercentage/100},e.prototype._rowHeightForMaxHeight=function(t){return t/(this.maxRowHeightPercentage/100)},e.prototype._setupGallery=function(){var t,e;if(!this._galleryInitialized)return this._galleryInitialized=!0,t=n()?2:10,e={useSizeFromData:!0,rowHeight:this.rowHeight,maxRowHeight:this.maxRowHeight,fixedHeight:null!=this.forceRowHeight,margins:t,cssAnimation:!0,lastRow:this.hideLastRow?"hide":"nojustify",waitThumbnailsLoad:this.waitThumbnailsLoad,selector:"> .photo_thumbnail",captions:!1,hasLoadingSpinner:this.hasLoadingSpinner},this.$(this.childViewContainer).justifiedGallery(e).on("jg.resize",function(t){return function(){var e;return e=t.$(".photo_thumbnail:eq(1)"),e.find(".add_to_gallery_button").qtip("reposition")}}(this))},e.prototype._recalcLayout=function(){return this.useJustifiedGallery?_.defer(function(t){return function(){return t.$(t.childViewContainer).justifiedGallery()}}(this)):void 0},e.prototype._onStartDragging=function(t,e){return e.item.show().addClass(this.ORIGINAL_WHILE_DRAGGING_CLASS),e.helper.addClass("photo-thumbnail--dragging")},e.prototype._onStopDragging=function(t,e){var o,i,r;return e.item.show().removeClass(this.ORIGINAL_WHILE_DRAGGING_CLASS).removeAttr("style"),this.$(".photo-thumbnail--dragging").removeClass("photo-thumbnail--dragging"),this.unNudge(),o=e.item.next(),i=e.item.prev(),r=e.item,r.append('<div class="photo-feedback-overlay"></div>'),r.find(".photo-feedback-overlay").animate({opacity:"toggle"},this.HEALING_TRANSITION_DURATION),_.delay(function(){return r.find(".photo-feedback-overlay").animate({opacity:"toggle"},this.HEALING_TRANSITION_DURATION,"swing",function(){return r.find(".photo-feedback-overlay").remove()})},this.HEALING_TRANSITION_DELAY),this.onDragDropComplete(r,i,o)},e.prototype._onDraggingOverNewPosition=function(t,e){var o,i,r;return this.unNudge(),i=e.placeholder,o=i.prev(".photo_thumbnail"),r=i.next(".photo_thumbnail"),o.length||r.length?(o.length?(i.height(o.height()),i.css({top:o.position().top+"px",left:o.position().left+o.width()+this.NUDGE_OFFSET+"px"})):(i.height(r.height()),i.css({top:r.position().top+"px",left:r.position().left-this.NUDGE_OFFSET+"px"})),this.nudgeRow(i),i.removeClass("photo-thumbnail__placeholder--visible"),_.delay(function(){return i.addClass("photo-thumbnail__placeholder--visible")},100)):void 0},e.prototype.showLastRow=function(){return this.useJustifiedGallery&&0!==this.collection.length?(this._setupGallery(),this.$(this.childViewContainer).justifiedGallery({lastRow:"nojustify"})):void 0},e.prototype.refreshGallery=function(){if(0!==this.collection.length&&(this.$el.removeClass("infinite_scroll_container--no_content_yet"),this.useJustifiedGallery&&(this._setupGallery(),this.$(this.childViewContainer).justifiedGallery("norewind")),this.ui.showMore.hide(),this.ui.backToTop.hide(),this.pagination)){if(this.updatePaginationUrlParam(),this.ui.pageCounter.i18n("page",{page:this.collection.page,total:this.collection.totalPages}),this.collection.page<=2?this.ui.backToTop.hide():this.ui.backToTop.show(),this.collection.page%2!==0)return this.ui.showMore.hide();if(this.pauseInfiniteScroll(),!this.collection.finished())return this.ui.showMore.show()}},e.prototype.onClickMorePhotos=function(){return this.collection.remove(this.collection.models),$(window).scrollTop(this.$el.offset().top-58),this.continueInfiniteScroll(),this.trigger("infinite_scroll:fetch_next")},e.prototype.onClickBackToTop=function(){return this.collection.remove(this.collection.models),this.collection.reset(),this.continueInfiniteScroll(),this.collection.fetch()},e.prototype.updatePaginationUrlParam=function(){var t;return t=this._extractUrlParams(),t.page=this.collection.page,App.router.navigate(document.location.pathname+"?"+$.param(t),{
replace:!0})},e.prototype.pauseInfiniteScroll=function(){return this.trigger("infinite_scroll:pause")},e.prototype.continueInfiniteScroll=function(){return this.trigger("infinite_scroll:continue")},e.prototype._extractUrlParams=function(){var t,e;return e={},""!==document.location.search&&(t=_.map(document.location.search.substr(1).split("&"),function(t){return t.split("=")}),_.each(t,function(t){return e[t[0]]=t[1]})),e},e}(Marionette.CompositeView),n=function(){return $("body").hasClass("smartphone")||$("body").hasClass("tablet")}}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=function(t,e){return function(){return t.apply(e,arguments)}},r=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("Photos.Views"),t.PhotoDownloadSection=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="photo_download_section",o.prototype.className="photo_download_section",o.prototype.ui={expandableHeader:".sidebar_expandable_header",expandableContent:".sidebar_expandable_content"},o.prototype.regions={licensingRegion:".licensing_region"},o.prototype.behaviors={HasButtons:{"@ui.expandableHeader":"onClickExpand"}},o.prototype.onRender=function(){return this.model.getMarketplaceLicenses().done(function(t){return function(){return t.isDestroyed?void 0:t.licensingRegion.show(new App.Photos.Views.PhotoLicenseView({model:t.model}))}}(this)),PxCurrentUser.isRolledOut("unification")&&(null==App.currentUser||App.currentUser.isBuyer())?(this.expanded=!0,this.ui.expandableHeader.hide()):this.expanded="true"===$.cookie("photo_download_expanded"),this._toggleExpanded(this.expanded)},o.prototype.onClickExpand=function(){return this.expanded=!this.expanded,this._toggleExpanded(this.expanded)},o.prototype._toggleExpanded=function(t){return this.ui.expandableHeader.toggleClass("sidebar_expandable_header--expanded",t),this.ui.expandableContent.toggleClass("sidebar_expandable_content--expanded",t),$.cookie("photo_download_expanded",t,{path:"/",expires:365})},o}(Marionette.LayoutView),t.PhotoLicenseView=function(t){function o(){return this._onFreePhotoDownload=i(this._onFreePhotoDownload,this),this._onRequestExclusive=i(this._onRequestExclusive,this),o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="photo_license_view",o.prototype.className="photo_license_view",o.prototype.ui={downloadButton:".js-download-button",requestToLicenseButton:".request_to_license_button",basicLicenseRadioButton:"input:radio",extendedLicenseCheckbox:".checkbox",subtotalCalculation:".checkout_subtotal__calculation",freeDownloadButton:".js_free_photo_download"},o.prototype.behaviors={HasButtons:{"@ui.downloadButton":"_downloadPhoto","@ui.requestToLicenseButton":"_onRequestToLicense"},HasAddToCartButton:{withText:!0}},o.prototype.events={"click .js-request-exclusive":"_onRequestExclusive","click @ui.basicLicenseRadioButton":"setupLicensesAndSubtotal","click @ui.extendedLicenseCheckbox":"setupLicensesAndSubtotal","click @ui.freeDownloadButton":"_onFreePhotoDownload"},o.prototype.modelEvents={"cart:update":"render"},o.prototype.templateHelpers=function(){var t,e;return t=this._buttonType(),e=this.model.isRightsManaged()||this.model.isAvailableForImmediatePurchase()||this.model.isOwner()&&this.model.isSubmitted(),{licenses:this.model.get("basic_licenses").concat(this.model.get("extended_licenses")),basicLicenses:this.model.get("basic_licenses"),extendedLicenses:this.model.get("extended_licenses"),isAvailableForImmediatePurchase:this.model.isAvailableForImmediatePurchase(),isExclusive:this.model.isExclusive(),isEditorial:this.model.isEditorial(),isFreePhoto:this.model.isFreePhoto()&&PxCurrentUser.isRolledOut("unification"),freePhotoUrl:this.model.freePhotoUrl(),compUrl:this.model.compUrl(),buttonType:t,showDownloadComp:e,isCuratedCollection:this.model.isCuratedCollection(),isModelReleased:this.model.isModelReleased(),isLocationReleased:this.model.isLocationReleased(),isCreativeCommons:this.model.isCreativeCommonsCompatible(),ccLicenseUrl:this.model.getCreativeCommonsLicenseUrl(),licenseName:this.model.getLicenseName(),ccPhotoDownloadUrl:this.model.getCreativeCommonsPhotoUrl(),currency:this.model.get("currency"),shouldShowRequestToLicenseModal:this._shouldShowRequestToLicenseModal(),licenseRequestButtonIsAddToCart:this._licenseRequestButtonIsAddToCart()}},o.prototype.initialize=function(){return o.__super__.initialize.apply(this,arguments),this.licenseSelection=App.Models.LicenseSelection.instance()},o.prototype.onRender=function(){var t;return this._setInitialLicenseSelection(),t=this.model.get("basic_licenses").concat(this.model.get("extended_licenses")),_.each(t,function(t){return function(e){var o;return o=e.license_name,t.hideFlyoutContainers(o),t.setupFlyouts(o)}}(this))},o.prototype.onAttach=function(t){return this.setupLicensesAndSubtotal(t)},o.prototype.setupLicensesAndSubtotal=function(t){var e,o,i,r;return o=this.getDisabledAddonElements(),this.setDisabledElementsToAvailable(o),"click"===t.type?(e=this._getClickedExtendedLicenseName(t),this.toggleExtendedLicense(this.findLicense(e)),r=this.getSelectedLicenseNames()):r=this.licenseSelection.fetch(),this.licenseSelection.select(r),i=this.getIncludedAddonElementsForNames(r),this.setAvailableElementsToDisabled(i),this.setSubtotal(r)},o.prototype.getBasicLicensesForNames=function(t){return _.filter(this.model.get("basic_licenses"),function(e){return _.contains(t,e.license_name)})},o.prototype.getExtendedLicensesForNames=function(t){return _.filter(this.model.get("extended_licenses"),function(e){return _.contains(t,e.license_name)})},o.prototype.getAllLicensesForNames=function(t){return this.getExtendedLicensesForNames(t).concat(this.getBasicLicensesForNames(t))},o.prototype.getIncludedAddonsForLicenseNames=function(t){var e;return _.unique(_.flatten(function(){var o,i,r,n;for(r=this.getAllLicensesForNames(t),n=[],o=0,i=r.length;i>o;o++)e=r[o],e.addon_inclusion&&n.push(e.addon_inclusion.split(","));return n}.call(this)))},o.prototype.getSelectedBasicLicenses=function(){var t,e;return e=this.ui.basicLicenseRadioButton,t=[this._selectedBasicLicenseName(e)],this.getBasicLicensesForNames(t)},o.prototype.getSelectedExtendedLicenses=function(){var t,e;return t=$(".checkbox.checked"),e=this._selectedExtendedLicenseNames(t),this.getExtendedLicensesForNames(e)},o.prototype.getAllSelectedLicenses=function(){return this.getSelectedExtendedLicenses().concat(this.getSelectedBasicLicenses())},o.prototype.getSelectedLicenseNames=function(){var t,e,o,i;return i=this.ui.basicLicenseRadioButton,t=[],t.push(this._selectedBasicLicenseName(i)),e=this.ui.extendedLicenseCheckbox,o=this._selectedExtendedLicenseNames(e),o.concat(t)},o.prototype.getIncludedAddonElementsForNames=function(t){var e,o;return o=this.getIncludedAddonsForLicenseNames(t),e=_.map(o,function(t){return function(e){return t.findLicense(e)}}(this))},o.prototype.getDisabledAddonElements=function(){return this.$(".extended_license_type--disabled")},o.prototype.findLicense=function(t){return this.$("[data-license='"+t+"']")},o.prototype._selectedBasicLicenseName=function(t){var e;return e=_.find(t,function(t){return function(e){return t.$(e).prop("checked")===!0}}(this)),this.$(e).val()},o.prototype._selectedExtendedLicenseNames=function(t){var e;return e=_.filter(t,function(t){return function(e){return t.$(e).hasClass("checked")&&!t.$(e).hasClass("included_addon")}}(this)),_.map(e,function(t){return function(e){return t.$(e).attr("value")}}(this))},o.prototype._getClickedExtendedLicenseName=function(t){var e,o,i;return o=_.map(this.model.get("extended_licenses"),function(t){return t.license_name}),i=$(t.target),e=i.attr("value"),_.contains(o,e)?e:void 0},o.prototype.getSubtotalInCentsForLicenseNames=function(t){var e,o,i,n,s,a,l;for(s=this.getAllLicensesForNames(t),o=this.getIncludedAddonsForLicenseNames(t),l=0,e=0,i=s.length;i>e;e++)n=s[e],a=n.license_name,r.call(o,a)<0&&(l+=n.price);return l},o.prototype.setSubtotal=function(t){var e;return e=this.getSubtotalInCentsForLicenseNames(t),this.ui.subtotalCalculation.html(this._formatMoney(e))},o.prototype.setDisabledElementsToAvailable=function(t){return _.each(t,function(t){return function(e){return t._setIncludedAddonElementToAvailable(e),t._setPriceToAvailable(e)}}(this))},o.prototype.setAvailableElementsToDisabled=function(t){return _.each(t,function(t){return function(e){return t._disableIncludedAddonElement(e),t._setPriceToDisabled(e)}}(this))},o.prototype.toggleExtendedLicense=function(t){return t.find(".checkbox").toggleClass("checked")},o.prototype._setIncludedAddonElementToAvailable=function(t){var e,o,i,r,n;return n=this.$(t),n.removeClass("extended_license_type--disabled"),e=n.find(".check-wrap"),e.removeClass("included_addon"),o=n.find(".checkbox"),o.removeClass("included_addon"),r=n.find(".extended_license_type__label_content"),r.removeClass("extended_license_type__label_content--disabled"),i=n.find(".license-info-icon"),i.removeClass("license-info-icon--disabled")},o.prototype._disableIncludedAddonElement=function(t){var e,o,i,r,n;return n=t,n.addClass("extended_license_type--disabled"),e=t.find(".check-wrap"),e.addClass("included_addon"),o=t.find(".checkbox"),o.addClass("included_addon"),r=t.find(".extended_license_type__label_content"),r.addClass("extended_license_type__label_content--disabled"),i=t.find(".license-info-icon"),i.addClass("license-info-icon--disabled")},o.prototype._setPriceToAvailable=function(t){var e,o,i,r;return o=[$(t).data("license")],e=_.first(this.getExtendedLicensesForNames(o)),i=e.price,r=$(t).find(".extended_license_type__price"),r.html(this._formatMoney(i))},o.prototype._setPriceToDisabled=function(t){var e,o,i,r;return o=[t.data("license")],e=_.first(this.getExtendedLicensesForNames(o)),i=0,r=t.find(".extended_license_type__price"),r.html(this._formatMoney(i))},o.prototype.hideFlyoutContainers=function(t){return this.$("#"+t+"_info").hide()},o.prototype.setupFlyouts=function(t){return this.findLicense(t).find(".license-info-icon").qtip({content:this.$("#"+t+"_info"),style:{classes:"licensing_flyout",def:!1,tip:{width:20,height:10,mimic:"right center"}},position:{my:"right center",at:"left center",viewport:$(window),effect:!1},hide:{delay:0,fixed:!0,event:"mouseout"}})},o.prototype._buttonType=function(){return this.model.isRightsManaged()?"request_to_license":this.model.isAvailableForImmediatePurchase()||this.model.isOwner()&&this.model.isSubmitted()?this._isBuyerExperience()?"add_to_cart":"download":this.model.isCreativeCommonsCompatible()?"creative_commons_licensed":this.model.isOwner()?"submit_to_prime":"request_to_license"},o.prototype._setInitialLicenseSelection=function(){var t,e;return e=this.licenseSelection.fetch(),e.forEach(function(t){return function(e){return t.findLicense(e).find('input[type="radio"]').prop("checked",!0),t.findLicense(e).find(".checkbox").addClass("checked")}}(this)),t=this.getIncludedAddonElementsForNames(e),this.setAvailableElementsToDisabled(t)},o.prototype._downloadPhoto=function(){var t,e,o;return e=this.getSelectedLicenseNames(),t=this.getSubtotalInCentsForLicenseNames(e),PxOptimizely.trackEvent("photo_download_button"),PxOptimizely.trackRevenue("photo_download_revenue",t),o=this.model.marketplaceLicenseUrl(e),window.open(o,"_blank")},o.prototype._isBuyerExperience=function(){return PxCurrentUser.isRolledOut("unification")&&null!=App.currentUser&&App.currentUser.isBuyer()},o.prototype._shouldShowRequestToLicenseModal=function(){return!App.currentUser||!$.cookie("dismiss_tooltip_request_to_license_"+App.currentUser.id)},o.prototype._licenseRequestButtonIsAddToCart=function(){return this._isBuyerExperience()&&!this._shouldShowRequestToLicenseModal()},o.prototype._onRequestToLicense=function(){var t;return this._shouldShowRequestToLicenseModal()?(t=new App.Photos.Views.RequestToLicenseModal({model:this.model,checkoutCallback:function(t){return function(){return t._downloadPhoto()}}(this)}),t.showModal(),this.listenToOnce(t,"dismissed",this.render)):this._isBuyerExperience()?void 0:this._downloadPhoto()},o.prototype._onRequestExclusive=function(){var t;return t=new App.Photos.Views.ExclusiveUseModal({model:this.model}),t.showModal(),!1},o.prototype._onFreePhotoDownload=function(t){var e;return null==App.currentUser?(e=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"download_free_photo",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"download_free_photo",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(e,"signup:success login:success",function(){return window.location.reload()}),e.showModal(),!1):!0},o.prototype._formatMoney=function(t){return App.Helpers.Numbers.formatMoney(t,this.model.get("currency"))},o}(Marionette.ItemView)}.call(this),function(){var t;t=null!=window.PxOptimizely?window.PxOptimizely:window.PxOptimizely={},t.trackEvent=function(t){return window.PxPhotoTracking?(null==window.optimizely&&(window.optimizely=[]),window.optimizely.push(["trackEvent",t])):void 0},t.trackRevenue=function(t,e){return window.PxPhotoTracking?(null==window.optimizely&&(window.optimizely=[]),window.optimizely.push(["trackEvent",t,{revenue:e}])):void 0},t.activateExperiment=function(t){return window.PxPhotoTracking?(null==window.optimizely&&(window.optimizely=[]),window.optimizely.push(["activate",t])):void 0}}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),t.SignupTeaser=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="signup_teaser_view",o.prototype.className="signup_teaser_view",o}(Marionette.ItemView)}.call(this),function(){var t,e,o,i,r=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function o(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},s={}.hasOwnProperty;i=App.module("Photos.Views"),t=$(window),i.PhotosLayout=function(i){function s(t){null==t&&(t={}),this._showRelatedPhotos=r(this._showRelatedPhotos,this),this._resizeContainer=r(this._resizeContainer,this),this._resizeContainerHeight=r(this._resizeContainerHeight,this),this._onKeyUp=r(this._onKeyUp,this),this._onKeyDown=r(this._onKeyDown,this),this.resize=r(this.resize,this),this._onClickOutside=r(this._onClickOutside,this),null==this.behaviors&&(this.behaviors={}),t.modal&&(this.behaviors.ModalDialog={closeButton:!1,closeOnRoute:!1,wrapperClass:"photos-modal-wrapper",dialogClass:"photos-modal-dialog",fullScreen:!0,closeOnEsc:!0}),s.__super__.constructor.apply(this,arguments)}return n(s,i),s.prototype.PRELOADED_IMAGE_SIZE=32,s.prototype.MAX_BUYER_MODE_CONTAINER_HEIGHT=650,s.prototype.MAX_BUYER_MODE_WIDTH=900,s.prototype.MAX_PHOTOGRAPHER_MODE_WIDTH=2048,s.prototype.KEYBOARD_SHORTCUTS={left:37,right:39,h:72,f:70,l:76,m:77,esc:27,a:65},s.prototype.CONSTRAINTS={topMargin:20,bottomMargin:34,horizontalMargin:40,photoPadding:20,minWidth:300,minHeight:600},s.prototype.template="photos_index_layout",s.prototype.className="photos_index_layout",s.prototype.ui={mainContainer:".main_container",tagsContainer:".tags_container",relatedContainer:".related_container",photoContainer:".photo_container",photo:".photo_container .photo",photoLoadingIndicator:".photo_container .loading",close:".close",overlay:".overlay",mobileCTA:".call-to-action",focus:".focus"},s.prototype.regions={adultContentRegion:".adult_content_region",sidebarRegion:".sidebar_region",photoFocusRegion:".photo-focus-region",tagsRegion:".tags-region",relatedPhotosRegion:".related_photos_region",relatedGalleriesRegion:".photos_layout__related_galleries_region",signupTeaserRegion:".signup_teaser_region",mobileCTARegion:".call-to-action"},s.prototype.events={"click @ui.close":"_onClickClose","click @ui.focus":"_triggerFocus","contextmenu @ui.overlay":"_onPhotoRightClicked","click .nav.left":"_navigateLeft","click .nav.right":"_navigateRight"},s.prototype.templateHelpers=function(){return{hasUnificationRollout:PxCurrentUser.isRolledOut("unification")}},s.prototype._onPhotoRightClicked=function(t){return this._loadingPhoto?void 0:(App.Photos.Views.PhotoCopyrightTooltip.showTooltip(this.photo,t),t.preventDefault())},s.prototype.initialize=function(t){var e,o,i,r,n;if(null==t&&(t={}),this.modal=null!=(o=t.modal)?o:!1,this.navigationContext=t.navigationContext,this.shouldUpdateUrl=null!=(i=t.shouldUpdateUrl)?i:!0,this.newComment=null!=(r=t.newComment)?r:App.controller.tidyIntParam("newComment"),this.GA=_.clone(t.GA),this.commenter=t.commenter,this.modal?(n=$("body").width(),$("body, .fix_width_on_modal").css("width",n+"px")):(e=App.controller.tidyEnumParam("from",App.Photos.Collections.PhotoNavigationFactory.prototype.GA_ENABLED_CONTEXTS),null!=e&&(this.GA={label:App.Photos.Collections.PhotoNavigationFactory.buildGALabel(e)})),null!=this.GA&&(this.GA.category="Photo Modal"),this._domReadyDfd=$.Deferred(),null==t.photoId)throw new Error("photoId cannot be found!");return this._getPhotoModelWithStates(t.photoId).done(function(t){return function(e){return t.isDestroyed?void 0:t._loadFirstPhotoAndContext(e)}}(this)).fail(function(t){return function(e){return t.isDestroyed?void 0:t._displayError()}}(this)),this.listenTo(App.vent,"showPhotoInPlace",function(t,e){return null==e&&(e={}),this._replacePhotoWithContext(t,e.navigationContext)}),this.listenTo(App.vent,"history:navigate:photo",function(t){return this._navigateToHistoryPhoto(t)}),this.listenTo(App.vent,"history:navigate:closePhoto",function(){return this.destroyModal()})},s.prototype._getPhotoModelWithStates=function(t){var e,o,i;return e=App.Photos.Models.PhotoManager.getCachedModelById(t),i=null!=e?e.isPrivate():void 0,o=App.Photos.Models.PhotoManager.getModelById(t,{favoriteAndLikeStates:null!=App.currentUser,licensingStates:!0,userFollowingStates:null!=App.currentUser,noFetch:i})},s.prototype._urlHistoryContainsPath=function(t){return _.some(this.urlHistory,function(e){return 0===e.indexOf(t)})},s.prototype._navigateToHistoryPhoto=function(t){if(null==t.photoId)throw new Error("photoId cannot be found!");if(this._urlHistoryContainsPath(window.location.pathname))for(;this.urlHistory.length>0&&0!==this.urlHistory[this.urlHistory.length-1].indexOf(window.location.pathname);)this.urlHistory.pop();else this.urlHistory.push(window.location.pathname);return this._getPhotoModelWithStates(t.photoId).done(function(t){return function(e){return t.isDestroyed?void 0:(t.navigationContext&&t.stopListening(t.navigationContext),t._fetchNavigationContext(App.Photos.Collections.PhotoNavigationFactory.build(e,!1,{photoId:e.id})).done(function(){return t._startNavigationSupport(e)}),t._showPhoto(e,{skipUrlUpdate:!0}))}}(this)).fail(function(t){return function(e){return t.isDestroyed?void 0:t._displayError()}}(this))},s.prototype._fetchNavigationContext=function(t){return null!=this._navCtxFetchXhr&&this._navCtxFetchXhr.abort(),this.navigationContext=t,this._navCtxFetchXhr=t.fetch()},s.prototype._replacePhotoWithContext=function(e,o){return this.navigationContext&&this.stopListening(this.navigationContext),this.navigationContext=o,this._startNavigationSupport(e),this._showPhoto(e),t.scrollTop(0)},s.prototype._loadFirstPhotoAndContext=function(t){return null!=this.navigationContext?this._startNavigationSupport(t):this._fetchNavigationContext(App.Photos.Collections.PhotoNavigationFactory.build(t,!1,{photoId:t.id})).done(function(e){return function(){return e._startNavigationSupport(t)}}(this)),this._domReadyDfd.done(function(e){return function(){return e.isDestroyed?void 0:e._showPhoto(t,{skipTitleUpdate:!e.modal,skipUrlUpdate:!e.modal})}}(this))},s.prototype._startNavigationSupport=function(t){return this.listenTo(this.navigationContext,"sync",function(t){return function(){return t._delayedNavigationRendering()}}(this)),this.navigationContext.selectPhoto(t),this._delayedNavigationRendering()},s.prototype._delayedNavigationRendering=function(){return this._domReadyDfd.done(function(t){return function(){return t.isDestroyed?void 0:(t._updateNavigationArrows(),t._preloadSurroundingPhotos())}}(this))},s.prototype.onRender=function(){return this.ui.mainContainer.toggleClass("modal_version",this.modal),this.ui.tagsContainer.toggleClass("modal_version",this.modal),this.focusView=new App.Photos.Views.PhotoFocus,this.listenTo(this.focusView,"focus:close",function(t){return function(){return t.ui.mainContainer.show(),t.ui.tagsContainer.show(),t.ui.relatedContainer.show(),t.ui.mobileCTA.show(),t._resizeContainer()}}(this)),this.listenTo(this.focusView,"focus:nav:left",function(t){return function(){return t._navigateLeft()}}(this)),this.listenTo(this.focusView,"focus:nav:right",function(t){return function(){return t._navigateRight()}}(this)),this.photoFocusRegion.show(this.focusView),this._viewedOnPhoneOrTablet()&&this.mobileCTARegion.show(new App.Helpers.MobileCTA({heading:this.ui.mobileCTA.i18n("heading",{"return":!0}),subheading:this.ui.mobileCTA.i18n("subheading",{"return":!0}),button:this.ui.mobileCTA.i18n("button",{"return":!0}),content:{androidPhone:"<img src='/assets/mobile_cta/stars.png' /><div>"+this.ui.mobileCTA.i18n("android-ratings",{"return":!0})+"</div>",androidTablet:"<img src='/assets/mobile_cta/stars.png' /><div>"+this.ui.mobileCTA.i18n("android-ratings",{"return":!0})+"</div>","default":"<img src='/assets/mobile_cta/stars.png' /><div>"+this.ui.mobileCTA.i18n("ratings",{"return":!0})+"</div>"}})),this.modal?this.$el.on("click",this._onClickOutside):void 0},s.prototype._onClickOutside=function(t){return t.target===this.el?this.destroyModal():void 0},s.prototype.onDomRefresh=function(){return this._domReadyDfd.resolve()},s.prototype.onShow=function(){return this.modal||t.on("resize",this.resize),$(document).on("keyup",this._onKeyUp),$(document).on("keydown",this._onKeyDown),this.modal&&(App.Photos.isModalOpened=!0),this._resizeContainerHeight()},s.prototype.onDestroy=function(){var e;return this.modal&&$("body, .fix_width_on_modal").css("width",""),this.$el.off("click"),this.modal||t.off("resize",this.resize),$(document).off("keyup",this._onKeyUp),$(document).off("keydown",this._onKeyDown),App.Photos.Views.PhotoCopyrightTooltip.removeExistingTooltip(),this._removeRelatedPhotosScrollListener(),this.modal?(e=window.location.pathname,!this._urlHistoryContainsPath(e)||""===App.Photos.previousUrl&&"/"===e?App.Photos.isModalOpened=!1:(this.scrollTop=$(window).scrollTop(),$(window).one("scroll",function(t){return function(e){return $(window).scrollTop(t.scrollTop)}}(this)),window.history.go(-1*this.urlHistory.length)),App.vent.trigger("photo_modal:close")):void 0},s.prototype.resize=function(){return this.isDestroyed?void 0:(this.photo&&this._resizeContainer(),this.trigger("resize"))},s.prototype._onClickClose=function(){return this.destroyModal()},s.prototype._onKeyDown=function(t){return t.which===this.KEYBOARD_SHORTCUTS.a&&t.shiftKey&&t.metaKey?App.vent.trigger("show:moderator_panel"):void 0},s.prototype._onKeyUp=function(t){var e,o;if("TEXTAREA"!==(e=t.target.tagName)&&"INPUT"!==e&&(o=_.last(App.Behaviors.ModalDialog.Manager.shownDialogs),null==o||o.view===this))switch(t.which){case this.KEYBOARD_SHORTCUTS.left:return this._navigateLeft();case this.KEYBOARD_SHORTCUTS.right:return this._navigateRight();case this.KEYBOARD_SHORTCUTS.h:case this.KEYBOARD_SHORTCUTS.m:return this._toggleFocusView();case this.KEYBOARD_SHORTCUTS.l:return this._toggleLike();case this.KEYBOARD_SHORTCUTS.f:return this._toggleLike();case this.KEYBOARD_SHORTCUTS.esc:if(this.focusView.active)return this._toggleFocusView(),t.preventDefault(),t.stopPropagation()}},s.prototype._toggleFocusView=function(){return this.focusView.active?this.focusView.closeFocusView():this._triggerFocus()},s.prototype._toggleLike=function(){var t;if(null!=this.photo&&!this._loadingPhoto&&!this.photo.isOwner()&&!this.photo.isPrivate())return t=function(t){return function(t,e){t&&App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this),this.photo.getLikeState()?(this.photo.unlike(t),this._sendGAEvent({action:"Unlike Button Clicked"})):(PxOptimizely.trackEvent("photo_like"),this.photo.like(t),this._sendGAEvent({action:"Like Button Clicked"}))},s.prototype._navigateLeft=function(){return this._navigateWithDelta(-1)},s.prototype._navigateRight=function(){return this._navigateWithDelta(1)},s.prototype._navigateWithDelta=function(t){var e,o;return null==t&&(t=1),!this.navigationContext||(e=this.navigationContext.selectedPhotoOffset()+t,0>e||e>=this.navigationContext.getLength())?void 0:(t>0?PxOptimizely.trackEvent("photo_right_arrow"):PxOptimizely.trackEvent("photo_left_arrow"),o=this.navigationContext.photoAt(e),this.navigationContext.selectPhoto(o),this._showPhoto(o),this._updateNavigationArrows())},s.prototype._updateNavigationArrows=function(){var t,e,o;return this.ui.overlay.toggleClass("logged-out",null==App.currentUser),t=this.navigationContext.selectedPhotoOffset(),e=0>=t,o=t>=this.navigationContext.getLength()-1,this.$(".nav.left").toggleClass("disabled",e),this.$(".nav.right").toggleClass("disabled",o),this.focusView.updateNavigationArrows(e,o)},s.prototype._resizeContainerStandalone=function(t,e,o){var i,r,n,s;return r=t-o-this.CONSTRAINTS.horizontalMargin-2*this.CONSTRAINTS.photoPadding,null==this._navHeight&&(this._navHeight=$(".main-nav").height()),i=e-this._navHeight-this.CONSTRAINTS.bottomMargin-2*this.CONSTRAINTS.photoPadding,s=PxCurrentUser.isRolledOut("unification")&&(null!=(n=App.currentUser)?n.isBuyer():void 0)&&i>this.MAX_BUYER_MODE_CONTAINER_HEIGHT,s&&(i=this.MAX_BUYER_MODE_CONTAINER_HEIGHT),{photoContainerWidth:r,photoContainerHeight:i}},s.prototype._resizeContainerModal=function(t,e,o){var i,r,n,s;return r=t-o-this.CONSTRAINTS.horizontalMargin,i=e-this.CONSTRAINTS.topMargin-this.CONSTRAINTS.bottomMargin,s=PxCurrentUser.isRolledOut("unification")&&(null!=(n=App.currentUser)?n.isBuyer():void 0)&&i>this.MAX_BUYER_MODE_CONTAINER_HEIGHT,s&&(i=this.MAX_BUYER_MODE_CONTAINER_HEIGHT),{photoContainerWidth:r,photoContainerHeight:i}},s.prototype._resizeContainerSingleCol=function(t,e,o,i){var r,n;return n=o,r=Math.floor(e*(n/t)),r>e&&(r=e),{photoContainerWidth:n,photoContainerHeight:r}},s.prototype._isSingleColLayout=function(){var e;return e=t.width(),this._viewedOnPhoneOrTablet()&&679>e},s.prototype._resizeContainerHeight=function(){var e,o,i,r,n,s;return n=t.height(),s=t.width(),i=this.$(".photo_sidebar").width(),null==this.scrollbarWidth&&(this.scrollbarWidth=s-$("body").width()),s-=this.scrollbarWidth,r=this._isSingleColLayout(),this.$el.toggleClass("single_col_layout",r),r||(o=this.modal?this._resizeContainerModal:this._resizeContainerStandalone,e=o.call(this,s,n,i),this.photoContainerWidth=e.photoContainerWidth,this.photoContainerHeight=e.photoContainerHeight,r)?void 0:this.ui.photoContainer.height(this.photoContainerHeight)},s.prototype._resizeContainer=function(){var e,o,i,r,n,s,a,l,u,p;return i=this.photo.get("height"),r=this.photo.get("width"),u=t.height(),p=t.width(),l=this._isSingleColLayout(),this._resizeContainerHeight(),l&&(n=this._resizeContainerSingleCol(r,i,p,u),this.photoContainerWidth=n.photoContainerWidth,this.photoContainerHeight=n.photoContainerHeight),l||(r>this.photoContainerWidth?(e=PxCurrentUser.isRolledOut("unification")&&(null!=(s=App.currentUser)?s.isBuyer():void 0),o=e?this.MAX_BUYER_MODE_WIDTH:this.MAX_PHOTOGRAPHER_MODE_WIDTH,a=r>=o&&this.photoContainerWidth>=o?i*(o/r):i*(this.photoContainerWidth/r)):a=i,a>this.photoContainerHeight&&(a=this.photoContainerHeight),this.ui.photo.css("margin-top",(this.photoContainerHeight-a)/2+"px")),this._updatePhotoSize()},s.prototype._updatePhotoSize=function(){var t,e,o,i,r,n,s;if(this.photo)return this._highRezImageLoaded?this.ui.photo.css({width:"auto",height:"auto"}):(e=this.photo.dimensionsForImageSize(this._highRezPhotoImageSize),s=e.width,r=e.height,n=s/r,t=this.photoContainerWidth/this.photoContainerHeight,n>=t?(i=Math.min(s,this.photoContainerWidth),o=Math.floor(i/n)):(o=Math.min(r,this.photoContainerHeight),i=Math.floor(n*o)),this.ui.photo.css({width:i,height:o}))},s.prototype._reset=function(){var t;return App.Photos.Views.PhotoCopyrightTooltip.removeExistingTooltip(),this._removeRelatedPhotosScrollListener(),this.tagsRegion.reset(),this.relatedGalleriesRegion.reset(),this.relatedPhotosRegion.reset(),this.adultContentRegion.reset(),null!=(t=this.focusView)&&t.reset(),this.ui.photo.hide(),this.ui.photoLoadingIndicator.hide(),_.delay(function(t){return function(){return t._loadingPhoto?t.ui.photoLoadingIndicator.show():void 0}}(this),200),this.photo&&(this.stopListening(this.photo),this.stopListening(this.photo.getRelatedPhotos()),this.photo.set(App.Photos.Views.AdultContentPlaceholder.ATTRIBUTE_NAME,!1)),this.photo=null,this._highRezImageLoaded=!1},s.prototype._getHighRezImageSize=function(){var e,o,i,r,n,s,a,l,u,p,c;if(this.photo.get("width")>this.photo.get("height")?(s=this.photo.get("width"),e=t.width()):(s=this.photo.get("height"),e=t.height()),(null!=(a=App.currentUser)?a.isBuyer():void 0)&&("undefined"!=typeof PxCurrentUser&&null!==PxCurrentUser?PxCurrentUser.isRolledOut("unification"):void 0))return 14;for(r=[{m:1e3,size:34},{m:1500,size:35},{m:2e3,size:36}],u=Math.max(1,null!=(l=window.devicePixelRatio)?l:1),u=Math.min(u,1.5),p=e*u,i=null,o=0,n=r.length;n>o;o++)if(c=r[o],c.m>=p&&this.photo.isImageDownloaded({size:c.size})){i=c;break}return i||(i=_.find(r,function(t){return t.m>=p})),i||(i=r[r.length-1]),i.size},s.prototype._startHighRezImageDownload=function(){var t,e,o,i,r;return t=this._getHighRezImageSize(),e=this.photo.getImagePathAndSize({size:t}),o=this.photo.getImagePathAndSize({size:this.PRELOADED_IMAGE_SIZE}),null==o||this.photo.isImageDownloaded({size:e.size})?(this.photoImageUrl=e.path,this.photoImageSize=e.size,void(this._highRezImageLoaded=!0)):(this.photoImageUrl=o.path,this.photoImageSize=o.size,this._highRezPhotoImageSize=e.size,this._highRezImageLoaded=!1,i=this.photo.id,r=this.photo.downloadImage({size:e.size}),r.done(function(t){return function(){var o;if(!t.isDestroyed&&i===t.photo.id)return t.photoImageUrl=e.path,t.photoImageSize=e.size,t._highRezImageLoaded=!0,t.ui.photo.one("load",function(){return t.isDestroyed||i!==t.photo.id?void 0:t._updatePhotoSize()}),t.ui.photo.attr("src",t.photoImageUrl),null!=(o=t.focusView)?o.updatePhoto(t.photo,t.photoImageUrl):void 0}}(this)))},s.prototype._displayError=function(){return App.Flash.error("Sorry, we cannot find this photo.")},s.prototype._showPhoto=function(t,e){var o;return null==e&&(e={}),this._reset(),this._loadingPhoto=!0,this.photo=t,this._startHighRezImageDownload(),o=App.Photos.Models.PhotoManager.getModelById(t.id,{favoriteAndLikeStates:null!=App.currentUser,licensingStates:!0,userFollowingStates:null!=App.currentUser,noFetch:this.photo.get("privacy")}),o.done(function(t){return function(o){var i;if(!t.isDestroyed)return t.photo=o,i=t.photo.getUser(),i&&i.get("analytics_code")&&i.hasGATrackingEnabled()&&PxApp.GA.send_custom_pageview(i.get("analytics_code"),t.photo.get("url")),t._displayAndResizeCurrentPhoto(e)}}(this)).fail(function(t){return function(e){return t.isDestroyed?void 0:t._displayError()}}(this))},s.prototype._triggerFocus=function(){var t;if(!(PxCurrentUser.isRolledOut("unification")&&(null!=(t=App.currentUser)?t.isBuyer():void 0)))return this.ui.tagsContainer.hide(),this.ui.relatedContainer.hide(),this.ui.mobileCTA.hide(),_.delay(function(t){return function(){return t.focusView.active?t.ui.mainContainer.hide():void 0}}(this),300),PxOptimizely.trackEvent("photo_open_focus"),this.focusView.openFocusView()},s.prototype._photoAltText=function(t){return t.get("name")+" by "+t.getUser().get("fullname")+" on 500px"},s.prototype._showRelatedGalleries=function(){var t;return t=new App.Photos.Collections.RelatedGalleries([],{photo:this.photo,rpp:3}),t.fetch().done(function(e){return function(){return 0!==t.length?e.relatedGalleriesRegion.show(new App.Photos.Views.RelatedGalleriesForPhoto({collection:t})):void 0}}(this))},s.prototype._isRelatedPhotoSectionVisible=function(){var e;return this._viewedOnPhoneOrTablet()?!1:null!=this.focusView&&this.focusView.active?!1:(e=this.$(this.relatedPhotosRegion.el).offset().top,e<t.scrollTop()+t.innerHeight())},s.prototype._viewedOnPhoneOrTablet=function(){return null==this.$body&&(this.$body=$("body")),this.$body.hasClass("smartphone")||this.$body.hasClass("tablet");
},s.prototype._showRelatedPhotos=function(){return this._isRelatedPhotoSectionVisible()&&!this.shouldHideRelatedPhotos?(this._removeRelatedPhotosScrollListener(),this.photo.getRelatedPhotos().fetch(),this.relatedPhotosRegion.show(new e({collection:this.photo.getRelatedPhotos(),modal:this.modal}))):void 0},s.prototype._setRelatedPhotosScrollListener=function(){return null==this.$target&&(this.$target=this.modal?$(".photos-modal-wrapper"):t),this.$target.on("scroll",this._showRelatedPhotos)},s.prototype._removeRelatedPhotosScrollListener=function(){var t;return null!=(t=this.$target)?t.off("scroll",this._showRelatedPhotos):void 0},s.prototype._showRelatedPhotosCTA=function(){var t;return t=new o,this.relatedPhotosRegion.show(t),this.listenTo(t,"show:related_photos",function(t){return function(){return t.shouldHideRelatedPhotos=!1,t._showRelatedPhotos()}}(this))},s.prototype._showSignupTeaser=function(){return this._viewedOnPhoneOrTablet()?void 0:null==App.currentUser&&null==this.signupTeaserRegion.currentView?this.signupTeaserRegion.show(new App.Views.SignupTeaser):void 0},s.prototype._displayAndResizeCurrentPhoto=function(t){var e,o,i,r,n;return null==t&&(t={}),this._loadingPhoto=!1,this._highRezImageLoaded?null!=(e=this.focusView)&&e.updatePhoto(this.photo,this.photoImageUrl):null!=(o=this.focusView)&&o.updatePhoto(this.photo,this.photoImageUrl,this._highRezPhotoImageSize),this.sidebarRegion.show(new App.Photos.Views.Sidebar({model:this.photo,newComment:this.newComment,GA:this.GA,commenter:this.commenter})),this.photo.get("nsfw")&&!(null!=(i=App.currentUser)?i.get("show_nude"):void 0)&&(this.adultContentRegion.show(new App.Photos.Views.AdultContentPlaceholder({model:this.photo})),this.listenToOnce(this.photo,"change:"+App.Photos.Views.AdultContentPlaceholder.ATTRIBUTE_NAME,function(t){return function(){return t.adultContentRegion.reset()}}(this))),this._resizeContainer(),this.ui.photo.attr("src",this.photoImageUrl).attr("alt",this._photoAltText(this.photo)).show(),this.shouldHideRelatedPhotos=null!=(r=this.navigationContext)?r.shouldHideRelatedPhotos():void 0,this._viewedOnPhoneOrTablet()||this.photo.isPrivate()||((null!=(n=this.photo.get("tags"))?n.length:void 0)&&this.tagsRegion.show(new App.Photos.Views.Tags({model:this.photo})),this._showRelatedGalleries(),this.shouldHideRelatedPhotos?this._showRelatedPhotosCTA():this._setRelatedPhotosScrollListener()),t.skipUrlUpdate||this._updateUrl(),t.skipTitleUpdate||App.setTitle(this.photo.get("name")),this._showSignupTeaser(),this._preloadSurroundingPhotos()},s.prototype._preloadSurroundingPhotos=function(){var t,e,o,i,r,n,s,a,l;if(t=this.navigationContext.selectedPhotoOffset(),t>=0){for(i=[],a=[-1,1,2,3],l=[],o=0,r=a.length;r>o;o++)e=a[o],n=t+e,0>n||n>=this.navigationContext.getLength()||(s=this.navigationContext.photoAt(n),i.push(s.id),l.push(s.prefetchImage({size:this.PRELOADED_IMAGE_SIZE})));return l}},s.prototype._updateUrl=function(){var t,e;return e=this.photo.get("url"),t=this.navigationContext.buildBrowserUrlParams(),_.isEmpty(t)||(e=e+"?"+$.param(t)),null==this.urlHistory&&(this.urlHistory=[]),this.urlHistory.push(e),this.shouldUpdateUrl&&App.router.navigate(e),this.shouldUpdateUrl=!0},s.prototype._sendGAEvent=function(t){var e;return null==t&&(t={}),_.isObject(this.GA)?(e=_.extend({},this.GA,t),PxApp.GA.event(e)):void 0},s}(Marionette.LayoutView),i.AdultContentPlaceholder=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.ATTRIBUTE_NAME="adultShown",e.prototype.template="adult_content_placeholder",e.prototype.className="adult_content_placeholder",e.prototype.ui={showAdult:".show_adult"},e.prototype.events={"click @ui.showAdult":"onShowAdultClicked"},e.prototype.onShowAdultClicked=function(){return this.model.set(i.AdultContentPlaceholder.ATTRIBUTE_NAME,!0)},e}(Marionette.ItemView),i.PhotoCopyrightTooltip=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.id="photo_copyright_tooltip",e.prototype.template="photo_copyright_tooltip",e.prototype.className="photo-copyright-tooltip",e.prototype.events={"contextmenu *":function(t){return t.preventDefault()}},e.showTooltip=function(t,e){var o,r,n;return i.PhotoCopyrightTooltip.removeExistingTooltip(),n=new i.PhotoCopyrightTooltip({model:t,event:e}),n.render(),n.$el.css({left:null!=(o=e.pageX)?o:e.clientX+document.scrollLeft,top:null!=(r=e.pageY)?r:e.clientY+document.scrollTop}),$("body").append(n.$el),PxApp.GA.event({category:"Photo",action:"Copyright Tooltip"})},e.removeExistingTooltip=function(){return $("#"+i.PhotoCopyrightTooltip.prototype.id).remove()},e.prototype.onRender=function(){return _.delay(function(t){return function(){return t._teardown()}}(this),1800)},e.prototype._teardown=function(){return this.$el.fadeOut("fast",function(t){return function(){return t.$el.remove()}}(this))},e}(Marionette.ItemView),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.template="related_photos_cta",e.prototype.className="related_photos_cta",e.prototype.triggers={"click .show_related":"show:related_photos"},e}(Marionette.LayoutView),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.template="related_photos_view",e.prototype.className="related_photos_view",e.prototype.ui={title:".related_photos_header"},e.prototype.initialize=function(t){return null==t&&(t={}),this.modal=t.modal,this.listenTo(this.collection,"add",this._showTitle)},e.prototype.regions={gridRegion:".grid"},e.prototype.onRender=function(){var t,e;return t={collection:this.collection,eventName:"showPhotoInPlace",hasHoverState:!0,waitThumbnailsLoad:!1},this.modal&&(t.scrollContainer=this.$el.closest(".photos-modal-wrapper")),e=new App.Photos.Views.FullAspectRatioPhotoGrid(t),this.gridRegion.show(e),null==App.currentUser?e.pauseInfiniteScroll():void 0},e.prototype.onAttach=function(){return this.ui.title.hide()},e.prototype._showTitle=function(){return this.ui.title.show()},e}(Marionette.LayoutView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Views"),t.GalleryCardView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.tagName="div",o.prototype.template="gallery_card_view",o.prototype.className="gallery_card_view px_card medium no_badge",o.prototype.ui={galleryPhotoCount:".gallery_card_view__photo_count",privateIcon:".gallery_card_view__private_icon",nameWrapper:".gallery_card_view__name_wrapper"},o.prototype.templateHelpers=function(){var t,e,o,i;return t=this.showNSFWplaceholder?"":null!=(e=this.model.get("cover_photo"))&&null!=(o=e[0])?o.url:void 0,i=this.model.isPrivate()?this.model.getCanonicalPath():userPath(this.user)+"/galleries/"+this.model.get("custom_path"),{imageUrl:t,href:i,isPrivate:this.model.isPrivate(),includeAvatar:this.includeAvatar,avatar:this.user.userpic_https_url,avatarUrl:userPath(this.user),userFullName:this.user.fullname,containsOwnerPhotosOnly:this.model.containsOwnerPhotosOnly()}},o.prototype.initialize=function(t){var e,o,i,r,n;if(n=null!=(o=null!=(i=App.currentUser)?i.get("show_nude"):void 0)?o:!1,e=this.model.get("cover_photo").length>0&&this.model.get("cover_photo")[0].nsfw,this.showNSFWplaceholder=!n&&e,this.includeAvatar=t.includeAvatar,this.user=null!=(r=this.options.user)?r:this.model.get("user"),null==this.user)throw new Error("@user is missing")},o.prototype.onRender=function(){var t;return this.includeAvatar||this.$el.addClass("no_avatar"),t=this.model.containsOwnerPhotosOnly()?"photos-by":"curated-by",this.showNSFWplaceholder&&this.$el.addClass("nsfw_placeholder"),this.ui.galleryPhotoCount.i18n(t,{count:this.model.get("items_count")}),this.model.isPrivate()&&this.ui.privateIcon.addClass("gallery_card_view__private_icon--visible"),this.$el.data("id",this.model.id)},o}(Marionette.ItemView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Views"),t.RelatedGalleriesForPhoto=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="related_galleries_for_photo",o.prototype.className="related_galleries_for_photo",o.prototype.childView=App.Views.GalleryCardView,o.prototype.childViewContainer=".cards_container",o.prototype.childViewOptions={includeAvatar:!0},o.prototype.ui={loadMore:".related_galleries_for_photo__load_more_cta",seeMorePill:".related_galleries_for_photo__see_more_cta"},o.prototype.behaviors={HasButtons:{"@ui.loadMore":"_loadMoreRelatedGalleries","@ui.seeMorePill":"_loadFirstRelatedGalleries"}},o.prototype.NUM_RELATED_GALLERIES_PER_PAGE=10,o.prototype.onRender=function(){return this._updateSeeMorePill()},o.prototype._loadFirstRelatedGalleries=function(){return this.listenTo(this.collection,"sync",this._updateShowMoreButton),this.collection.rpp=this.NUM_RELATED_GALLERIES_PER_PAGE,this.collection.fetch().done(function(t){return function(){return t._updateSeeMorePill()}}(this))},o.prototype._loadMoreRelatedGalleries=function(){return this.collection.nextPage()},o.prototype._updateSeeMorePill=function(){return this.collection.length<=3&&!this.collection.finished()?this.ui.seeMorePill.show():this.ui.seeMorePill.hide()},o.prototype._updateShowMoreButton=function(){return this.collection.length>3&&!this.collection.finished()?this.ui.loadMore.show():this.ui.loadMore.hide()},o}(Marionette.CompositeView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Photos.Views"),t.RequestToLicenseModal=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="request_to_license_modal",o.prototype.className="action_modal request_to_license_modal",o.prototype.ui={closeButton:".close",checkoutButton:".checkout",searchButton:".search",checkbox:".checkbox_input",footer:".footer"},o.prototype.behaviors={ModalDialog:!0,HasButtons:{"@ui.closeButton":"onCloseClicked","@ui.checkoutButton":"onCheckoutClicked","@ui.searchButton":"onSearchClicked"},HasAddToCartButton:{withText:!0}},o.prototype.events={"change @ui.checkbox":"onCheckChange"},o.prototype.modelEvents={"cart:update":"onAddToCartClicked"},o.prototype.templateHelpers=function(){return{isBuyerExperience:PxCurrentUser.isRolledOut("unification")&&null!=App.currentUser&&App.currentUser.isBuyer()}},o.prototype.initialize=function(t){return o.__super__.initialize.apply(this,arguments),this.checkoutCallback=t.checkoutCallback},o.prototype.resize=function(){return $(window).width()<=685?this.$el.width($(window).width()-20):this.$el.width(685),this.trigger("resize")},o.prototype.onAddToCartClicked=function(){return this._setDismissalCookie(),this._close()},o.prototype.onCheckoutClicked=function(){return this._setDismissalCookie(),this._close(),this.checkoutCallback()},o.prototype.onSearchClicked=function(){return this._setDismissalCookie(),this._close(),window.open("https://marketplace.500px.com/search/availability=prime,subprime,editorial,subeditorial","_blank")},o.prototype.onCheckChange=function(t){return this.dismissModal=t.target.checked},o.prototype.onCloseClicked=function(){return this._close()},o.prototype._close=function(){return this.destroyModal()},o.prototype._setDismissalCookie=function(){return this.dismissModal&&null!=App.currentUser?($.cookie("dismiss_tooltip_request_to_license_"+App.currentUser.id,1,{expires:365,path:"/"}),this.trigger("dismissed")):void 0},o}(Marionette.LayoutView)}.call(this),function(t,e){function o(t,e,o){var i=t.children(),r=!1;t.empty();for(var s=0,a=i.length;a>s;s++){var l=i.eq(s);if(t.append(l),o&&t.append(o),n(t,e)){l.remove(),r=!0;break}o&&o.detach()}return r}function i(e,o,s,a,l){var u=!1,p="a table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",c="script, .dotdotdot-keep";return e.contents().detach().each(function(){var h=this,d=t(h);if("undefined"==typeof h||3==h.nodeType&&0==t.trim(h.data).length)return!0;if(d.is(c))e.append(d);else{if(u)return!0;e.append(d),!l||d.is(a.after)||d.find(a.after).length||e[e.is(p)?"after":"append"](l),n(s,a)&&(u=3==h.nodeType?r(d,o,s,a,l):i(d,o,s,a,l),u||(d.detach(),u=!0)),u||l&&l.detach()}}),u}function r(e,o,i,r,a){var p=e[0];if(!p)return!1;var h=u(p),d=-1!==h.indexOf(" ")?" ":"\u3000",_="letter"==r.wrap?"":d,m=h.split(_),g=-1,f=-1,y=0,v=m.length-1;for(r.fallbackToLetter&&0==y&&0==v&&(_="",m=h.split(_),v=m.length-1);v>=y&&(0!=y||0!=v);){var w=Math.floor((y+v)/2);if(w==f)break;f=w,l(p,m.slice(0,f+1).join(_)+r.ellipsis),n(i,r)?(v=f,r.fallbackToLetter&&0==y&&0==v&&(_="",m=m[0].split(_),g=-1,f=-1,y=0,v=m.length-1)):(g=f,y=f)}if(-1==g||1==m.length&&0==m[0].length){var b=e.parent();e.detach();var P=a&&a.closest(b).length?a.length:0;b.contents().length>P?p=c(b.contents().eq(-1-P),o):(p=c(b,o,!0),P||b.detach()),p&&(h=s(u(p),r),l(p,h),P&&a&&t(p).parent().append(a))}else h=s(m.slice(0,g+1).join(_),r),l(p,h);return!0}function n(t,e){return t.innerHeight()>e.maxHeight}function s(e,o){for(;t.inArray(e.slice(-1),o.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),o.lastCharacter.noEllipsis)<0&&(e+=o.ellipsis),e}function a(t){return{width:t.innerWidth(),height:t.innerHeight()}}function l(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function u(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function p(t){do t=t.previousSibling;while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function c(e,o,i){var r,n=e&&e[0];if(n){if(!i){if(3===n.nodeType)return n;if(t.trim(e.text()))return c(e.contents().last(),o)}for(r=p(n);!r;){if(e=e.parent(),e.is(o)||!e.length)return!1;r=p(e[0])}if(r)return c(t(r),o)}return!1}function h(e,o){return e?"string"==typeof e?(e=t(e,o),e.length?e:!1):e.jquery?e:!1:!1}function d(t){for(var e=t.innerHeight(),o=["paddingTop","paddingBottom"],i=0,r=o.length;r>i;i++){var n=parseInt(t.css(o[i]),10);isNaN(n)&&(n=0),e-=n}return e}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return t.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var r=this;r.data("dotdotdot")&&r.trigger("destroy.dot"),r.data("dotdotdot-style",r.attr("style")||""),r.css("word-wrap","break-word"),"nowrap"===r.css("white-space")&&r.css("white-space","normal"),r.bind_events=function(){return r.bind("update.dot",function(e,a){e.preventDefault(),e.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:d(r),l.maxHeight+=l.tolerance,"undefined"!=typeof a&&(("string"==typeof a||"nodeType"in a&&1===a.nodeType)&&(a=t("<div />").append(a).contents()),a instanceof t&&(s=a)),m=r.wrapInner('<div class="dotdotdot" />').children(),m.contents().detach().end().append(s.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var p=!1,c=!1;return u.afterElement&&(p=u.afterElement.clone(!0),p.show(),u.afterElement.detach()),n(m,l)&&(c="children"==l.wrap?o(m,l,p):i(m,r,m,l,p)),m.replaceWith(m.contents()),m=null,t.isFunction(l.callback)&&l.callback.call(r[0],c,s),u.isTruncated=c,c}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(r[0],u.isTruncated),u.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(r[0],s),s}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),r.unwatch().unbind_events().contents().detach().end().append(s).attr("style",r.data("dotdotdot-style")||"").data("dotdotdot",!1)}),r},r.unbind_events=function(){return r.unbind(".dot"),r},r.watch=function(){if(r.unwatch(),"window"==l.watch){var e=t(window),o=e.width(),i=e.height();e.bind("resize.dot"+u.dotId,function(){o==e.width()&&i==e.height()&&l.windowResizeFix||(o=e.width(),i=e.height(),c&&clearInterval(c),c=setTimeout(function(){r.trigger("update.dot")},100))})}else p=a(r),c=setInterval(function(){if(r.is(":visible")){var t=a(r);(p.width!=t.width||p.height!=t.height)&&(r.trigger("update.dot"),p=t)}},500);return r},r.unwatch=function(){return t(window).unbind("resize.dot"+u.dotId),c&&clearInterval(c),r};var s=r.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,e),u={},p={},c=null,m=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),u.afterElement=h(l.after,r),u.isTruncated=!1,u.dotId=_++,r.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&r.watch(),r},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","\u3000",",",";",".","!","?"],noEllipsis:[]}},t.fn.dotdotdot.debug=function(t){};var _=1,m=t.fn.html;t.fn.html=function(o){return o!=e&&!t.isFunction(o)&&this.data("dotdotdot")?this.trigger("update",[o]):m.apply(this,arguments)};var g=t.fn.text;t.fn.text=function(o){return o!=e&&!t.isFunction(o)&&this.data("dotdotdot")?(o=t("<div />").text(o).html(),this.trigger("update",[o])):g.apply(this,arguments)}}}(jQuery),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Behaviors"),t.HasAddToCartButton=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.defaults={withText:!1},o.prototype.ui={addToCartButton:".add_to_cart"},o.prototype.events={"click @ui.addToCartButton":"addToCart"},o.prototype.initialize=function(){return o.__super__.initialize.apply(this,arguments),this.isAdding=!1,this.licenseSelection=App.Models.LicenseSelection.instance()},o.prototype.addToCart=function(){var t,e,o,i,r;return this.isAdding?!1:(e=this.view.model,o=e.get("id"),t=this.licenseSelection.fetchForPhoto(e),PxCurrentUser.isRolledOut("unification")&&(null!=(i=App.currentUser)?i.isBuyer():void 0)?this.isAdding||PxTopnav.Services.CartHelper.isPhotoInCart(o)?(document.location=PxTopnav.PRIME_URL+"/cart",!1):(this.isAdding=!0,this.options.withText&&this.ui.addToCartButton.i18n("proceed-to-checkout"),PxTopnav.Services.CartHelper.add(this.view.model.get("id"),t).fail(function(t){return function(){var e,o;return e=(o=App.Helpers.API).parseError.apply(o,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(e)),t.options.withText?t.ui.addToCartButton.i18n("add-to-cart"):void 0}}(this)).always(function(t){return function(){return e.trigger("cart:update"),t.isAdding=!1}}(this)),!1):(r=e.marketplaceLicenseUrl(t),window.open(r,"_blank"),!1))},o.prototype.onRender=function(){var t,e;return PxCurrentUser.isRolledOut("unification")&&(null!=(e=App.currentUser)?e.isBuyer():void 0)||this.ui.addToCartButton.addClass("download"),this.options.withText?(t=this.view.model.get("id"),PxTopnav.Services.CartHelper.load().done(function(e){return function(){var o;return o=PxTopnav.Services.CartHelper.isPhotoInCart(t)?"proceed-to-checkout":"add-to-cart",e.ui.addToCartButton.i18n(o)}}(this))):void 0},o}(Marionette.Behavior)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Behaviors"),t.HasFollowButton=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(t){return t!==!0?this.options=t:void 0},o.prototype.onRender=function(){var t,e,o,i;return i=null!=(o=this.options.target)?o:".follow-button",this.view.$(i).length>0?(null==this.view.followButton&&this.view.addRegion("followButton",i),e=$.isFunction(this.options.model)?this.options.model.call(this.view):this.view.model,t=new App.Behaviors.FollowButton({model:e,parentView:this.view,options:this.options}),this.view.followButton.show(t)):void 0},o}(Marionette.Behavior),t.FollowButton=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="has_follow_button",o.prototype.ui={button:".button",followingButton:".button.following"},o.prototype.behaviors={HasButtons:{"@ui.button":"onClick"}},o.prototype.events={"mouseenter @ui.followingButton":"onHover","mouseleave @ui.followingButton":"onHoverOut"},o.prototype.initialize=function(t){if(this.parentView=t.parentView,this.options=t.options,!$.isFunction(this.model.isSelf))throw new Error("Model does not define required function: isSelf()");if(!$.isFunction(this.model.getFollowState))throw new Error("Model does not define required function: getFollowState()");if(!$.isFunction(this.model.follow))throw new Error("Model does not define required function: follow()")},o.prototype.modelEvents={"follow_button:change:following":"onRender"},o.prototype.onRender=function(){return null!=this.options["class"]&&this.ui.button.addClass(this.options["class"]),this._changeState(this.model.getFollowState())},o.prototype.onHover=function(){return this.followState?this.ui.followingButton.i18n("unfollow"):void 0},o.prototype.onHoverOut=function(){return this.followState?this.ui.followingButton.i18n("following"):void 0},o.prototype.onClick=function(){var t;if(!this.model.isSelf())return null!=App.currentUser?!this.followState&&App.Views.PublicActionModal.shouldShow()?(t=new App.Views.PublicActionModal({callback:function(t){return function(){return t._togglefollow()}}(this)}),t.showModal()):this._togglefollow():this._handleVisitor()},o.prototype._handleVisitor=function(){var t,e,o,i;return this.parentView.trigger("follow:signup"),e=App.Helpers.deviceType(),/^ip/.test(e)?(t="px://500px.com/user/"+this.model.id,i=App.Helpers.appLink(e),App.Helpers.openOrDownloadApp(t,i)):/^android/.test(e)?window.location=App.Helpers.appLink(e):(o=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"follow",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"follow",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(o,"signup:success",function(){return this.model.follow(function(t){return function(e,o){return null!=t.options.signup?t.options.signup.call(t.view):window.location.reload()}}(this))}),this.listenToOnce(o,"login:success",function(){return this.model.follow(function(t){return function(e,o){return null!=t.options.login?t.options.login.call(t.view):window.location.reload()}}(this))}),o.showModal())},o.prototype._togglefollow=function(){var t;return t=this.followState===!1?"follow":"unfollow",this.parentView.trigger(t+":before"),this.model[t].call(this.model,function(e){return function(o,i){return o?(e.parentView.trigger(t+":error"),App.Flash.error(App.Helpers.API.getErrorMessage(o))):(e.parentView.trigger(t+":after"),e._changeState(i),e.model.trigger("follow_button:change:following"))}}(this))},o.prototype._changeState=function(t){return this.followState=t,this.parentView.$el.toggleClass("following",this.followState),this.parentView.$el.toggleClass("self",this.model.isSelf()),this.parentView.trigger("follow_button:change:after",t)},o}(Marionette.ItemView)}.call(this),function(){var t,e,o;t=null!=(e=null!=(o="undefined"!=typeof App&&null!==App?App.module("Lib"):void 0)?o:PxApp)?e:window,t.PopupHelper=function(){function t(){}return t.prototype.coords=function(t,e){var o,i;return o=screen.width/2-t/2,i=screen.height/2-e/2,"left="+o+",top="+i+",width="+t+",height="+e},t.prototype.open=function(t,e,o,i,r){var n,s,a;return null==r&&(r={}),null==r.resizable&&(r.resizable=!1),null==r.toolbar&&(r.toolbar=!1),null==r.menubar&&(r.menubar=!1),null==r.status&&(r.status=!1),null==r.location&&(r.location=!1),null==r.scrollbars&&(r.scrollbars=!1),r=function(){var t;t=[];for(n in r)a=r[n],t.push(n+"="+(a?1:0));return t}(),s=this.coords(o,i)+","+r.join(","),window.open(t,e,s)},t}()}.call(this),function(){var t,e,o,i=function(t,e){return function(){return t.apply(e,arguments)}};t=null!=(e=null!=(o="undefined"!=typeof App&&null!==App?App.module("Lib"):void 0)?o:PxApp)?e:window,t.Sharelizer=function(){function e(e){this.twitterUrl=i(this.twitterUrl,this);var o;if(this.url=e.url,this.category=e.category,this._lightbox=e.lightbox,!this.category)throw"Category required";if(!this.url)throw"URL required";this.popup=null!=(o=e.popup)?o:new t.PopupHelper}var o;return o=["twitter","facebook","pinterest","google"],e.prototype.logGaEvent=function(t,e){var o,i;return null==e&&(e={}),PxApp.GA.event({category:null!=(o=e.category)?o:this.category,action:null!=(i=e.action)?i:"Share with "+t})},e.prototype.utmUrl=function(t){return PxApp.GA.url_with_utm_tags(this.url,{utm_medium:t})},e.prototype.vk=function(t){return null==t&&(t={}),this.logGaEvent("vk",t),this.popup.open(this.vkUrl(),"vk_share",550,400,{resizable:!0})},e.prototype.google=function(t){return null==t&&(t={}),this.logGaEvent("google",t),this.popup.open(this.googleUrl(),"google_share",550,400,{resizable:!0})},e.prototype.facebook=function(t,e){return null==e&&(e={}),this.logGaEvent("facebook",e),this.popup.open(this.facebookUrl(t),"facebook",660,380)},e.prototype.stumbleupon=function(t,e){return null==e&&(e={}),this.logGaEvent("stumbleupon",e),this.popup.open(this.stumbleuponUrl(t),"stumbleupon",660,380)},e.prototype.pinterest=function(t,e,o){return null==o&&(o={}),this.logGaEvent("pinterest",o),this.popup.open(this.pinterestUrl(t,e),"pinterest_share",630,270)},e.prototype.twitter=function(t,e){return null==e&&(e={}),this.logGaEvent("twitter",e),this.popup.open(this.twitterUrl(t),"twitter",550,400,{resizable:!0})},e.prototype.weibo=function(t,e){return null==e&&(e={}),this.logGaEvent("weibo",e),this.popup.open(this.weiboUrl(t),"weibo_share",630,270)},e.prototype.qzone=function(t,e){return null==e&&(e={}),this.logGaEvent("qzone",e),this.popup.open(this.qzoneUrl(t),"qzone_share",630,270)},e.prototype.renren=function(t,e){return null==e&&(e={}),this.logGaEvent("renren",e),this.popup.open(this.renrenUrl(t),"renren_share",630,270)},e.prototype.douban=function(t,e){return null==e&&(e={}),this.logGaEvent("douban",e),this.popup.open(this.doubanUrl(t),"douban_share",630,270)},e.prototype.huaban=function(t,e){return null==e&&(e={}),this.logGaEvent("huaban",e),this.popup.open(this.huabanUrl(t),"huaban_share",630,270)},e.prototype.email=function(t){var e;return null==t.email&&(t.email=null!=(e="undefined"!=typeof current_user&&null!==current_user?current_user.get("email"):void 0)?e:$.cookie("email")),this.lightbox(new PxApp.Views.Ui.Prompts.ShareByEmail(t))},e.prototype.embed=function(t){return this.lightbox(new PxApp.Views.Photos.EmbedPrompt(t))},e.prototype.lightbox=function(t){var e;return e=new Px.Views.Shared.Lightbox({type:"html",view:t}),this._lightbox.show(e)},e.prototype.vkUrl=function(){return"https://vk.com/share.php?"+$.param({url:this.utmUrl("vk")})},e.prototype.stumbleuponUrl=function(t){return"http://www.stumbleupon.com/submit?"+$.param({url:this.utmUrl("stumbleupon"),title:t.title})},e.prototype.googleUrl=function(){return"https://plus.google.com/share?"+$.param({url:this.utmUrl("googleplus")})},e.prototype.facebookUrl=function(t){var e;return e={u:this.utmUrl("facebook")},null!=t&&(e.t=t),"http://www.facebook.com/sharer.php?"+$.param(e)},e.prototype.pinterestUrl=function(t,e){return"https://www.pinterest.com/pin/create/button/?"+$.param({url:this.utmUrl("pinterest"),media:t,description:e})},e.prototype.twitterUrl=function(t){return"https://twitter.com/intent/tweet?"+$.param({url:this.utmUrl("twitter"),text:t})},e.prototype.weiboUrl=function(t){var e;return e={url:this.utmUrl("weibo"),count:"1",appkey:"637776580",ralateUid:"5186527104"},t=_.extend(e,t),"http://service.weibo.com/share/share.php?"+$.param(t)},e.prototype.qzoneUrl=function(t){var e;return e={url:this.utmUrl("qzone"),showcount:"1",desc:"",summary:"\u6765\u81ea\u9ad8\u7aef\u6444\u5f71\u793e\u533a 500px.com",site:"500px.com"},t=_.extend(e,t),"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+$.param(t)},e.prototype.renrenUrl=function(t){var e;return e={resourceUrl:this.utmUrl("renren"),srcUrl:"https://500px.com",showcount:"1",description:"\u6765\u81ea\u9ad8\u7aef\u6444\u5f71\u793e\u533a 500px.com"},t=_.extend(e,t),"http://widget.renren.com/dialog/share?"+$.param(e)},e.prototype.doubanUrl=function(t){var e;return e={href:this.utmUrl("douban"),text:"\u6765\u81ea\u9ad8\u7aef\u6444\u5f71\u793e\u533a 500px.com",source:"500px.com",v:1},t=_.extend(e,t),"http://www.douban.com/share/service/?"+$.param(t)},e.prototype.huabanUrl=function(t){return null==t.url&&(t.url=this.utmUrl("huaban")),"http://huaban.com/bookmarklet/?"+$.param(t)},e.prototype.twitterMention=function(t){var e,o;return e=t.get("contacts"),e&&(o=e.twitter,o&&!o.match(/^\s+$/))?" (@"+o+")":""},e}()}.call(this),function(){var t,e,o=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;e=App.module("Behaviors"),e.HasSharelizers=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return o(i,e),i.prototype.onRender=function(){var e,o;return e=this.view.$(".sharelizer-button"),e.length>0?(o=[],_.each(e,function(e){return function(i,r){var n,s,a;return n=$(i).data("provider"),s="share"+n+"Button",e.view.addRegion(s,".sharelizer-button[data-provider="+n+"]"),a=new t({model:e.view.model,provider:n}),o.push(n),e.view[s].show(a)}}(this))):void 0},i}(Marionette.Behavior),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.template="sharelizer_button",e.prototype.tagName="a",e.prototype.className="button",e.prototype.events={click:"clickShare"},e.prototype.initialize=function(t){return this.provider=t.provider},e.prototype.clickShare=function(t){return t.preventDefault(),this.model.share(this.provider)},e}(Marionette.ItemView)}.call(this),function(){var t,e,o,i,r,n,s,a,l=function(t,e){function o(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},u={}.hasOwnProperty;a=App.module("Photos.Views"),t=$(window),a.Sidebar=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="sidebar",e.prototype.className="photo_sidebar",e.prototype.regions={attributionRegion:".attribution_region",descriptionRegion:".description_region",actionsRegion:".actions_region",actorsRegion:".actors_region",moderatorRegion:".moderator_region",detailsRegion:".details_region",licensingStateRegion:".licensing_states_region",licensingRegion:".licensing_region",activityRegion:".activity_region",stickyHeaderRegion:".sticky_header_region"},e.prototype.ui={attributionRegion:".attribution_region",actionsRegion:".actions_region",scrollbarDetector:".scrollbar_detector",actorsRegion:".actors_region",activityRegion:".activity_region",licensingStateRegion:".licensing_states_region"},e.prototype.initialize=function(t){return null==t&&(t={}),this.getLikedByUsers(),this.newComment=t.newComment,this.GA=t.GA,this.commenter=t.commenter,t},e.prototype.getTemplate=function(){return PxCurrentUser.isRolledOut("unification")&&(!App.currentUser||App.currentUser.isBuyer())?"sidebar_buyer":"sidebar"},e.prototype.onShow=function(){var t,e;return this.ui.scrollbarDetector.outerWidth()<this.$el.outerWidth()-2&&this.$el.addClass("photo_sidebar--with_scrollbar"),this.attributionRegion.show(new App.Photos.Views.Attribution({model:this.model})),this.stickyHeaderRegion.show(new App.Photos.Views.StickyHeader({model:this.model,GA:this.GA})),this.hasActorsSnippet()?this.getLikedByUsers().done(function(t){return function(e){var o;if(!t.isDestroyed&&null!=e.totalItems&&(!t.model.isOwner()||e.totalItems>0))return o=new App.Photos.Views.ActorsSnippetView({model:t.model,collection:e}),t.actorsRegion.show(o)}}(this)).fail(function(t){return function(){return t.isDestroyed?void 0:t.ui.actorsRegion.hide()}}(this)):this.ui.actorsRegion.hide(),
this.model.isPrivate()&&!this.model.isOwner()?this.ui.actionsRegion.hide():this.actionsRegion.show(new o({model:this.model,GA:this.GA})),this.$(".moderator_region").length>0&&this.listenTo(App.vent,"show:moderator_panel",function(t){return function(){return null!=t.moderatorRegion.currentView?(t.moderatorRegion.reset(),$(".moderator_region").hide()):(t.moderatorRegion.show(new r({model:t.model})),$(".moderator_region").show())}}(this)),this._isSingleColLayout()||(this._hasDescription()&&this.descriptionRegion.show(new App.Photos.Views.Description({model:this.model})),t={model:this.model,likePromise:this.hasActorsSnippet()?null:this.getLikedByUsers(),hasDescription:!this._hasDescription()},this.detailsRegion.show(new App.Photos.Views.DetailsSection(t)),this.model.isLicenseable()&&this.licensingRegion.show(new App.Photos.Views.PhotoDownloadSection({model:this.model})),this.model.isPrivate()?this.ui.activityRegion.hide():(t={model:this.model,newComment:this.newComment,commenter:this.commenter},this.activityRegion.show(new App.Photos.Views.ActivitySection(t))),this.$el.scrollLock("on",null,!0),$(".photo_sidebar").scrollspy({container:$(".photo_sidebar"),min:function(t){return function(){return t.ui.attributionRegion.outerHeight()+t.ui.actionsRegion.outerHeight()}}(this),max:99999999,onEnter:function(t){return function(){return t.stickyHeaderRegion.currentView.$el.addClass("photo_sticky_header--fixed")}}(this),onLeave:function(t){return function(){return t.stickyHeaderRegion.currentView.$el.removeClass("photo_sticky_header--fixed")}}(this)})),PxCurrentUser.isRolledOut("unification")&&(null!=(e=App.currentUser)?e.isBuyer():void 0)?this.licensingStateRegion.show(new i({model:this.model})):this.ui.licensingStateRegion.hide()},e.prototype.hasActorsSnippet=function(){var t;return!(PxCurrentUser.isRolledOut("unification")&&(null!=(t=App.currentUser)?t.isBuyer():void 0))},e.prototype.getLikedByUsers=function(){var t;return null!=this._likePromise?this._likePromise:(this._likePromise=$.Deferred(),this.model.isPrivate()?(this._likePromise.reject(),this._likePromise):(t=this.model.getLikedByUsers(),null!=t.totalItems?this._likePromise.resolve(t):t.fetch().always(function(e){return function(){return e._likePromise.resolve(t)}}(this)),this._likePromise))},e.prototype._isSingleColLayout=function(){return null==this.$photosLayout&&(this.$photosLayout=this.$el.closest(".photos_index_layout")),this.$photosLayout.hasClass("single_col_layout")},e.prototype._hasDescription=function(){var t;return PxCurrentUser.isRolledOut("unification")&&(null!=(t=App.currentUser)?t.isBuyer():void 0)?!1:"Untitled"===this.model.get("name")&&""===this.model.get("description")?!1:!this.model.isPrivate()},e}(Marionette.LayoutView),a.StickyHeader=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="photo_sticky_header",e.prototype.className="photo_sticky_header",e.prototype.regions={extraActions:".extra-actions"},e.prototype.ui={addToGalleryButton:".photo_sticky_header__add_to_gallery_button"},e.prototype.behaviors={HasLikeButton:{withCount:!1,"class":"sticky_header__action"},HasExtraActionsDropdown:{extraActions:{buttonClass:"share sticky_header__action",dropdownViewClass:function(){return s}}},HasButtons:{"@ui.addToGalleryButton":"_openAddToGalleryPopover"},HasAddToCartButton:!0},e.prototype._openAddToGalleryPopover=function(t){var e,o,i;return null!=App.currentUser?(i=new App.Views.AddToGalleriesPopover({kind:"gallery",photos:[this.model]}),e=function(){return i.dismiss()},this.listenToOnce(i,"IsPopover:show",function(t){return function(){return $(".photo_sidebar").one("scroll",e)}}(this)),this.listenToOnce(i,"IsPopover:hide",function(t){return function(){return $(".photo_sidebar").off("scroll",e)}}(this)),i.showPopover(t)):(o=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"photos_like",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"photos_like",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(o,"signup:success login:success",function(){return window.location.reload()}),o.showModal()),!1},e.prototype.initialize=function(t){return null==t&&(t={}),this.GA=t.GA},e.prototype.templateHelpers=function(){return{isBuyerExperience:PxCurrentUser.isRolledOut("unification")&&(!App.currentUser||App.currentUser.isBuyer())&&this.model.isLicenseable()}},e.prototype.onRender=function(){var t;return(null!=(t=App.currentUser)?t.id:void 0)===this.model.get("user_id")&&this.$el.addClass("photo_sticky_header--self"),this.listenTo(this,"like:after",this._onPhotoLiked)},e.prototype._onPhotoLiked=function(t){return t?this._sendGAEvent({action:"Like Button Clicked"}):this._sendGAEvent({action:"Unlike Button Clicked"})},e.prototype._sendGAEvent=function(t){var e;return null==t&&(t={}),_.isObject(this.GA)?(e=_.extend({},this.GA,t),PxApp.GA.event(e)):void 0},e}(Marionette.LayoutView),a.Attribution=function(t){function e(t){null!=App.currentUser&&App.currentUser.id!==t.model.get("user_id")&&(null==this.behaviors&&(this.behaviors={}),this.behaviors.HasFollowButton={"class":"mini_follow",model:function(){return this.model.getUser()}},this.on("follow:before follow:signup",function(){return PxOptimizely.trackEvent("photo_follow_photographer")})),e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="attribution",e.prototype.className="attribution",e.prototype.ui={followers:".followers",photographer_info:".photographer_info"},e.prototype.behaviors={HasLikeButton:!0},e.prototype.onRender=function(){return null!=App.currentUser&&App.currentUser.id!==this.model.get("user_id")?this.ui.followers.hide():(this.ui.followers.i18n({count:this.model.getUser().get("followers_count")}),this.ui.photographer_info.addClass("logged_out"))},e}(Marionette.LayoutView),a.Description=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="description",e.prototype.className="description",e.prototype.ui={descriptionContainer:".description_container",more:"a.more",less:"a.less"},e.prototype.events={"click @ui.more":"onClickMore","click @ui.less":"onClickLess"},e.prototype.templateHelpers=function(){return{isPrivate:this.model.isPrivate()}},e.prototype.onRender=function(){return this.$el.toggleClass("title-only",!$.trim(this.model.get("description"))),this.ui.descriptionContainer.find("a").attr("rel","nofollow")},e.prototype.onShow=function(){return this.ui.descriptionContainer.dotdotdot({callback:function(t){return function(e,o){return e?void 0:t.$("a.more").hide()}}(this)})},e.prototype.onClickMore=function(t){var e;return t.preventDefault(),null!=App.currentUser?(this.ui.descriptionContainer.trigger("destroy").addClass("description_container--maximized"),this.ui.more.hide(),this.ui.less.show()):(e=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"photos_full_description",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"photos_full_description",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(e,"signup:success login:success",function(){return window.location.reload()}),e.showModal())},e.prototype.onClickLess=function(t){return t.preventDefault(),this.ui.descriptionContainer.removeClass("description_container--maximized").dotdotdot(),this.ui.less.hide(),this.ui.more.show()},e}(Marionette.ItemView),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.handleAction=function(t,e){return"share"===t?(this.model.share(e.data("medium")),PxOptimizely.trackEvent("photo_sharelizer_"+e.data("medium"))):this[t].call(this,e)},e.prototype.embedPhoto=function(){var t;return t=new App.Photos.Views.EmbedPhotoModal({model:this.model}),t.showModal()},e}(App.Behaviors.HasExtraActionsDropdown.DropdownBase),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="photo_sharing_extra_actions_dropdown",e.prototype.className="photo-sharing-extra-actions-dropdown",e}(n),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="curator_actions",e.prototype.className="curator-actions",e.prototype.regions={extraActions:".extra-actions"},e.prototype.ui={addToGalleryButton:".curator_actions__add_to_gallery_button",extraActions:".extra-actions"},e.prototype.behaviors={HasExtraActionsDropdown:{extraActions:{buttonClass:"share",compactList:!1,dropdownViewClass:function(){return s}}},HasLikeButton:{withCount:!0},HasSharelizers:!0,HasButtons:{"@ui.addToGalleryButton":"_openAddToGalleryPopover"}},e.prototype._openAddToGalleryPopover=function(t){var e,o,i;return null!=App.currentUser?(i=new App.Views.AddToGalleriesPopover({kind:"gallery",photos:[this.model]}),e=function(){return i.dismiss()},this.listenToOnce(i,"IsPopover:show",function(t){return function(){return $(".photo_sidebar").one("scroll",e)}}(this)),this.listenToOnce(i,"IsPopover:hide",function(t){return function(){return $(".photo_sidebar").off("scroll",e)}}(this)),i.showPopover(t)):(o=PxCurrentUser.isRolledOut("unification")?new App.Views.UnifiedSignupLoginModal({action:"photos_like",oauthRedirect:window.location.href}):new App.Views.SignupLoginModal({action:"photos_like",startWithSignup:!0,oauthRedirect:window.location.href}),this.listenToOnce(o,"signup:success login:success",function(){return window.location.reload()}),o.showModal()),!1},e.prototype.initialize=function(t){return null==t&&(t={}),this.GA=t.GA},e.prototype.onRender=function(){return this.on("like:before like:signup",function(){return PxOptimizely.trackEvent("photo_like")}),this.model.isPrivate()&&this.$el.addClass("curator_actions--private"),this.listenTo(this,"like:after",this._onPhotoLiked)},e.prototype._onPhotoLiked=function(t){return t?this._sendGAEvent({action:"Like Button Clicked"}):this._sendGAEvent({action:"Unlike Button Clicked"})},e.prototype._sendGAEvent=function(t){var e;return null==t&&(t={}),_.isObject(this.GA)?(e=_.extend({},this.GA,t),PxApp.GA.event(e)):void 0},e}(Marionette.LayoutView),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="moderator_actions",e.prototype.classname="moderator_actions",e.prototype.LICENSING_STATES={none:0,presubmitted:9,removed:1,submitted:2,prime:3,pending:4,subprime:5,subeditorial:7,illegal:8,editorial:6,rights_managed:10},e.prototype.ui={nsfwButton:".button.nsfw",unnsfwButton:".button.unnsfw",privateButton:".mark_private",illegalButton:".mark_illegal"},e.prototype.behaviors={HasButtons:{"@ui.nsfwButton":"toggleNSFW","@ui.unnsfwButton":"toggleNSFW","@ui.privateButton":"onClickPrivate","@ui.illegalButton":"setIllegal"}},e.prototype.onRender=function(){return this.$el.toggleClass("nsfw",this.model.get("nsfw"))},e.prototype.toggleNSFW=function(){return $.post("https://api.500px.com/v1/admin/photos/"+this.model.id+"/nsfw").done(function(t){return function(e){return t.model.set("nsfw",e.nsfw),t.$el.toggleClass("nsfw",t.model.get("nsfw"))}}(this))},e.prototype.setIllegal=function(){return $.post("https://api.500px.com/v1/admin/photos/"+this.model.id+"/illegal").done(function(t){return function(e){return t.model.set("licensing_status",t.LICENSING_STATES.illegal)}}(this))},e.prototype.onClickPrivate=function(){return $.post("https://api.500px.com/v1/admin/photos/"+this.model.id+"/private").done(function(t){return function(e){return window.location.href="/admin/community/photos/"+t.model.get("id")}}(this))},e}(Marionette.LayoutView),a.ReportContentModal=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return l(o,e),o.prototype.template="report_content_modal",o.prototype.className="action_modal report-content-modal",o.prototype.ui={closeButton:".header .close",reasonSelect:".content select",submitButton:".content .submit"},o.prototype.templateHelpers=function(){return{photo:"photo"===this.type,user:"user"===this.type,gallery:"gallery"===this.type}},o.prototype.behaviors={ModalDialog:{closeButton:!1,wrapperClass:"report-content-modal-wrapper",dialogClass:"report-content-modal-dialog"},HasButtons:{"@ui.closeButton":"onCloseClicked","@ui.submitButton":"onSubmitClicked"}},o.prototype.initialize=function(t){if(null==t&&(t={}),this.type=t.type,!this.type)throw new Error("Missing object type")},o.prototype.resize=function(){return t.width()<=360?this.$el.width(t.width()-20):this.$el.width(360),this.trigger("resize")},o.prototype.onCloseClicked=function(){return this.destroyModal()},o.prototype.onSubmitClicked=function(){return this.model.reportContent(this.ui.reasonSelect.val()).done(function(t){return function(){return App.Flash.success(t.ui.submitButton.i18n("success",{"return":!0})),t.destroyModal()}}(this))},o}(Marionette.LayoutView),a.EmbedPhotoModal=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return l(o,e),o.prototype.template="embed_photo_modal",o.prototype.className="action_modal embed-photo-modal",o.prototype.ui={closeButton:".header .close",codeBlock:"pre",previewImage:".preview img"},o.prototype.events={"click @ui.codeBlock":"_selectCode"},o.prototype.behaviors={ModalDialog:{closeButton:!1,wrapperClass:"embed-photo-modal-wrapper",dialogClass:"embed-photo-modal-dialog"},HasButtons:{"@ui.closeButton":"onCloseClicked"}},o.prototype.templateHelpers=function(){return{embed_image_url:this.model.getImagePath({size:900})}},o.prototype.onRender=function(){return this.ui.previewImage.load(function(t){return function(){return window.pxembed.scan(),t.trigger("resize")}}(this))},o.prototype._selectCode=function(){return this._selectText(this.ui.codeBlock)},o.prototype.resize=function(){return t.width()<=600?this.$el.width(t.width()-20):this.$el.width(600),this.trigger("resize")},o.prototype.onCloseClicked=function(){return this.destroyModal()},o.prototype._selectText=function(t){var e,o,i;return i=t[0],document.body.createTextRange?(e=document.body.createTextRange(),e.moveToElementText(i),e.select()):window.getSelection?(o=window.getSelection(),e=document.createRange(),e.selectNodeContents(i),o.removeAllRanges(),o.addRange(e)):void 0},o}(Marionette.LayoutView),a.ActorsSnippetView=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="actors_snippet_view",e.prototype.tagName="div",e.prototype.className="liked_by_container",e.prototype.ui={heartIcon:".icon",likedBySnippet:".liked_by"},e.prototype.regions={actorsWidgetRegion:".actors_widget"},e.prototype.modelEvents={"change:likedByCurrentUser":"updateContent"},e.prototype.setupOthersFlyout=function(){var t,e,o;return null!=this.qtipApi&&this.qtipApi.hide(),t=new a.ActorsWidgetView({collection:this.collection}),this.actorsWidgetRegion.show(t),o={style:{classes:"actors_flyout",def:!1,tip:{width:20,height:10,mimic:"right center",offset:90}},position:{my:"right bottom",at:"left center",viewport:$(window),effect:!1,adjust:{x:-5,y:30},target:this.$el},show:"click",hide:"click unfocus"},e=this.$(".show_others").qtip(_.extend({content:t.$el},o)),this.qtipApi=e.qtip("api")},e.prototype.onRender=function(){var t,e,o,i,r,n,s,a,l,u,p,c;if(t=this.$(".liked_by_widget"),p=this.collection.totalItems,0===p)return t.addClass("empty");for(t.addClass("liked"),u=_.first(this.collection.models,1),c=_.map(u,function(t){var e,o,i;return o=t.getUser(),i=o.get("fullname"),e=$("<a>").attr({href:userPath(o)}).text(i),$("<div>").append(e).html()}),a={html:!0},o=i=0,r=c.length;r>i;o=++i)n=c[o],a["actor"+(o+1)]=n;return 1>=p?this.$(".liked_by").i18n("1",a):(l=2===p?"others-single":"others-multiple",s=this.$(".liked_by").i18n(l,{others_count:p-1,"return":!0}),e=$("<a>").attr({href:"#"}).addClass("show_others").text(s),a.others_link=$("<div>").append(e).html(),this.$(".liked_by").i18n("more",a),this.setupOthersFlyout())},e.prototype.updateContent=function(){return this.render()},e}(Marionette.LayoutView),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="actor_composite_view",e.prototype.tagName="li",e.prototype.className="actor",e.prototype.behaviors={HasFollowButton:{"class":"mini_follow",model:function(){return this.model.getUser()}}},e}(Marionette.LayoutView),a.ActorsWidgetView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return l(o,t),o.prototype.childView=e,o.prototype.template="actors_widget_view",o.prototype.className="actors_widget_view",o.prototype.childViewContainer="ul.actors",o.prototype.ui={list:".inside .info.list.scroll"},o.prototype.behaviors={InfiniteScroll:{container:function(){return this.ui.list}}},o}(Marionette.CompositeView),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.template="licensing_states_view",e.prototype.className="licensing_states_view",e.prototype.templateHelpers=function(){return{isUnavailable:!this.model.isAvailableForImmediatePurchase(),isUnavailableAndRequestable:this.isUnavailableAndRequestable(),isExclusive:this.model.isExclusive(),isEditorial:this.model.isEditorial()}},e.prototype.ui={infoIcons:".licensing_state__icon"},e.prototype.onShow=function(){return this._setupTooltips()},e.prototype.onDestroy=function(){return this._removeTooltips()},e.prototype.isUnavailableAndRequestable=function(){return!this.model.isAvailableForImmediatePurchase()&&this.model.isRequestable()},e.prototype._setupTooltips=function(){return this.ui.infoIcons.each(function(t,e){var o,i;return o=$(e),i=$(o.data("tooltip")),0!==i.length&&i.hasClass("licensing_state__info")?$(e).qtip({content:i,style:{classes:"licensing_flyout",def:!1,tip:{width:20,height:10,mimic:"right center"}},position:{my:"right center",at:"left center",viewport:$(window),effect:!1},hide:{delay:0,fixed:!0,event:"mouseout"}}):void 0})},e.prototype._removeTooltips=function(){return this.ui.infoIcons.each(function(t,e){return $(e).qtip("destroy",!0)})},e}(Marionette.LayoutView)}.call(this),function(){var t,e,o,i=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},r={}.hasOwnProperty;o=App.module("Photos.Views"),o.Tags=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template="tags",o.prototype.className="photo_tags",o.prototype.regions={tags:".tag-container"},o.prototype.onRender=function(){var t,o;return t=function(){var t,e,i,r,n;for(r=null!=(i=this.model.attributes.tags)?i:[],n=[],t=0,e=r.length;e>t;t++)o=r[t],n.push({name:o});return n}.call(this),this.tags.show(new e({collection:new Backbone.Collection(t)}))},o}(Marionette.LayoutView),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.template="single_tag",e.prototype.tagName="span",e}(Marionette.ItemView),e=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,e),o.prototype.childView=t,o}(Marionette.CollectionView)}.call(this),function(){var t;t=App.module("Helpers"),t.BrowserSupport=function(){function t(){}return t.draganddrop=function(){var t;return t=document.createElement("div"),"draggable"in t||"ondragstart"in t&&"ondrop"in t},t}()}.call(this),function(){var t,e=[].slice;t=App.module("Helpers"),t.loadImage=function(t){var o,i;return o=$.Deferred(),i=new Image,i.onload=function(){return o.resolve(i,t)},i.onerror=function(){return o.reject.apply(o,[t].concat(e.call(arguments)))},i.src=t,o.promise()},t.selectFixedWidthImageSize=function(t,e,o){var i,r,n,s,a,l,u,p;if(0>=t)throw new Error("must provide positive target width");if(0>=e)throw new Error("must provide positive image width");if(0>=o)throw new Error("must provide positive image height");for(l=Math.max(1,null!=(s=window.devicePixelRatio)?s:1),p=e/o,n=e>o?1:p,r=[{width:300*p,size:32},{width:450*p,size:31},{width:600*p,size:33},{width:1e3*n,size:34},{width:1500*n,size:35},{width:2e3*n,size:36}],r.sort(function(t,e){return t.width-e.width}),l=Math.min(l,1.5),u=t*l,a=(u-t)/4,i=r.pop();r.length>0&&i.width<u-a;)i=r.pop();return i.size},t.selectFixedHeightImageSize=function(t,e,o){var i,r,n,s,a,l,u,p;if(0>=t)throw new Error("must provide positive target height");if(0>=e)throw new Error("must provide positive image width");if(0>=o)throw new Error("must provide positive image height");for(p=Math.max(1,null!=(a=window.devicePixelRatio)?a:1),i=o/e,s=o>e?1:i,n=[{height:300,size:32},{height:450,size:31},{height:600,size:33},{height:1e3*s,size:34},{height:1500*s,size:35},{height:2e3*s,size:36}],n.sort(function(t,e){return t.height-e.height}),p=Math.min(p,1.5),u=t*p,l=(u-t)/4,r=n.pop();n.length>0&&r.height<u-l;)r=n.pop();return r.size}}.call(this),function(){var t;t=App.module("Helpers"),t.mobileOS=function(t){return t.match(/^ip/)?"ios":"android"},t.appLink=function(t){return t.match(/^ip/)?"https://itunes.apple.com/app/500px/id471965292":"https://play.google.com/store/apps/details?id=com.fivehundredpx.viewer"},t.openOrDownloadApp=function(t,e){return _.delay(function(){return window.location=e},25),window.location=t},t.deviceType=function(){var t,e;return(e=navigator.userAgent.match(/iP(ad|hone)|Android/))?(t=null,"Android"===e[0]?t=navigator.userAgent.match(/Mobile/)?Math.max($(window).height(),$(window).width())>700?"androidTablet":"androidPhone":"androidTablet":e&&(t=e[0].toLowerCase()),t):null},t.isSmartphone=function(){return $("body").hasClass("smartphone")},t.isTablet=function(){return $("body").hasClass("tablet")},t.isDesktop=function(){return $("body").hasClass("desktop")},t.isMobileOrTablet=function(){return t.isSmartphone()||t.isTablet()}}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Helpers"),t.MobileCTA=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.template="mobile_cta",o.prototype.ui={wrap:".wrap",backdrop:".mobile_cta",heading:".heading",subheading:".subheading",button:"a.button",content:".content"},o.prototype.initialize=function(t){return this.options=t},o.prototype.onRender=function(){var t,e;return(e=App.Helpers.deviceType())?(t=this.options.content[e]||this.options.content["default"],this.ui.heading.text(this.options.heading),this.ui.subheading.text(this.options.subheading),this.ui.button.text(this.options.button),this.ui.button.prop("href",App.Helpers.appLink(e)),t&&this.ui.content.html(t),this.ui.backdrop.addClass(e)):void this.$el.hide()},o}(Marionette.LayoutView)}.call(this),function(t,e){function o(t){return!!(""===t||t&&t.charCodeAt&&t.substr)}function i(t){return c?c(t):"[object Array]"===h.call(t)}function r(t){return t&&"[object Object]"===h.call(t)}function n(t,e){var o;t=t||{},e=e||{};for(o in e)e.hasOwnProperty(o)&&null==t[o]&&(t[o]=e[o]);return t}function s(t,e,o){var i,r,n=[];if(!t)return n;if(p&&t.map===p)return t.map(e,o);for(i=0,r=t.length;r>i;i++)n[i]=e.call(o,t[i],i,t);return n}function a(t,e){return t=Math.round(Math.abs(t)),isNaN(t)?e:t}function l(t){var e=u.settings.currency.format;return"function"==typeof t&&(t=t()),o(t)&&t.match("%v")?{pos:t,neg:t.replace("-","").replace("%v","-%v"),zero:t}:t&&t.pos&&t.pos.match("%v")?t:o(e)?u.settings.currency.format={pos:e,neg:e.replace("%v","-%v"),zero:e}:e}var u={};u.version="0.4.1",u.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var p=Array.prototype.map,c=Array.isArray,h=Object.prototype.toString,d=u.unformat=u.parse=function(t,e){if(i(t))return s(t,function(t){return d(t,e)});if(t=t||0,"number"==typeof t)return t;e=e||u.settings.number.decimal;var o=new RegExp("[^0-9-"+e+"]",["g"]),r=parseFloat((""+t).replace(/\((.*)\)/,"-$1").replace(o,"").replace(e,"."));return isNaN(r)?0:r},_=u.toFixed=function(t,e){e=a(e,u.settings.number.precision);var o=Math.pow(10,e);return(Math.round(u.unformat(t)*o)/o).toFixed(e)},m=u.formatNumber=u.format=function(t,e,o,l){if(i(t))return s(t,function(t){return m(t,e,o,l)});t=d(t);var p=n(r(e)?e:{precision:e,thousand:o,decimal:l},u.settings.number),c=a(p.precision),h=0>t?"-":"",g=parseInt(_(Math.abs(t||0),c),10)+"",f=g.length>3?g.length%3:0;return h+(f?g.substr(0,f)+p.thousand:"")+g.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+p.thousand)+(c?p.decimal+_(Math.abs(t),c).split(".")[1]:"")},g=u.formatMoney=function(t,e,o,p,c,h){if(i(t))return s(t,function(t){return g(t,e,o,p,c,h)});t=d(t);var _=n(r(e)?e:{symbol:e,precision:o,thousand:p,decimal:c,format:h},u.settings.currency),f=l(_.format),y=t>0?f.pos:0>t?f.neg:f.zero;return y.replace("%s",_.symbol).replace("%v",m(Math.abs(t),a(_.precision),_.thousand,_.decimal))};u.formatColumn=function(t,e,p,c,h,_){if(!t)return[];var g=n(r(e)?e:{symbol:e,precision:p,thousand:c,decimal:h,format:_},u.settings.currency),f=l(g.format),y=f.pos.indexOf("%s")<f.pos.indexOf("%v")?!0:!1,v=0,w=s(t,function(t,e){if(i(t))return u.formatColumn(t,g);t=d(t);var o=t>0?f.pos:0>t?f.neg:f.zero,r=o.replace("%s",g.symbol).replace("%v",m(Math.abs(t),a(g.precision),g.thousand,g.decimal));return r.length>v&&(v=r.length),r});return s(w,function(t,e){return o(t)&&t.length<v?y?t.replace(g.symbol,g.symbol+new Array(v-t.length+1).join(" ")):new Array(v-t.length+1).join(" ")+t:t})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=u),exports.accounting=u):"function"==typeof define&&define.amd?define([],function(){return u}):(u.noConflict=function(o){return function(){return t.accounting=o,u.noConflict=e,u}}(t.accounting),t.accounting=u)}(this),function(){var t;t=App.module("Helpers"),t.Numbers=function(){function t(){}return t.suffixFormatter=function(t,e){var o,i,r,n;for(n=[{value:1e18,symbol:"E"},{value:1e15,symbol:"P"},{value:1e12,symbol:"T"},{value:1e9,symbol:"G"},{value:1e6,symbol:"M"},{value:1e3,symbol:"k"}],o=0,i=n.length;i>o;o++)r=n[o],t>=r.value&&(t=this._formatWithSuffix(t,e,r));return t.toString()},t._formatWithSuffix=function(t,e,o){return(t/o.value).toFixed(e).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+o.symbol},t.formatMoney=function(t,e,o){var i,r;return null==o&&(o={}),t/=e.get("subunit_to_unit"),r=o.precision||0,i=e.get(o.display||"symbol"),accounting.formatMoney(t,_.extend({precision:r},i))},t}()}.call(this),function(){var t;t=App.module("Helpers"),t.parseUrlParams=function(){var t,e,o,i,r,n,s,a,l;for(r=window.location.search,"?"===(null!=r?r[0]:void 0)&&(r=r.slice(1)),s=r.split("&"),t={},e=0,i=s.length;i>e;e++)n=s[e],a=n.split("="),o=a[0],l=a[1],t[o]=_.escape(l);return t},t.getQueryParam=function(e){var o;return null!=(o=t.parseUrlParams())?o[e]:void 0}}.call(this),window.phoneNumberHelper=function(t){return t.countryCodeJSON='{"": {"calling-code": "", "country-name": ""}, "BD": {"calling-code": "880", "country-name": "\u09ac\u09be\u0982\u09b2\u09be\u09a6\u09c7\u09b6 \u0997\u09a3\u09aa\u09cd\u09b0\u099c\u09be\u09a4\u09a8\u09cd\u09a4\u09cd\u09b0\u09c0 (Bangladesh)"}, "BF": {"calling-code": "226", "country-name": "Burkina Faso"}, "BG": {"calling-code": "359", "country-name": "\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f (Bulgaria)"}, "BA": {"calling-code": "387", "country-name": "Bosna i Hercegovina (Bosnia and Herzegovina)"}, "BB": {"calling-code": "1246", "country-name": "Barbados"}, "BE": {"calling-code": "32", "country-name": "Belgi\xeb (Belgium)"}, "BL": {"calling-code": "590", "country-name": "Saint-Barth\xe9lemy (Saint Barth\xe9lemy)"}, "BM": {"calling-code": "1441", "country-name": "Bermuda"}, "BN": {"calling-code": "673", "country-name": "Negara Brunei Darussalam (Brunei)"}, "BO": {"calling-code": "591", "country-name": "Estado Plurinacional de Bolivia (Bolivia)"}, "BH": {"calling-code": "973", "country-name": "\u200f\u0627\u0644\u0628\u062d\u0631\u064a\u0646 (Bahrain)"}, "BI": {"calling-code": "257", "country-name": "R\xe9publique du Burundi (Burundi)"}, "BJ": {"calling-code": "229", "country-name": "B\xe9nin (Benin)"}, "BT": {"calling-code": "975", "country-name": "\u0f60\u0f56\u0fb2\u0f74\u0f42\u0f0b\u0f61\u0f74\u0f63\u0f0b (Bhutan)"}, "JM": {"calling-code": "1876", "country-name": "Jamaica"}, "BV": {"calling-code": "47", "country-name": "Bouvet\xf8ya (Bouvet Island)"}, "BW": {"calling-code": "267", "country-name": "Republic of Botswana (Botswana)"}, "WS": {"calling-code": "685", "country-name": "S\u0101moa (Samoa)"}, "BR": {"calling-code": "55", "country-name": "Brasil (Brazil)"}, "BS": {"calling-code": "1242", "country-name": "Commonwealth of the Bahamas (Bahamas)"}, "JE": {"calling-code": "44", "country-name": "Bailiwick of Jersey (Jersey)"}, "BY": {"calling-code": "375", "country-name": "\u0411\u0435\u043b\u0430\u0440\u0443\u0301\u0441\u044c (Belarus)"}, "BZ": {"calling-code": "501", "country-name": "Belize"}, "RU": {"calling-code": "7", "country-name": "\u0420\u043e\u0441\u0441\u0438\u044f (Russia)"}, "RW": {"calling-code": "250", "country-name": "Rwanda"}, "RS": {"calling-code": "381", "country-name": "\u0421\u0440\u0431\u0438\u0458\u0430 (Serbia)"}, "TL": {"calling-code": "670", "country-name": "Rep\xfablica Democr\xe1tica de Timor-Leste (Timor-Leste)"}, "RE": {"calling-code": "262", "country-name": "La R\xe9union (R\xe9union)"}, "TM": {"calling-code": "993", "country-name": "T\xfcrkmenistan (Turkmenistan)"}, "TJ": {"calling-code": "992", "country-name": "\u0422\u043e\u04b7\u0438\u043a\u0438\u0441\u0442\u043e\u043d (Tajikistan)"}, "O1": {"calling-code": "", "country-name": ""}, "RO": {"calling-code": "40", "country-name": "Rom\xe2nia (Romania)"}, "TK": {"calling-code": "690", "country-name": "Tokelau"}, "GW": {"calling-code": "245", "country-name": "Guin\xe9-Bissau (Guinea-Bissau)"}, "GU": {"calling-code": "1671", "country-name": "Guam"}, "GT": {"calling-code": "502", "country-name": "Rep\xfablica de Guatemala (Guatemala)"}, "GS": {"calling-code": "500", "country-name": "South Georgia and the South Sandwich Islands (South Georgia)"}, "GR": {"calling-code": "30", "country-name": "\u0395\u03bb\u03bb\u03ac\u03b4\u03b1 (Greece)"}, "GQ": {"calling-code": "240", "country-name": "Guinea Ecuatorial (Equatorial Guinea)"}, "GP": {"calling-code": "590", "country-name": "Guadeloupe"}, "JP": {"calling-code": "81", "country-name": "\u65e5\u672c (Japan)"}, "GY": {"calling-code": "592", "country-name": "Co-operative Republic of Guyana (Guyana)"}, "GG": {"calling-code": "44", "country-name": "Bailiwick of Guernsey (Guernsey)"}, "GF": {"calling-code": "594", "country-name": "Guyane fran\xe7aise (French Guiana)"}, "GE": {"calling-code": "995", "country-name": "\u10e1\u10d0\u10e5\u10d0\u10e0\u10d7\u10d5\u10d4\u10da\u10dd (Georgia)"}, "GD": {"calling-code": "1473", "country-name": "Grenada"}, "GB": {"calling-code": "44", "country-name": "United Kingdom of Great Britain and Northern Ireland (United Kingdom)"}, "GA": {"calling-code": "241", "country-name": "R\xe9publique gabonaise (Gabon)"}, "SV": {"calling-code": "503", "country-name": "Rep\xfablica de El Salvador (El Salvador)"}, "GN": {"calling-code": "224", "country-name": "Guin\xe9e (Guinea)"}, "GM": {"calling-code": "220", "country-name": "Republic of the Gambia (Gambia)"}, "GL": {"calling-code": "299", "country-name": "Kalaallit Nunaat (Greenland)"}, "GI": {"calling-code": "350", "country-name": "Gibraltar"}, "GH": {"calling-code": "233", "country-name": "Republic of Ghana (Ghana)"}, "OM": {"calling-code": "968", "country-name": "\u0639\u0645\u0627\u0646 (Oman)"}, "TN": {"calling-code": "216", "country-name": "\u062a\u0648\u0646\u0633 (Tunisia)"}, "JO": {"calling-code": "962", "country-name": "\u0627\u0644\u0623\u0631\u062f\u0646 (Jordan)"}, "WF": {"calling-code": "681", "country-name": "Wallis et Futuna (Wallis and Futuna)"}, "HR": {"calling-code": "385", "country-name": "Hrvatska (Croatia)"}, "HT": {"calling-code": "509", "country-name": "Ha\xefti (Haiti)"}, "HU": {"calling-code": "36", "country-name": "Magyarorsz\xe1g (Hungary)"}, "HK": {"calling-code": "852", "country-name": "\u9999\u6e2f (Hong Kong)"}, "HN": {"calling-code": "504", "country-name": "Rep\xfablica de Honduras (Honduras)"}, "HM": {"calling-code": "672", "country-name": "Heard Island and McDonald Islands"}, "VE": {"calling-code": "58", "country-name": "Rep\xfablica Bolivariana de Venezuela (Venezuela)"}, "PR": {"calling-code": "1", "country-name": "Estado Libre Asociado de Puerto Rico (Puerto Rico)"}, "PS": {"calling-code": "970", "country-name": "\u0641\u0644\u0633\u0637\u064a\u0646 (Palestine)"}, "PW": {"calling-code": "680", "country-name": "Republic of Palau (Palau)"}, "PT": {"calling-code": "351", "country-name": "Rep\xfablica portugu\xeas (Portugal)"}, "SJ": {"calling-code": "4779", "country-name": "Svalbard og Jan Mayen (Svalbard and Jan Mayen)"}, "PY": {"calling-code": "595", "country-name": "Rep\xfablica de Paraguay (Paraguay)"}, "IQ": {"calling-code": "964", "country-name": "\u0627\u0644\u0639\u0631\u0627\u0642 (Iraq)"}, "PA": {"calling-code": "507", "country-name": "Panam\xe1 (Panama)"}, "PF": {"calling-code": "689", "country-name": "Polyn\xe9sie fran\xe7aise (French Polynesia)"}, "PG": {"calling-code": "675", "country-name": "Papua Niugini (Papua New Guinea)"}, "PE": {"calling-code": "51", "country-name": "Per\xfa (Peru)"}, "PK": {"calling-code": "92", "country-name": "Islamic Republic of Pakistan (Pakistan)"}, "PH": {"calling-code": "63", "country-name": "Pilipinas (Philippines)"}, "PN": {"calling-code": "64", "country-name": "Pitcairn Group of Islands (Pitcairn Islands)"}, "A2": {"calling-code": "", "country-name": ""}, "PL": {"calling-code": "48", "country-name": "Polska (Poland)"}, "PM": {"calling-code": "508", "country-name": "Saint-Pierre-et-Miquelon (Saint Pierre and Miquelon)"}, "ZM": {"calling-code": "260", "country-name": "Republic of Zambia (Zambia)"}, "EH": {"calling-code": "212", "country-name": "\u0627\u0644\u0635\u062d\u0631\u0627\u0621 \u0627\u0644\u063a\u0631\u0628\u064a\u0629 (Western Sahara)"}, "EE": {"calling-code": "372", "country-name": "Eesti (Estonia)"}, "EG": {"calling-code": "20", "country-name": "\u0645\u0635\u0631 (Egypt)"}, "ZA": {"calling-code": "27", "country-name": "Republiek van Suid-Afrika (South Africa)"}, "EC": {"calling-code": "593", "country-name": "Rep\xfablica del Ecuador (Ecuador)"}, "IT": {"calling-code": "39", "country-name": "Italia (Italy)"}, "VN": {"calling-code": "84", "country-name": "Vi\u1ec7t Nam (Vietnam)"}, "SB": {"calling-code": "677", "country-name": "Solomon Islands"}, "EU": {"calling-code": "", "country-name": ""}, "ET": {"calling-code": "251", "country-name": "\u12a2\u1275\u12ee\u1335\u12eb (Ethiopia)"}, "SO": {"calling-code": "252", "country-name": "Soomaaliya (Somalia)"}, "ZW": {"calling-code": "263", "country-name": "Republic of Zimbabwe (Zimbabwe)"}, "SA": {"calling-code": "966", "country-name": "\u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629 (Saudi Arabia)"}, "ES": {"calling-code": "34", "country-name": "Espa\xf1a (Spain)"}, "ER": {"calling-code": "291", "country-name": "\u12a4\u122d\u1275\u122b (Eritrea)"}, "ME": {"calling-code": "382", "country-name": "\u0426\u0440\u043d\u0430 \u0413\u043e\u0440\u0430 (Montenegro)"}, "MD": {"calling-code": "373", "country-name": "Republica Moldova (Moldova)"}, "MG": {"calling-code": "261", "country-name": "Madagasikara (Madagascar)"}, "MF": {"calling-code": "590", "country-name": "Saint-Martin (Saint Martin)"}, "MA": {"calling-code": "212", "country-name": "\u0627\u0644\u0645\u063a\u0631\u0628 (Morocco)"}, "MC": {"calling-code": "377", "country-name": "Principaut\xe9 de Monaco (Monaco)"}, "UZ": {"calling-code": "998", "country-name": "O\u2018zbekiston (Uzbekistan)"}, "MM": {"calling-code": "95", "country-name": "\u1019\u103c\u1014\u103a\u1019\u102c (Myanmar)"}, "ML": {"calling-code": "223", "country-name": "R\xe9publique du Mali (Mali)"}, "MO": {"calling-code": "853", "country-name": "\u6fb3\u9580 (Macau)"}, "MN": {"calling-code": "976", "country-name": "\u041c\u043e\u043d\u0433\u043e\u043b \u0443\u043b\u0441 (Mongolia)"}, "MH": {"calling-code": "692", "country-name": "M\u0327aje\u013c (Marshall Islands)"}, "MK": {"calling-code": "389", "country-name": "\u041c\u0430\u043a\u0435\u0434\u043e\u043d\u0438\u0458\u0430 (Macedonia)"}, "MU": {"calling-code": "230", "country-name": "Maurice (Mauritius)"}, "MT": {"calling-code": "356", "country-name": "Malta"}, "MW": {"calling-code": "265", "country-name": "Mala\u0175i (Malawi)"}, "MV": {"calling-code": "960", "country-name": "\u078b\u07a8\u0788\u07ac\u0780\u07a8\u0783\u07a7\u0787\u07b0\u0796\u07ad\u078e\u07ac (Maldives)"}, "MQ": {"calling-code": "596", "country-name": "Martinique"}, "MP": {"calling-code": "1670", "country-name": "Commonwealth of the Northern Mariana Islands (Northern Mariana Islands)"}, "MS": {"calling-code": "1664", "country-name": "Montserrat"}, "MR": {"calling-code": "222", "country-name": "\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627 (Mauritania)"}, "IM": {"calling-code": "44", "country-name": "Isle of Man"}, "UG": {"calling-code": "256", "country-name": "Republic of Uganda (Uganda)"}, "MY": {"calling-code": "60", "country-name": "\u0645\u0644\u064a\u0633\u064a\u0627 (Malaysia)"}, "MX": {"calling-code": "52", "country-name": "M\xe9xico (Mexico)"}, "IL": {"calling-code": "972", "country-name": "\u05d9\u05e9\u05e8\u05d0\u05dc (Israel)"}, "FR": {"calling-code": "33", "country-name": "R\xe9publique fran\xe7aise (France)"}, "IO": {"calling-code": "246", "country-name": "British Indian Ocean Territory"}, "FX": {"calling-code": "33", "country-name": "R\xe9publique fran\xe7aise (France)"}, "SH": {"calling-code": "290", "country-name": "Saint Helena, Ascension and Tristan da Cunha"}, "A1": {"calling-code": "", "country-name": ""}, "AX": {"calling-code": "358", "country-name": "\xc5land (\xc5land Islands)"}, "FI": {"calling-code": "358", "country-name": "Suomi (Finland)"}, "FJ": {"calling-code": "679", "country-name": "Republic of Fiji (Fiji)"}, "FK": {"calling-code": "500", "country-name": "Falkland Islands"}, "FM": {"calling-code": "691", "country-name": "Federated States of Micronesia (Micronesia)"}, "FO": {"calling-code": "298", "country-name": "F\xf8royar (Faroe Islands)"}, "NI": {"calling-code": "505", "country-name": "Rep\xfablica de Nicaragua (Nicaragua)"}, "NL": {"calling-code": "31", "country-name": "Nederland (Netherlands)"}, "NO": {"calling-code": "47", "country-name": "Norge (Norway)"}, "NA": {"calling-code": "264", "country-name": "Republic of Namibia (Namibia)"}, "VU": {"calling-code": "678", "country-name": "Ripablik blong Vanuatu (Vanuatu)"}, "NC": {"calling-code": "687", "country-name": "Nouvelle-Cal\xe9donie (New Caledonia)"}, "NE": {"calling-code": "227", "country-name": "R\xe9publique du Niger (Niger)"}, "NF": {"calling-code": "672", "country-name": "Territory of Norfolk Island (Norfolk Island)"}, "NG": {"calling-code": "234", "country-name": "Federal Republic of Nigeria (Nigeria)"}, "NZ": {"calling-code": "64", "country-name": "New Zealand"}, "NP": {"calling-code": "977", "country-name": "\u0928\u092a\u0932 (Nepal)"}, "NR": {"calling-code": "674", "country-name": "Republic of Nauru (Nauru)"}, "NU": {"calling-code": "683", "country-name": "Niu\u0113 (Niue)"}, "CK": {"calling-code": "682", "country-name": "Cook Islands"}, "CI": {"calling-code": "225", "country-name": "C\xf4te d\'Ivoire (Ivory Coast)"}, "CH": {"calling-code": "41", "country-name": "Schweiz (Switzerland)"}, "CO": {"calling-code": "57", "country-name": "Rep\xfablica de Colombia (Colombia)"}, "CN": {"calling-code": "86", "country-name": "\u4e2d\u56fd (China)"}, "CM": {"calling-code": "237", "country-name": "Cameroun (Cameroon)"}, "CL": {"calling-code": "56", "country-name": "Rep\xfablica de Chile (Chile)"}, "CC": {"calling-code": "61", "country-name": "Territory of the Cocos (Keeling) Islands (Cocos (Keeling) Islands)"}, "CA": {"calling-code": "1", "country-name": "Canada"}, "CG": {"calling-code": "242", "country-name": "R\xe9publique du Congo (Republic of the Congo)"}, "CF": {"calling-code": "236", "country-name": "B\xeaafr\xeeka (Central African Republic)"}, "CD": {"calling-code": "243", "country-name": "RD Congo (DR Congo)"}, "CZ": {"calling-code": "420", "country-name": "\u010cesk\xe1 republika (Czech Republic)"}, "CY": {"calling-code": "357", "country-name": "\u039a\u03cd\u03c0\u03c1\u03bf\u03c2 (Cyprus)"}, "CX": {"calling-code": "61", "country-name": "Territory of Christmas Island (Christmas Island)"}, "CR": {"calling-code": "506", "country-name": "Rep\xfablica de Costa Rica (Costa Rica)"}, "CV": {"calling-code": "238", "country-name": "Cabo Verde (Cape Verde)"}, "CU": {"calling-code": "53", "country-name": "Rep\xfablica de Cuba (Cuba)"}, "SZ": {"calling-code": "268", "country-name": "Kingdom of Swaziland (Swaziland)"}, "SY": {"calling-code": "963", "country-name": "\u0633\u0648\u0631\u064a\u0627 (Syria)"}, "KG": {"calling-code": "996", "country-name": "\u041a\u044b\u0440\u0433\u044b\u0437\u0441\u0442\u0430\u043d (Kyrgyzstan)"}, "KE": {"calling-code": "254", "country-name": "Republic of Kenya (Kenya)"}, "SR": {"calling-code": "597", "country-name": "Republiek Suriname (Suriname)"}, "KI": {"calling-code": "686", "country-name": "Independent and Sovereign Republic of Kiribati (Kiribati)"}, "KH": {"calling-code": "855", "country-name": "K\xe2mp\u016dch\xe9a (Cambodia)"}, "KN": {"calling-code": "1869", "country-name": "Federation of Saint Christopher and Nevisa (Saint Kitts and Nevis)"}, "KM": {"calling-code": "269", "country-name": "Komori (Comoros)"}, "ST": {"calling-code": "239", "country-name": "S\xe3o Tom\xe9 e Pr\xedncipe (S\xe3o Tom\xe9 and Pr\xedncipe)"}, "SK": {"calling-code": "421", "country-name": "Slovensko (Slovakia)"}, "KR": {"calling-code": "82", "country-name": "\ub300\ud55c\ubbfc\uad6d (South Korea)"}, "SI": {"calling-code": "386", "country-name": "Slovenija (Slovenia)"}, "KP": {"calling-code": "850", "country-name": "\ubd81\ud55c (North Korea)"}, "KW": {"calling-code": "965", "country-name": "\u0627\u0644\u0643\u0648\u064a\u062a (Kuwait)"}, "SN": {"calling-code": "221", "country-name": "S\xe9n\xe9gal (Senegal)"}, "SM": {"calling-code": "378", "country-name": "Serenissima Repubblica di San Marino (San Marino)"}, "SL": {"calling-code": "232", "country-name": "Republic of Sierra Leone (Sierra Leone)"}, "SC": {"calling-code": "248", "country-name": "R\xe9publique des Seychelles (Seychelles)"}, "KZ": {"calling-code": "7", "country-name": "\u049a\u0430\u0437\u0430\u049b\u0441\u0442\u0430\u043d (Kazakhstan)"}, "KY": {"calling-code": "1345", "country-name": "Cayman Islands"}, "SG": {"calling-code": "65", "country-name": "Republic of Singapore (Singapore)"}, "SE": {"calling-code": "46", "country-name": "Sverige (Sweden)"}, "SD": {"calling-code": "249", "country-name": "\u0627\u0644\u0633\u0648\u062f\u0627\u0646 (Sudan)"}, "DO": {"calling-code": "1", "country-name": "Rep\xfablica Dominicana (Dominican Republic)"}, "DM": {"calling-code": "1767", "country-name": "Commonwealth of Dominica (Dominica)"}, "DJ": {"calling-code": "253", "country-name": "R\xe9publique de Djibouti (Djibouti)"}, "DK": {"calling-code": "45", "country-name": "Danmark (Denmark)"}, "VG": {"calling-code": "1284", "country-name": "Virgin Islands (British Virgin Islands)"}, "DE": {"calling-code": "49", "country-name": "Deutschland (Germany)"}, "YE": {"calling-code": "967", "country-name": "\u0627\u0644\u064a\u064e\u0645\u064e\u0646 (Yemen)"}, "DZ": {"calling-code": "213", "country-name": "\u0627\u0644\u062c\u0632\u0627\u0626\u0631 (Algeria)"}, "US": {"calling-code": "1", "country-name": "United States of America (United States)"}, "UY": {"calling-code": "598", "country-name": "Rep\xfablica Oriental del Uruguay (Uruguay)"}, "YT": {"calling-code": "262", "country-name": "D\xe9partement de Mayotte (Mayotte)"}, "UM": {"calling-code": "1", "country-name": "United States Minor Outlying Islands"}, "LB": {"calling-code": "961", "country-name": "\u0644\u0628\u0646\u0627\u0646 (Lebanon)"}, "LC": {"calling-code": "1758", "country-name": "Saint Lucia"}, "LA": {"calling-code": "856", "country-name": "\u0eaa\u0e9b\u0e9b\u0ea5\u0eb2\u0ea7 (Laos)"}, "TV": {"calling-code": "688", "country-name": "Tuvalu"}, "TW": {"calling-code": "886", "country-name": "\u81fa\u7063 (Taiwan)"}, "TT": {"calling-code": "1868", "country-name": "Republic of Trinidad and Tobago (Trinidad and Tobago)"}, "TR": {"calling-code": "90", "country-name": "T\xfcrkiye (Turkey)"}, "LK": {"calling-code": "94", "country-name": "\u0dc1\u0dca\u200d\u0dbb\u0dd3 \u0dbd\u0d82\u0d9a\u0dcf\u0dc0 (Sri Lanka)"}, "LI": {"calling-code": "423", "country-name": "F\xfcrstentum Liechtenstein (Liechtenstein)"}, "LV": {"calling-code": "371", "country-name": "Latvija (Latvia)"}, "TO": {"calling-code": "676", "country-name": "Kingdom of Tonga (Tonga)"}, "LT": {"calling-code": "370", "country-name": "Lietuva (Lithuania)"}, "LU": {"calling-code": "352", "country-name": "Grand-Duch\xe9 de Luxembourg (Luxembourg)"}, "LR": {"calling-code": "231", "country-name": "Republic of Liberia (Liberia)"}, "LS": {"calling-code": "266", "country-name": "Kingdom of Lesotho (Lesotho)"}, "TH": {"calling-code": "66", "country-name": "\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28\u0e44\u0e17\u0e22 (Thailand)"}, "TF": {"calling-code": "262", "country-name": "Territoire des Terres australes et antarctiques fran\xe7aises (French Southern and Antarctic Lands)"}, "TG": {"calling-code": "228", "country-name": "R\xe9publique togolaise (Togo)"}, "TD": {"calling-code": "235", "country-name": "Tchad (Chad)"}, "TC": {"calling-code": "1649", "country-name": "Turks and Caicos Islands"}, "LY": {"calling-code": "218", "country-name": "\u200f\u0644\u064a\u0628\u064a\u0627 (Libya)"}, "VA": {"calling-code": "379", "country-name": "Vaticano (Vatican City)"}, "VC": {"calling-code": "1784", "country-name": "Saint Vincent and the Grenadines"}, "AE": {"calling-code": "971", "country-name": "\u062f\u0648\u0644\u0629 \u0627\u0644\u0625\u0645\u0627\u0631\u0627\u062a \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0645\u062a\u062d\u062f\u0629 (United Arab Emirates)"}, "AD": {"calling-code": "376", "country-name": "Andorra"}, "AG": {"calling-code": "1268", "country-name": "Antigua and Barbuda"}, "AF": {"calling-code": "93", "country-name": "\u0627\u0641\u063a\u0627\u0646\u0633\u062a\u0627\u0646 (Afghanistan)"}, "AI": {"calling-code": "1264", "country-name": "Anguilla"}, "VI": {"calling-code": "1340", "country-name": "Virgin Islands of the United States (United States Virgin Islands)"}, "IS": {"calling-code": "354", "country-name": "\xcdsland (Iceland)"}, "IR": {"calling-code": "98", "country-name": "\u0627\u06cc\u0631\u0627\u0646 (Iran)"}, "AM": {"calling-code": "374", "country-name": "\u0540\u0561\u0575\u0561\u057d\u057f\u0561\u0576 (Armenia)"}, "AL": {"calling-code": "355", "country-name": "Shqip\xebria (Albania)"}, "AO": {"calling-code": "244", "country-name": "Rep\xfablica de Angola (Angola)"}, "AN": {"calling-code": "599", "country-name": "Antia Hulandes (Netherlands Antilles)"}, "AQ": {"calling-code": "672", "country-name": "Antarctica"}, "AP": {"calling-code": "", "country-name": ""}, "AS": {"calling-code": "1684", "country-name": "American Samoa"}, "AR": {"calling-code": "54", "country-name": "Rep\xfablica Argentina (Argentina)"}, "AU": {"calling-code": "61", "country-name": "Commonwealth of Australia (Australia)"}, "AT": {"calling-code": "43", "country-name": "\xd6sterreich (Austria)"}, "AW": {"calling-code": "297", "country-name": "Aruba"}, "IN": {"calling-code": "91", "country-name": "\u092d\u093e\u0930\u0924 (India)"}, "TZ": {"calling-code": "255", "country-name": "Jamhuri ya Muungano wa Tanzania (Tanzania)"}, "AZ": {"calling-code": "994", "country-name": "Az\u0259rbaycan (Azerbaijan)"}, "IE": {"calling-code": "353", "country-name": "\xc9ire (Ireland)"}, "ID": {"calling-code": "62", "country-name": "Republik Indonesia (Indonesia)"}, "UA": {"calling-code": "380", "country-name": "\u0423\u043a\u0440\u0430\u0457\u043d\u0430 (Ukraine)"}, "QA": {"calling-code": "974", "country-name": "\u0642\u0637\u0631 (Qatar)"}, "MZ": {"calling-code": "258", "country-name": "Mo\xe7ambique (Mozambique)"}}',
t.countryCodeList=JSON.parse(t.countryCodeJSON),t.loadCountryCodes=function(e){var o=t.countryCodeList,i=[];for(var r in o)o[r]["calling-code"]&&o[r]["country-name"]&&i.push(r);i.sort();var n,s;for(n=0,s=i.length;s>n;n++){r=i[n];var a=o[r]["calling-code"],l=o[r]["country-name"];e.append('<option value="'+r+'"> +'+a+" - "+l+"</option>")}},t.separatedNumberAndCountryCode=function(e,o){var i=e;if(t.countryCodeList[o]&&t.countryCodeList[o]["calling-code"]){var r="+"+t.countryCodeList[o]["calling-code"];e.substring(0,r.length)==r&&(i=e.substring(r.length))}else o="US";return{number:i,countryCode:o}},t.resizeCountryCodeSelect=function(e){var o="+"+t.countryCodeList[e.val()]["calling-code"],i=$("<span>").text(o).css("font",e.css("font")).css("font-size",e.css("font-size")).hide();$("body").append(i);var r=i.width()+30;i.remove(),e.width(r)},t}(window.phoneNumberHelper||{}),function(){var t;t=App.module("Helpers"),t.qtip=function(t,e,o,i){var r,n;return null==o&&(o=[]),null==i&&(i={}),n=document.createElement("div"),n.classList.add("popover"),n.classList.add("contain"),r=_.defaults(i,{content:$(n).append(e.addClass("clearfix").addClass("inside")),style:{classes:o.concat(["qtip-container"]).join(" "),def:!1,tip:{width:20,height:10,mimic:"top center"}},position:{my:"top center",at:"bottom center",viewport:$(window),effect:!1,adjust:{method:"shift",x:35,y:-15}},show:{delay:0,event:"click"},hide:{delay:0,event:"click unfocus"},events:{show:function(){return $(window).one("scroll",function(t){return function(){return t.qtip("hide")}}(this)),$(window).one("resize",function(t){return function(){return t.qtip("hide")}}(this))}}}),t.qtip(r).on("click",function(t){return t.preventDefault()})},t.qtipMenu=function(e,o,i){var r,n,s,a,l,u,p;return null==i&&(i={}),a=_.defaults(i,{activeClass:"selected",initial:null,footer:null,classes:[]}),l=document.createElement("div"),p=document.createElement("div"),_.map(["info","list"],function(t){return p.classList.add(t)}),l.appendChild(p),s=document.createElement("ul"),p.appendChild(s),r=$(l),n=null,a.footer&&(a.footer.addClass("footer"),r.append(a.footer)),_.map(o,function(t,e){var o,i,l;return l=document.createElement("li"),l.innerHTML='<a href="#">'+e+"</a>",o=$(l),i=function(){return r.find("."+a.activeClass).removeClass(a.activeClass),o.addClass(a.activeClass),t()},null!=a.initial&&a.initial===e&&i(),l.onclick=function(){return n.hide(),$(".qtip").hide(),i()},s.appendChild(l)}),u=_.omit(a,["activeClass","initial","footer","classes"]),n=t.qtip(e,$(l),a.classes,u).qtip("api")},t.translatedQtipMenu=function(e,o,i){var r,n,s,a;null==i&&(i={}),s={};for(r in o)a=o[r],n=e.i18n(r,{"return":!0}),s[n]=a;return t.qtipMenu(e,s,i)}}.call(this),function(){var t;t=App.module("Helpers"),t.Translator=function(){function t(){}return t.translate=function(t,e){var o,i,r;if(null!=window.bingAccessToken)return null==this._cachedResults&&(this._cachedResults={}),r=""+Math.ceil(1e10*Math.random()),i="bingTranslatorCallback_"+r,window[i]=function(t){return function(e){return t._cachedResults[r]=e}}(this),o={appId:"Bearer "+window.bingAccessToken,to:navigator.language,text:t,contentType:"text/html",oncomplete:"bingTranslatorCallback_"+r},$.ajax({url:"https://api.microsofttranslator.com/V2/Ajax.svc/Translate",type:"GET",data:o,dataType:"jsonp",complete:function(t){return function(){return e(t._cachedResults[r]),delete t._cachedResults[r],delete window[i]}}(this)})},t}()}.call(this),function(){var t;t=App.module("Photos"),null!=window.standalonePhotoPage&&App.start(),t.show=function(t,e){var o,i,r;return null==e&&(e={}),r=null!=(i=e.shouldUpdateUrl)?i:!0,r&&(App.Photos.previousUrl=Backbone.history.getFragment()),App.Photos.previousTitle=document.title,o=new App.Photos.Views.PhotosLayout({photoId:t,modal:!0,navigationContext:e.navigationContext,shouldUpdateUrl:r,newComment:e.newComment,GA:e.GA,commenter:e.commenter}),o.showModal(),o},t.executeActionWithPhotoModal=function(t){return App.Photos.isModalOpened&&App.vent.trigger("history:navigate:closePhoto"),App.Photos.isModalOpened&&App.Photos.previousUrl===Backbone.history.getFragment()?document.title=App.Photos.previousTitle:t(),App.Photos.isModalOpened=!1},t.showPhotoControllerAction=function(t){return App.Photos.isModalOpened?App.vent.trigger("history:navigate:photo",{photoId:t}):App.Photos.show(t,{shouldUpdateUrl:!1})}}.call(this);