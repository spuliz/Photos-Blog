function md5cycle(t,e){var i=t[0],o=t[1],n=t[2],r=t[3];i=ff(i,o,n,r,e[0],7,-680876936),r=ff(r,i,o,n,e[1],12,-389564586),n=ff(n,r,i,o,e[2],17,606105819),o=ff(o,n,r,i,e[3],22,-1044525330),i=ff(i,o,n,r,e[4],7,-176418897),r=ff(r,i,o,n,e[5],12,1200080426),n=ff(n,r,i,o,e[6],17,-1473231341),o=ff(o,n,r,i,e[7],22,-45705983),i=ff(i,o,n,r,e[8],7,1770035416),r=ff(r,i,o,n,e[9],12,-1958414417),n=ff(n,r,i,o,e[10],17,-42063),o=ff(o,n,r,i,e[11],22,-1990404162),i=ff(i,o,n,r,e[12],7,1804603682),r=ff(r,i,o,n,e[13],12,-40341101),n=ff(n,r,i,o,e[14],17,-1502002290),o=ff(o,n,r,i,e[15],22,1236535329),i=gg(i,o,n,r,e[1],5,-165796510),r=gg(r,i,o,n,e[6],9,-1069501632),n=gg(n,r,i,o,e[11],14,643717713),o=gg(o,n,r,i,e[0],20,-373897302),i=gg(i,o,n,r,e[5],5,-701558691),r=gg(r,i,o,n,e[10],9,38016083),n=gg(n,r,i,o,e[15],14,-660478335),o=gg(o,n,r,i,e[4],20,-405537848),i=gg(i,o,n,r,e[9],5,568446438),r=gg(r,i,o,n,e[14],9,-1019803690),n=gg(n,r,i,o,e[3],14,-187363961),o=gg(o,n,r,i,e[8],20,1163531501),i=gg(i,o,n,r,e[13],5,-1444681467),r=gg(r,i,o,n,e[2],9,-51403784),n=gg(n,r,i,o,e[7],14,1735328473),o=gg(o,n,r,i,e[12],20,-1926607734),i=hh(i,o,n,r,e[5],4,-378558),r=hh(r,i,o,n,e[8],11,-2022574463),n=hh(n,r,i,o,e[11],16,1839030562),o=hh(o,n,r,i,e[14],23,-35309556),i=hh(i,o,n,r,e[1],4,-1530992060),r=hh(r,i,o,n,e[4],11,1272893353),n=hh(n,r,i,o,e[7],16,-155497632),o=hh(o,n,r,i,e[10],23,-1094730640),i=hh(i,o,n,r,e[13],4,681279174),r=hh(r,i,o,n,e[0],11,-358537222),n=hh(n,r,i,o,e[3],16,-722521979),o=hh(o,n,r,i,e[6],23,76029189),i=hh(i,o,n,r,e[9],4,-640364487),r=hh(r,i,o,n,e[12],11,-421815835),n=hh(n,r,i,o,e[15],16,530742520),o=hh(o,n,r,i,e[2],23,-995338651),i=ii(i,o,n,r,e[0],6,-198630844),r=ii(r,i,o,n,e[7],10,1126891415),n=ii(n,r,i,o,e[14],15,-1416354905),o=ii(o,n,r,i,e[5],21,-57434055),i=ii(i,o,n,r,e[12],6,1700485571),r=ii(r,i,o,n,e[3],10,-1894986606),n=ii(n,r,i,o,e[10],15,-1051523),o=ii(o,n,r,i,e[1],21,-2054922799),i=ii(i,o,n,r,e[8],6,1873313359),r=ii(r,i,o,n,e[15],10,-30611744),n=ii(n,r,i,o,e[6],15,-1560198380),o=ii(o,n,r,i,e[13],21,1309151649),i=ii(i,o,n,r,e[4],6,-145523070),r=ii(r,i,o,n,e[11],10,-1120210379),n=ii(n,r,i,o,e[2],15,718787259),o=ii(o,n,r,i,e[9],21,-343485551),t[0]=add32(i,t[0]),t[1]=add32(o,t[1]),t[2]=add32(n,t[2]),t[3]=add32(r,t[3])}function cmn(t,e,i,o,n,r){return e=add32(add32(e,t),add32(o,r)),add32(e<<n|e>>>32-n,i)}function ff(t,e,i,o,n,r,s){return cmn(e&i|~e&o,t,e,n,r,s)}function gg(t,e,i,o,n,r,s){return cmn(e&o|i&~o,t,e,n,r,s)}function hh(t,e,i,o,n,r,s){return cmn(e^i^o,t,e,n,r,s)}function ii(t,e,i,o,n,r,s){return cmn(i^(e|~o),t,e,n,r,s)}function md51(t){txt="";var e,i=t.length,o=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)md5cycle(o,md5blk(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(md5cycle(o,n),e=0;16>e;e++)n[e]=0;return n[14]=8*i,md5cycle(o,n),o}function md5blk(t){var e,i=[];for(e=0;64>e;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}function rhex(t){for(var e="",i=0;4>i;i++)e+=hex_chr[t>>8*i+4&15]+hex_chr[t>>8*i&15];return e}function hex(t){for(var e=0;e<t.length;e++)t[e]=rhex(t[e]);return t.join("")}function md5(t){return hex(md51(t))}function add32(t,e){return t+e&4294967295}function add32(t,e){var i=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(i>>16);return o<<16|65535&i}(function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Models"),t.Photo=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments),this.imagesDownloadPromises={},this.imagesDownloaded={}},i.prototype.url=function(){return"https://api.500px.com/v1/photos/"+this.id},i.prototype._imageDownloadKey=function(t){return"size:"+t.size+"-https:"+t.https},i.prototype.prefetchImage=function(t){var e;return _.defaults(t,{size:4,https:!0}),e=this._imageDownloadKey(t),this.imagesDownloaded[e]||null!=this.imagesDownloadPromises[e]?void 0:this.downloadImage(t)},i.prototype.isImageDownloaded=function(t){return _.defaults(t,{size:4,https:!0}),this.imagesDownloaded[this._imageDownloadKey(t)]},i.prototype.downloadImage=function(t){var e,i,o,n;return _.defaults(t,{size:4,https:!0}),o=this._imageDownloadKey(t),this.imagesDownloadPromises[o]?this.imagesDownloadPromises[o]:(e=$.Deferred(),n=this.imagesDownloadPromises[o]=e.promise(),i=new Image,i.onload=function(n){return function(){return n.imagesDownloaded[o]=!0,e.resolve(i.src,t),n.imagesDownloadPromises[o]=null}}(this),i.onerror=function(i){return function(){return e.reject(t),i.imagesDownloadPromises[o]=null}}(this),i.src=this.getImagePath(t),n)},i.prototype.addDownloadedImageSize=function(t){var e;return _.defaults(t,{size:4,https:!0}),e=this._imageDownloadKey(t),this.imagesDownloaded[e]=!0},i.prototype.getImagePathAndSize=function(t){var e,i;return _.defaults(t,{size:4,https:!0,ignoresConverting:!0}),e=this.getInternalImagePathAndSize(t),null==e&&(3===(i=t.size)||600===i?3!==t.size&&(t.size=3,e=this.getInternalImagePathAndSize(t)):4!==t.size&&(t.size=4,e=this.getInternalImagePathAndSize(t))),null==e&&(t.size=null,e=this.getInternalImagePathAndSize(t)),e},i.prototype.getInternalImagePathAndSize=function(t){var e,i,o,n,r,s;n=this.get("images");for(e in n)if(i=n[e],t.size===i.size||null==t.size)return o=t.https?null!=(r=i.https_url)?r:i.secure_url:i.url,s=i.size,t.ignoresConverting&&o.match(/\/placeholder\//)?null:{path:o,size:s};return null},i.prototype.getImagePath=function(t){var e;return e=this.getImagePathAndSize(t),null!=e?e.path:void 0},i.prototype.getInternalImagePath=function(t){var e;return e=this.getInternalImagePathAndSize(t),null!=e?e.path:void 0},i.prototype.parse=function(t){var e;return null!=(e=t.photo)?e:t},i.prototype.isPublic=function(){return this.get("privacy")===!1},i.prototype.isPrivate=function(){return this.get("privacy")===!0},i.prototype.imageUrl=function(){var t,e;return e=this.getInternalImagePath({size:4,https:!0}),null==e&&(e=this.getInternalImagePath({size:34,https:!0})),null==e&&(e=this.get("images")[0].secure_url),null!=e?e:null!=(t=this.get("images")[0])?t.url:void 0},i.prototype.isConverting=function(){return null!=this.get("converted")&&0===this.get("converted")||this.imageUrl().indexOf("/placeholder/")>=0},i.prototype.dimensionsForImageSize=function(t){var e,i,o,n,r,s;return s=this.get("width"),r=this.get("height"),null!=s&&null!=r?(n={14:900,34:1e3,35:1500,36:2e3},e=n[t],null==e&&(e=t),s>r?(o=Math.min(s,e),i=Math.round(r*o/s)):(i=Math.min(r,e),o=Math.round(s*i/r)),{width:o,height:i}):void 0},i.prototype.submitToQuest=function(t){return $.post("https://api.500px.com/v1/quests/"+t+"/entries",{photo_id:this.get("id")})},i}(Backbone.Model)}).call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty,o=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("Organizer.Models"),t.Photo=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.url=function(){return"https://api.500px.com/v1/photos/"+this.id+"?"+$.param({include_licensing:!0,image_size:[3]})},i.prototype.inMarketplace=function(){var t,e,i;return t=[8,1,0],null!=(e=this.get("marketplace"))?e:null!=this.get("licensing_id")&&(i=this.get("licensing_status"),o.call(t,i)<0)},i}(App.Models.Photo)}.call(this),function(){var t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;t=null!=(e="undefined"!=typeof App&&null!==App?App.module("Models"):void 0)?e:PxApp,t.UploadedFile=function(t){function e(t){var o,n;if(this.file=t,this._timeoutUpload=i(this._timeoutUpload,this),this._fakeCompleteUpload=i(this._fakeCompleteUpload,this),this._updateProgress=i(this._updateProgress,this),!this.file||null==(null!=(o=null!=(n=this.file.url)?n:this.file.type)?o:this.file.photo_id))throw new Error("UploadedPhoto requires a file arguments");e.__super__.constructor.call(this)}return o(e,t),e.prototype.baseUrl=function(){return PxConfig.endpoints.media_service_upload_url},e.prototype.initialize=function(){return this.set("name",this.file.name),this.set("upload_status","not_started")},e.prototype.url=function(){return this.baseUrl()+"?"+$.param({authenticity_token:PxApp.csrf_token})},e.prototype.beginUpload=function(){return this.set("upload_status","in_progress"),this.set("upload_finished",!1),this._createParent().then(function(t){return function(){return t._uploadFile()}}(this)).fail(function(t){return function(){return t.set("upload_status","error")}}(this))},e.prototype.abort=function(){var t;return null!=(t=this.api)&&t.xhr.abort(),this.set("upload_status","aborted")},e.prototype._createParent=function(){return $.Deferred().resolve()},e.prototype._uploadFile=function(){var t,e,i;return e=$.Deferred(),t=new FormData,this.file.url?t.append("remote_url",this.file.url):this.file.photo_id?t.append("source_photo_id",this.file.photo_id):t.append("file",this.file),i=_.result(this,"url"),this.api=PxApp.api.post(i,t,{api_url:PxApp.api.upload_url,processData:!1,contentType:!1,cache:!1,xhr:function(t){return function(){var e;return e=$.ajaxSettings.xhr(),e.upload.addEventListener("progress",t._updateProgress),e}}(this)}),this.api.error(function(t){return function(i){var o,n;return 4===i.readyState?(o=JSON.parse(i.responseText),n="server_error",void 0!==o.error_key&&(n=o.error_key)):n="connection_error",t.set("upload_status","error"),e.reject()}}(this)),this.api.success(function(t){return function(){return t.set("upload_status","success"),e.resolve()}}(this)),this.api.complete(function(t){return function(){return t._realUploadFinished=!0,t.set("upload_finished",!0)}}(this)),e},e.prototype._updateProgress=function(t){var e;return e=t.lengthComputable?t.loaded/t.total*100:50,100===Math.round(e)&&_.delay(this._fakeCompleteUpload,5e3),this.set("upload_progress",e)},e.prototype._fakeCompleteUpload=function(){var t;if(this.get("upload_finished")!==!0)return t=new Error("Possible hanging upload: "+this.get("id")),"undefined"!=typeof NREUM&&null!==NREUM&&NREUM.noticeError(t),this.set({upload_finished:!0,upload_status:"success"}),_.delay(this._timeoutUpload,5e3)},e.prototype._timeoutUpload=function(){var t;if(!this._realUploadFinished)return t=new Error("Aborting hanging upload: "+this.get("id")),"undefined"!=typeof NREUM&&null!==NREUM&&NREUM.noticeError(t),this.api.xhr.abort()},e}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Models"),t.UploadedPhoto=function(t){function i(t,e,o){this.file=t,this.autoActivate=null!=e?e:!0,this.uploadToLocalListingClaim=null!=o?o:null,i.__super__.constructor.call(this,this.file)}return e(i,t),i.prototype.url=function(){return i.__super__.url.call(this)+"&"+$.param({upload_key:this._uploadKey,photo_id:this.get("id")})},i.prototype.initialize=function(){return i.__super__.initialize.call(this),this.set("images",[])},i.prototype._createParent=function(){var t,e;return t=$.Deferred(),e={auto_activate:this.autoActivate},null!==this.uploadToLocalListingClaim&&(e.use_assignments_user=!0),this.api=PxApp.api.post("/photos",e),this.api.success(function(e){return function(i){return e._uploadKey=i.upload_key,e.set(_.omit(i.photo,"name","images")),t.resolve()}}(this)),this.api.error(function(e){return function(i){return e.set("upload_status","error"),e.set("upload_error",!0),e.set("upload_finished",!0),t.reject()}}(this)),t},i}(App.Models.UploadedFile)}.call(this);var BinaryFile=function(t,e,i){var o=t.byteLength,n=new DataView(t);this.getRawData=function(){return n},this.getByteAt=function(t){if(t>o)throw"Tried to read past the end of the file";return n.getUint8(t)},this.getBytesAt=function(t,e){var i,o=t+e,r=[];for(i=t;o>=i;i++)r.push(n.getInt8(i));return r},this.getLength=function(){return o},this.getSByteAt=function(t){var e=this.getByteAt(t);return e>127?e-256:e},this.getShortAt=function(t,e){var i=e?(this.getByteAt(t)<<8)+this.getByteAt(t+1):(this.getByteAt(t+1)<<8)+this.getByteAt(t);return 0>i&&(i+=65536),i},this.getSShortAt=function(t,e){var i=this.getShortAt(t,e);return i>32767?i-65536:i},this.getLongAt=function(t,e){var i=this.getByteAt(t),o=this.getByteAt(t+1),n=this.getByteAt(t+2),r=this.getByteAt(t+3),s=e?(((i<<8)+o<<8)+n<<8)+r:(((r<<8)+n<<8)+o<<8)+i;return 0>s&&(s+=4294967296),s},this.getSLongAt=function(t,e){var i=this.getLongAt(t,e);return i>2147483647?i-4294967296:i},this.getStringAt=function(t,e){for(var i=[],o=this.getBytesAt(t,e),n=0;e>n;n++)i[n]=String.fromCharCode(o[n]);return i.join("")},this.getCharAt=function(t){return String.fromCharCode(this.getByteAt(t))},this.toBase64=function(){return window.btoa(n)},this.fromBase64=function(t){n=window.atob(t)}},EXIF={};!function(){function t(t){for(var e,i,o,n,r,s,a=2,l=t.getLength();l>a&&!(a+4>l)&&(e=t.getByteAt(a++),255==e);){if(i=t.getByteAt(a++),o=t.getShortAt(a,!0),200!=i&&192==(240&i)&&l>=a+7){a+=3,s=t.getShortAt(a,!0),a+=2,r=t.getShortAt(a,!0);break}for(a+=o;l>a;)if(e=t.getByteAt(a++),255==e&&l>a&&(n=t.getByteAt(a++),0!=n)){a-=2;break}}return{Width:r,Height:s}}function e(e){var i=function(t){for(var e={},i=0;i<t.length;i++)$.extend(e,t[i]);return e};try{var n=[];if(255!=e.getByteAt(0)||216!=e.getByteAt(1))return n;n.push(t(e));for(var r=2,l=e.getLength();l>r;){if(255!=e.getByteAt(r))return a&&console.log("Not a valid marker at offset "+r+", found: "+e.getByteAt(r)),i(n);var u=e.getByteAt(r+1);22400==u?(a&&console.log("Found 0xFFE1 marker"),n.push(s(e,r+4,e.getShortAt(r+2,!0)-2)),r+=2+e.getShortAt(r+2,!0)):225==u?(a&&console.log("Found 0xFFE1 marker"),n.push(s(e,r+4,e.getShortAt(r+2,!0)-2))):237==u&&(a&&console.log("Found 0xFFED marker"),n.push(o(e,r+4,e.getShortAt(r+2,!0)-2))),r+=2+e.getShortAt(r+2,!0)}}catch(h){}return i(n)}function i(t){try{return decodeURIComponent(escape(t))}catch(e){try{return decodeURIComponent(UTF8.decode(t))}catch(e){return null}}}function o(t,e,o){var n={};if("Photoshop"!=t.getStringAt(e,9))return a&&console.log("Not valid Photoshop data! "+t.getStringAt(e,9)),!1;var r,s,l,u,h,p=[];for(h=0;o>h;h++){var c=t.getByteAt(e+h);if(!(28!=c||h+1>=o)){var d=t.getByteAt(e+h+1);if(2==d){h+=1;var f=String(t.getByteAt(e+h))+":"+String(t.getByteAt(e+h+1)),g=t.getShortAt(e+h+2,!0);if(0!=g){var m=null;try{m=i(t.getStringAt(e+h+4,g))}catch(_){}if(!m)continue;"2:120"==f?n.ImageDescription=m:"2:15"==f?r=m:"2:20"==f?s=m:"2:25"==f?p.push(m):"2:5"==f?l=m:"2:105"==f?u=m:"2:80"==f&&(n.Artist=m),h+=g+3}}}}return n.ImageTitle=l||u,n.ImageKeywords=p.join(","),n.ImageCategory=r||s,n}function n(t,e,i,o,n){for(var s=t.getShortAt(i,n),l={},u=0;s>u;u++){var h=i+12*u+2,p=o[t.getShortAt(h,n)];!p&&a&&console.log("Unknown tag: "+t.getShortAt(h,n)),l[p]=r(t,h,e,i,n)}return l}function r(t,e,i,o,n){var r=t.getShortAt(e+2,n),s=t.getLongAt(e+4,n),a=t.getLongAt(e+8,n)+i;switch(r){case 1:case 7:if(1==s)return t.getByteAt(e+8,n);for(var l=s>4?a:e+8,u=[],h=0;s>h;h++)u[h]=t.getByteAt(l+h);return u;case 2:var p=s>4?a:e+8;return t.getStringAt(p,s-1);case 3:if(1==s)return t.getShortAt(e+8,n);for(var l=s>2?a:e+8,u=[],h=0;s>h;h++)u[h]=t.getShortAt(l+2*h,n);return u;case 4:if(1==s)return t.getLongAt(e+8,n);for(var u=[],h=0;s>h;h++)u[h]=t.getLongAt(a+4*h,n);return u;case 5:if(1==s)return t.getLongAt(a,n)/t.getLongAt(a+4,n);for(var u=[],h=0;s>h;h++)u[h]=t.getLongAt(a+8*h,n)/t.getLongAt(a+4+8*h,n);return u;case 9:if(1==s)return t.getSLongAt(e+8,n);for(var u=[],h=0;s>h;h++)u[h]=t.getSLongAt(a+4*h,n);return u;case 10:if(1==s)return t.getSLongAt(a,n)/t.getSLongAt(a+4,n);for(var u=[],h=0;s>h;h++)u[h]=t.getSLongAt(a+8*h,n)/t.getSLongAt(a+4+8*h,n);return u}}function s(t,e,i){if("Exif"!=t.getStringAt(e,4))return a&&console.log("Not valid EXIF data! "+t.getStringAt(e,4)),!1;var o,r=e+6;if(18761==t.getShortAt(r))o=!1;else{if(19789!=t.getShortAt(r))return a&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;o=!0}if(42!=t.getShortAt(r+2,o))return a&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var s=t.getLongAt(r+4,o),l=n(t,r,r+s,EXIF.TiffTags,o);if(l.ExifIFDPointer){var u=n(t,r,r+l.ExifIFDPointer,EXIF.Tags,o);for(var h in u){switch(h){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":u[h]=EXIF.StringValues[h][u[h]];break;case"ExifVersion":case"FlashpixVersion":u[h]=String.fromCharCode(u[h][0],u[h][1],u[h][2],u[h][3]);break;case"ComponentsConfiguration":u[h]=EXIF.StringValues.Components[u[h][0]]+EXIF.StringValues.Components[u[h][1]]+EXIF.StringValues.Components[u[h][2]]+EXIF.StringValues.Components[u[h][3]]}l[h]=u[h]}}if(l.GPSInfoIFDPointer){var p=n(t,r,r+l.GPSInfoIFDPointer,EXIF.GPSTags,o);for(var h in p){switch(h){case"GPSVersionID":p[h]=p[h][0]+"."+p[h][1]+"."+p[h][2]+"."+p[h][3]}l[h]=p[h]}}return l}var a=!1;EXIF.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID",42036:"LensModel"},EXIF.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},EXIF.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},EXIF.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},EXIF.readFromBinaryFile=function(t){return e(t)}}(),UTF8={encode:function(t){for(var e,i=-1,o=(t=t.split("")).length,n=String.fromCharCode;++i<o;t[i]=(e=t[i].charCodeAt(0))>=127?n(192|e>>>6)+n(128|63&e):t[i]);return t.join("")},decode:function(t){for(var e,i,o=-1,n=(t=t.split("")).length,r=String.fromCharCode,s="charCodeAt";++o<n;128&(e=t[o][s](0))&&(t[o]=r(192==(252&e)&&128==(192&(i=t[o+1][s](0)))?((3&e)<<6)+(63&i):128),t[++o]=""));return t.join("")}},function t(e,i,o){function n(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return n(i?i:t)},h,h.exports,t,e,i,o)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)n(o[s]);return n}({1:[function(t,e,i){var o=t("./index"),n=function(){return this}();n.ExifParser=o},{"./index":2}],2:[function(t,e,i){function o(){return this}var n=t("./lib/parser");e.exports={create:function(e,i){if(i=i||o(),e instanceof i.ArrayBuffer){var r=t("./lib/dom-bufferstream");return new n(new r(e,0,e.byteLength,!0,i))}var s=t("./lib/bufferstream");return new n(new s(e,0,e.length,!0))}}},{"./lib/bufferstream":3,"./lib/dom-bufferstream":5,"./lib/parser":9}],3:[function(t,e,i){function o(t,e,i,o){this.buffer=t,this.offset=e||0,i="number"==typeof i?i:t.length,this.endPosition=this.offset+i,this.setBigEndian(o)}o.prototype={setBigEndian:function(t){this.bigEndian=!!t},nextUInt8:function(){var t=this.buffer.readUInt8(this.offset);return this.offset+=1,t},nextInt8:function(){var t=this.buffer.readInt8(this.offset);return this.offset+=1,t},nextUInt16:function(){var t=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,t},nextUInt32:function(){var t=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,t},nextInt16:function(){var t=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,t},nextInt32:function(){var t=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,t},nextFloat:function(){var t=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,t},nextDouble:function(){var t=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,t},nextBuffer:function(t){var e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e},remainingLength:function(){return this.endPosition-this.offset},nextString:function(t){var e=this.buffer.toString("ascii",this.offset,this.offset+t);return this.offset+=t,e},mark:function(){var t=this;return{openWithOffset:function(e){return e=(e||0)+this.offset,new o(t.buffer,e,t.endPosition-e,t.bigEndian)},offset:this.offset}},offsetFrom:function(t){return this.offset-t.offset},skip:function(t){this.offset+=t},branch:function(t,e){return e="number"==typeof e?e:this.endPosition-(this.offset+t),new o(this.buffer,this.offset+t,e,this.bigEndian)}},e.exports=o},{}],4:[function(t,e,i){function o(t){return parseInt(t,10)}function n(t,e){t=t.map(o),e=e.map(o);var i=new Date;i.setUTCFullYear(t[0]),i.setUTCMonth(t[1]-1),i.setUTCDate(t[2]),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i.setUTCMilliseconds(0);var n=i.getTime()/1e3;return n}function r(t){var e=t.substr(0,10).split("-"),i=t.substr(11,8).split(":"),r=t.substr(19,6),s=r.split(":").map(o),a=s[0]*l+s[1]*u,h=n(e,i);return h-=a,"number"!=typeof h||isNaN(h)?void 0:h}function s(t){var e=t.split(" "),i=e[0].split(":"),o=e[1].split(":"),r=n(i,o);return"number"!=typeof r||isNaN(r)?void 0:r}function a(t){var e=19===t.length&&":"===t.charAt(4),i=25===t.length&&"T"===t.charAt(10);return i?r(t):e?s(t):void 0}var l=3600,u=60;e.exports={parseDateWithSpecFormat:s,parseDateWithTimezoneFormat:r,parseExifDate:a}},{}],5:[function(t,e,i){function o(t,e,i,o,n,r){this.global=n,e=e||0,i=i||t.byteLength-e,this.arrayBuffer=t.slice(e,e+i),this.view=new n.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(o),this.offset=0,this.parentOffset=(r||0)+e}o.prototype={setBigEndian:function(t){this.littleEndian=!t},nextUInt8:function(){var t=this.view.getUint8(this.offset);return this.offset+=1,t},nextInt8:function(){var t=this.view.getInt8(this.offset);return this.offset+=1,t},nextUInt16:function(){var t=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,t},nextUInt32:function(){var t=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,t},nextInt16:function(){var t=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,t},nextInt32:function(){var t=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,t},nextFloat:function(){var t=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t},nextDouble:function(){var t=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t},nextBuffer:function(t){var e=this.arrayBuffer.slice(this.offset,this.offset+t);return this.offset+=t,e},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(t){var e=this.arrayBuffer.slice(this.offset,this.offset+t);return e=String.fromCharCode.apply(null,new this.global.Uint8Array(e)),this.offset+=t,e},mark:function(){var t=this;return{openWithOffset:function(e){return e=(e||0)+this.offset,new o(t.arrayBuffer,e,t.arrayBuffer.byteLength-e,!t.littleEndian,t.global,t.parentOffset)},offset:this.offset,getParentOffset:function(){return t.parentOffset}}},offsetFrom:function(t){return this.parentOffset+this.offset-(t.offset+t.getParentOffset())},skip:function(t){this.offset+=t},branch:function(t,e){return e="number"==typeof e?e:this.arrayBuffer.byteLength-(this.offset+t),new o(this.arrayBuffer,this.offset+t,e,!this.littleEndian,this.global,this.parentOffset)}},e.exports=o},{}],6:[function(t,e,i){e.exports={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",
34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}}},{}],7:[function(t,e,i){function o(t,e){switch(t){case 1:return e.nextUInt8();case 3:return e.nextUInt16();case 4:return e.nextUInt32();case 5:return[e.nextUInt32(),e.nextUInt32()];case 6:return e.nextInt8();case 8:return e.nextUInt16();case 9:return e.nextUInt32();case 10:return[e.nextInt32(),e.nextInt32()];case 11:return e.nextFloat();case 12:return e.nextDouble();default:throw new Error("Invalid format while decoding: "+t)}}function n(t){switch(t){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function r(t,e){var i,r,s=e.nextUInt16(),a=e.nextUInt16(),l=n(a),u=e.nextUInt32(),h=l*u;if(h>4&&(e=t.openWithOffset(e.nextUInt32())),2===a){i=e.nextString(u);var p=i.indexOf("\x00");-1!==p&&(i=i.substr(0,p))}else if(7===a)i=e.nextBuffer(u);else if(0!==a)for(i=[],r=0;u>r;++r)i.push(o(a,e));return 4>h&&e.skip(4-h),[s,i,a]}function s(t,e,i){var o,n,s=e.nextUInt16();for(n=0;s>n;++n)o=r(t,e),i(o[0],o[1],o[2])}function a(t){var e=t.nextString(6);if("Exif\x00\x00"!==e)throw new Error("Invalid EXIF header");var i=t.mark(),o=t.nextUInt16();if(18761===o)t.setBigEndian(!1);else{if(19789!==o)throw new Error("Invalid TIFF header");t.setBigEndian(!0)}if(42!==t.nextUInt16())throw new Error("Invalid TIFF data");return i}e.exports={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(t,e){var i;try{i=a(t)}catch(o){return!1}var n,r,l,u=i.openWithOffset(t.nextUInt32()),h=this.IFD0;s(i,u,function(t,i,o){switch(t){case 34853:r=i[0];break;case 34665:n=i[0];break;default:e(h,t,i,o)}});var p=u.nextUInt32();if(0!==p){var c=i.openWithOffset(p);s(i,c,e.bind(null,this.IFD1))}if(r){var d=i.openWithOffset(r);s(i,d,e.bind(null,this.GPSIFD))}if(n){var f=i.openWithOffset(n),g=this.InteropIFD;s(i,f,function(t,i,o){40965===t?l=i[0]:e(g,t,i,o)})}if(l){var m=i.openWithOffset(l);s(i,m,e.bind(null,this.InteropIFD))}return!0}}},{}],8:[function(t,e,i){e.exports={parseSections:function(t,e){var i,o;for(t.setBigEndian(!0);t.remainingLength()>0&&218!==o;){if(255!==t.nextUInt8())throw new Error("Invalid JPEG section offset");o=t.nextUInt8(),i=o>=208&&217>=o||218===o?0:t.nextUInt16()-2,e(o,t.branch(0,i)),t.skip(i)}},getSizeFromSOFSection:function(t){return t.skip(1),{height:t.nextUInt16(),width:t.nextUInt16()}},getSectionName:function(t){var e,i;switch(t){case 216:e="SOI";break;case 196:e="DHT";break;case 219:e="DQT";break;case 221:e="DRI";break;case 218:e="SOS";break;case 254:e="COM";break;case 217:e="EOI";break;default:t>=224&&239>=t?(e="APP",i=t-224):t>=192&&207>=t&&196!==t&&200!==t&&204!==t?(e="SOF",i=t-192):t>=208&&215>=t&&(e="RST",i=t-208)}var o={name:e};return"number"==typeof i&&(o.index=i),o}}},{}],9:[function(t,e,i){function o(t,e,i,o,n,r,s){this.startMarker=t,this.tags=e,this.imageSize=i,this.thumbnailOffset=o,this.thumbnailLength=n,this.thumbnailType=r,this.app1Offset=s}function n(t){this.stream=t,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}var r=t("./jpeg"),s=t("./exif"),a=t("./simplify");o.prototype={hasThumbnail:function(t){return this.thumbnailOffset&&this.thumbnailLength?"string"!=typeof t?!0:"image/jpeg"===t.toLowerCase().trim()?6===this.thumbnailType:"image/tiff"===t.toLowerCase().trim()?1===this.thumbnailType:!1:!1},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var t,e=this._getThumbnailStream();return r.parseSections(e,function(e,i){"SOF"===r.getSectionName(e).name&&(t=r.getSizeFromSOFSection(i))}),t}},n.prototype={enableBinaryFields:function(t){return this.flags.readBinaryTags=!!t,this},enablePointers:function(t){return this.flags.hidePointers=!t,this},enableTagNames:function(t){return this.flags.resolveTagNames=!!t,this},enableImageSize:function(t){return this.flags.imageSize=!!t,this},enableReturnTags:function(t){return this.flags.returnTags=!!t,this},enableSimpleValues:function(t){return this.flags.simplifyValues=!!t,this},parse:function(){var e,i,n,l,u,h,p,c,d,f=this.stream.mark(),g=f.openWithOffset(0),m=this.flags;return m.resolveTagNames&&(p=t("./exif-tags")),m.resolveTagNames?(e={},c=function(t){return e[t.name]},d=function(t,i){e[t.name]=i}):(e=[],c=function(t){var i;for(i=0;i<e.length;++i)if(e[i].type===t.type&&e[i].section===t.section)return e.value},d=function(t,i){var o;for(o=0;o<e.length;++o)if(e[o].type===t.type&&e[o].section===t.section)return void(e.value=i)}),r.parseSections(g,function(t,o){var c,d=o.offsetFrom(f);225===t?(c=s.parseTags(o,function(t,i,o,r){if(m.readBinaryTags||7!==r){if(513===i){if(n=o[0],m.hidePointers)return}else if(514===i){if(l=o[0],m.hidePointers)return}else if(259===i&&(u=o[0],m.hidePointers))return;if(m.returnTags)if(m.simplifyValues&&(o=a.simplifyValue(o,r)),m.resolveTagNames){var h=t===s.GPSIFD?p.gps:p.exif,c=h[i];c||(c=p.exif[i]),e[c]=o}else e.push({section:t,type:i,value:o})}}),c&&(h=d)):m.imageSize&&"SOF"===r.getSectionName(t).name&&(i=r.getSizeFromSOFSection(o))}),m.simplifyValues&&(a.castDegreeValues(c,d),a.castDateValues(c,d)),new o(f,e,i,n,l,u,h)}},e.exports=n},{"./exif":7,"./exif-tags":6,"./jpeg":8,"./simplify":10}],10:[function(t,e,i){var o=t("./exif"),n=t("./date"),r=[{section:o.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:o.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],s=[{section:o.SubIFD,type:36867,name:"DateTimeOriginal"},{section:o.SubIFD,type:36868,name:"CreateDate"}];e.exports={castDegreeValues:function(t,e){r.forEach(function(i){var o=t(i);if(o){var n=t({section:i.section,type:i.refType,name:i.refName}),r=n===i.posVal?1:-1,s=(o[0]+o[1]/60+o[2]/3600)*r;e(i,s)}})},castDateValues:function(t,e){s.forEach(function(i){var o=t(i);if(o){var r=n.parseExifDate(o);"undefined"!=typeof r&&e(i,r)}})},simplifyValue:function(t,e){return Array.isArray(t)&&(t=t.map(function(t){return 10===e||5===e?t[0]/t[1]:t}),1===t.length&&(t=t[0])),t}}},{"./date":4,"./exif":7}]},{},[1]),function(){var t,e,i;e=null!=(i="undefined"!=typeof App&&null!==App?App.module("Models"):void 0)?i:PxApp,e.ExifParser=function(){function i(t){this.setFile(t)}return i.prototype.setFile=function(t){return this.file=t},i.prototype.getFile=function(){return this.file},i.prototype.extractExif=function(){var t;return t=$.Deferred(),this._loadExifFromFile(this.file).done(function(i){return function(o){return i.cleanedAttributes=e.ExifParser.cleanExif(o,i.file),t.resolve(i.cleanedAttributes)}}(this)),t},i.cleanExif=function(t,e){var i;return null==t&&(t=this.exifData),null==e&&(e=null),i={},_.extend(i,this.extractTakenAt(t)),_.extend(i,this.extractShutterSpeed(t)),_.extend(i,this.extractCameraAndLens(t)),_.extend(i,this.extractTitleAndDescription(t,null!=e?e.name:void 0)),_.extend(i,this.extractTags(t)),_.extend(i,this.extractLatLng(t)),_.extend(i,this.extractOrientation(t)),i},i.extractTakenAt=function(t){return void 0!==t.DateTimeOriginal?{taken_at:t.DateTimeOriginal}:t.DateTimeDigitized?{taken_at:t.DateTimeDigitized}:{}},i.extractShutterSpeed=function(t){return void 0!==t.ExposureTime?t.ExposureTime<1?{shutter_speed:"1/"+Math.round(1/t.ExposureTime)}:{shutter_speed:Math.floor(t.ExposureTime)}:{}},i.extractCameraAndLens=function(t){var e;return e={},t.Model&&(e.camera=t.Model),t.FocalLength&&(e.focal_length=t.FocalLength),t.ISOSpeedRatings&&(e.iso=t.ISOSpeedRatings),t.FNumber&&(e.aperture=t.FNumber),t.LensModel&&(e.lens=t.LensModel),e},i.extractTitleAndDescription=function(t,e){var i,o,n,r;return null==e&&(e=null),n={},o=(t.ImageTitle||"").trim(),i=(t.ImageDescription||"").trim(),o&&i?(n.name=o,n.description=i):o||i?n.name=o||i:e&&(r=this.extractTitleFromFilename(e),r&&(n.name=r)),n},i.extractTags=function(t){var e;return void 0!==t.ImageKeywords&&(e=_.unique(t.ImageKeywords.split(/\s*(?:;|,)\s*/)),e.length>0&&""!==e[0])?{tags:e}:{}},i.extractLatLng=function(t){var e;return e={},_.extend(e,this.extractLat(t)),_.extend(e,this.extractLng(t)),e},i.extractLat=function(t){var e,i;return t.GPSLatitude&&t.GPSLongitude?(i="S"===t.GPSLatitudeRef?-1:1,e=(t.GPSLatitude[0]||0)+(t.GPSLatitude[1]||0)/60+(t.GPSLatitude[2]||0)/3600,e*=i,{latitude:Math.round(1e6*e)/1e6}):{}},i.extractLng=function(t){var e,i;return t.GPSLatitude&&t.GPSLongitude?(i="W"===t.GPSLongitudeRef?-1:1,e=(t.GPSLongitude[0]||0)+(t.GPSLongitude[1]||0)/60+(t.GPSLongitude[2]||0)/3600,e*=i,{longitude:Math.round(1e6*e)/1e6}):{}},i.extractOrientation=function(t){var e;return!t.Orientation||1!==(e=parseInt(t.Orientation,10))&&2!==e&&3!==e&&4!==e&&5!==e&&6!==e&&7!==e&&8!==e?{}:{orientation:parseInt(t.Orientation,10)}},i.extractTitleFromFilename=function(t){var e;for(t=t.trim(),t=t.replace(/\.[A-Za-z]{1,4}$/," "),e="";e!==t;)e=t,t=t.replace(/([_A-Z0-9]{4}[0-9]{4,8})([^0-9].*)/,"$2");return t=t.replace(/[_:,\-\.\s\\\/]+/g," "),t=t.replace(/([0-9]+\s?)*/g,""),t.trim()},i.prototype.hasThumbnail=function(){var t;return t=this._getExifResult(),t.hasThumbnail("image/jpeg")||t.hasThumbnail("image/png")},i.prototype.getThumbnail=function(){var e,i;if(!this.arrayBuffer)throw new Error("Cannot extract until _loadExifFromFile");return e=$.Deferred(),i=this._getExifResult(),i.hasThumbnail("image/jpeg")?e.resolve("data:image/jpeg;base64,"+t(i.getThumbnailBuffer())):i.hasThumbnail("image/png")?e.resolve("data:image/png;base64,"+t(i.getThumbnailBuffer())):e.reject(),e},i.prototype.getDimensions=function(){return this._getExifResult().imageSize},i.prototype._getExifResult=function(){var t;return null!=this._exifResult?this._exifResult:(t=window.ExifParser.create(this.arrayBuffer),this._exifResult=t.parse())},i.prototype._loadExifFromFile=function(t){var e;return e=$.Deferred(),App.Lib.FileReader.readAsArrayBuffer(t).done(function(t){return function(i){var o,n;return t.arrayBuffer=i,o=new BinaryFile(t.arrayBuffer),n=EXIF.readFromBinaryFile(o),e.resolve(n)}}(this)),e},i}(),t=function(t){return btoa(String.fromCharCode.apply(null,new Uint8Array(t)))}}.call(this),function(){var t,e,i,o,n;n=App.module("Models"),e=1,t=8,i=6,o=3,n.FileThumbnailer=function(){function n(t,i){var o,n,r,s;null==i&&(i={}),this.file=t,this.maxWidth=null!=(o=i.maxWidth)?o:256,this.maxHeight=null!=(n=i.maxHeight)?n:256,this.exif=i.exif,this.orientation=null!=(r=null!=(s=this.exif)?s.cleanedAttributes.orientation:void 0)?r:e}return n.prototype.generateThumbnail=function(){var t,e,i,o,n;if(t=$.Deferred(),this.file.type.match("image.*")){try{o=null!=(n=this.exif)?n.hasThumbnail():void 0}catch(i){e=i,"undefined"!=typeof NREUM&&null!==NREUM&&NREUM.noticeError(e),this._makeThumbnail(t)}o?this.exif.getThumbnail().done(function(e){return function(i){return e._dataUrlToImage(i,function(i){return i.width>=.75*e.maxWidth||i.height>=.75*e.maxHeight?e._applyOrientation({image:i}).done(function(e){return t.resolve(e)}):e._makeThumbnail(t)})}}(this)):this._makeThumbnail(t)}else t.reject("Invalid file type");return t},n.prototype._makeThumbnail=function(t){return this._readFromFile(function(e){return function(i,o){var n,r,s;return r=[i.width,i.height],s=r[0],n=r[1],s/2>e.maxWidth&&n/2>e.maxHeight?t.resolve(e._scaleByHalf(i)):e._applyOrientation({image:i,dataUrl:o}).done(function(e){return t.resolve(e)})}}(this)),t},n.prototype._readFromFile=function(t){return App.Lib.FileReader.readAsDataURL(this.file).done(function(e){return function(i){return e._dataUrlToImage(i,function(e){return t(e,i)})}}(this))},n.prototype._imageToCanvas=function(t){var e,i;return e=document.createElement("canvas"),e.width=t.width,e.height=t.height,i=e.getContext("2d"),i.imageSmoothingEnabled=!0,i.drawImage(t,0,0,t.width,t.height),e},n.prototype._scaleByHalf=function(t){var e,i,o,n,r,s,a;for(s=[t.width,t.height],a=s[0],r=s[1],e=document.createElement("canvas"),e.width=a/2,e.height=r/2,o=e.getContext("2d"),o.imageSmoothingEnabled=!0,o.drawImage(t,0,0,a/2,r/2),a/=2,r/=2;a/2>this.maxWidth&&r/2>this.maxHeight;)a=0|a,r=0|r,o.drawImage(e,0,0,a,r,0,0,a/2,r/2),a/=2,r/=2;return a=0|a,r=0|r,i=document.createElement("canvas"),i.width=a,i.height=r,n=i.getContext("2d"),n.imageSmoothingEnabled=!0,n.drawImage(e,0,0,a,r,0,0,a,r),this._applyOrientationToCanvas(i).toDataURL("image/jpeg")},n.prototype._applyOrientation=function(t){var i,o;return o=$.Deferred(),t.dataUrl&&this.orientation===e?o.resolve(t.dataUrl):(t.image?(i=this._imageToCanvas(t.image),i=this._applyOrientationToCanvas(i),o.resolve(i.toDataURL("image/jpeg"))):this._dataUrlToImage(t.dataUrl,function(t){return function(e){return i=t._imageToCanvas(e),i=t._applyOrientationToCanvas(i),o.resolve(i.toDataURL("image/jpeg"))}}(this)),o)},n.prototype._dataUrlToImage=function(t,e){var i;return i=new Image,i.onload=function(){return e(i)},i.src=t},n.prototype._applyOrientationToCanvas=function(n){var r,s,a,l,u,h,p;return this.orientation===e?n:(a=document.createElement("canvas"),(l=this.orientation)===t||l===i||l===o?(u=this.orientation===t?[-90,n.height,n.width]:this.orientation===o?[180,n.width,n.height]:this.orientation===i?[90,n.height,n.width]:void 0,h=u[0],p=u[1],s=u[2],a.width=p,a.height=s,r=a.getContext("2d"),r.imageSmoothingEnabled=!0,r.translate(p/2,s/2),r.rotate(h/180*Math.PI),r.drawImage(n,-(n.width/2),-(n.height/2)),a):void 0)},n}()}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Uploader.Models"),t.Photo=function(t){function i(t){if(this.uploadedPhoto=t,!(this.uploadedPhoto instanceof App.Models.UploadedPhoto))throw new Error("Must pass Uploader.Models.Photo an uploadedPhoto");i.__super__.constructor.call(this),this.set("tags",[]),this.set(this.uploadedPhoto.attributes),this.bindEvents()}return e(i,t),i.prototype.loadExifAndThumbnail=function(){return this.parseExif().done(function(t){return function(){return t.loadThumbnail()}}(this))},i.prototype.loadThumbnail=function(t,e){var i;if(null==t&&(t=256),null==e&&(e=256),!this.exifParsed)throw new Error("Cannot load thumbnails utnil exif is parsed");if(this.thumbLoaded)throw new Error("Thumb already loaded");return i=$.Deferred(),this.uploadedPhoto.file.url?(this._setImageUrl(this.uploadedPhoto.file.url),this.thumbLoaded=!0,i.resolve()):new App.Models.FileThumbnailer(this.uploadedPhoto.file,{exif:this.exifParser,maxWidth:t,maxHeight:e}).generateThumbnail().done(function(t){return function(e){return t._setImageUrl(e),t.thumbLoaded=!0,i.resolve()}}(this)),i},i.prototype.parseExif=function(){return this.uploadedPhoto.file.url?(this.exifParsed=!0,$.Deferred().resolve()):(this.exifParser=new App.Models.ExifParser(this.uploadedPhoto.file),this.exifParser.extractExif().done(function(t){return function(e){return t.exifParsed=!0,null!=e.tags&&(e.tags=e.tags.concat(t.get("tags"))),t.set(e)}}(this)))},i.prototype.bindEvents=function(){return this.forwardProperties(this.uploadedPhoto,"id","upload_progress","upload_status","upload_finished"),this.on("remove",function(t){return function(){return t.uploadedPhoto.collection.remove(t.uploadedPhoto)}}(this))},i.prototype.abort=function(){return this.uploadedPhoto.abort()},i.prototype.save=function(){var t,e;return t=this.attributes.images,delete this.attributes.images,e=i.__super__.save.call(this),e?e.always(function(e){return function(){return e.attributes.images=t}}(this)):this.attributes.images=t,e},i.prototype._setImageUrl=function(t){return this.set("images",[{https_url:t,size:4}])},i}(App.Organizer.Models.Photo)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Uploader.Collections"),t.Photos=function(t){function i(t,e,o,n,r,s){this.uploadedPhotos=t,this.uploadDestination=e,this.defaultTag=o,this.quest=n,this.uploadToLocalListingClaim=r,this.listingProjectId=s,i.__super__.constructor.call(this,!1)}return e(i,t),i.prototype.model=App.Uploader.Models.Photo,i.prototype.initialize=function(){var t,e,i,o,n,r;for(this.uploadedPhotos.on("add",function(t){return function(e){var i;return i=new t.model(e),i.set("selected",!0),t._setUploadDestination(i),t._setUploadToLocalListingClaimAttr(i),t._setDefaultTag(i),t.add(i)}}(this)),this.uploadedPhotos.on("remove",function(t){return function(e){return t.remove(new t.model(e))}}(this)),n=this.uploadedPhotos.models,r=[],t=0,e=n.length;e>t;t++)o=n[t],i=new this.model(o),i.set("selected",!0),this._setUploadDestination(i),this._setUploadToLocalListingClaimAttr(i),this._setDefaultTag(i),r.push(this.add(i));return r},i.prototype.publish=function(){var t,e,i,o,n,r,s,a,l,u;for(t=this.toJSON(),a=_.reject(t,function(t){return t.rejected===!0}),e=0,n=a.length;n>e;e++)s=a[e],null!=s.tags&&(s.tags=s.tags.join(",")),s.sets=function(){var t,e;t=s.sets,e=[];for(o in t)u=t[o],e.push(u);return e}().join(","),delete s.images,null!=s.releases&&(s.releases=function(){var t,e,o,n;for(o=s.releases,n=[],t=0,e=o.length;e>t;t++)i=o[t],32===i.length?n.push(App.Uploader.releases[i].get("id")):n.push(i);return n}(),s.releases=s.releases.join(",")),delete s.upload_status,delete s.upload_percent;return l="https://webapi.500px.com/uploader/publish",a.length>0?(r={photos:a},null!=this.uploadToLocalListingClaim&&(r.claim_id=this.uploadToLocalListingClaim),null!=this.quest&&(r.quest=this.quest),$.post(l,r)):$.Deferred().resolve()},i.prototype.successful=function(){return this.filter(function(t){return"success"===t.uploadedPhoto.get("upload_status")})},i.prototype.finishSelection=function(){return this.trigger("selection:finished")},i.prototype.parseExif=function(){var t,e;return t=$.Deferred(),e=function(i){return function(){var o;return o=i.find(function(t){return!t.exifParsed}),o?o.parseExif().done(e):(t.resolve(),i.finishSelection())}}(this),e(),t},i.prototype.loadThumbnails=function(){var t,e;return t=$.Deferred(),e=function(i){return function(){var o;return o=i.find(function(t){return t.exifParsed&&!t.thumbLoaded}),o?o.loadThumbnail().done(e):t.resolve()}}(this),e(),t},i.prototype.checkRequirements=function(){return null!=this.uploadToLocalListingClaim?_.each(this.models,function(t){return function(e){var i;return i=e.exifParser.getDimensions(),null!=e.get("rejected")==!0||t._checkDimensionsAgainstProjectId(i)?void 0:(e.set("rejected",!0),App.vent.trigger("photo:locallistings:rejected"))}}(this)):void 0},i.prototype._setDefaultTag=function(t){return null!=this.defaultTag?t.get("tags").push(this.defaultTag):void 0},i.prototype._setUploadToLocalListingClaimAttr=function(t){return null!==this.uploadToLocalListingClaim?(t.set("privacy","1"),t.set("listing_project_id",this.listingProjectId)):void 0},i.prototype._setUploadDestination=function(t){return null==this.uploadDestination?t.set("privacy","0"):"public"===this.uploadDestination.get("path")?t.set("privacy","0"):null!=this.uploadDestination.get("id")?"portfolio"!==this.uploadDestination.get("kind")&&3!==this.uploadDestination.get("kind")?t.set("galleries",[this.uploadDestination.get("id")]):t.set("sets",[this.uploadDestination.get("id")]):void 0},i.prototype._checkDimensionsAgainstProjectId=function(t){return 1===this.listingProjectId?t.width>=4200||t.height>=4200:t.width>=3e3||t.height>=3e3},i}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Uploader.Collections"),t.Portfolios=function(t){function o(){return this.parse=e(this.parse,this),o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.model=Backbone.Model,o.prototype.url=function(){var t;return t={page:this.page,rpp:50,source:"portfolio"},"https://webapi.500px.com/organizer/sources/set?"+$.param(t)},o.prototype.fetchAll=function(){return this.fetchDfd=$.Deferred(),this.page=1,this.on("sync",function(t){return function(){return t.fetchNextPage()}}(this)),this.fetch(),this.fetchDfd.promise()},o.prototype.fetchNextPage=function(){return this.page>=this.total_pages?this.fetchDfd.resolve():(this.page+=1,this.fetch({remove:!1}))},o.prototype.parse=function(t){return this.page=t.current_page,this.total_pages=t.total_pages,t.sets},o}(Backbone.Collection)}.call(this),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.ProgressBar=t()}}(function(){var t;return function e(t,i,o){function n(s,a){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[s]={exports:{}};t[s][0].call(h.exports,function(e){var i=t[s][1][e];return n(i?i:e)},h,h.exports,e,t,i,o)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)n(o[s]);return n}({1:[function(e,i,o){!function(e){"undefined"==typeof SHIFTY_DEBUG_NOW&&(SHIFTY_DEBUG_NOW=function(){return+new Date});var n=function(){"use strict";function n(){}function r(t,e){var i;for(i in t)Object.hasOwnProperty.call(t,i)&&e(i)}function s(t,e){return r(e,function(i){t[i]=e[i]}),t}function a(t,e){r(e,function(i){"undefined"==typeof t[i]&&(t[i]=e[i])})}function l(t,e,i,o,n,r,s){var a,l=(t-r)/n;for(a in e)e.hasOwnProperty(a)&&(e[a]=u(i[a],o[a],f[s[a]],l));return e}function u(t,e,i,o){return t+(e-t)*i(o)}function h(t,e){var i=d.prototype.filter,o=t._filterArgs;r(i,function(n){"undefined"!=typeof i[n][e]&&i[n][e].apply(t,o)})}function p(t,e,i,o,n,r,s,a,u){w=e+i,C=Math.min(b(),w),P=C>=w,t.isPlaying()&&!P?(u(t._timeoutHandler,v),h(t,"beforeTween"),l(C,o,n,r,i,e,s),h(t,"afterTween"),a(o)):P&&(a(r),t.stop(!0))}function c(t,e){var i={};return"string"==typeof e?r(t,function(t){i[t]=e}):r(t,function(t){i[t]||(i[t]=e[t]||m)}),i}function d(t,e){this._currentState=t||{},this._configured=!1,this._scheduleFunction=g,"undefined"!=typeof e&&this.setConfig(e)}var f,g,m="linear",_=500,v=1e3/60,y=Date.now?Date.now:function(){return+new Date},b=SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:y;g="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame||setTimeout:setTimeout;var w,C,P;return d.prototype.tween=function(t){return this._isTweening?this:(void 0===t&&this._configured||this.setConfig(t),this._start(this.get()),this.resume())},d.prototype.setConfig=function(t){t=t||{},this._configured=!0,this._pausedAtTime=null,this._start=t.start||n,this._step=t.step||n,this._finish=t.finish||n,this._duration=t.duration||_,this._currentState=t.from||this.get(),this._originalState=this.get(),this._targetState=t.to||this.get(),this._timestamp=b();var e=this._currentState,i=this._targetState;return a(i,e),this._easing=c(e,t.easing||m),this._filterArgs=[e,this._originalState,i,this._easing],h(this,"tweenCreated"),this},d.prototype.get=function(){return s({},this._currentState)},d.prototype.set=function(t){this._currentState=t},d.prototype.pause=function(){return this._pausedAtTime=b(),this._isPaused=!0,this},d.prototype.resume=function(){this._isPaused&&(this._timestamp+=b()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0;var t=this;return this._timeoutHandler=function(){p(t,t._timestamp,t._duration,t._currentState,t._originalState,t._targetState,t._easing,t._step,t._scheduleFunction)},this._timeoutHandler(),this},d.prototype.stop=function(t){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=n,t&&(s(this._currentState,this._targetState),h(this,"afterTweenEnd"),this._finish.call(this,this._currentState)),this},d.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},d.prototype.setScheduleFunction=function(t){this._scheduleFunction=t},d.prototype.dispose=function(){var t;for(t in this)this.hasOwnProperty(t)&&delete this[t]},d.prototype.filter={},d.prototype.formula={linear:function(t){return t}},f=d.prototype.formula,s(d,{now:b,each:r,tweenProps:l,tweenProp:u,applyFilter:h,shallowCopy:s,defaults:a,composeEasingObject:c}),"function"==typeof SHIFTY_DEBUG_NOW&&(e.timeoutHandler=p),"object"==typeof o?i.exports=d:"function"==typeof t&&t.amd?t(function(){return d}):"undefined"==typeof e.Tweenable&&(e.Tweenable=d),d}();!function(){n.shallowCopy(n.prototype.formula,{easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return Math.pow(t-1,5)+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInSine:function(t){return-Math.cos(t*(Math.PI/2))+1},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1);
},easeOutBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swingFromTo:function(t){var e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},swingFrom:function(t){var e=1.70158;return t*t*((e+1)*t-e)},swingTo:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},bounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?2-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},easeFromTo:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeFrom:function(t){return Math.pow(t,4)},easeTo:function(t){return Math.pow(t,.25)}})}(),function(){function t(t,e,i,o,n,r){function s(t){return((d*t+f)*t+g)*t}function a(t){return((m*t+_)*t+v)*t}function l(t){return(3*d*t+2*f)*t+g}function u(t){return 1/(200*t)}function h(t,e){return a(c(t,e))}function p(t){return t>=0?t:0-t}function c(t,e){var i,o,n,r,a,u;for(n=t,u=0;8>u;u++){if(r=s(n)-t,p(r)<e)return n;if(a=l(n),p(a)<1e-6)break;n-=r/a}if(i=0,o=1,n=t,i>n)return i;if(n>o)return o;for(;o>i;){if(r=s(n),p(r-t)<e)return n;t>r?i=n:o=n,n=.5*(o-i)+i}return n}var d=0,f=0,g=0,m=0,_=0,v=0;return g=3*e,f=3*(o-e)-g,d=1-g-f,v=3*i,_=3*(n-i)-v,m=1-v-_,h(t,u(r))}function e(e,i,o,n){return function(r){return t(r,e,i,o,n,1)}}n.setBezierFunction=function(t,i,o,r,s){var a=e(i,o,r,s);return a.x1=i,a.y1=o,a.x2=r,a.y2=s,n.prototype.formula[t]=a},n.unsetBezierFunction=function(t){delete n.prototype.formula[t]}}(),function(){function t(t,e,i,o,r){return n.tweenProps(o,e,t,i,1,0,r)}var e=new n;e._filterArgs=[],n.interpolate=function(i,o,r,s){var a=n.shallowCopy({},i),l=n.composeEasingObject(i,s||"linear");e.set({});var u=e._filterArgs;u.length=0,u[0]=a,u[1]=i,u[2]=o,u[3]=l,n.applyFilter(e,"tweenCreated"),n.applyFilter(e,"beforeTween");var h=t(i,a,o,r,l);return n.applyFilter(e,"afterTween"),h}}(),function(t){function e(t,e){k.length=0;var i,o=t.length;for(i=0;o>i;i++)k.push("_"+e+"_"+i);return k}function i(t){var e=t.match(w);return e?(1===e.length||t[0].match(b))&&e.unshift(""):e=["",""],e.join(T)}function o(e){t.each(e,function(t){var i=e[t];"string"==typeof i&&i.match(x)&&(e[t]=n(i))})}function n(t){return l(x,t,r)}function r(t){var e=s(t);return"rgb("+e[0]+","+e[1]+","+e[2]+")"}function s(t){return t=t.replace(/#/,""),3===t.length&&(t=t.split(""),t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),I[0]=a(t.substr(0,2)),I[1]=a(t.substr(2,2)),I[2]=a(t.substr(4,2)),I}function a(t){return parseInt(t,16)}function l(t,e,i){var o=e.match(t),n=e.replace(t,T);if(o)for(var r,s=o.length,a=0;s>a;a++)r=o.shift(),n=n.replace(T,i(r));return n}function u(t){return l(P,t,h)}function h(t){for(var e=t.match(C),i=e.length,o=t.match(S)[0],n=0;i>n;n++)o+=parseInt(e[n],10)+",";return o=o.slice(0,-1)+")"}function p(o){var n={};return t.each(o,function(t){var r=o[t];if("string"==typeof r){var s=_(r);n[t]={formatString:i(r),chunkNames:e(s,t)}}}),n}function c(e,i){t.each(i,function(t){for(var o=e[t],n=_(o),r=n.length,s=0;r>s;s++)e[i[t].chunkNames[s]]=+n[s];delete e[t]})}function d(e,i){t.each(i,function(t){var o=e[t],n=f(e,i[t].chunkNames),r=g(n,i[t].chunkNames);o=m(i[t].formatString,r),e[t]=u(o)})}function f(t,e){for(var i,o={},n=e.length,r=0;n>r;r++)i=e[r],o[i]=t[i],delete t[i];return o}function g(t,e){A.length=0;for(var i=e.length,o=0;i>o;o++)A.push(t[e[o]]);return A}function m(t,e){for(var i=t,o=e.length,n=0;o>n;n++)i=i.replace(T,+e[n].toFixed(4));return i}function _(t){return t.match(C)}function v(e,i){t.each(i,function(t){for(var o=i[t],n=o.chunkNames,r=n.length,s=e[t].split(" "),a=s[s.length-1],l=0;r>l;l++)e[n[l]]=s[l]||a;delete e[t]})}function y(e,i){t.each(i,function(t){for(var o=i[t],n=o.chunkNames,r=n.length,s="",a=0;r>a;a++)s+=" "+e[n[a]],delete e[n[a]];e[t]=s.substr(1)})}var b=/(\d|\-|\.)/,w=/([^\-0-9\.]+)/g,C=/[0-9.\-]+/g,P=new RegExp("rgb\\("+C.source+/,\s*/.source+C.source+/,\s*/.source+C.source+"\\)","g"),S=/^.*\(/,x=/#([0-9]|[a-f]){3,6}/gi,T="VAL",k=[],I=[],A=[];t.prototype.filter.token={tweenCreated:function(t,e,i,n){o(t),o(e),o(i),this._tokenData=p(t)},beforeTween:function(t,e,i,o){v(o,this._tokenData),c(t,this._tokenData),c(e,this._tokenData),c(i,this._tokenData)},afterTween:function(t,e,i,o){d(t,this._tokenData),d(e,this._tokenData),d(i,this._tokenData),y(o,this._tokenData)}}}(n)}(this)},{}],2:[function(t,e,i){var o=t("./shape"),n=t("./utils"),r=function(t,e){this._pathTemplate="M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",o.apply(this,arguments)};r.prototype=new o,r.prototype.constructor=r,r.prototype._pathString=function(t){var e=t.strokeWidth;t.trailWidth&&t.trailWidth>t.strokeWidth&&(e=t.trailWidth);var i=50-e/2;return n.render(this._pathTemplate,{radius:i,"2radius":2*i})},r.prototype._trailString=function(t){return this._pathString(t)},e.exports=r},{"./shape":6,"./utils":8}],3:[function(t,e,i){var o=t("./shape"),n=t("./utils"),r=function(t,e){this._pathTemplate="M 0,{center} L 100,{center}",o.apply(this,arguments)};r.prototype=new o,r.prototype.constructor=r,r.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 "+e.strokeWidth),t.setAttribute("preserveAspectRatio","none")},r.prototype._pathString=function(t){return n.render(this._pathTemplate,{center:t.strokeWidth/2})},r.prototype._trailString=function(t){return this._pathString(t)},e.exports=r},{"./shape":6,"./utils":8}],4:[function(t,e,i){var o=t("./line"),n=t("./circle"),r=t("./square"),s=t("./path");e.exports={Line:o,Circle:n,Square:r,Path:s}},{"./circle":2,"./line":3,"./path":5,"./square":7}],5:[function(t,e,i){var o=t("shifty"),n=t("./utils"),r={easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"},s=function(t,e){e=n.extend({duration:800,easing:"linear",from:{},to:{},step:function(){}},e),this._path=t,this._opts=e,this._tweenable=null;var i=this._path.getTotalLength();this._path.style.strokeDasharray=i+" "+i,this.set(0)};s.prototype.value=function(){var t=this._getComputedDashOffset(),e=this._path.getTotalLength(),i=1-t/e;return parseFloat(i.toFixed(6),10)},s.prototype.set=function(t){this.stop(),this._path.style.strokeDashoffset=this._progressToOffset(t);var e=this._opts.step;if(n.isFunction(e)){var i=this._easing(this._opts.easing),o=this._calculateTo(t,i);e(o,this._opts.attachment||this)}},s.prototype.stop=function(){this._stopTween(),this._path.style.strokeDashoffset=this._getComputedDashOffset()},s.prototype.animate=function(t,e,i){e=e||{},n.isFunction(e)&&(i=e,e={});var r=n.extend({},e),s=n.extend({},this._opts);e=n.extend(s,e);var a=this._easing(e.easing),l=this._resolveFromAndTo(t,a,r);this.stop(),this._path.getBoundingClientRect();var u=this._getComputedDashOffset(),h=this._progressToOffset(t),p=this;this._tweenable=new o,this._tweenable.tween({from:n.extend({offset:u},l.from),to:n.extend({offset:h},l.to),duration:e.duration,easing:a,step:function(t){p._path.style.strokeDashoffset=t.offset,e.step(t,e.attachment)},finish:function(t){n.isFunction(i)&&i()}})},s.prototype._getComputedDashOffset=function(){var t=window.getComputedStyle(this._path,null);return parseFloat(t.getPropertyValue("stroke-dashoffset"),10)},s.prototype._progressToOffset=function(t){var e=this._path.getTotalLength();return e-t*e},s.prototype._resolveFromAndTo=function(t,e,i){return i.from&&i.to?{from:i.from,to:i.to}:{from:this._calculateFrom(e),to:this._calculateTo(t,e)}},s.prototype._calculateFrom=function(t){return o.interpolate(this._opts.from,this._opts.to,this.value(),t)},s.prototype._calculateTo=function(t,e){return o.interpolate(this._opts.from,this._opts.to,t,e)},s.prototype._stopTween=function(){null!==this._tweenable&&(this._tweenable.stop(),this._tweenable.dispose(),this._tweenable=null)},s.prototype._easing=function(t){return r.hasOwnProperty(t)?r[t]:t},e.exports=s},{"./utils":8,shifty:1}],6:[function(t,e,i){var o=t("./path"),n=t("./utils"),r="Object is destroyed",s=function a(t,e){if(!(this instanceof a))throw new Error("Constructor was called without new keyword");if(0!==arguments.length){this._opts=n.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{autoStyle:!0,color:null,value:"",className:"progressbar-text"}},e,!0);var i,r=this._createSvgView(this._opts);if(i=n.isString(t)?document.querySelector(t):t,!i)throw new Error("Container does not exist: "+t);this._container=i,this._container.appendChild(r.svg),this.text=null,this._opts.text.value&&(this.text=this._createTextElement(this._opts,this._container),this._container.appendChild(this.text)),this.svg=r.svg,this.path=r.path,this.trail=r.trail;var s=n.extend({attachment:this},this._opts);this._progressPath=new o(r.path,s)}};s.prototype.animate=function(t,e,i){if(null===this._progressPath)throw new Error(r);this._progressPath.animate(t,e,i)},s.prototype.stop=function(){if(null===this._progressPath)throw new Error(r);void 0!==this._progressPath&&this._progressPath.stop()},s.prototype.destroy=function(){if(null===this._progressPath)throw new Error(r);this.stop(),this.svg.parentNode.removeChild(this.svg),this.svg=null,this.path=null,this.trail=null,this._progressPath=null,null!==this.text&&(this.text.parentNode.removeChild(this.text),this.text=null)},s.prototype.set=function(t){if(null===this._progressPath)throw new Error(r);this._progressPath.set(t)},s.prototype.value=function(){if(null===this._progressPath)throw new Error(r);return void 0===this._progressPath?0:this._progressPath.value()},s.prototype.setText=function(t){if(null===this._progressPath)throw new Error(r);null===this.text&&(this.text=this._createTextElement(this._opts,this._container),this._container.appendChild(this.text)),this.text.removeChild(this.text.firstChild),this.text.appendChild(document.createTextNode(t))},s.prototype._createSvgView=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(e,t);var i=null;(t.trailColor||t.trailWidth)&&(i=this._createTrail(t),e.appendChild(i));var o=this._createPath(t);return e.appendChild(o),{svg:e,path:o,trail:i}},s.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 100")},s.prototype._createPath=function(t){var e=this._pathString(t);return this._createPathElement(e,t)},s.prototype._createTrail=function(t){var e=this._trailString(t),i=n.extend({},t);return i.trailColor||(i.trailColor="#eee"),i.trailWidth||(i.trailWidth=i.strokeWidth),i.color=i.trailColor,i.strokeWidth=i.trailWidth,i.fill=null,this._createPathElement(e,i)},s.prototype._createPathElement=function(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",t),i.setAttribute("stroke",e.color),i.setAttribute("stroke-width",e.strokeWidth),e.fill?i.setAttribute("fill",e.fill):i.setAttribute("fill-opacity","0"),i},s.prototype._createTextElement=function(t,e){var i=document.createElement("p");return i.appendChild(document.createTextNode(t.text.value)),t.text.autoStyle&&(e.style.position="relative",i.style.position="absolute",i.style.top="50%",i.style.left="50%",i.style.padding=0,i.style.margin=0,n.setStyle(i,"transform","translate(-50%, -50%)"),t.text.color?i.style.color=t.text.color:i.style.color=t.color),i.className=t.text.className,i},s.prototype._pathString=function(t){throw new Error("Override this function for each progress bar")},s.prototype._trailString=function(t){throw new Error("Override this function for each progress bar")},e.exports=s},{"./path":5,"./utils":8}],7:[function(t,e,i){var o=t("./shape"),n=t("./utils"),r=function(t,e){this._pathTemplate="M 0,{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{strokeWidth}",this._trailTemplate="M {startMargin},{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{halfOfStrokeWidth}",o.apply(this,arguments)};r.prototype=new o,r.prototype.constructor=r,r.prototype._pathString=function(t){var e=100-t.strokeWidth/2;return n.render(this._pathTemplate,{width:e,strokeWidth:t.strokeWidth,halfOfStrokeWidth:t.strokeWidth/2})},r.prototype._trailString=function(t){var e=100-t.strokeWidth/2;return n.render(this._trailTemplate,{width:e,strokeWidth:t.strokeWidth,halfOfStrokeWidth:t.strokeWidth/2,startMargin:t.strokeWidth/2-t.trailWidth/2})},e.exports=r},{"./shape":6,"./utils":8}],8:[function(t,e,i){function o(t,e,i){t=t||{},e=e||{},i=i||!1;for(var n in e)if(e.hasOwnProperty(n)){var r=t[n],s=e[n];i&&h(r)&&h(s)?t[n]=o(r,s,i):t[n]=s}return t}function n(t,e){var i=t;for(var o in e)if(e.hasOwnProperty(o)){var n=e[o],r="\\{"+o+"\\}",s=new RegExp(r,"g");i=i.replace(s,n)}return i}function r(t,e,i){for(var o=0;o<p.length;++o){var n=s(p[o]);t.style[n+s(e)]=i}t.style[e]=i}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function a(t){return"string"==typeof t||t instanceof String}function l(t){return"function"==typeof t}function u(t){return"[object Array]"===Object.prototype.toString.call(t)}function h(t){if(u(t))return!1;var e=typeof t;return"object"===e&&!!t}var p="webkit moz o ms".split(" ");e.exports={extend:o,render:n,setStyle:r,capitalize:s,isString:a,isFunction:l,isObject:h}},{}]},{},[4])(4)}),function(){var t=function(t,i){function o(){this.constructor=t}for(var n in i)e.call(i,n)&&(t[n]=i[n]);return o.prototype=i.prototype,t.prototype=new o,t.__super__=i.prototype,t},e={}.hasOwnProperty;App.Behaviors.HasProgressBar=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.modelEvents={"change:upload_progress":"changeUploadProgress","change:upload_finished":"changeUploadFinished"},i.prototype.initialize=function(t){var e;return t===!0&&(t={}),this.progressSelector=null!=(e=t.selector)?e:".uploaded_file_progress_bar"},i.prototype.changeUploadProgress=function(t,e){return this.progressBar.animate(e/100)},i.prototype.changeUploadFinished=function(t,e){return this.$el.toggleClass("upload_finished",e===!0)},i.prototype.onRender=function(){return this.changeUploadFinished(this.view.model,this.view.model.get("upload_finished")),this.view.model.get("upload_finished")!==!0?(this.progressBar=new ProgressBar.Circle(this.$(this.progressSelector)[0],{color:"#1898dd",trailColor:"#c4e3f9",strokeWidth:15,trailWidth:15,duration:0}),this.changeUploadProgress()):void 0},i}(Marionette.Behavior)}.call(this);var hex_chr="0123456789abcdef".split("");if("5d41402abc4b2a76b9719d911017c592"!=md5("hello"),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Uploader.Models"),t.Release=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.defaults={same:!0,count:0},i.prototype.initialize=function(t){return t.uploadedRelease?(this.uploadedRelease=t.uploadedRelease,this.set(_.pick(this.uploadedRelease.attributes,"name")),this.forwardProperties(this.uploadedRelease,"id","upload_progress","upload_status","upload_finished")):this.set({upload_progress:100,upload_status:"finished",upload_finished:!0})},i}(Backbone.Model)}.call(this),function(){var t,e,i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Uploader.Collections"),e=[],t.Releases=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.url="https://webapi.500px.com/licensing/releases",e.prototype.model=App.Uploader.Models.Release,e.prototype.parse=function(t){return t.licensing_releases},e}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Uploader.Collections"),t.Sets=function(t){function o(){return this.parse=e(this.parse,this),o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.model=Backbone.Model,o.prototype.url="https://webapi.500px.com/organizer/sources",o.prototype.parse=function(t){return t.sources.profile},o}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Uploader.Models"),t.Set=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.baseUrl=function(){return"https://webapi.500px.com/organizer/sets"},i.prototype.url=function(){return this.isNew()?this.baseUrl():this.baseUrl()+"/"+this.get("id")},i.prototype.parse=function(t){return t.set},i.generatePath=function(t){var e,i,o;for(o=e=t.trim().toLowerCase().replace(/[^a-z0-9_ -]/g," ").replace(/\s+/g,"-"),i=0;App.Uploader.sets.findWhere({path:o})||App.Uploader.portfolios.findWhere({path:o});)i+=1,o=e+"-"+i;return o},i}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Organizer.Models"),t.Tag=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.idAttribute="name",i.prototype.url=function(){var t,e;return t=this.taggableModel.url().split("?"),e=t.length>1?t[1]:"",t[0]+"/tags?"+e+"tags="+this.attributes.name},i.prototype.initialize=function(t,e){return this.taggableModel=e.taggableModel},i.prototype.isNew=function(){return!1},i}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Organizer.Collections"),t.Photos=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.model=App.Organizer.Models.Photo,i}(Backbone.Collection),t.PhotoTags=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.model=App.Organizer.Models.Tag,i}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty,o=[].slice;t=App.module("Organizer.Models"),t.BatchEditablePhoto=function(t){function i(t,e){var o,n,r;for(null==e&&(e={}),this.photos=t,o=0,n=t.length;n>o;o++)r=t[o],this.listenTo(r,"change:name",this.onNameChange);this._createEditableFields(),this.on("sync",this.onSync),i.__super__.constructor.call(this,{},e)}return e(i,t),i.prototype.editableFields=["name","description","category","nsfw","camera","lens","focal_length","shutter_speed","aperture","iso","taken_at","license_type","releases","licensing_status","licensing_id","licensing_type","licensing_errors","exclusive_use","licensing_usage","watermark","marketplace"],i.prototype.exifFields=["camera","lens","focal_length","shutter_speed","aperture","iso","taken_at"],i.prototype.discoverabilityWeights={category:2,tags:2,name:2,description:1,geolocation:3},i.prototype.photos_with_max_tags=[],i.prototype.sameTags={},i.prototype.tags=[],i.prototype.initialize=function(){return this.previousTagsToAdd=[]},i.prototype.defaults=function(){return{add_galleries:[],remove_galleries:[],add_sets:[],remove_sets:[],add_releases:[],remove_releases:[]}},i.prototype.onNameChange=function(t,e){return this.editableAttributes.name=this._createEditableRegularField("name"),this.trigger("updatedName")},i.prototype._createEditableFields=function(){var t;return t=this._createEditableRegularFields(),t.geolocation=this._createEditableGeoInfo(),t.tags=this._createEditableTags(),t.sets=this._createEditableSets(),t.releases=this._createEditableReleases(),t.marketplace=this._createEditableMarketplace(),t.exclusive_use=this._createEditableExclusiveUse(),this.editableAttributes=t},i.prototype._createEditableMarketplace=function(){var t,e,i,o;return o=function(){var e,i,o,n;for(o=this.photos,n=[],e=0,i=o.length;i>e;e++)t=o[e],n.push(t.inMarketplace());return n}.call(this),o=_.uniq(o),i=o.length<=1,{same:i,values:o,uniqueValue:i&&null!=(e=o[0])?e:""}},i.prototype._createEditableExclusiveUse=function(){var t,e,i,o;return o=_.uniq(function(){var e,i,o,n;for(o=this.photos,n=[],e=0,i=o.length;i>e;e++)t=o[e],n.push("exclusive"===t.get("licensing_type"));return n}.call(this)),i=o.length<=1,{same:i,values:o,uniqueValue:i&&null!=(e=o[0])?e:""}},i.prototype._createEditableRegularFields=function(){var t,e,i,o,n;for(t={},n=this.editableFields,i=0,o=n.length;o>i;i++)e=n[i],t[e]=this._createEditableRegularField(e);return t},i.prototype._createEditableRegularField=function(t){var e,i,o,n;return n=_.uniq(function(){var i,o,n,r;for(n=this.photos,r=[],i=0,o=n.length;o>i;i++)e=n[i],r.push(e.get(t));return r}.call(this)),o=n.length<=1,{same:o,values:n,uniqueValue:o&&null!=(i=n[0])?i:""}},i.prototype._createEditableGeoInfo=function(){var t,e,i,o,n,r,s,a,l,u,h,p,c;for(t={},l=this.photos,e=0,n=l.length;n>e;e++)s=l[e],o=s.get("latitude"),r=s.get("longitude"),i=o+","+r,null==t[i]?(a={latitude:o,longitude:r,count:1},t[i]=a):t[i].count+=1;return c=_.values(t),p=c.length<=1,{same:p,values:c,uniqueValue:p&&null!=(null!=(u=c[0])?u.latitude:void 0)&&null!=(null!=(h=c[0])?h.longitude:void 0)?c[0]:null}},i.prototype._createEditableTags=function(){var t,e,i,o,n,r,s,a,l,u,h,p;for(h={},a=this.photos,t=0,o=a.length;o>t;t++)for(r=a[t],s=null!=(l=r.get("tags"))?l:[],e=0,n=s.length;n>e;e++)u=s[e],null!=h[u]?(h[u].count+=1,h[u].photo_ids.push(r.id)):h[u]={same:!1,count:1,photo_ids:[r.id]};for(i in h)p=h[i],p.same=p.count===this.photos.length;return this.updateMaxedKeywordPhotos(),h},i.prototype._createEditableRelation=function(t){var e,i,o,n,r,s,a,l,u,h,p,c,d,f;for(h={},p=this.photos,i=0,s=p.length;s>i;i++)for(l=p[i],d=null!=(c=l.get(t))?c:[],n=0,a=d.length;a>n;n++)u=d[n],o=$.isPlainObject(u)?u.id:u,null==h[o]&&(h[o]={count:0}),h[o].count+=1,u.id&&null==(e=h[o]).record&&(e.record=u);for(r in h)f=h[r],f.same=f.count===this.photos.length;return h},i.prototype._createEditableSets=function(){return this._createEditableRelation("sets")},i.prototype._createEditableReleases=function(){return this._createEditableRelation("releases")},i.prototype.isNew=function(){return!1},i.prototype.hasGeoCoords=function(){return!0},i.prototype.reconcileGalleryMemberships=function(t){var e,i,o,n,r;for(n=this.photos,r=[],e=0,i=n.length;i>e;e++)o=n[e],null==o.get("upload_status")?r.push(t.reconcileMembershipOfPhoto(o.id)):r.push(void 0);return r},i.prototype.checkGalleryMembership=function(t){var e,i,o,n,r;if(o={},_.contains(this.get("add_galleries"),t.get("id")))o.containsAllPhotos=o.containsSomePhotos=!0;else if(_.contains(this.get("remove_galleries"),t.get("id")))o.containsAllPhotos=o.containsSomePhotos=!1;else for(o.containsAllPhotos=!0,o.containsSomePhotos=!1,r=this.photos,e=0,i=r.length;i>e;e++)n=r[e],t.containsPhoto(n)?o.containsSomePhotos=!0:o.containsAllPhotos=!1;return o},i.prototype.addGallery=function(t){return this.get("add_galleries").push(t),this.set("remove_galleries",_.without(this.get("remove_galleries"),t))},i.prototype.removeGallery=function(t){return this.get("remove_galleries").push(t),this.set("add_galleries",_.without(this.get("add_galleries"),t))},i.prototype.addSet=function(t){return this.get("add_sets").push(t),this.set("remove_sets",_.without(this.get("remove_sets"),t))},i.prototype.removeSet=function(t){return this.get("remove_sets").push(t),this.set("add_sets",_.without(this.get("add_sets"),t))},i.prototype.addRelease=function(t){return null==this.attributes.add_releases&&this.set("add_releases",[]),this.get("add_releases").push(t),this.set("remove_releases",_.without(this.get("remove_releases"),t))},i.prototype.removeRelease=function(t){return null==this.attributes.remove_releases&&this.set("remove_releases",[]),this.get("remove_releases").push(t),this.set("add_releases",_.without(this.get("add_releases"),t))},i.prototype.hasGalleries=function(){var t,e,i,o;for(o=this.photos,t=0,e=o.length;e>t;t++)if(i=o[t],!_.isEmpty(i.get("galleries")))return!0;return!1},i.prototype.allHaveGalleries=function(){var t,e,i,o;if(_.isEmpty(this.photos))return!1;for(o=this.photos,t=0,e=o.length;e>t;t++)if(i=o[t],_.isEmpty(i.get("galleries")))return!1;return!0},i.prototype.hasSets=function(){var t,e,i,o,n,r;for(r=null!=(o=App.Uploader.sets)?o.map(function(t){var e;return null!=(e=t.get("id"))?e:[]}):void 0,n=this.photos,t=0,e=n.length;e>t;t++)if(i=n[t],!_.isEmpty(_.intersection(i.get("sets"),r)))return!0;return!1},i.prototype.allHaveSets=function(){var t,e,i,o,n,r;if(r=null!=(o=App.Uploader.sets)?o.map(function(t){var e;return null!=(e=t.get("id"))?e:[]}):void 0,_.isEmpty(this.photos))return!1;for(n=this.photos,t=0,e=n.length;e>t;t++)if(i=n[t],_.isEmpty(_.intersection(i.get("sets"),r)))return!1;return!0},i.prototype.hasPortfolios=function(){var t,e,i,o,n,r;for(o=null!=(n=App.Uploader.portfolios)?n.map(function(t){var e;return null!=(e=t.get("id"))?e:[]}):void 0,r=this.photos,t=0,e=r.length;e>t;t++)if(i=r[t],!_.isEmpty(_.intersection(i.get("sets"),o)))return!0;return!1},i.prototype.allHavePortfolios=function(){var t,e,i,o,n,r;if(o=null!=(n=App.Uploader.portfolios)?n.map(function(t){var e;return null!=(e=t.get("id"))?e:[]}):void 0,_.isEmpty(this.photos))return!1;for(r=this.photos,t=0,e=r.length;e>t;t++)if(i=r[t],_.isEmpty(_.intersection(i.get("sets"),o)))return!1;return!0},i.prototype.geoCoords=function(){var t,e;return null!=(e=this.get("longitude"))&&null!=(t=this.get("latitude"))?{longitude:e,latitude:t}:null!=this.editableAttributes.geolocation.uniqueValue?this.editableAttributes.geolocation.uniqueValue:null},i.prototype.setGeoCoords=function(t,e){if(null==e&&(e={}),null==t)return this.clearGeoCoords(e);if(this.editableAttributes.geolocation.same&&null!=this.editableAttributes.geolocation.uniqueValue&&t.longitude===this.editableAttributes.geolocation.uniqueValue.longitude&&t.latitude===this.editableAttributes.geolocation.uniqueValue.latitude){if(this.unset("longitude",e),this.unset("latitude",e),!e.silent)return this.trigger("change:geolocation")}else if(t.longitude!==this.get("longitude")&&t.latitude!==this.get("latitude")&&(this.set({longitude:t.longitude,latitude:t.latitude},e),!e.silent))return this.trigger("change:geolocation")},i.prototype.clearGeoCoords=function(t){return null==this.get("longitude")&&null==this.get("latitude")||(this.unset("longitude",t),this.unset("latitude",t),t.silent)?void 0:this.trigger("change:geolocation")},i.prototype.url=function(){var t,e;return t=function(){var t,i,o,n;for(o=this.photos,n=[],t=0,i=o.length;i>t;t++)e=o[t],n.push(e.id);return n}.call(this),"https://webapi.500px.com/photos/update?id="+t.join(",")},i.prototype.jobUrl=function(t){return"https://webapi.500px.com/photos/update?job_id="+t},i.prototype.setBatchedAttributes=function(t,e){var i,o,n,r,s,a,l,u,h,p;for(i={},l=this.editableFields,r=0,s=l.length;s>r;r++)n=l[r],null!=(h=t[n])&&(p=h.toString(),a=this.editableAttributes[n],a.same?a.uniqueValue.toString()===p?this.unset(n,e):i[n]=h:0===p.length||"multi_values"===h&&("category"===n||"nsfw"===n||"license_type"===n||"exclusive_use"===n)?this.unset(n,e):i[n]=h);return o=this._affectedTagAttributes(t.tags),this.previousTagsToAdd=null!=(u=this.previousAttributes().add_tags)?u.split(","):void 0,null!=o.add_tags?i.add_tags=o.add_tags:this.unset("add_tags"),null!=o.remove_tags?i.remove_tags=o.remove_tags:this.unset("remove_tags"),this.set(i,e)},i.prototype.batchedAttributesChanged=function(){return _.keys(this.attributes).length>0},i.prototype.save=function(){var t,e,n,r,s,a,l,u,h,p,c,d,f;if(e=1<=arguments.length?o.call(arguments,0):[],r=[],t=function(){var e,i,o,r,s;for(r=null!=(o=this.get("add_releases"))?o:[],s=[],e=0,i=r.length;i>e;e++)l=r[e],32===l.length?(f=App.Uploader.allReleases.find(function(t){var e;return(null!=(e=t.uploadedRelease)?e.get("hash"):void 0)===l}),f.get("id")?s.push(f.get("id")):(n=$.Deferred(),f.on("change:id",function(e){return t[_.indexOf(t,e.get("hash"))]=e.id,n.resolve()}),s.push(l))):s.push(l);return s}.call(this),null!=App.myGalleries){for(c=this.get("add_galleries"),a=0,h=c.length;h>a;a++)s=c[a],App.myGalleries.get(s).addPhotos(this.photos);for(d=this.get("remove_galleries"),u=0,p=d.length;p>u;u++)s=d[u],App.myGalleries.get(s).removePhotos(this.photos)}return r.length>0?$.when.apply($,r).then(function(o){return function(){return o.set("add_releases",t),i.__super__.save.apply(o,e)}}(this)):(this.set("add_releases",t),i.__super__.save.apply(this,e))},i.prototype._affectedTagAttributes=function(t){var e,i,o,n,r,s,a,l;return this.newTags=t,e=function(){var e,i,o;for(o=[],e=0,i=t.length;i>e;e++)a=t[e],o.push(a.get("name"));return o}(),n={},s=_.keys(this.editableAttributes.tags),o=_.difference(e,s),i=function(){var e,i,o;for(o=[],e=0,i=t.length;i>e;e++)a=t[e],a.get("same")&&(l=a.get("name"),null!=this.editableAttributes.tags[l]&&(this.editableAttributes.tags[l].same||o.push(l)));return o}.call(this),o=_.union(o,i),o.length>0&&(n.add_tags=o.join(",")),r=_.difference(s,e),r.length>0&&(n.remove_tags=r.join(",")),this.updateMaxedKeywordPhotos(o,r),n},i.prototype.onSync=function(t,e,i){var o;return null!=e.in_progress?(o=e.in_progress.job_id,_.delay(function(t){return function(){return $.ajax({url:t.jobUrl(o),type:"PUT",dataType:"json"}).fail(function(e,o,n){return t.trigger("error",t.model,e,i)}).done(function(e,o,n){return t.onSync(t.model,e,i)})}}(this),1e3)):this.propagateBatchedAttributes(e.photos)},i.prototype.propagateBatchedAttributes=function(t){var e,i,o,n,r,s,a,l,u,h,p,c,d;if(o=null!=t,!o)for(t={},u=this.photos,n=0,s=u.length;s>n;n++)l=u[n],t[l.id]={data:this.attributes};for(c={okay:0,error:0,missing:0},h=this.photos,r=0,a=h.length;a>r;r++)l=h[r],p=t[l.id],null!=p?null!=(e=p.data)?(c.okay+=1,d=_.partial(_.pick,e),i=this.editableFields.concat(["longitude","latitude"]),e=d(i),o?this._propagateFromServer(l,p,e):this._propagateLocal(l,p,e)):c.error+=1:c.missing+=1;return this._createEditableFields(),o?(this.clear({silent:!0}),this.trigger("batchedChange",c)):void 0},i.prototype._propagateFromServer=function(t,e,i){var o;return t.set(i),null!=(o=e.data.tags)?t.set({tags:o,silent:!0}):void 0},i.prototype._propagateLocal=function(t,e,i){return null!=i.category&&(i.category=0|i.category),null!=i.license_type&&(i.license_type=0|i.license_type),t.set(i),this._propagateLocalTags(t),this._propagateLocalSets(t),this._propagateLocalGalleries(t),this._propagateLocalReleases(t)},i.prototype._propagateLocalTags=function(t){var e,i,o,n,r,s,a;return a=null!=(i=null!=(o=this.attributes.add_tags)?o.split(","):void 0)?i:[],e=_.difference(this.previousTagsToAdd,a),e.length>0&&t.set("tags",_.union(t.get("tags"),e)),this.attributes.remove_tags||this.attributes.add_tags?(r=null!=(n=t.get("tags"))?n:[],this.attributes.remove_tags&&(r=_.difference(r,this.attributes.remove_tags.split(","))),this.attributes.add_tags&&(a=_.difference(this.attributes.add_tags.split(","),r),s=App.Organizer.Collections.PhotoTags.prototype.MAX_NUMBER_OF_TAGS-r.length,a.length>s&&(a=_.first(a,s)),r=_.union(r,a)),t.set("tags",r)):void 0},i.prototype._propagateLocalGalleries=function(t){var e,i;if(this.attributes.remove_galleries||this.attributes.add_galleries)return e=null!=(i=t.get("galleries"))?i:[],this.attributes.remove_galleries&&(e=_.difference(e,this.attributes.remove_galleries)),this.attributes.add_galleries&&(e=_.union(e,this.attributes.add_galleries)),t.set("galleries",e)},i.prototype._propagateLocalSets=function(t){var e,i;return this.attributes.remove_sets||this.attributes.add_sets?(i=null!=(e=t.get("sets"))?e:[],this.attributes.remove_sets&&(i=_.difference(i,this.attributes.remove_sets)),this.attributes.add_sets&&(i=_.union(i,this.attributes.add_sets)),t.set("sets",i)):void 0},i.prototype._propagateLocalReleases=function(t){var e,i;return this.attributes.remove_releases||this.attributes.add_releases?(i=null!=(e=t.get("releases"))?e:[],
this.attributes.remove_releases&&(i=_.difference(i,this.attributes.remove_releases)),this.attributes.add_releases&&(i=_.union(i,this.attributes.add_releases)),t.set("releases",i)):void 0},i.prototype._getTagsCount=function(){return null!=this.newTags?this.newTags.length:this.getInitialTags().length},i.prototype._isFieldQualified=function(t){var e,i,o,n;if(1!==this.photos.length)return!1;switch(t){case"name":case"description":return n=$.trim(null!=(i=this.get(t))?i:this.editableAttributes[t].uniqueValue),!!n&&("name"!==t||"Untitled"!==n);case"category":return e=parseInt(null!=(o=this.get(t))?o:this.editableAttributes[t].uniqueValue),null!=e&&!isNaN(e)&&0!==e;case"geolocation":return null!=this.geoCoords();default:return!1}},i.prototype.getDiscoverability=function(){var t,e;if(1===this.photos.length){null==this.weightsTotal&&(this.weightsTotal=_.reduce(_.values(this.discoverabilityWeights),function(t,e){return t+e},0)),e=0;for(t in this.discoverabilityWeights)"tags"===t?e+=Math.min(this._getTagsCount(),this.discoverabilityWeights.tags):this._isFieldQualified(t)&&(e+=this.discoverabilityWeights[t]);return Math.round(e/this.weightsTotal*100)}},i.prototype.getInitialTags=function(){return _.map(this.editableAttributes.tags,function(t,e){return{name:e,count:t.count,same:t.same}})},i.prototype.clear=function(t){return this.newTags=null,i.__super__.clear.call(this,t)},i.prototype.updateMaxedKeywordPhotos=function(t,e){var i,o,n,r,s;for(null==t&&(t=[]),null==e&&(e=[]),this.photos_with_max_tags=[],s=this.photos,i=0,o=s.length;o>i;i++)r=s[i],n=_.without(_.union(r.get("tags"),t),e).length,n>=App.Organizer.Collections.PhotoTags.prototype.MAX_NUMBER_OF_TAGS&&this.photos_with_max_tags.push(r.id);return this.photos_with_max_tags},i}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Views"),t.WidgetPane=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.onRender=function(){var t,e,i,o,n,r,s;for(e=this.mixinTemplateHelpers(this.serializeData()),s=this.$("ul.fields li"),i=0,o=s.length;o>i;i++)n=s[i],t=$(n),""===t.html()&&(r=n.className,t.html(Marionette.Renderer.render(r+"_widget",e,this)));return this.bindUIElements()},i}(Marionette.LayoutView)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Views"),null==window.mapScriptDfd&&(window.mapScriptDfd=$.Deferred(),$.getScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyDJFLGCQOjy2vyHzXNxPGOOc8uuKRNzGQc&libraries=places&async=2&callback=initialize_maps")),window.initialize_maps=function(t){return function(){return window.mapScriptDfd.resolve()}}(this),t.Map=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.DEFAULT_LOCATION_ZOOM_LEVEL=1,i.prototype.ZOOM_LEVEL=8,i.prototype.initialize=function(t){var e;return this.mapCache=null!=(e=t.mapCache)?e:{},window.mapScriptDfd.done(function(e){return function(){var i,o,n;if(null==e.mapCache.map?(e.mapCache.mapCanvas=$("<div class='map_canvas' style='width: 100%; height: 100%;'></div>"),e.$el.append(e.mapCache.mapCanvas),e.mapCache.map=new google.maps.Map(e.mapCache.mapCanvas[0])):(e.mapCache.mapCanvas.detach(),e._removeSearch(),e.$el.append(e.mapCache.mapCanvas),e.refresh({zoomLevel:e.ZOOM_LEVEL})),e.map=e.mapCache.map,i={center:new google.maps.LatLng(0,0),zoom:e.ZOOM_LEVEL,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,scrollwheel:null!=(o=t.scroll)?o:!1,draggable:null!=(n=t.enableLocationPicker)?n:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}},e.map.setOptions(i),e._centerMap(),t.enableLocationPicker){if(!$.isFunction(e.model.setGeoCoords))throw new Error("model does not support setGeoCoords");if(google.maps.event.addListener(e.map,"click",function(t){return e._onClick(t)}),google.maps.event.addListener(e.map,"dblclick",function(t){return e._onDblClick()}),null!=t.searchInputEl)return e._setupSearch(t.searchInputEl)}}}(this))},i.prototype._onClick=function(t){return null==this.timeout?this.timeout=setTimeout(function(e){return function(){return e.timeout=null,e._setLocation(t.latLng)}}(this),500):void 0},i.prototype._onDblClick=function(){return null!=this.timeout?(clearTimeout(this.timeout),this.timeout=null):void 0},i.prototype._setupSearch=function(t){return this.mapCache.search=$(t),this.searchBox=new google.maps.places.SearchBox(t),this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(t),this.searchBox.addListener("places_changed",function(t){return function(){return t._searchChanged()}}(this)),this.map.addListener("bounds_changed",function(t){return function(){return t.searchBox.setBounds(t.map.getBounds())}}(this)),this.autocomplete=new google.maps.places.Autocomplete(t),this.autocomplete.bindTo("bounds",this.map),this.autocomplete.addListener("place_changed",function(t){return function(){return t._autocompleteChanged()}}(this)),$("body").on("mousedown",".pac-container",function(t){return t.stopPropagation()})},i.prototype._autocompleteChanged=function(){var t;return t=this.autocomplete.getPlace(),null!=t.geometry?(this._setLocation(t.geometry.location),this.map.setZoom(this.ZOOM_LEVEL)):void 0},i.prototype._searchChanged=function(){var t,e;return e=this.searchBox.getPlaces(),e.length>0?(t=e[0],this._setLocation(t.geometry.location),this.map.setZoom(this.ZOOM_LEVEL)):void 0},i.prototype.onDestroy=function(){return google.maps.event.clearInstanceListeners(this.map),$("body").off("mousedown",".pac-container"),this._removeMarker(),this._removeSearch(),this.mapCache.mapCanvas.detach()},i.prototype.refresh=function(t){return null==t&&(t={}),window.mapScriptDfd.done(function(e){return function(){var i;return null!=e.map&&(i=t.zoomLevel,google.maps.event.trigger(e.map,"resize"),null!=e.mapCache.marker?e.map.setCenter(e.mapCache.marker.position):e._moveToDefaultLocation(),null!=i)?e.map.setZoom(i):void 0}}(this))},i.prototype._removeSearch=function(){return null!=this.mapCache.search?(this.mapCache.search.detach(),delete this.mapCache.search):void 0},i.prototype._centerMap=function(){var t,e,i;return("function"==typeof(t=this.model).hasGeoCoords?t.hasGeoCoords():void 0)?(i=this.model.geoCoords(),null!=i?this._moveToGeoCoords(new google.maps.LatLng(i.latitude,i.longitude)):this._moveToDefaultLocation()):("function"==typeof(e=this.model).hasLocation?e.hasLocation():void 0)?this._moveToAddress([this.model.get("city"),this.model.get("state"),this.model.get("country")].join(",")):null!=("undefined"!=typeof App&&null!==App?App.currentUser:void 0)?this._moveToAddress([App.currentUser.get("city"),App.currentUser.get("state"),App.currentUser.get("country")].join(",")):this._moveToDefaultLocation()},i.prototype._moveToGeoCoords=function(t,e){return null==e&&(e=!0),this.map.setCenter(t),e?this._updateMarker(t):this._removeMarker()},i.prototype._moveToAddress=function(t){var e;return e=new google.maps.Geocoder,e.geocode({address:t},function(t){return function(e,i){return i===google.maps.GeocoderStatus.OK?t._moveToGeoCoords(e[0].geometry.location):t._moveToDefaultLocation()}}(this))},i.prototype._moveToDefaultLocation=function(){return this._moveToGeoCoords(new google.maps.LatLng(25,-25),!1),this.map.setZoom(this.DEFAULT_LOCATION_ZOOM_LEVEL)},i.prototype._updateMarker=function(t){return this._removeMarker(),this.mapCache.marker=new google.maps.Marker({map:this.map,position:t})},i.prototype._removeMarker=function(){return null!=this.mapCache.marker?this.mapCache.marker.setMap(null):void 0},i.prototype._setLocation=function(t){return this._moveToGeoCoords(t),this.model.setGeoCoords({latitude:t.lat(),longitude:t.lng()})},i}(Marionette.ItemView)}.call(this),function(){var t,e,i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;e=App.module("Organizer.Views"),e.EditPrimePane=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,e),o.prototype.template="photo_edit_prime_pane",o.prototype.initialize=function(t){return this.photos=t.photos,1===this.photos.length?this.model=this.photos[0]:void 0},o.prototype.behaviors={HasButtons:{".submit_to_prime":"onClickSubmitToPrime",".status a.licensing_status":"onClickSubmitToPrime"}},o.prototype.ui={submitButton:"a.button"},o.prototype.templateHelpers=function(){var t,e,i,o,n,r,s,a,l,u,h,p,c,d,f,g,m,_,v;if(i=0,s=1,u=2,r=3,o=4,h=5,t=6,l=7,e=8,n=9,a=10,!this.model){for(p=!1,_=this.photos,d=0,f=_.length;f>d;d++)if(m=_[d],4===m.get("licensing_status")){p=!0;break}return g={licensed:p,multiple:this.photos.length>1,licensing_changes_required:p}}return v=function(){switch(this.model.get("licensing_status")){case n:case u:case r:case h:case a:return"available";case t:case l:return"editorial";case e:return"declined";case o:return"changes_required";case s:return"not_submitted"}}.call(this),c=function(){switch(this.model.get("licensing_status")){case n:case u:case r:case h:case t:case l:case o:case a:return"/photo/"+this.model.id+"/licensing";case e:return"/settings/store/faq#license-states"}}.call(this),g={licensed:0!==this.model.get("licensing_status"),licensing_href:c},g["licensing_"+v]=1,g},o.prototype.onShow=function(){var t;return this.photos.length>1||8===(null!=(t=this.model)?t.get("licensing_status"):void 0)?this.disable():this.enable()},o.prototype.onClickSubmitToPrime=function(e){var i,o;if(!this.$el.hasClass("disabled"))return i=$(e.target),i.hasClass("licensing_status")&&i.hasClass("declined")?!0:(o=new t({model:this.model}),o.showModal(),App.vent.once("licensing-done",function(t){return function(){var e,i;return e=null!=(i=t.model.get("licensing_status"))?i:0,o.destroyModal(),t.model.fetch().done(function(){if(2===t.model.get("licensing_status"))switch(e){case 4:App.vent.trigger("marketplace:changesMade",[t.model.id]);break;case 0:case 1:App.vent.trigger("marketplace:newSubmission",[t.model.id])}return t.render()})}}(this)))},o.prototype.enable=function(){return this.ui.submitButton.removeClass("disabled")},o.prototype.disable=function(){return this.ui.submitButton.addClass("disabled")},o}(Marionette.ItemView),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.behaviors={ModalDialog:{maxWidth:1200,paddingX:80,paddingY:100}},e.prototype.template="prime_submission_iframe",e}(Marionette.ItemView)}.call(this),function(){var t;t=App.module("Organizer.Models"),t.OrganizerTrash=function(){function t(){}return t.prototype["delete"]=function(t){return this._destroyPhotos(t).done(function(e){return function(i){var o,n,r;e._removeFromGrid(t),App.controller.organizer.getSource().clearSelection({silentIndividualChange:!0}),App.vent.trigger("photo:trashed",{set:"all_photos",photos:_.pluck(t,"id")}),App.vent.trigger("photo:trashed",{set:"public",photos:i.profile}),App.vent.trigger("photo:trashed",{set:"marketplace",removed_count:i.prime_removed,changes_required:i.prime_changes_required_removed}),n=i.sets;for(o in n)r=n[o],App.vent.trigger("photo:trashed",{set:parseInt(o,10),photos:r});return null}}(this))},t.prototype._removeFromGrid=function(t){var e,i,o,n;for(n=[],e=0,i=t.length;i>e;e++)o=t[e],n.push(o.destroy());return n},t.prototype._destroyPhotos=function(t){return $.ajax({method:"post",url:PxConfig.endpoints.web_bff+"/organizer/photos/delete",data:{id:_.pluck(t,"id").join(",")},dataType:"json"})},t}()}.call(this),function(){var t;t=App.module("Views.Common.Helpers"),t.measureScrollBarWidth=function(){var t,e,i,o;try{return i=$("<div />"),$("body").append(i),i.width(50).height(50).css({overflow:"scroll",visibility:"hidden",position:"absolute"}),o=$("<div />").height(1),i.append(o),t=o.width(),e=i.width(),i.remove(),e-t}catch(n){return 20}}}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Organizer.Collections"),t.TagSuggestions=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.model=App.Organizer.Models.Tag,i.prototype.DEFAULT_SIZE=50,i.prototype.url=function(){var t,e;return t="https://webapi.500px.com/tags",e={size:this.DEFAULT_SIZE},null!=this.userId&&(t="https://webapi.500px.com/tags/user",e.user_id=this.userId),null!=this.prefix&&(e.prefix=this.prefix),t+"?"+$.param(e)},i.prototype.fetch=function(t){return null!=(null!=t?t.prefix:void 0)&&(this.prefix=t.prefix),i.__super__.fetch.call(this)},i.prototype.initialize=function(t,e){var i;return this.userId=null!=e?e.userId:void 0,this.numTags=Number(null!=e?e.numTags:void 0),0<(i=this.numTags)&&1e3>i?void 0:this.numTags=this.DEFAULT_SIZE},i.prototype.parse=function(t){var e,i,o,n,r;for(o=t.tags,n=[],e=0,i=o.length;i>e;e++)r=o[e],n.push(new App.Organizer.Models.Tag({name:r},{taggableModel:null}));return n},i}(Backbone.Collection),t.TagVocabulary=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.DEFAULT_TAGS=["20-24 years","25-29 years","30-34 years","abandoned","above","abstract","access","active","activity","adorable","adult","adventure","aerial","affection","africa","agriculture","air","alaska","alberta","alone","alpine","alps","alternative energy","amazing","america","animal","antique","arch","arches","architectural","architecture","arctic","area","argentina","art","asia","asian","asian ethnicity","asking","atlantic","atmosphere","attraction","attractive","aurora","aurora borealis","autumn","baby","background","backlight","bald eagle","bali","balloon","banff","bangkok","barn","bavaria","beach","beak","bear","beautiful","beauty","beauty in nature","bed","bedroom","bee","beer","beetle","belgium","bench","berlin","bicycle","big","bird","bird of prey","birds eye view","bizzare","black","black and white","blonde","bloom","blooming","blossom","blue","blur","board room","boat","boats","body","bokeh","botanical","botany","botswana","box","boy","branch","branches","brasil","brazil","breakfast","brick","bridge","bright","british","british columbia","brooklyn","brother","brown","brunette","bud","budapest","buddha","buddhism","bug","building","bush","business","business man","business meeting","business people","business woman","businessman","businesswoman","butterfly","cactus","calgary","california","calm","camping","canada","canal","candid","canine","canyon","capital","car","caribbean","cascade","castle","casual","casual clothing","cat","cathedral","caucasian","caucasian ethnicity","cave","celebration","cellphone","chart","cheerful","cheetah","cherry","chicago","child","childhood","children","chile","china","christmas","church","city","cityscape","classroom","clean","clear","cliff","climbing","close up","close-up","closeup","cloud","clouds","cloudscape","cloudy","coast","coastal","coastline","cocktail","coffee","cold","collaboration","color","color image","colorful","colors","colour","colourful","colours","communication","composition","computer","concept","connection","construction","contrast","convenience","cooking","cool","copy space","corn","country","countryside","couple","cow","creative","creature","creek","crop","cub","cubs","culture","currency","customer service","cute","cycling","d800","daisy","dancing","dandelion","danger","dark","dawn","day","daylight","daytime","decay","decoration","deer","delicate","delicious","depression","desert","design","desk","dessert","destination","detail","dew","digital ","digital manipulation","digital tablet","dock","doctor","dog","dolomites","dolomiti","dome","domestic","domestic animal","door","downtown","dragonfly","dramatic","dream","dress","drink","drinking","drop","dry","dubai","duck","dunes","dusk","eagle","early","earth","eat","eating","ecology","education","elegance","elegant","elephant","embrace","empty","endangered","energy","engineer","entertainment","environment","erosion","estonia","europe","evening","exercise","exercising","exotic","exploration","exterior","eye","eyes","face","fall","falls","family","fantasy","farm","farmer","farming","farmland","fashion","fashion model","father","fauna","feather","feeding","feline","female","fence","field","fields","film","filter","fine art","fire","fireworks","fish","fishing","five","flamingo","flight","floral","flow","flower","flowers","flowing","fluffy","fly","flying","focus","fog","foggy","foliage","food","forest","formation","forrest","four","fox","france","freedom","freeze","fresh","freshness","friends","friendship","frog","front view","frost","frozen","fruit","full length","fun","funny","fur","furniture","gal","garden","gate","geology","germany","gift","giraffe","girl","giving","glacier","glamour","glass","globe","glow","gold","golden","golden hour","gorge","grain","grand canyon","grandchild","grandfather","grandmother","grandparent","grass","grassland","gray","great","green","grey","grin","groceries","ground","group","group of objects","growth","gym","hair","hand","hands","handshake","happiness","happy","harbor","harbour","harvest","hawaii","hawk","haze","hdr","head","head and shoulders","headphones","headset","health","health club","health spa","healthy","heaven","heritage","heron","high","high angle","highlands","highway","hike","hiking","hill","himalaya","himalayas","hispanic","historic","historical","hokkaido","holding","holiday","holland","home","hong kong","horizon","horizontal","horse","horses","hot","hotel","house","hug","human","human being","hummingbird","hungary","hunter","hunting","ice","iceberg","iceland","idyllic","illuminated","indian","indoor","indoors","industrial","industry","ingredient","insect","insects","inside","instructor","interior","internet","island","isolated","israel","istanbul","italian","italy","japanese","jetty","jogging","journey","joy","jumping","jungle","juvenile","kid","kingfisher","kiss","kitchen","kitten","kitty","laboratory","lady","lagoon","lake","land","landmark","landscape","landscapes","laptop","large","laughing","lava","lavender","leaf","leaves","legs","leisure","leisure activity","lens","leopard","library","life","lifestyle","lifestyles","light","lighthouse","lightning","lights","lily","line","lines","lion","little","lizard","london","lonely","long","long exposure","looking","looking down","lotus","love","lovely","lush","macro","magic","maine","majestic","make-up","makro","male","mammal","man","manhattan","manual worker","map","mare","marina","marine","marsh","mature couple","meadow","medical exam","medieval","mediterranean","meeting","metal","mexico","mid adult","milky way","mill","mirror","mist","misty","moab","mobile","mobile phone","mobility","model","modern","monkey","mono","monochrome","montana","monument","mood","moody","moon","morning","morocco","moscow","mosque","moss","mother","motion","motorcycle","mount","mountain","mountains","movement","moving up","multi-ethnic","multi-ethnic group","multi-generation family","mushroom","music","national","national park","natural","natural light","natural world","nature","nature photograph","nature pics","negative space","nepal","nest","nevada","new york","night","nightclub","nightscape","nobody","north","north carolina","northern lights","norway","nude","nurse","nyc","ocean","office","old","on the phone","one","one person","online","orange","organic","outdoor","outdoors","outside","overcast","overhead","owl","pacific","palace","palm","panorama","panoramic","paradise","parent","paris","park","party","pasture","patagonia","path","patient","pattern","peace","peaceful","peacock","peak","peaks","pelican","people","perch","perched","person","perspective","peru","pet","petal","photo","photography","picture","pier","pine","pink","place","places","plant","plants","play","playa","plumage","pollen","pond","pool","poppy","port","portrait","posing","power","prague","predator","presentation","pretty","prey","primate","puddle","puppy","pure","purple","quiet","rain","rainbow","rainforest","range","raptor","raw","ray","reading","real people","rear view","recreation","red","red fox","reflection","reflections","relationship","relax","relaxation","religion","repairing","reptile","reserve","resort","rest","restaurant","resting","retro","rice","ridge","river","road","rock","rockies","rocks","rocky","rocky mountains","romania","romantic","rome","roof","rose","ruins","running","rural","rust","rustic","sadness","safari","san francisco","sand","sandstone","santorini","scandinavia","scene","scenery","scenic","scenics","school","sculpture","sea","seagull","seascape","seashore","seaside","season","seasons","seattle","see","seminar","senior adult","senior couple","sensual","sensuality","sepia","serene","serenity","series","sexy","shadow","shadows","sharing","sheep","shine","ship","shopping","shore","shoreline","sibling","sightseeing","silence","silhouette","singapore","single","sisters","sitting","ski","skiing","skin","sky","skyline","skyscraper","sleeping","small","small business","smart phone","smile","smiling","smoke","smooth","snail","snake","snow","soft","solitude","south","spa","space","spider","splash","sport","spring","springtime","square","squirrel","stairs","standing","star","stars","startup","statue","stem","still","still life","stone","stones","store","storm","stream","street","structure","student","studio","style","suburban","summer","summit","sun","sundown","sunflower","sunlight","sunny","sunrise","sunset","sunshine","surf","surreal","swamp","swan","sweet","sweet light","swimming","sydney","symbol","table","tablet","tail","taiwan","talking","tall","tasty","teacher","technology","teenager","telephone","television","temple","texas","text","text messaging","texture","thai","thailand","three","three quarter length","tide","tiger","time","together","togetherness","top","toronto","tour","tourism","tourist","tower","town","track","traditional","traffic","trail","train","training","tranquil","tranquility","transportation","travel","tree","trees","trekking","trip","tropical","trunk","tulip","tulips","turkey","turquoise","turtle","tuscany","twilight","two","two people","ukraine","underwater","unesco","united kingdom","university","up","urban","urbex","usa","using computer","vacation","valley","vancouver","vegetable","vegetation","vehicle","venice","vertical","veterinarian\u200e","vibrant","victoria","vietnam","view","view from above","village","vintage","violet","vista","vivid","volcanic","volcano","walk","walking","wall","wallpaper","warm","washington","water","waterfall","waterfront","wave","way","weather","web","wedding","west","wet","wheat","white","white space","wide","wide angle","wild","wild animal","wilderness","wildlife","wind","windmill","window","wine","wing","winter","wireless","wolf","wolves","woman","women","wood","wooden","woodland","woods","work","working","world","worried","yellow","yellowstone","yoga","yosemite","young","young adult","young men","young women","youth","yukon","zebra","zion","zo"],i.prototype.initialize=function(){var t,e;return this.set(function(){var i,o;i=this.DEFAULT_TAGS,o=[];for(t in i)e=i[t],o.push(new App.Organizer.Models.Tag({name:e},{taggableModel:null}));return o}.call(this))},i}(Backbone.Collection),t.PhotoTags=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.model=App.Organizer.Models.Tag,i.prototype.MAX_NUMBER_OF_TAGS=30,i.prototype.select=function(t){var e,i;return this.selected&&t.cid!==this.selected.cid&&(i=this.selected),e=this.indexOf(t),-1===e?!1:(this.selectedIndex=e,this.selected=t,"undefined"!=typeof old_selected&&null!==old_selected&&old_selected.trigger("deselect",old_selected),t.trigger("select",t),this)},i.prototype.selectPrevious=function(){var t,e;if(0!==this.selectedIndex)return t=null!=(e=this.models[this.selectedIndex-1])?e:this.last(),t?this.select(t):void 0},i.prototype.deselect=function(){var t,e;return null!=(e=this.selected)&&e.trigger("deselect",t),t=this.selected,this.selected=this.selectedIndex=null,t},i.prototype.selectNext=function(){var t,e;if(void 0!==this.selectedIndex)return t=this.selectedIndex+1,e=this.models[t],e?this.select(e):this.deselect()},i.prototype.selectIndex=function(t){return this.select(this.models[t])},i.prototype.iWhere=function(t,e){return this.filter(function(t){return t.get("name").toLowerCase()===e.toLowerCase()})},i}(Backbone.Collection)}.call(this),function(){var t,e,i,o,n=function(t,e){function i(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty,s=function(t,e){return function(){return t.apply(e,arguments)}};i=App.module("Organizer.Views"),o=App.module("Organizer.Views.Tags"),e=App.Organizer,t={left:37,up:38,right:39,down:40,del:46,backspace:8,tab:9,f:102,l:108,"return":13,escape:27},i.TagsField=function(i){function o(){return o.__super__.constructor.apply(this,arguments)}return n(o,i),o.prototype.template="photo_details_tags",o.prototype.initialize=function(i){if(this.collection=i.collection,!this.collection)throw new Error("Must pass in a collection to TagsField");if(this.listenTo(this.collection,"add",this.addTag),this.listenTo(this.collection,"remove",this.removeTag),this.listenTo(this.collection,"reset",this.resetTags),this.listenTo(this.collection,"select",this.updateSelectedTag),this.listenTo(this.collection,"deselect",this.updateSelectedTag),this.listenTo(this.collection,"add remove",this.toggleTagInput),this.listenTo(this.collection,"add remove change",function(t){return function(e){return t.trigger("tag:update")}}(this)),this.photos=i.model.photos,!this.photos)throw new Error("Must pass in a model with photos");return this.globalTagCandidates=i.globalTagCandidates,this.userTagCandidates=i.userTagCandidates,null==this.globalTagCandidates&&(this.globalTagCandidates=new e.Collections.TagVocabulary),null==this.userTagCandidates&&(this.userTagCandidates=new e.Collections.TagSuggestions([],{userId:App.currentUser.id})),this.photos.length>0&&this.userTagCandidates.fetch(),this.keyboardCallbacks={},this.keyboardCallbacks[t.left]=this.onLeftKey,this.keyboardCallbacks[t.right]=this.onRightKey,this.keyboardCallbacks[t.del]=this.onDelKey,this.keyboardCallbacks[t.backspace]=this.onBackspaceKey},o.prototype.ui=function(){return{tagField:".tag_field",input:".tag_field input"}},o.prototype.events={"focus @ui.input":"focusField","blur @ui.input":"blurField","click .tag":"applyToAll","click .tag .remove":"removeTagElement","keydown @ui.input":"handleInputKeypress",mousedown:"stopEventUnlessInput",dragstart:"stopEventUnlessInput",click:"focusInput"},o.prototype.handleInputKeypress=function(t){var e;return this.hideStartPlaceholder(),e={isCursorAtBeginningOfInput:0===t.target.selectionStart,isAtagCurrentlySelected:null!==this.collection.selectedIndex,isSomeTextSelected:t.target.selectionStart!==t.target.selectionEnd},this.keyboardCallbacks[t.which]?this.keyboardCallbacks[t.which].call(this,event,e):this.collection.selected?(this.collection.deselect(),!0):void 0},o.prototype.onLeftKey=function(t,e){return e.isCursorAtBeginningOfInput?(this.collection.selectPrevious(),t.preventDefault()):void 0},o.prototype.onRightKey=function(t,e){return e.isAtagCurrentlySelected?(this.collection.selectNext(),t.preventDefault()):void 0},o.prototype.onDelKey=function(t,e){var i;return e.isAtagCurrentlySelected?(i=this.collection.selectedIndex,this.collection.remove(this.collection.selected),this.collection.deselect(),this.collection.selectIndex(i),t.preventDefault()):void 0},o.prototype.onBackspaceKey=function(t,e){var i;return e.isAtagCurrentlySelected&&!e.isSomeTextSelected?(i=this.collection.selectedIndex,i-=1,this.collection.remove(this.collection.selected),this.collection.deselect(),i>=0&&this.collection.selectIndex(i),t.preventDefault()):e.isCursorAtBeginningOfInput&&!e.isSomeTextSelected?(this.collection.selectPrevious(),t.preventDefault()):void 0},o.prototype.selectedElement=function(){return this.$el.find("[data-cid='"+this.collection.selected.cid+"']")},o.prototype.stopEventUnlessInput=function(t){return"INPUT"!==t.target.tagName?t.preventDefault():void 0},o.prototype.focusInput=function(){return this.collection.deselect(),this.ui.input.prop("disabled",!1).focus(),this.resizeInput()},o.prototype.removeTagElement=function(t){var e,i;return t.stopPropagation(),e=$(t.target).closest(".tag").attr("data-cid"),i=this.collection.get(e),this.collection.remove(i),this.focusInput()},o.prototype.applyToAll=function(t){var e,i,o,n;return t.stopPropagation(),e=$(t.target).closest(".tag"),i=e.attr("data-cid"),o=this.collection.get(i),o.set({same:!0}),e.addClass("same"),n=this.updateTagTitle(this.photos.length,this.photos.length,e),e.attr("title",n)},o.prototype.resetTags=function(){return this.$(".tag").remove(),null!=this.collection.findWhere({same:!1})&&(this.collection.comparator=function(t){return-t.get("same")},this.collection.sort()),this.collection.each(function(t){return function(e){return t.addTag(e)}}(this))},o.prototype.removeTag=function(t){return this.$(".tag[data-cid='"+t.cid+"']").remove(),this.ui.input.width(1),this.resizeInput(),this.updatePlaceholder()},o.prototype.showStartPlaceholder=function(){return this.ui.tagField.addClass("init")},o.prototype.hideStartPlaceholder=function(){return this.ui.tagField.removeClass("init")},o.prototype.updateSelectedTag=function(){return this.$(".tag").removeClass("selected"),this.collection.selected?this.selectedElement().addClass("selected"):void 0},o.prototype.currentValue=function(){return this.trimTag(this.ui.input.val())},o.prototype.trimTag=function(t){return t=t.replace(/^[#,\s]*(.*?)\s*$/,"$1"),t.slice(0,45)},o.prototype.addCurrentValueToCollection=function(){var t,i,o,n,r,s,a,l;for(l=this.ui.input.val().split(/[,#]+/),l=l.filter(function(t){return function(e){return t.trimTag(e)}}(this)),t=this.collection.where({same:!0}),i=_.isEmpty(this.model.photos_with_max_tags)?!0:!1,o=0,n=l.length;n>o&&(r=l[o],!this.keywordsFull());o++)0===this.userTagCandidates.where({name:r}).length&&(s=new e.Models.Tag({name:r},{taggableModel:null}),this.userTagCandidates.add(s,{at:0})),a=_.first(this.collection.iWhere("name",r)),null!=a?(a.set({same:i}),i&&this.$(".tag[data-cid='"+a.cid+"']").addClass("same")):this.collection.add({name:r,same:i},{at:this.collection.length});return this.ui.input.val("")},o.prototype.focusField=function(){return this.ui.input.prop("disabled",!1),this.$el.addClass("focused"),this.autoCompletion.clearSuggestions()},o.prototype.blurField=function(){return""!==this.currentValue()&&this.tagEntered(),this.$el.removeClass("focused"),this.autoCompletion.clearSuggestions(),this.updatePlaceholder()},o.prototype.resizeInput=function(){return _.defer(function(t){return function(){var e,i,o,n;return t.ui.input.val(""),o=t.$el.position().left,n=t.$el.width()-10,e=t.ui.input.position().left,i=n-(e-o)-10,100>i&&(i=n),t.ui.input.width(i)}}(this))},o.prototype.addTag=function(t){var e,i,o,n,r,s;return this.ui.input.width(1),n=t.toJSON(),n.photos=this.photos.length,e=$(Marionette.Renderer.render("photo_details_tag",t.toJSON())),e.attr("data-cid",t.cid),t.get("same")&&e.addClass("same"),this.photos.length>1&&(i=null!=(o=t.get("count"))?o:this.photos.length,s=this.photos.length,r=this.updateTagTitle(i,s,e),e.attr("title",r)),this.ui.tagField.before(e),this.updatePlaceholder(),this.resizeInput()},o.prototype.updateTagTitle=function(t,e,i){return i.find(".i18n").i18n("appears",t,e,{"return":!0})},o.prototype.toggleTagInput=function(){return this.keywordsFull()?this.ui.tagField.hide():(this.ui.tagField.show(),this.resizeInput())},o.prototype.keywordsFull=function(){var t,e,i,o,n,r,s,a;for(a=function(){var t,e,o,n;for(o=this.collection.models,n=[],t=0,e=o.length;e>t;t++)i=o[t],n.push(i.get("name"));return n}.call(this),r=[],s=this.photos,t=0,e=s.length;e>t;t++)n=s[t],r=_.union(r,n.get("tags"));return o=_.difference(a,r),_.all(this.photos,function(t){return function(e){var i;return i=_.intersection(e.get("tags"),a),i.length+o.length>=t.collection.MAX_NUMBER_OF_TAGS}}(this))},o.prototype.updatePlaceholder=function(){return this.collection.models.length>0?(this.hideStartPlaceholder(),this.ui.input.attr("placeholder",this.$("input").data("i18n-placeholder-short"))):(this.showStartPlaceholder(),this.ui.input.attr("placeholder",""))},o.prototype.tagEntered=function(t){var e,i;return e=this.autoCompletion.getSelectedTag(),e&&this.ui.input.val(e),this.autoCompletion.clearSuggestions(),
i=this.currentValue(),""===i||this.keywordsFull()||(this.addCurrentValueToCollection(),this.toggleTagInput()),null!=t?t.preventDefault():void 0},o.prototype.onRender=function(){var t,i;return this.autoCompletion=new e.Views.Tags.AutoCompletion({parent:this,input:this.ui.input,globalTagCandidates:this.globalTagCandidates,userTagCandidates:this.userTagCandidates,existingTags:this.collection,waitTime:200}),this.autoCompletion.bind("dropdown:show",function(t){return function(){return t.$el.addClass("ac_attached")}}(this)),this.autoCompletion.bind("dropdown:hide",function(t){return function(){return t.$el.removeClass("ac_attached")}}(this)),this.autoCompletion.render(),this.ui.input.on("keydown",function(t){return function(e){return t.handleKeydown(e)}}(this)),this.ui.input.on("keypress",function(t){return function(e){return t.handleKeypress(e)}}(this)),(null!=(t=this.photos)?t.length:void 0)>0&&this.ui.input.prop("disabled",!1),this.toggleTagInput(),this.updatePlaceholder(),(null!=(i=this.photos)?i.length:void 0)>1&&(this.$el.addClass("bulk"),this.ui.input.removeClass("init")),this.resetTags()},o.prototype.activate=function(){return _.defer(function(t){return function(){return t.resizeInput()}}(this)),this},o.prototype.handleKeypress=function(t){var e,i,o;return o=t.which,i="#".charCodeAt(0),e=",".charCodeAt(0),o!==i&&o!==e||(this.tagEntered(),o===i)?void 0:t.preventDefault()},o.prototype.handleKeydown=function(e){var i;return i=e.which,i===t["return"]||i===t.tab?(e.preventDefault(),this.tagEntered()):i===t.escape?(e.preventDefault(),this.autoCompletion.clearSuggestions(e)):i===t.up?(e.preventDefault(),this.autoCompletion.moveUp(e)):i===t.down?(e.preventDefault(),this.autoCompletion.moveDown(e)):void 0},o.prototype.val=function(){return this.collection.models},o.prototype.size=function(){return this.collection.models.length},o.prototype.max=function(){return this.collection.MAX_NUMBER_OF_TAGS},o}(Marionette.ItemView),o.AutoCompletion=function(i){function o(){return o.__super__.constructor.apply(this,arguments)}return n(o,i),o.prototype.TAG_SEPARATOR="-",o.prototype.className="tags_autocompletion_wrap",o.prototype.minCharacters=2,o.prototype.maxNumResultsShown=8,o.prototype.waitTime=!1,o.prototype.currentKeyword="",o.prototype.initialize=function(t){return this.$input=t.input,this.parent=t.parent,this.globalTagCandidates=t.globalTagCandidates,this.userTagCandidates=t.userTagCandidates,this.existingTags=t.existingTags,_.extend(this,_.pick(t,"minCharacters","maxNumResultsShown","waitTime")),this.waitTime?this.filter=_.debounce(this.filter,this.waitTime):void 0},o.prototype.render=function(){return this.$input.attr("autocomplete","off"),this.$input.on("keyup",function(t){return function(e){return t.keyup(e)}}(this)),this.parent.$el.after(this.$el)},o.prototype.keyup=function(e){var i,o;if(e.keyCode!==t.escape)return o=this.parent.currentValue(),i=o.toLowerCase(),this.isChanged(i)||this.$el.is(":hidden")?this.isValid(i)?this.filter(i,o):(this.$el.empty(),this.hide()):void 0},o.prototype.getDowncasedUsedTags=function(){var t,e,i,o,n;for(n={},i=this.existingTags.models,t=0,e=i.length;e>t;t++)o=i[t],n[o.get("name").toLowerCase()]=1;return n},o.prototype.filter=function(t,e){var i,o,n,r,s,a,l,u,h,p,c;for(c=this.getDowncasedUsedTags(),i=[],u=this.userTagCandidates.models,r=0,a=u.length;a>r;r++)p=u[r],o=p.get("name").toLowerCase(),0!==o.indexOf(t)||c[o]||(i.push(p),c[o]=1);for(n=[this.TAG_SEPARATOR],h=this.globalTagCandidates.models,s=0,l=h.length;l>s;s++)p=h[s],o=p.get("name").toLowerCase(),0!==o.indexOf(t)||c[o]||(n.push(p),c[o]=1);return n.length>1&&(i=i.concat(n)),this.loadSuggestions(i,t,e)},o.prototype.isValid=function(t){return t.length>=this.minCharacters},o.prototype.isChanged=function(t){return this.currentKeyword!==t},o.prototype.moveUp=function(t){return this.moveSelection(-1),t.preventDefault()},o.prototype.moveDown=function(t){return this.moveSelection(1),t.preventDefault()},o.prototype.moveSelection=function(t){var e,i,o;return i=this.$el.children(),i.length>0?(o=this.$el.children(".selected"),e=o.length>0?o.first().index():-1,e+t<i.length&&(e+=t),o.removeClass("selected"),e>=0&&i.eq(e).addClass("selected"),this.$el.find(".tag_suggestion_separator.selected").length>0?this.moveSelection(t):void 0):void 0},o.prototype.loadSuggestions=function(t,e,i){var o,n,r,s;if(this.currentKeyword=e,this.results=t.slice(0,this.maxNumResultsShown),this.$el.empty(),this.results.length>0){for(_.last(this.results)===this.TAG_SEPARATOR&&this.results.pop(),r=this.results,o=0,n=r.length;n>o;o++)s=r[o],this.addTag(s,i);return this.$el.children().first().addClass("first"),this.$el.children().last().addClass("last"),this.show()}return this.hide()},o.prototype.addTag=function(t,i){var o;return o=new e.Views.Tags.AutoCompleteItem({matched:i,tag:t,parent:this}),o.render(),this.$el.append(o.$el)},o.prototype.select=function(t){return this.$el.children(".selected").removeClass("selected"),t.$el.addClass("selected"),this.parent.tagEntered(),this.$input.focus()},o.prototype.highlight=function(t){return this.$el.children(".selected").removeClass("selected"),t.$el.addClass("selected")},o.prototype.unhighlight=function(t){return t.$el.removeClass("selected")},o.prototype.getSelectedTag=function(){var t;return t=this.$el.find(".selected"),t.length>0?t.first().text().trim():void 0},o.prototype.hide=function(){return this.$el.hide(),this.trigger("dropdown:hide")},o.prototype.show=function(){return this.$el.width(this.parent.$el.width()),this.$el.show(),this.trigger("dropdown:show")},o.prototype.clearSuggestions=function(t){return this.currentKeyword="",this.$el.empty(),this.hide(),null!=t?t.stop():void 0},o}(Backbone.View),o.AutoCompleteItem=function(t){function e(){return this.unhighlight=s(this.unhighlight,this),this.highlight=s(this.highlight,this),this.select=s(this.select,this),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.className="tag_suggestion",e.prototype.template="photo_details_tag_auto_completion_item",e.prototype.separatorTemplate="photo_details_tag_suggestion_separator",e.prototype.renderSeparator=function(){var t;return t=Marionette.Renderer.render(this.separatorTemplate,{})},e.prototype.initialize=function(t){return this.matched=t.matched,this.tag=t.tag,this.parent=t.parent},e.prototype.onRender=function(){return this.tag===this.parent.TAG_SEPARATOR?this.setElement(this.renderSeparator()):void 0},e.prototype.serializeData=function(){var t,e;return e=_.isString(this.tag)?this.tag:this.tag.get("name"),t=this.matched.length,{tag_matched:this.matched,tag_remaining:e.substr(t)}},e.prototype.events={mousedown:"select",mouseover:"highlight",mouseout:"unhighlight"},e.prototype.select=function(t){return t.preventDefault(),this.tag!==this.parent.TAG_SEPARATOR?this.parent.select(this):void 0},e.prototype.highlight=function(t){return this.parent.highlight(this)},e.prototype.unhighlight=function(t){return this.parent.unhighlight(this)},e}(Marionette.ItemView)}.call(this),function(){var t,e,i,o=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty,r=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};i=App.module("Organizer.Views"),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.baseUrl=function(){return"https://api.500px.com/v1/tags/suggested"},e.prototype.url=function(){return _.result(this,"baseUrl")+"?"+$.param({tags:this.tags})},e.prototype.initialize=function(t,e){return this.tagsCollection=e.tags,this.listenTo(this.tagsCollection,"add remove",function(t){return function(){return t.fetch()}}(this))},e.prototype.fetch=function(t){var i;return null==t&&(t={}),this.tags=function(){var t,e,o,n;for(o=this.tagsCollection.models,n=[],t=0,e=o.length;e>t;t++)i=o[t],n.push(i.get("name"));return n}.call(this),this.tags.length>0?e.__super__.fetch.call(this,t):this.reset(!1)},e.prototype.parse=function(t){var e,i,o,n,s,a;for(o=t.suggested_tags,s=[],e=0,i=o.length;i>e;e++)a=o[e],n=a.name,r.call(this.tags,n)<0&&s.push(a);return s},e}(Backbone.Collection),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.tagName="li",e.prototype.template="suggested_tag",e.prototype.className="suggested_tag",e.prototype.triggers={click:"select"},e}(Marionette.ItemView),i.SuggestedTags=function(i){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,i),n.prototype.template="suggested_tags",n.prototype.childView=t,n.prototype.childViewContainer="ul",n.prototype.childEvents={select:"onSelect"},n.prototype.collectionEvents={sync:"onSync"},n.prototype.initialize=function(t){return this.tagsCollection=t.tags,this.collection=new e(!1,{tags:this.tagsCollection}),this.listenTo(this.tagsCollection,"add remove",this.toggleEl)},n.prototype.onSelect=function(t){var e;return e=t.model.get("name"),t.$el.addClass("out"),_.delay(function(e){return function(){return t.$el.remove()}}(this),350),this.tagsCollection.add({name:e,id:e,same:!0})},n.prototype.onShow=function(){return this.collection.fetch(),this.toggleEl()},n.prototype.onSync=function(){return this.toggleEl()},n.prototype.toggleEl=function(){var t;return t=this.collection.length>0&&this.tagsCollection.length>0&&this.tagsCollection.length<this.tagsCollection.MAX_NUMBER_OF_TAGS,this.$el.toggle(t)},n}(Marionette.CompositeView)}.call(this),function(){var t,e;t=App.module("Lib"),t.FileReader=function(){function t(){}return t.readAsDataURL=function(t){return e(t,"dataURL")},t.readAsArrayBuffer=function(t){return e(t,"ArrayBuffer")},t}(),e=function(t,e){var i,o;if(i=$.Deferred(),o=new FileReader,o.onload=function(t){return i.resolve(t.target.result)},o.onerror=function(){return i.reject.apply(i,arguments)},"dataURL"===e)o.readAsDataURL(t);else{if("ArrayBuffer"!==e)throw new Error("Unknown format in FileReader#read");o.readAsArrayBuffer(t)}return i}}.call(this),function(){var t,e,i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=null!=(e="undefined"!=typeof App&&null!==App?App.module("Models"):void 0)?e:PxApp,t.UploadedRelease=function(t){function e(t,i){this.type=t,e.__super__.constructor.call(this,i)}return i(e,t),e.prototype.baseUrl=function(){return PxConfig.endpoints.media_service_upload_url+"/licensing/release"},e.prototype.url=function(){return e.__super__.url.call(this)+"&"+$.param({release_id:this.get("id")})},e.prototype.computeHash=function(){var t;return t=$.Deferred(),App.Lib.FileReader.readAsDataURL(this.file).done(function(e){return function(i){var o;return o=window.md5(i),e.set({hash:o}),t.resolve(o)}}(this)),t},e.prototype._createParent=function(){return $.post("https://webapi.500px.com/licensing/releases",{type:this.type,name:this.get("name")}).done(function(t){return function(e){return t.set(e)}}(this))},e}(App.Models.UploadedFile)}.call(this),function(){var t,e,i,o,n,r,s,a,l=function(t,e){function i(){this.constructor=t}for(var o in e)u.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;s=App.module("Organizer.Views"),t=4,App.Uploader.releases=a={},App.Uploader.allReleases=n=null,r=null,e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.tagName="li",e.prototype.template="release_item",e.prototype.className="uploaded_file",e.prototype.ui={check:".completed_checkmark"},e.prototype.behaviors={HasButtons:{"a.delete":"clickDelete",".progress":{confirm:"Are you sure you want to abort this upload?",fn:"clickDelete"}},HasProgressBar:!0},e.prototype.events={click:"onClick"},e.prototype.modelEvents={"change:same":"onChangeSame"},e.prototype.onClick=function(t){return $(t.target).is("a")||$(t.target).is("path")||this.model.get("same")?void 0:this.trigger("add")},e.prototype.onRender=function(){return this.onChangeSame()},e.prototype.onChangeSame=function(){return this.$el.toggleClass("same",this.model.get("same")===!0)},e.prototype.clickDelete=function(){return"in_progress"===this.model.get("upload_status")&&this.model.uploadedRelease.abort(),this.trigger("delete")},e}(Marionette.ItemView),s.ReleasesWidget=function(o){function s(){return s.__super__.constructor.apply(this,arguments)}return l(s,o),s.prototype.childView=e,s.prototype.childViewContainer="ul.releases",s.prototype.template="releases_widget",s.prototype.className="release_widget",s.prototype.childEvents={"delete":"onDelete",add:"onApplyToAll"},s.prototype.templateHelpers=function(){var e,i;return e=_.uniq(function(){var t,e,o,n;for(o=this.model.photos,n=[],t=0,e=o.length;e>t;t++)i=o[t],n.push(i.inMarketplace());return n}.call(this)),{attributes:this.model.editableAttributes,cid:this.model.cid,store_enabled:App.currentUser.get("store_enabled"),show_reupload:function(e){return function(){return 1===e.model.photos.length?(i=e.model.photos[0],i.get("licensing_status")===t&&i.get("licensing_errors")):!1}}(this),licensing_status_same:e.length<=1,licensing_status_checked:1===e.length&&e[0]?!0:!1}},s.prototype.initialize=function(t){var e,i,o,l,u;s.__super__.initialize.call(this),n||(App.Uploader.allReleases=n=new App.Uploader.Collections.Releases,r=n.fetch()),this.collection=new App.Uploader.Collections.Releases,i=this.model.editableAttributes.releases,u=[];for(l in i)e=i[l],e.record?o=new App.Uploader.Models.Release(e.record):(o=32===l.length?a[l]:n.get(l),o=o.clone()),o.set("same",e.same),u.push(this.collection.add(o));return u},s.prototype.ui={addReleaseSelect:"select.add_release_types",inputField:".release_file_field",marketCheck:".marketplace .checkbox",addModel:".add_model_release",addLocation:".add_location_release",releaseSelect:"select.release_select",subPanes:".sub_panes",reuploadFile:"#file_reupload_field",reuploadButton:".button.reupload"},s.prototype.events={"change @ui.inputField":"onPickedFiles","click @ui.marketCheck":"onMarketCheck","click @ui.addModel":"clickAddModel","click @ui.addLocation":"clickAddLocation","change @ui.releaseSelect":"changeReleaseSelect","change @ui.reuploadFile":"onReuploadFilePicked"},s.prototype.onReuploadFilePicked=function(t){var e,i;return e=new FormData,e.append("photo_id",this.model.photos[0].id),e.append("file",t.target.files[0]),i=$.ajax({url:"/upload/store",data:e,processData:!1,contentType:!1,type:"POST"}),App.router.lockNavigation(this.$(".resubmit_pane").i18n("confirm",{"return":!0})),this.ui.reuploadButton.addClass("loading"),i.done(function(t){return function(e){return t.model.photos[0].set(e.photo),t.model.trigger("batchedChange")}}(this)),i.fail(function(t){return function(t){return alert(t.responseText)}}(this)),i.complete(function(t){return function(){var e;return App.router.unlockNavigation(),"function"==typeof(e=t.ui.reuploadButton).removeClass?e.removeClass("loading"):void 0}}(this)),i},s.prototype.onRender=function(){return this._renderReleasesDropdown()},s.prototype.onShow=function(){return this._primeChange(this.ui.marketCheck.hasClass("checked"))},s.prototype.onMarketCheck=function(t){var e,i,o,n,r;if(i=!this.ui.marketCheck.hasClass("checked"))App.currentUser.get("store_enabled")?this.ui.subPanes.slideDown():App.Uploader.Views.ContributorAgreementOverlay.showAgreement().done(function(t){return function(){return t.ui.subPanes.slideDown(),App.currentUser.set("store_enabled",!0),$.post("https://api.500px.com/v1/licensing/enable_store")}}(this)).fail(function(t){return function(){return t.ui.marketCheck.removeClass("checked"),t._primeChange(!1)}}(this));else{if(r=this.model.editableAttributes.licensing_status.values,e=function(){var t,e,i;for(i=[],t=0,e=r.length;e>t;t++)n=r[t],0!==n&&1!==n&&i.push(n);return i}().length,e>0&&(o=this.$(".marketplace").i18n({count:this.model.photos.length,"return":!0}),!confirm(o)))return t.stopPropagation(),!1;this.ui.subPanes.slideUp()}return this._primeChange(i)},s.prototype.onDelete=function(t){var e,i,o;return i=t.model,e=null!=(o=i.id)?o:i.get("hash"),this.model.removeRelease(e),this.collection.remove(t.model),this.trigger("change:releases")},s.prototype.clickAddModel=function(){return this.type="model"},s.prototype.clickAddLocation=function(){return this.type="location"},s.prototype.onPickedFiles=function(t,e){return this._uploadReleases(t.target.files)},s.prototype.onApplyToAll=function(t){var e,i;return e=t.model,this.model.addRelease(null!=(i=e.id)?i:e.get("hash")),t.model.set("same",!0),this.trigger("change:releases")},s.prototype.changeReleaseSelect=function(){var t,e;return(e=this.ui.releaseSelect.val())?(t=n.get(e),t&&this._addRelease(t),this.ui.releaseSelect.find(".placeholder").prop("selected",!0)):void 0},s.prototype._renderReleasesDropdown=function(){return null==this.releaseDropdown&&(this.releaseDropdown=new i({el:this.ui.releaseSelect,collection:n,selectedCount:this.model.photos.length})),this.releaseDropdown.render()},s.prototype._addRelease=function(t){var e,i;return e=null!=(i=t.id)?i:t.uploadedRelease.get("hash"),this.model.addRelease(e),this.collection.add(t.clone()),this.trigger("change:releases")},s.prototype._uploadReleases=function(t){var e,i,o,r;for(r=[],i=0,o=t.length;o>i;i++)e=t[i],r.push(function(t){return function(e){var i;return i=new App.Models.UploadedRelease(t.type,e),i.computeHash().done(function(e){var o;return a[e]||(a[e]=new App.Uploader.Models.Release({uploadedRelease:i,type:i.type}),n.add(a[e]),i.beginUpload()),o=a[e],o.get("id")?t._addRelease(o):o.on("change:id",function(){return t._addRelease(o)})})}}(this)(e));return r},s.prototype._primeChange=function(t){return this.ui.subPanes.toggleClass("disabled",!t)},s}(Marionette.CompositeView),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.tagName="option",e.prototype.template="release_select_item",e.prototype.onRender=function(){return this.$el.attr("value",this.model.get("id"))},e}(Marionette.ItemView),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.childView=o,e.prototype.initialize=function(t){return this.selectedCount=t.selectedCount,this.listenTo(this.collection,"sync",this.onSync)},e.prototype.onSync=function(){return 0===this.collection.length&&this.$el.closest(".select_wrap").hide(),this.$el.prop("disabled",0===this.collection.length)},e.prototype.onAddChild=function(t){return"model"===t.model.get("type")?t.$el.appendTo(this.$el.find("optgroup.models")):t.$el.appendTo(this.$el.find("optgroup.locations")),this.$el.closest(".select_wrap").show(),this.$el.prop("disabled",!1)},e.prototype.onRender=function(){return this.$el.prop("disabled",0===this.collection.length),this.$el.find("option.placeholder").i18n({count:this.selectedCount}),this.onSync()},e}(Marionette.CollectionView)}.call(this),function(){var t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;e=App.module("Organizer.Views"),t=4,Handlebars.registerHelper("nl2br",function(t){return new Handlebars.SafeString(t.replace(/\n/g,"<br>"))}),e.LicensingErrorsWidget=function(e){function n(){return this.onScroll=i(this.onScroll,this),n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.template="licensing_errors_widget",n.prototype.className="licensing_errors_widget",n.prototype.templateHelpers=function(){var t;return t=_.uniq(this.errors()),1===t.length?{same:!0,errors:t[0]}:{same:!1}},n.prototype.onShow=function(){return 0===this.errors().length?void this.$el.closest("li.licensing_errors").hide():(_.delay(function(t){return function(){return $("#organizer_right_pane .scroll").on("scroll",t.onScroll)}}(this),100),this.$el.closest("li.licensing_errors").addClass("flyout"),this.$(".licensing_errors_container").hide(),this.$qtip=this.$(".flyout_target").qtip({content:this.$(".licensing_errors_container"),style:{classes:"uploader_flyout",def:!1,tip:{width:20,height:10,mimic:"right center",offset:20}},position:{my:"right bottom",at:"left center",viewport:$(window),container:function(){return $("#organizer_right_pane .scroll")},effect:!1,adjust:{scroll:!0,x:-10,y:25}},show:"click",hide:"click"}))},n.prototype.onDestroy=function(){return null!=this.$qtip?(this.$qtip.qtip("destroy",!0),$("#organizer_right_pane .scroll").off("scroll",this.onScroll)):void 0},n.prototype.onScroll=function(){return this.$qtip.qtip("hide")},n.prototype.errors=function(){var e,i,o,n,r;for(n=function(){var e,i,n,r;for(n=this.model.photos,r=[],e=0,i=n.length;i>e;e++)o=n[e],o.get("licensing_status")===t&&r.push(o);return r}.call(this),r=[],e=0,i=n.length;i>e;e++)o=n[e],o.get("licensing_errors")&&r.push(o.get("licensing_errors"));return r},n}(Marionette.ItemView)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Models"),t.Gallery=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.GALLERY_KINDS={KIND_GENERAL:0,KIND_LIGHTBOX:4,KIND_LICENSING_GALLERY:4,KIND_PORTFOLIO:4,KIND_PROFILE:3},i.prototype.isEmpty=function(){return 0===this.get("items_count")},i.prototype.containsOwnerPhotosOnly=function(){var t;return(t=this.get("kind"))===this.GALLERY_KINDS.KIND_PROFILE||t===this.GALLERY_KINDS.KIND_PORTFOLIO},i.prototype.isPrivate=function(){return this.get("privacy")},i.prototype.markPhotoMembership=function(t,e){return null==e&&(e={}),null==this._memberPhotoIds&&(this._memberPhotoIds={}),this._memberPhotoIds[t]=!0,e.silent?void 0:this.trigger("change:photoMembership",t,!0)},i.prototype.containsPhoto=function(t){return null==this._memberPhotoIds&&(this._memberPhotoIds={}),t.id in this._memberPhotoIds},i.prototype.getCoverPhotoId=function(){var t;return null!=(t=this.getCoverPhoto())?t.id:void 0},i.prototype.getCoverPhoto=function(){var t;return null!=(t=this.get("cover_photo"))?t[0]:void 0},i.prototype.setCover=function(t){var e;return e={_method:"put",cover_photo_id:t,cover_size:2048},$.post("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id"),e).done(function(t){return function(e){return t.set("cover_photo",e.gallery.cover_photo)}}(this))},i.prototype.addPhotos=function(t){var e,i;return i={_method:"put",add:{photos:function(){var i,o,n;for(n=[],i=0,o=t.length;o>i;i++)e=t[i],n.push(e.id);return n}()}},$.post("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id")+"/items",i).done(function(i){return function(o){var n,r,s;for(n=0,r=t.length;r>n;n++)e=t[n],"added"===(null!=(s=o[e.id])?s.result:void 0)&&(null==i._memberPhotoIds&&(i._memberPhotoIds={}),i._memberPhotoIds[e.id]=!0,i.trigger("change:photoMembership",e.id,!0),i._lastAddedPhotoHistory=_.reject(i._lastAddedPhotoHistory,function(t){return t.id===e.id}),i._lastAddedPhotoHistory.push(e));return i.set("updated_at",(new Date).toISOString())}}(this))},i.prototype.removePhotos=function(t){var e,i;return i={_method:"put",remove:{photos:function(){var i,o,n;for(n=[],i=0,o=t.length;o>i;i++)e=t[i],n.push(e.id);return n}()}},$.post("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id")+"/items",i).done(function(i){return function(o){var n,r,s;for(n=0,r=t.length;r>n;n++)e=t[n],"removed"===(null!=(s=o[e.id])?s.result:void 0)&&(null==i._memberPhotoIds&&(i._memberPhotoIds={}),delete i._memberPhotoIds[e.id],i.trigger("change:photoMembership",e.id,!1),i._lastAddedPhotoHistory=_.reject(i._lastAddedPhotoHistory,function(t){return t.id===e.id}));return i.set("updated_at",(new Date).toISOString())}}(this))},i.prototype.getLastAddedPhoto=function(){var t;return null==this._lastAddedPhotoHistory&&(this._lastAddedPhotoHistory=[],t=this.get("last_added_photo"),null!=t&&this._lastAddedPhotoHistory.push(new App.Models.Photo(t))),_.last(this._lastAddedPhotoHistory)},i.prototype.getPrivateShareUrl=function(){return null==this.privateUrlDfd&&(this.privateUrlDfd=$.Deferred(),$.get("https://api.500px.com/v1/users/"+this.get("user_id")+"/galleries/"+this.get("id")+"/share_url").done(function(t){return function(e){return t.privateUrlDfd.resolve("https://500px.com/"+e.share_url)}}(this)).fail(function(t){return function(e,i,o){var n;return(n=t.privateUrlDfd).reject.apply(n,arguments)}}(this))),this.privateUrlDfd.promise()},i.prototype.getCanonicalPath=function(){var t,e,i,o;return this.isPrivate()?"/g/"+this.get("token"):(e=null!=(t=this.galleryPath)?t:this.get("custom_path"),null==e&&(e=this.id),i=this.get("user"),o=_.isFunction(i.get)?i.get("username"):i.username,"/"+o+"/galleries/"+e)},i.prototype.getCanonicalUrl=function(){var t;return t=this.getCanonicalPath(),"https://500px.com"+t},i.prototype.getUrl=function(){var t,e;return t=this.get("user"),e=_.isFunction(t.get)?t.get("username"):t.username,"https://500px.com/"+e+"/galleries/"+this.get("custom_path")},i.prototype.isOwnedByCurrentUser=function(){var t;return this.get("user_id")===(null!=(t=App.currentUser)?t.get("id"):void 0)},i.prototype.getApiIdentifier=function(){var t;return t=this.isPrivate()&&!this.isOwnedByCurrentUser()?this.galleryPath:this.id},i.prototype.share=function(t,e){return null==this.popup&&(this.popup=new App.Lib.Sharelizer({url:this.getCanonicalUrl(),category:"Gallery Page"})),this[t](e)},i.prototype.google=function(t){return this.popup.google()},i.prototype.facebook=function(t){return this.popup.facebook()},i.prototype.vk=function(t){return this.popup.vk()},i.prototype._pinterestShareData=function(){var t;return{media:null!=(t=this.get("cover_photo"))?t[0].url:void 0,description:this.get("description")}},i.prototype.pinterest=function(t){var e;if(e=this._pinterestShareData(),!e.media)throw"This view doesn't know how to share with pinterest";return this.popup.pinterest(e.media,e.description)},i.prototype._twitterShareData=function(){return{text:'Gallery "'+this.get("name")+'" by '+this.get("user").fullname+" #500px"}},i.prototype.twitter=function(t){var e;if(e=this._twitterShareData(),!e.text)throw"This view doesn't know how to share with twitter";return this.popup.twitter(e.text)},i.prototype._stumbleuponShareData=function(){return{title:'Gallery "'+this.get("name")+'" by '+this.get("user").fullname+" #500px"}},i.prototype.stumbleupon=function(t){var e;if(e=this._stumbleuponShareData(),!e.title)throw"This view doesn't know how to share with StumbleUpon";return this.popup.stumbleupon(e)},i.prototype.isFeatured=function(){return!!this.get("editors_choice")},i.prototype.feature=function(){var t,e;if(!App.currentUser)throw new Error("feature requires current user");if(this.isFeatured())throw new Error("gallery is already featured");return e="https://api.500px.com/v1/users/"+this.userId+"/galleries/"+this.galleryPath+"/editors_choice/add",t={method:"PUT"},$.ajax(e,t).done(function(t){return function(){return t.set({editors_choice:!0})}}(this))},i.prototype.unfeature=function(){var t,e;if(!App.currentUser)throw new Error("feature requires current user");if(!this.isFeatured())throw new Error("gallery is not featured");return e="https://api.500px.com/v1/users/"+this.userId+"/galleries/"+this.galleryPath+"/editors_choice/remove",t={method:"PUT"},$.ajax(e,t).done(function(t){return function(){return t.set({editors_choice:!1})}}(this))},i.prototype.reportContent=function(t,e){var i,o,n;return null==e&&(e=""),i=this.getApiIdentifier(),n="https://api.500px.com/v1/users/"+this.userId+"/galleries/"+i+"/report",o={reason:t},0===Number(t)&&(o.reason_details=e),$.post(n,o).done(function(e){return function(){return e.trigger("contentReported",t)}}(this))},i}(Backbone.Model)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Galleries.Models"),t.Gallery=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.initialize=function(t){return null==t&&(t={}),this.userId=t.userId,this.galleryPath=t.galleryPath},i.prototype.url=function(){var t,e;return t={include_user:!0,include_cover:1,cover_size:2048},e="https://api.500px.com/v1/users/"+this.userId+"/galleries",null!=this.galleryPath&&(e+="/"+this.galleryPath),e+"?"+$.param(t)},i.prototype.parse=function(t){return t.gallery},i}(App.Models.Gallery)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Behaviors"),t.HasButtons=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.initialize=function(){var t,e,i,o,n;null==(t=this.view).events&&(t.events={}),this.options=this.view.normalizeUIKeys(this.options),e=this.options,i=[];for(o in e)n=e[o],i.push(function(t){return function(e,i){return t.bindClickEvent(e,i)}}(this)(o,n));return i},i.prototype.bindClickEvent=function(t,e){var i,o,n;return o=this,null!=(i=this.view.events)[n="click "+t]?i[n]:i[n]=function(i){var n,r,s,a,l,u,h,p,c;return c=this,a=o._extractOptions(c,e),"#"!==$(i.target).attr("href")&&(i.metaKey||i.ctrlKey||i.shiftKey)?void 0:(n=c.$(t),r=null!=(l=a.disabledClass)?l:"disabled",s=null!=(u=a.loadingClass)?u:"loading",n.hasClass(r)||n.is(":disabled")?o._stopEvent(i,a):o._confirmClick(c,n,i,a)?(h=a.fn.call(c,i),h===!0?!0:(p=o._stopEvent(i,a),$.isFunction(null!=h?h.always:void 0)&&(n.addClass("disabled loading"),h.always(function(){return n.removeClass("disabled loading")})),p)):o._stopEvent(i,a))}},i.prototype._extractOptions=function(t,e){var i;if(i={},$.isPlainObject(e)){if(i=e,null!=e.trigger?i.fn=function(i){return function(){return t.trigger(e.trigger)}}(this):!$.isFunction(i.fn)&&$.isFunction(t[i.fn])&&(i.fn=t[i.fn]),!$.isFunction(i.fn))throw new Error("No callback function specified")}else if($.isFunction(e))i={fn:e};else{if(!$.isFunction(t[e]))throw console.error(e),new Error("HasButton doesn't know how to use this value: "+e);i={fn:t[e]}}return i},i.prototype._stopEvent=function(t,e){if(null==e.stopEvent&&(e.stopEvent=!0),e.stopEvent===!0)return t.preventDefault(),!1;if(t[e.stopEvent]===!1)return!0;if(t[e.stopEvent])return t[e.stopEvent]();throw new Error("Unknown HasButtons value for stopEvent: "+option.stopEvent)},i.prototype._confirmClick=function(t,e,i,o){var n,r,s;return n=null!=(r=o.confirm)?r:e.data("confirm"),null!=n&&n!==!1?$.isFunction(n)?(s=n.apply(t),_.isString(s)?window.confirm(s):s):window.confirm(n):!0},i}(Marionette.Behavior)}.call(this),function(){var t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;e=App.module("Behaviors"),t=$(window),e.IsPopover=function(e){function n(){return this.dismiss=i(this.dismiss,this),this.showPopover=i(this.showPopover,this),n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.initialize=function(t){if(this.classPrefix=t.classPrefix,null==this.classPrefix)throw new Error("must provide classPrefix");return this.view.dismiss=this.dismiss,this.view.showPopover=this.showPopover},n.prototype.showPopover=function(e,i){var o,n,r,s,a;if(null==i&&(i={}),null==e)throw new Error("View creator must provide event");return n=$("<div></div>").addClass("popover "+this.classPrefix+"__container").hide(),o=$("<div></div>").addClass("contain "+this.classPrefix+"__composite"),n.append(o),s={overwrite:!1,style:{def:!1,classes:"px_popover "+this.classPrefix,tip:{width:20,height:10}},position:{my:"left center",at:"right center",viewport:t,effect:!1,adjust:{method:"flipinvert shift"}},show:{event:e.type,delay:0,ready:!0},hide:{delay:0,event:"click unfocus"},events:{render:function(t){return function(e,i){return t.view.setElement(o),t.view.render()}}(this),show:function(e){return function(i,o){return t.one("scroll resize",function(){return o.hide()}),e.view.trigger("IsPopover:show",o)}}(this),hide:function(t){return function(e,i){return t.view.trigger("IsPopover:hide",i),t.qtipApi=null,i.destroy()}}(this)}},null!=i.position&&_.extend(s.position,i.position),null!=i.hide&&_.extend(s.hide,i.hide),r=$(i.target||e.target),a=_.defaults({content:n},s),this.qtipApi=r.qtip(a,e).qtip("api")},n.prototype.dismiss=function(){
var t;return null!=(t=this.qtipApi)?t.hide():void 0},n}(Marionette.Behavior)}.call(this),function(){var t,e,i,o,n=function(t,e){function i(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty;o=App.module("Views"),t=$(window),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.template="add_to_galleries_popover_empty",e.prototype.className="add_to_galleries_popover_empty",e}(Marionette.ItemView),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.template="add_to_galleries_popover_item",e.prototype.tagName="li",e.prototype.className="add_to_galleries_popover__item",e.prototype.ui={thumbnail:".add_to_galleries_popover_item__thumbnail",checkbox:".add_to_galleries_popover_item__checkmark",popoverItem:".add_to_galleries_popover_item__wrap"},e.prototype.triggers={"click @ui.popoverItem":"clicked"},e.prototype.modelEvents={"change:photoMembership":"_updateCheckmark"},e.prototype.onRender=function(){return this._updateCheckmark()},e.prototype._updateCheckmark=function(){var t,e,i,o,n,r,s;if(this.model.isNew())t=!0,e=!1;else if(this.options.photos)for(t=!0,e=!1,s=this.options.photos,o=0,n=s.length;n>o;o++)r=s[o],this.model.containsPhoto(r)?e=!0:t=!1;else this.options.batchEditablePhoto&&(i=this.options.batchEditablePhoto.checkGalleryMembership(this.model),t=i.containsAllPhotos,e=i.containsSomePhotos);return t?this.select():e?this.selectPartial():this.unselect()},e.prototype.templateHelpers=function(){var t;return{thumbUrl:null!=(t=this.model.getLastAddedPhoto())?t.getImagePath({size:1}):void 0,galleryUrl:this.model.getCanonicalUrl()}},e.prototype.toggleCheckmark=function(){return this._checked=this._partiallyChecked?!0:!this._checked,this._partiallyChecked=!1,this.ui.thumbnail.toggleClass("add_to_galleries_popover_item__thumbnail--checked",this._checked),this.ui.checkbox.toggleClass("add_to_galleries_popover_item__checkmark--checked",this._checked),this.ui.checkbox.removeClass("add_to_galleries_popover_item__checkmark--partial_checked")},e.prototype.selected=function(){return this._checked},e.prototype.select=function(){return this._checked=!0,this._partiallyChecked=!1,this.ui.thumbnail.addClass("add_to_galleries_popover_item__thumbnail--checked"),this.ui.checkbox.addClass("add_to_galleries_popover_item__checkmark--checked")},e.prototype.selectPartial=function(){return this._checked=!0,this._partiallyChecked=!0,this.ui.thumbnail.addClass("add_to_galleries_popover_item__thumbnail--checked"),this.ui.checkbox.addClass("add_to_galleries_popover_item__checkmark--partial_checked")},e.prototype.unselect=function(){return this._checked=!1,this._partiallyChecked=!1,this.ui.thumbnail.removeClass("add_to_galleries_popover_item__thumbnail--checked"),this.ui.checkbox.removeClass("add_to_galleries_popover_item__checkmark--checked"),this.ui.checkbox.removeClass("add_to_galleries_popover_item__checkmark--partial_checked")},e}(Marionette.ItemView),o.AddToGalleriesPopover=function(t){function o(t){null==t&&(t={}),null==App.myGalleries&&(App.myGalleries=new App.Collections.MyGalleries([])),App.myGalleries.sort(),t.collection=App.myGalleries,o.__super__.constructor.call(this,t)}return n(o,t),o.prototype.template="add_to_galleries_popover",o.prototype.childViewContainer="ul",o.prototype.childView=i,o.prototype.emptyView=e,o.prototype.childViewOptions=function(){return{batchEditablePhoto:this.batchEditablePhoto,photos:this.photos}},o.prototype.behaviors={InfiniteScroll:{container:function(){return this.ui.list}},HasButtons:{"@ui.createButton":"onCreateButtonClicked"},IsPopover:{classPrefix:"add_to_galleries_popover"}},o.prototype.ui={title:".add_to_galleries_popover__create_gallery__title",closeButton:".add_to_galleries_popover__close_button",createIcon:".add_to_galleries_popover__create_icon",createInput:".add_to_galleries_popover__title_input",createSection:".add_to_galleries_popover__create_section",privacyCheckbox:".add_to_galleries_popover__checkbox",createButton:".add_to_galleries_popover__create_button",list:".add_to_galleries_popover__galleries_list.scroll"},o.prototype.events={"click @ui.closeButton":"onClickClose","click @ui.createIcon":"onCreateIconClicked","click @ui.createInput":function(){return this.toggleCreateSection(!0)},"input @ui.createInput":function(){return this.toggleCreateSection(!0)},"click @ui.privacyCheckbox":function(){return this.ui.privacyCheckbox.toggleClass("checked")},keyup:"onKeyup"},o.prototype.onClickClose=function(){return this.dismiss()},o.prototype.onCreateIconClicked=function(){return this.toggleCreateSection(!0),this.ui.createInput.focus()},o.prototype.onCreateButtonClicked=function(){var t,e,i,o;return e=(null!=(o=App.currentUser)?o.isBuyer():void 0)?!0:this.ui.privacyCheckbox.hasClass("checked"),t={userId:App.currentUser.id,name:this._getNewTitle(),privacy:e,kind:0,auto_path:!0},i=new App.Galleries.Models.Gallery(t),i.save().done(function(t){return function(e){return i.set({user:App.currentUser.toJSON()},{silent:!0}),t.toggleCreateSection(!1),t._toggleGalleryMembership(i,!0),App.myGalleries.add(i,{at:0})}}(this)).fail(function(t){return function(){var e,i;return e=(i=App.Helpers.API).parseError.apply(i,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(e)),t.ui.createInput.focus()}}(this))},o.prototype.toggleCreateSection=function(t){return this.createMode=t,this.ui.createSection.toggleClass("add_to_galleries_popover__create_section--active",t),t||this.ui.createInput.val(""),this._updateCreateButton(),this.ui.list.height(this.$(".inside").innerHeight()-this.ui.title.outerHeight()-this.ui.createInput.outerHeight()-2-(t?111:0))},o.prototype._updateCreateButton=function(){return this.ui.createButton.toggleClass("disabled",this._getNewTitle().length<1)},o.prototype._getNewTitle=function(){return $.trim(this.ui.createInput.val())},o.prototype.initialize=function(t){var e;if(this.kind=t.kind,this.batchEditablePhoto=t.batchEditablePhoto,this.photos=t.photos,"gallery"!==(e=this.kind)&&"portfolio"!==e&&"profile"!==e)throw new Error("Incorrect kind: "+this.kind);if(null!=this.batchEditablePhoto){if(null!=this.photos)throw new Error("photos should not be used in batch editing mode")}else if(!(null!=this.photos&&this.photos.length>0))throw new Error("photos are missing");return this.createMode=!1,this._checkMembership()},o.prototype._checkMembership=function(){var t,e,i,o;if(null!=this.photos)for(o=this.photos,t=0,e=o.length;e>t;t++)i=o[t],this.collection.reconcileMembershipOfPhoto(i.id);else this.batchEditablePhoto.reconcileGalleryMemberships(this.collection);return this.listenTo(this.collection,"error:reconcileMembershipOfPhoto",function(t){return function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this))},o.prototype.onKeyup=function(t){var e;switch(t.which){case 27:return this.createMode?this.ui.createInput.val()?(e=this.ui.list.i18n("messages-abort-creation",{"return":!0}),confirm(e)?this.toggleCreateSection(!1):this.ui.createInput.focus()):this.toggleCreateSection(!1):this.dismiss();case 13:if(this.createMode&&!this.ui.createButton.hasClass("disabled"))return this.onCreateButtonClicked()}},o.prototype.onRender=function(){return null==this.collection.totalPages&&this.collection.fetch(),this.ui.title.i18n("galleries",{count:1}),this.ui.createInput.attr("placeholder",this.ui.createInput.i18n(this.kind,{"return":!0})),this.ui.list.scrollLock("on",null,!0),_.defer(function(t){return function(){return t.ui.createInput.focus(),t.toggleCreateSection(!1)}}(this))},o.prototype.onChildviewClicked=function(t,e){return t.toggleCheckmark(),this._toggleGalleryMembership(e.model,t.selected(),t)},o.prototype._toggleGalleryMembership=function(t,e,i){var o,n,r,s,a,l;return null!=this.batchEditablePhoto?e?this.batchEditablePhoto.addGallery(t.id):(this.batchEditablePhoto.removeGallery(t.id),null!=i&&i.render(),App.vent.trigger("addToGalleriesPopover:removePhoto",t.id,null!=(r=i.options.photos)&&null!=(s=r[0])?s.id:void 0)):(e?(o=t.addPhotos,n="messages-gallery-add"):(App.vent.trigger("addToGalleriesPopover:removePhoto",t.id,null!=(a=i.options.photos)&&null!=(l=a[0])?l.id:void 0),o=t.removePhotos,n="messages-gallery-remove"),o.call(t,this.photos).done(function(e){return function(){var i,o;return o=$("<a>").text(e.ui.list.i18n("messages-view-gallery",{"return":!0})).attr("href",t.getCanonicalUrl()).attr("target","_blank")[0].outerHTML,i=e.ui.list.i18n(n,{count:e.photos.length,"return":!0})+" "+o,App.Flash.success(i),e.dismiss()}}(this)).fail(function(t){return function(){var t,e;return t=(e=App.Helpers.API).parseError.apply(e,arguments),App.Flash.error(App.Helpers.API.getErrorMessage(t))}}(this))),App.vent.trigger("change:gallery_membership")},o}(Marionette.CompositeView)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty,o=[].slice;t=App.module("Collections"),t.MyGalleries=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.rpp=20,i.prototype.model=App.Models.Gallery,i.prototype.comparator=function(t){return-Date.parse(t.get("updated_at"))},i.prototype.url=function(){var t;return t={privacy:"both",include_cover:1,cover_size:3,include_last_added:!0,sort:"last_added_to_at",sort_direction:"desc",kinds:"0,1,2,4,5"},"https://api.500px.com/v1/users/"+App.currentUser.id+"/galleries?"+$.param(t)},i.prototype.initialize=function(t,e){if(null==e&&(e={}),i.__super__.initialize.apply(this,arguments),this.on("add",this.onModelAdded),null==App.currentUser)throw new Error("Cannot find currentUser")},i.prototype.reconcileMembershipOfPhoto=function(t){return this._loadMembershipOfPhoto(t)},i.prototype._loadMembershipOfPhoto=function(t,e){var i,n,r,s,a;if(null==e&&(e=1),1===e){null!=(s=this._pendingReconciliationXhr)&&s.abort(),null==this._notLoadedGalleriesInfo&&(this._notLoadedGalleriesInfo={}),a=this._notLoadedGalleriesInfo;for(i in a)n=a[i],delete n[t]}return r={sort:"updated_at",sort_direction:"desc",user_id:App.currentUser.id,rpp:1e3},this._pendingReconciliationXhr=$.get("https://api.500px.com/v1/photos/"+t+"/galleries?"+$.param(r)).done(function(i){return function(o){var n,r,s,a,l,u;for(i._pendingReconciliationXhr=null,u=o.galleries,a=0,l=u.length;l>a;a++)r=u[a],s=r.id,r=i.findWhere({id:s}),null!=r?r.markPhotoMembership(t):(null==(n=i._notLoadedGalleriesInfo)[s]&&(n[s]={}),i._notLoadedGalleriesInfo[s][t]=!0);return e<o.total_pages?i._loadMembershipOfPhoto(t,e+1):void 0}}(this)).fail(function(t){return function(e,i,n){return"abort"!==i?t.trigger.apply(t,["error:reconcileMembershipOfPhoto"].concat(o.call(arguments))):void 0}}(this))},i.prototype.onModelAdded=function(t){var e,i,o,n;if(e=null!=(o=this._notLoadedGalleriesInfo)?o[t.id]:void 0,null!=e){for(i in e)n=e[i],t.markPhotoMembership(i);return delete this._notLoadedGalleriesInfo[t.id]}},i.prototype.parse=function(t){var e,o,n,r,s;for(s=null!=(r=null!=t?t.galleries:void 0)?r:[],o=0,n=s.length;n>o;o++)e=s[o],e.user=App.currentUser.toJSON();return i.__super__.parse.call(this,t)},i}(App.Collections.InfiniteCollection)}.call(this),function(){var t,e,i=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty,r=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};e=App.module("Organizer.Views"),e.PhotoDetailsPanel=function(n){function s(){return this.updateBulkMaxKeywordNotice=i(this.updateBulkMaxKeywordNotice,this),this.onDestroy=i(this.onDestroy,this),this.setupFlyoutWidgets=i(this.setupFlyoutWidgets,this),this.initialize=i(this.initialize,this),s.__super__.constructor.apply(this,arguments)}return o(s,n),s.prototype.ui={mapToggle:".map .flyout_target",discoverabilityHint:".discoverability .hint",discoverabilityBar:".discoverability .progress_bar",discoverabilityBarProgress:".discoverability .progress_bar .progress",scrollablePanel:".scroll.edit",tagsTextarea:".tags .tags_textarea_container",deleteButton:".delete_button",nameInput:".name input",setsCheck:".sets .flyout_target .completed_checkmark",galleriesCheck:".galleries_widget__uploader_target .completed_checkmark",portfoliosCheck:".portfolios .flyout_target .completed_checkmark",addToGalleryButton:".galleries_widget__button, .galleries_widget__uploader_target"},s.prototype.fields={input:["name","camera","lens","focal_length","shutter_speed","aperture","iso","taken_at"],textarea:["description"],checkbox:["nsfw","marketplace","exclusive_use","watermark"],select:["category","license_type","licensing_usage"],object:["tags"]},s.prototype.events={"click .checkbox":"toggleCheckbox","click @ui.deleteButton":"clickDelete","click @ui.mapToggle":"clickMap"},s.prototype.behaviors={HasButtons:{"@ui.addToGalleryButton":"_openAddToGalleryPopover"}},s.prototype._openAddToGalleryPopover=function(t){var e;return e=new App.Views.AddToGalleriesPopover({kind:"gallery",batchEditablePhoto:this.model,position:{my:"right center",at:"left center"}}),e.showPopover(t),!1},s.prototype.initialize=function(t){return this.enableFlyoutWidgets=t.enableFlyoutWidgets,this.enableTooltips=t.enableTooltips,this.isUploader=t.isUploader,t},s.prototype.templateHelpers=function(){return{attributes:this.model.editableAttributes}},s.prototype.onFormChanged=function(t){var e,i;if(0!==this.model.photos.length){if(this.model.setBatchedAttributes(this.readFields()),e=this.model.batchedAttributesChanged(),this.model.photos.length>1){this.$("ul.fields > li").removeClass("changed");for(i in this.model.attributes)r.call(this.model.exifFields,i)>=0?i="exif":"longitude"===i||"latitude"===i?i="map":"add_tags"===i||"remove_tags"===i?i="tags":("add_releases"===i||"remove_releases"===i)&&(i="releases"),this.$("ul.fields > li."+i).addClass("changed")}return this.updateDiscoverabilityBar(),this.trigger("formChanged",e),this.updateCompletedCheckmarks()}},s.prototype.updateCompletedCheckmarks=function(){return this.model.geoCoords()&&this.$(".map .completed_checkmark").addClass("checked"),this.model.allHaveGalleries()?this.ui.galleriesCheck.removeClass("partial_checked").addClass("checked"):this.model.hasGalleries()?this.ui.galleriesCheck.removeClass("checked").addClass("partial_checked"):this.ui.galleriesCheck.removeClass("checked").removeClass("partial_checked"),this.model.allHaveSets()?this.ui.setsCheck.removeClass("partial_checked").addClass("checked"):this.model.hasSets()?this.ui.setsCheck.removeClass("checked").addClass("partial_checked"):this.ui.setsCheck.removeClass("checked").removeClass("partial_checked"),this.model.allHavePortfolios()?this.ui.portfoliosCheck.removeClass("partial_checked").addClass("checked"):this.model.hasPortfolios()?this.ui.portfoliosCheck.removeClass("checked").addClass("partial_checked"):this.ui.portfoliosCheck.removeClass("checked").removeClass("partial_checked")},s.prototype.toggleCheckbox=function(t){var e;return e=$(t.target),e.hasClass("disabled")?void 0:(e.hasClass("checked")?e.removeClass("checked"):e.hasClass("multi_values")?e.toggleClass("multi_values checked"):e.addClass("checked"),this.onFormChanged(t))},s.prototype.onRender=function(){var t,i,o,n;return s.__super__.onRender.call(this),t=this.model.photos.length>1,this.listenTo(this.model,"updatedName",function(t){return function(){return t.onNameChanged()}}(this)),i=this.model.photos.length>0,i&&(this.updateDiscoverabilityBar(),this.updateDeleteButton(),this.$("input, textarea").on("input",function(t){return function(e){return t.onFormChanged(e)}}(this)),this.$el.on("change","select",function(t){return function(e){return t.onFormChanged(e)}}(this)),this.$(".field_reset").click(function(t){return function(e){return t.onSingleReset(e)}}(this)),this.listenTo(this.model,"change:geolocation",function(t){return function(){return t.onFormChanged()}}(this))),_.defer(function(t){return function(){return t.isDestroyed?void 0:t.setupFlyoutWidgets(i)}}(this)),this.tags=new App.Organizer.Views.TagsField({el:this.$(".tags_field_wrap"),collection:new App.Organizer.Collections.PhotoTags(this.model.getInitialTags()),model:this.model}),this.tags.render(),this.tags.on("tag:update",function(t){return function(e){return t.onFormChanged(e),t.updateBulkMaxKeywordNotice()}}(this)),this.updateBulkMaxKeywordNotice(),t?this.$(".tags").addClass("bulk"):(this.updateKeywordsCount(),this.tags.on("tag:update",function(t){return function(e){return t.updateKeywordsCount()}}(this))),null!=(o=this.licensingRegion)&&o.show(new e.EditPrimePane({photos:this.model.photos})),this._renderReleases(),this._renderLicensingErrors(),this.setupTooltips(),this.enableOrDisableForm(i),i&&(this.$("li.licensing").length>0&&this.addRegion("licensingRegion","li.licensing"),null!=(n=this.licensingRegion)&&n.show(new e.EditPrimePane({photos:this.model.photos})),this.model.photos.length>0)?this.showTagSuggestions():void 0},s.prototype._renderReleases=function(){return 0!==this.$("li.releases").length?(this.addRegion("releasesRegion","li.releases"),this.releaseWidget=new e.ReleasesWidget({model:this.model,releases:this.model.get("releases")}),this.releasesRegion.show(this.releaseWidget),this.releaseWidget.on("change:releases",function(t){return function(){return t.onFormChanged()}}(this))):void 0},s.prototype._renderLicensingErrors=function(){return this.$("li.licensing_errors").length>0?(this.addRegion("licensingErrorsRegion","li.licensing_errors"),this.licensingErrorsWidget=new e.LicensingErrorsWidget({model:this.model}),this.licensingErrorsRegion.show(this.licensingErrorsWidget)):void 0},s.prototype.showTagSuggestions=function(){return this.$("li.suggested_tags").length>0?(this.addRegion("suggestedTagsRegion","li.suggested_tags"),this.suggestedTags=new e.SuggestedTags({tags:this.tags.collection}),this.suggestedTagsRegion.show(this.suggestedTags)):void 0},s.prototype.onNameChanged=function(){return this.$("li.name input").is(":focus")?void 0:this.resetSingleSection(this.$("li.name"),"name")},s.prototype.setupTooltips=function(){var t,e,i,o,n;if(!this.enableTooltips)return this.$(".tooltip_target").hide();if(this.ui.discoverabilityHint.hide(),!this.$(".tooltip_target").hasClass("disabled")){for(o=this.$(".tooltip_target"),n=[],e=0,i=o.length;i>e;e++)t=o[e],n.push($(t).qtip({content:$(t).find(".tooltip_content"),style:{classes:"tooltip_container",tip:{width:14,height:8}},position:{my:"top center",at:"bottom center"},hide:{fixed:!0,delay:300}}));return n}},s.prototype.setupFlyoutWidgets=function(t){var e;return this.$("li.galleries").length>0&&this.listenTo(App.vent,"change:gallery_membership",function(t){return function(){return t.onFormChanged()}}(this)),this.$(".sets_container").hide(),this.$(".portfolios_container").hide(),t&&(e={style:{classes:"uploader_flyout",def:!1,tip:{width:20,height:10,mimic:"right center",offset:20}},position:{my:"right bottom",at:"left center",viewport:$(window),effect:!1,adjust:{x:-10,y:3}},show:"click",hide:"click unfocus"},this.$(".map").addClass("flyout"),this.$("li.sets").length>0&&(this.$(".sets").addClass("flyout"),this.setsQTip=this.$(".sets .flyout_target").qtip(_.extend({content:this.$(".sets_container"),events:{visible:function(t){return function(e,i){return i.tooltip.find(".flyout_title .title").i18n("sets",{count:t.model.photos.length}),t.sets.refresh()}}(this)}},e)),App.Uploader.setsXhr.done(function(t){return function(){var e;return null!=(e=t.setsQTip)?e.qtip("reposition"):void 0}}(this)),this.sets=new App.Uploader.Views.SetsWidget({el:this.$(".sets_container .sets_widget_composite"),collection:App.Uploader.sets,photoModel:this.model,qTipTarget:this.$(".sets .flyout_target"),kind:"profile"}),this.sets.render(),this.listenTo(this.sets,"changed:sets",function(t){return function(e){return t.onFormChanged()}}(this))),this.$("li.portfolios").length>0&&(this.$(".portfolios").addClass("flyout"),this.portfoliosQTip=this.$(".portfolios .flyout_target").qtip(_.extend({content:this.$(".portfolios_container"),events:{visible:function(t){return function(e,i){return i.tooltip.find(".flyout_title .title").i18n("portfolios",{count:t.model.photos.length}),t.portfolios.refresh()}}(this)}},e)),App.Uploader.portfoliosXhr.done(function(t){return function(){var e;return null!=(e=t.portfoliosQTip)?e.qtip("reposition"):void 0}}(this)),this.portfolios=new App.Uploader.Views.SetsWidget({el:this.$(".portfolios_container .sets_widget_composite"),collection:App.Uploader.portfolios,photoModel:this.model,qTipTarget:this.$(".portfolios .flyout_target"),kind:"portfolio"}),this.portfolios.render(),this.listenTo(this.portfolios,"changed:sets",function(t){return function(e){return t.onFormChanged()}}(this)))),this.updateCompletedCheckmarks()},s.prototype.onDestroy=function(){var t,e,i,o,n;if(this._removeMap(),this.$(".sets .flyout_target").qtip("destroy",!0),this.enableTooltips){for(o=this.$(".tooltip_target"),n=[],e=0,i=o.length;i>e;e++)t=o[e],n.push($(t).qtip("destroy",!0));return n}},s.prototype._removeMap=function(){var t;return null!=(t=this.map)&&t.destroy(),$(this.ui.mapToggle).qtip("destroy",!0)},s.prototype.updateDeleteButton=function(){return this.ui.deleteButton.i18n("label",{count:this.model.photos.length})},s.prototype.updateBulkMaxKeywordNotice=function(){var t;return t=this.model.photos.length>1,_.isEmpty(this.model.photos_with_max_tags)?this.$(".tags").removeClass("some_at_max"):this.$(".tags").addClass("some_at_max")},s.prototype.updateKeywordsCount=function(){return this.$(".tags .keywords_count_container .count").text(this.tags.size()+"/"+this.tags.max())},s.prototype.updateDiscoverabilityBar=function(){var t,e;return e=this.model.getDiscoverability(),t=null!=e,this.ui.discoverabilityBar.toggleClass("disabled",!t),this.enableTooltips&&this.$(".discoverability .tooltip_target").toggleClass("disabled",!t),t?(this.ui.discoverabilityHint.i18n("regular"),this.ui.discoverabilityBarProgress.width(e+"%"),this.ui.discoverabilityBarProgress.toggleClass("almost",e>=60&&100>e),this.ui.discoverabilityBarProgress.toggleClass("full",e>=100)):1===this.model.photos.length?this.ui.discoverabilityHint.i18n("private"):void 0},s.prototype.enableOrDisableForm=function(t){return this.ui.discoverabilityBar.toggleClass("disabled",!t),this.$("input, textarea, select, .checkbox, .button, .flyout_target h4, .galleries_widget__uploader_button").toggleClass("disabled",!t).prop("disabled",!t)},s.prototype.resetSingleSection=function(t,e){return"exif"===e?this._resetExifSection(t):"map"===e?this._resetMapSection(t):"tags"===e?this._resetTagsSection(t):this._resetInputSection(t,e)},s.prototype.onSingleReset=function(t){var e,i,o,n,s;if(t.preventDefault(),e=$(t.target).closest("ul.fields > li"),e.hasClass("map"))return this.resetSingleSection(e,"map"),void this.onFormChanged(t);if(e.hasClass("tags"))return this.resetSingleSection(e,"tags"),void this.onFormChanged(t);for(s=this.model.editableFields,o=0,n=s.length;n>o;o++)if(i=s[o],r.call(this.model.exifFields,i)>=0){if(e.hasClass("exif"))return this.resetSingleSection(e,"exif"),void this.onFormChanged(t)}else if(e.hasClass(i))return this.resetSingleSection(e,i),void this.onFormChanged(t)},s.prototype.readFields=function(){var t,e,i,o,n,r,s,a,l,u,h,p;h={};for(e in this.fields)if(o=this.fields[e],"checkbox"===e)for(n=0,a=o.length;a>n;n++)i=o[n],t=this.$("."+i+" .checkbox"),0!==t.length&&(t.hasClass("multi_values")?h[i]="multi_values":h[i]=t.hasClass("checked"));else if("object"===e)for(r=0,l=o.length;l>r;r++)i=o[r],p=this[i],h[i]=p.val();else for(s=0,u=o.length;u>s;s++)i=o[s],t=this.$("."+i+" "+e),h[i]=t.val();return h.marketplace||(delete h.exclusive_use,delete h.licensing_usage),h},s.prototype.clickDelete=function(){var t,e,i;return i=function(){var t,i,o,n;for(o=App.organizer.photos.models,n=[],t=0,i=o.length;i>t;t++)e=o[t],e.get("selected")&&n.push(e);return n}(),t=this.ui.deleteButton.i18n("confirm",{count:i.length,"return":!0}),confirm(t)?(new App.Organizer.Models.OrganizerTrash)["delete"](i).fail(function(t){return function(e){var i;return i=t.ui.deleteButton.i18n("error",{"return":!0}),new PxApp.Shared.FlashMessage({type:"error",message:i}).render()}}(this)).done(function(){return App.organizer.fetchPhotos()}):void 0},s.prototype.clickMap=function(e){var i,o,n;return i=this.model.photos.length>0,i&&(o=this.isUploader?null!=App.uploaderMapCache?App.uploaderMapCache:App.uploaderMapCache={}:null!=App.mapCache?App.mapCache:App.mapCache={},n=new t({model:this.model,mapCache:o}),n.showPopover(e)),!1},s.prototype._resetExifSection=function(t){var e,i,o,n,r,s;for(n=this.model.exifFields,r=[],i=0,o=n.length;o>i;i++)e=n[i],s=this.model.editableAttributes[e].same?this.model.editableAttributes[e].uniqueValue:"",r.push(t.find(".item."+e+" input").val(s));return r},s.prototype._resetMapSection=function(t){return this.model.editableAttributes.geolocation.same?this.model.setGeoCoords(this.model.editableAttributes.geolocation.uniqueValue):this.model.setGeoCoords(null)},s.prototype._resetTagsSection=function(t){return this.tags.collection.reset(this.model.getInitialTags()),t.removeClass("changed")},s.prototype._resetInputSection=function(t,e){var i;switch(i=t.find("input, textarea, select, .checkbox").first(),i.prop("tagName")){case"INPUT":case"TEXTAREA":return this.model.editableAttributes[e]?i.val(this.model.editableAttributes[e].uniqueValue):i.val("");case"SELECT":return this.model.editableAttributes[e].same?i.val(this.model.editableAttributes[e].uniqueValue):i.val("multi_values");case"DIV":if(i.hasClass("checkbox"))return this.model.editableAttributes[e].same?i.removeClass("multi_values").toggleClass("checked",this.model.editableAttributes[e].uniqueValue):i.removeClass("checked").addClass("multi_values")}},s}(App.Views.WidgetPane),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.template="organizer_map_popover",e.prototype.ui={mapBox:".map_box",done:".done"},e.prototype.events={"click @ui.done":"onClickDone"},e.prototype.behaviors={IsPopover:{classPrefix:"organizer_map_popover"}},e.prototype.initialize=function(t){return this.mapCache=t.mapCache,this.on("IsPopover:hide",function(t){return function(){return t.map.onDestroy()}}(this))},e.prototype.onRender=function(){return _.defer(function(t){return function(){return t.map=new App.Views.Map({model:t.model,el:t.ui.mapBox,scroll:!0,enableLocationPicker:!0,searchInputEl:t.$(".map_input")[0],mapCache:t.mapCache}),t.map.refresh()}}(this))},e.prototype.onClickDone=function(){return this.dismiss()},e}(Marionette.ItemView)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=App.module("Organizer.Views"),t.EditWidget=function(i){function o(){null==this.ui&&(this.ui={}),this.ui.header="h2.header",o.__super__.constructor.apply(this,arguments)}return e(o,i),o.prototype.regions={photoDetails:".photo_details"},o.prototype.onShow=function(){return this.onSelectionChanged(),this.monitorPhotoSelection(),this.listenTo(App.vent,"navigate",this.onNavigate),this.updateHeaderAndPanel(),this.setupModelEventHandlers()},o.prototype.setupModelEventHandlers=function(){return this.listenTo(this.model,"request",this.onRequestInProgress),this.listenTo(this.model,"batchedChange",this.onComplete),this.listenTo(this.model,"error",this.onError)},o.prototype.enable=function(){return this.$el.removeClass("disabled"),this.$("a").css("cursor","").removeAttr("disabled")},o.prototype.disable=function(){return this.$el.addClass("disabled"),this.$("a").css("cursor","default").attr("disabled","disabled")},o.prototype.onRequestInProgress=function(){return this.photoDetailsPanel.enableOrDisableForm(!1)},o.prototype.onComplete=function(){return this.photoDetailsPanel.render(),App.router.unlockNavigation()},o.prototype.onNavigate=function(t){return this.monitorPhotoSelection(),this.onSelectionChanged()},o.prototype.bindSelectionEvents=function(t){throw new Error("Implementation missing")},o.prototype.monitorPhotoSelection=function(){return this.bindSelectionEvents(function(t){return function(){return t.onSelectionChanged()}}(this))},o.prototype.onSelectionChanged=function(){return null!=this.model&&this.stopListening(this.model),this.model=new App.Organizer.Models.BatchEditablePhoto(this.getSelectedPhotos()),this.setupModelEventHandlers(),this.updateHeaderAndPanel()},o.prototype.updateHeaderAndPanel=function(){var e;return e=0===this.model.photos.length,this.$el.toggleClass("disabled",e),e?this.ui.header.i18n("disabled"):this.ui.header.i18n("editing",{count:this.model.photos.length}),null!=this.photoDetailsPanel&&this.stopListening(this.photoDetailsPanel),this.photoDetailsPanel=new t.PhotoDetailsPanel({model:this.model,template:this.photoDetailsTemplate,enableTooltips:this.enableTooltips,isUploader:this.isUploader}),this.photoDetails.show(this.photoDetailsPanel),this.listenTo(this.photoDetailsPanel,"formChanged",this.onFormChange),"function"==typeof this.updateUi?this.updateUi():void 0},o.prototype.onFormChange=function(t){throw new Error("Implementation missing")},o.prototype.saveModels=function(t){null==t&&(t=!0),t?this.model.save():this.model.propagateBatchedAttributes()},o}(Marionette.LayoutView)}.call(this),function(){var t,e,i,o=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;i=App.module("Uploader.Views"),i.EditPane=function(i){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,i),n.prototype.template="uploader_edit_pane",n.prototype.className="uploader_edit_pane",n.prototype.regions={editRegion:".edit_section",publishRegion:".publish_section"},n.prototype.initialize=function(){return this.listenTo(this.collection,"remove",this.onPhotoRemoved),this.listenTo(this.collection,"add",function(t){return this.editor.onSelectionChanged()})},n.prototype.onPhotoRemoved=function(){return this.editor.onSelectionChanged()},n.prototype.onShow=function(){return this.editor=new e({collection:this.collection}),this.editRegion.show(this.editor),this.publishButton=new t({collection:this.collection}),this.publishRegion.show(this.publishButton),this.listenTo(App.vent,"uploader:publish",function(t){return function(){return t.editor.disable()}}(this)),this.listenTo(App.vent,"uploader:publishFailed",function(t){return function(){return t.editor.enable()}}(this))},n}(Marionette.LayoutView),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.template="uploader_editor",e.prototype.className="uploader_editor",e.prototype.photoDetailsTemplate="uploader_photo_details",e.prototype.enableTooltips=!0,e.prototype.isUploader=!0,e.prototype.bindSelectionEvents=function(t){return this.stopListening(this.collection),this.listenTo(this.collection,"selection:finished",t)},e.prototype.getSelectedPhotos=function(){var t,e,i,o,n;for(o=this.collection.models,n=[],t=0,e=o.length;e>t;t++)i=o[t],i.get("selected")&&n.push(i);return n},e.prototype.onFormChange=function(t){return this.saveModels(!1)},e}(App.Organizer.Views.EditWidget),i.UploaderBottomBar=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return o(i,e),i.prototype.template="uploader_bottom_bar",i.prototype.className="uploader_bottom_bar",i.prototype.ui={requirements:".local_listings_requirements_message"},i.prototype.regions={publishRegion:".publish_button_region"},i.prototype.templateHelpers=function(){return{longestEdge:this._getLengthFromProjectId()}},i.prototype.initialize=function(t){return this.listingProjectId=t.listingProjectId,this.listenTo(App.vent,"photo:locallistings:rejected",function(t){return function(){return App.Flash.error(t.ui.requirements.text()),t.ui.requirements.toggleClass("local_listings_requirements_message--highlight",!0)}}(this))},i.prototype.onShow=function(){return this.publishRegion.show(new t({collection:this.collection}))},i.prototype._getLengthFromProjectId=function(){return 1===this.listingProjectId?"4200":"3000"},i}(Marionette.LayoutView),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.template="uploader_publish",e.prototype.className="uploader_publish",e.prototype.ui={publish:".publish"},e.prototype.behaviors={HasButtons:{"@ui.publish":"publish"
}},e.prototype.onShow=function(){return this.listenTo(this.collection,"change:upload_finished",this.onUploadFinished),this.listenTo(this.collection,"remove",this.onUploadFinished),this.listenTo(this.collection,"add",function(t){return this.ui.publish.find(".text").i18n("publish",{count:this.collection.length})}),null!=this.collection.quest?this.ui.publish.find(".text").i18n("submit-to-quest"):null!=this.collection.uploadToLocalListingClaim?this.ui.publish.find(".text").i18n("upload-to-local-listing-claim"):this.ui.publish.find(".text").i18n("publish",{count:this.collection.length})},e.prototype.amplitudeClickedPublishButton=function(){var t,e;return t=[],this.collection.any(function(t){return null!=t.uploadedPhoto.file.url})&&t.push("Web_Filepicker"),this.collection.any(function(t){return null==t.uploadedPhoto.file.url})&&t.push("Web_Computer"),null!=(e=window.AmplitudeLogger)?e.upload.clickedPublish(t):void 0},e.prototype.publish=function(){var t,e;if(this.amplitudeClickedPublishButton(),e=this.collection.all(function(t){return t.get("upload_finished")===!0}),this.$(".publish").addClass("disabled loading"),e){if(t=this.collection.publish().done(function(t){return function(){return App.vent.trigger("uploader:published")}}(this)).fail(function(t){return function(){return alert("Failed to publish some photos"),t.$(".publish").removeClass("disabled loading"),App.vent.trigger("uploader:publishFailed")}}(this)),!this.publishing)return App.vent.trigger("uploader:publish")}else if(!this.publishing)return this.publishing=!0,App.vent.trigger("uploader:publish")},e.prototype.onUploadFinished=function(){return this.publishing?this.publish():void 0},e}(Marionette.LayoutView),i.ContributorAgreementOverlay=function(t){function e(t){this.behaviors={HasButtons:{"@ui.agree":"onClickAgree"}},t.modal&&(this.modal=!0,this.behaviors.ModalDialog={maxWidth:5e3,padding:100}),e.__super__.constructor.call(this)}return o(e,t),e.prototype.template="contributor_agreement_overlay",e.prototype.className="contributor_agreement_overlay",e.prototype.ui={agree:".button.agree",no:"a.no",checkbox:".checkbox_input"},e.prototype.events={"click @ui.no":"onClickNo","change @ui.checkbox":"onCheckChange"},e.showAgreement=function(t){var i;return null==t&&(t={}),null==t.modal&&(t.modal=0===$(".main_region").length),i=new e(t),i.modal?i.showModal():$(".main_region").append(i.render().el),i.getPromise()},e.prototype.getPromise=function(){return this.dfd=$.Deferred()},e.prototype.onCheckChange=function(){return this.ui.agree.toggleClass("disabled",!this.ui.checkbox[0].checked)},e.prototype.onBeforeDestroyModal=function(){return this.dfd.reject()},e.prototype.onClickAgree=function(){return this.dfd.resolve(),this.modal?this.destroyModal():this.destroy()},e.prototype.onClickNo=function(){return this.dfd.reject(),this.modal?this.destroyModal():this.destroy()},e}(Marionette.ItemView)}.call(this),function(){null==window.PxConfig&&(window.PxConfig={})}.call(this),function(){PxConfig.endpoints={main_500px_url:"https://500px.com",api_url:"https://api.500px.com/v1",upload_url:"https://upload.500px.com/v1",media_service_upload_url:"https://media.500px.com/upload",media_service_upload_store_url:"https://media.500px.com/upload/photo/store",media_service_user_avatar_upload_url:"https://media.500px.com/upload/user/avatar",media_service_user_cover_upload_url:"https://media.500px.com/upload/user/cover",stats_url:"https://stats.500px.com",cookie_domain:".500px.com",pcdn_http_url:"https://ppcdn.500px.org",pcdn_https_url:"https://ppcdn.500px.org",prime_url:"https://marketplace.500px.com",new_era_url:"https://www.500pxart.com",web_bff:"https://webapi.500px.com"}}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};null==window.PxApp&&(window.PxApp={}),window.PxApp.api=function(){function i(){this.complete=t(this.complete,this),this.error=t(this.error,this),this.success=t(this.success,this)}return i.url=PxConfig.endpoints.api_url,i.upload_url=PxConfig.endpoints.upload_url,i.prefixed_url=function(t,e){return null==e&&(e=i.url),t.match(/^https?:\/\//)?t:""+e+t},i.use_jsonp=_.once(function(){return!("withCredentials"in new XMLHttpRequest)}),i.sync=function(t,e,i){var o,n,r,s,a,l,u;if(null==i&&(i={}),s={create:"POST",update:"PUT","delete":"DELETE",read:"GET",patch:"PUT"},i.url?(a=i.url,delete i.url):a=_.isFunction(e.url)?e.url():e.url,PxApp.api.use_jsonp()?(n=-1!==(r=a.indexOf("?")),n?a=a.slice(0,r)+".jsonp"+a.slice(r):a+=".jsonp",l={url:""+PxApp.api.prefixed_url(a),type:"GET",dataType:"jsonp"},l.data={_method:s[t].toLowerCase()},u=i.success,o=i.error,l.success=function(t,n,r){var s,a;return a=299>(s=t.status)&&s>199,a?(_.isFunction(u)&&u.apply(this,[e,t,i]),e.trigger("sync",e,t,i)):(401===t.status&&PxApp.api.handle_unauthorized_access(),_.isFunction(o)?o.call(this,r,t.status,t):void 0)},delete i.success,delete i.error):(l={url:""+PxApp.api.prefixed_url(a),type:s[t],dataType:"json",xhrFields:{withCredentials:!0}},l.data={},u=i.success,l.success=function(t,o,n){return _.isFunction(u)&&u.apply(this,[e,t,i]),e.trigger("sync",e,t,i)},delete i.success,o=i.error,l.error=function(t,e){var i,n;if(4===t.readyState&&401===t.status&&PxApp.api.handle_unauthorized_access(),_.isFunction(o)){i=t.statusText;try{n=$.parseJSON(t.responseText),i=n}catch(r){}return o.call(this,t,t.status,i)}},delete i.error),e&&!i.data)switch(t){case"create":case"update":_.isFunction(e.saveable_attributes)?_.extend(l.data,e.saveable_attributes()):_.extend(l.data,e.toJSON());break;case"patch":_.extend(l.data,i.attrs)}return l.data.authenticity_token=PxApp.csrf_token,i.data&&(_.extend(l.data,i.data),delete i.data),_.extend(l,i),$.ajax(l)},i.prototype.to_promise=function(){return this.dfd=$.Deferred(),this.success(function(){var t;return(t=this.dfd).resolve.apply(t,arguments)}),this.error(function(){var t;return(t=this.dfd).reject.apply(t,arguments)}),this.dfd.promise()},i.request=function(t,o,n,r){var s,a,l;return null==n&&(n={}),null==r&&(r={}),"undefined"!=typeof window.FormData&&n instanceof window.FormData?n.append("authenticity_token",PxApp.csrf_token):n.authenticity_token=PxApp.csrf_token,r.api_url?(s=r.api_url,delete r.api_url):s=PxApp.api.url,l=new PxApp.api,PxApp.api.use_jsonp()?(o=e.call(o,"?")>=0?o.replace("?",".jsonp?"):o+".jsonp",n._method=t.toLowerCase(),a={type:"GET",dataType:"jsonp",success:function(t,e,o){var n,r;return i.xhr=null,l.aborted?void 0:void 0!==t.status&&200!==t.status?(401===t.status&&PxApp.api.handle_unauthorized_access(),o.responseText=JSON.stringify(t),"function"==typeof l.on_error&&l.on_error(o,"error",t.status),null!=(n=l.on_complete)?n.call(i,o,"error"):void 0):("function"==typeof l.on_success&&l.on_success.apply(l,arguments),null!=(r=l.on_complete)?r.call(i,o,"success"):void 0)}}):a={type:t,dataType:"json",xhrFields:{withCredentials:!0},success:function(t,e,o){var n;if(!l.aborted)return"function"==typeof l.on_success&&l.on_success.apply(l,arguments),null!=(n=l.on_complete)?n.call(i,o,"success"):void 0}},a.url=PxApp.api.prefixed_url(o,s),a.data=n,a.error=function(t,e,o){var n;if("abort"!==e)return 4===t.readyState&&401===t.status&&PxApp.api.handle_unauthorized_access(),"function"==typeof l.on_error&&l.on_error.apply(l,arguments),null!=(n=l.on_complete)?n.call(i,t,"error"):void 0},_.extend(a,r),l.xhr=$.ajax(a),l},i.bulk_request=function(t,e,i,o){var n,r;return null==i&&(i={}),null==o&&(o={}),"put"===t&&null==i._method&&(i._method="put"),r=$.Deferred(),n=this.request.apply(this,arguments),n.success(function(e){return function(i,n,s){var a,l;return 200===s.status?r.resolve.apply(r,arguments):202===s.status?(a=i.photos.location.replace(/^\/v\d+\//,"/"),e.bulk_request_poll(a,t,null!=(l=o.interval)?l:1e3,r)):void 0}}(this)),n.error(function(){return r.reject.apply(r,arguments)}),r.promise()},i.bulk_request_poll=function(t,e,i,o){var n,r;return n=null,r={},"put"===e&&(r._method=e),function(i){return i=setInterval(function(){var n;return n=PxApp.api.request(e,t,r),n.error(function(){return clearInterval(i),o.reject()}),n.success(function(t){var e;if(null!=(e=t.photos)?!e.progress:!0)return clearInterval(i),o.resolve(t)})},1e3)}(n)},i["delete"]=function(t,e){return null==e&&(e={}),i.request("DELETE",t,e)},i.post=function(t,e,o){return null==e&&(e={}),null==o&&(o={}),i.request("POST",t,e,o)},i.get=function(t,e){return null==e&&(e={}),i.request("GET",t,e)},i.put=function(t,e){return null==e&&(e={}),i.request("PUT",t,e)},i.handle_unauthorized_access=function(){var t,e,i;try{if(i=new Date,null==sessionStorage.last401ReloadTimestamp||(i-new Date(sessionStorage.last401ReloadTimestamp))/1e3>=30)return sessionStorage.last401ReloadTimestamp=i.toISOString(),window.location.reload()}catch(e){t=e}},i.prototype.success=function(t){return this.on_success=t,this},i.prototype.error=function(t){return this.on_error=t,this},i.prototype.complete=function(t){return this.on_complete=t,this},i}()}.call(this),function(){var t,e,i,o=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function i(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=null!=(e=null!=(i="undefined"!=typeof App&&null!==App?App.module("Lib"):void 0)?i:PxApp)?e:window,t.PhotoUpload=function(t){function e(t){this.file=t,this.updateProgress=o(this.updateProgress,this),this.uploadFile=o(this.uploadFile,this),this.promise=$.Deferred(),this.api=PxApp.api.post("/photos"),this.api.success(function(t){return function(e){var i;return i=e.upload_key,t.photo=new App.Groups.Models.PhotoFileReader(e.photo,{file:t.file,uploader:t}),t.photo.on("photo:file:read",function(){return t.trigger("photo:created",t)}),t.uploadFile(t.file,i)}}(this))}return n(e,t),e.prototype.photo=null,e.prototype.api=null,e.prototype.endpoint=function(){return PxConfig.endpoints.media_service_upload_url},e.prototype.uploadFile=function(t,e){var i,o;return i=new FormData,i.append("upload_key",e),i.append("photo_id",this.photo.get("id")),i.append("file",t),o=_.isFunction(this.endpoint)?this.endpoint.call():this.endpoint,o+="?"+$.param({authenticity_token:PxApp.csrf_token,upload_key:e,photo_id:this.photo.get("id")}),this.api=PxApp.api.post(o,i,{api_url:PxApp.api.upload_url,processData:!1,contentType:!1,cache:!1,xhr:function(t){return function(){var e;return e=$.ajaxSettings.xhr(),e.upload.addEventListener("progress",t.updateProgress),e}}(this)}),this.api.error(function(t){return function(e){var i,o;return t.trigger("upload:progress",0),4===e.readyState?(i=JSON.parse(e.responseText),o="server_error",void 0!==i.error_key&&(o=i.error_key)):o="connection_error",t.promise.reject(),t.trigger("upload:error",o)}}(this)),this.api.success(function(t){return function(){return t.promise.resolve(),t.trigger("upload:progress",100),t.trigger("upload:success",100)}}(this)),this.api},e.prototype.updateProgress=function(t){var e;return e=t.lengthComputable?t.loaded/t.total*100:50,this.trigger("upload:progress",e)},e}(Marionette.Module)}.call(this),function(){var t,e,i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;e=App.module("Uploader.Views"),e.FileSelectorView=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,e),o.prototype.template="file_selector",o.prototype.className="file_selector",o.prototype.ui={localListingsRequirementsMessage:".local_listings_requirements_message"},o.prototype.regions={footerRegion:".footer"},o.prototype.events={"click .source":"onClickSource"},o.prototype.templateHelpers=function(){return{longestEdge:this._getLengthFromProjectId()}},o.prototype.initialize=function(t){return null==t&&(t={}),this.showLocalListingsRequirements=t.showLocalListingsRequirements,this.listingProjectId=t.listingProjectId,null!=this.showLocalListingsRequirements?this.showLocalListingsRequirements:this.showLocalListingsRequirements=!1},o.prototype.onRender=function(){return this.showLocalListingsRequirements&&this.ui.localListingsRequirementsMessage.addClass("local_listings_requirements_message--visible"),this.footerRegion.show(new t)},o.prototype.onClickSource=function(t){var e,i,o;return o=$(t.currentTarget).data("open-to"),e={mimetypes:["image/jpg","image/jpeg"],container:"window",services:["DROPBOX","FLICKR","FACEBOOK","GOOGLE_DRIVE","GMAIL","INSTAGRAM","PICASA","BOX","SKYDRIVE","CLOUDDRIVE"],openTo:o},i={category:"Upload Page",action:"Import button clicked"},null!=o&&(i.label=o.toLowerCase().replace(/(?:^|\s)\w/g,function(t){return t.toUpperCase()})),PxApp.GA.event(i),filepicker.setKey($(".external_sources").data("client-id")),filepicker.pickMultiple(e,function(t){return function(e){return t.trigger("filepicker_files_selected",e)}}(this))},o.prototype._getLengthFromProjectId=function(){return 1===this.listingProjectId?"4200":"3000"},o}(Marionette.LayoutView),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.template="grid_footer",e.prototype.onRender=function(){return this.$("p").i18n({count:App.currentUser.get("upload_limit"),html:!0})},e}(Marionette.LayoutView)}.call(this),function(){var t,e,i,o,n,r=function(t,e){function i(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty,a=function(t,e){return function(){return t.apply(e,arguments)}},l=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};o=null!=(n="undefined"!=typeof App&&null!==App?App.module("Views"):void 0)?n:window,t=$(window),e=3,i=function(t){function i(){null==this.modelEvents&&(this.modelEvents={}),_.extend(this.modelEvents,{"change:selected":"changeSelected","change:images":"onRender","change:name":"onRender","change:selected":"onRender"}),null==this.events&&(this.events={}),_.extend(this.events,{click:"clickPhoto"}),i.__super__.constructor.apply(this,arguments)}return r(i,t),i.prototype.template="squared_photo_grid_item",i.prototype.tagName="li",i.prototype.className="squared_photo_grid_item",i.prototype.clickPhoto=function(t){return t.stopPropagation(),this.throttledPhotoSelection(t)},i.prototype._selectPhoto=function(t){var e;return null!=(e=this.model.collection)?e.trigger("select",this.model,t):void 0},i.prototype._getPhotoModel=function(){throw new Error("Missing implementation")},i.prototype.changeSelected=function(t,e){return this.$el.toggleClass("ui-selected",!!this.model.get("selected"))},i.prototype.serializeData=function(){var t,e,i,o,n;for(i=this._getPhotoModel().toJSON(),n=this._getPhotoModel().get("images"),e=0,o=n.length;o>e;e++)t=n[e],3===t.size&&"jpeg"===t.format&&(i.image_url=t.https_url);return i},i.prototype.onRender=function(){var t,i,o,n,r,s,a,l,u;for(i=null!=(s=_.result(this,"defaultImageSize"))?s:e,o=new Image,a=this._getPhotoModel().get("images"),n=0,r=a.length;r>n;n++)t=a[n],t.size===i&&"jpeg"===t.format&&(u=t.https_url);return null==u&&(u=null!=(l=this._getPhotoModel().get("images")[0])?l.https_url:void 0),o.alt="name",o.onload=function(t){return function(){var e;return t.changeSelected(),e=o.height>o.width,t.$("img").attr("src",o.src).toggleClass("portrait",e).toggleClass("landscape",!e),t.resizeOverlay(),t.$el.addClass("loaded")}}(this),o.onerror=function(t){return function(){return t.changeSelected(),t.$el.find("img").attr("src","//assetcdn.500px.org/assets/organizer/converting_drag_handle-65e26c3290e09280004461b1e6aea05d.png"),t.$el.addClass("loaded")}}(this),null!=u&&(o.src=u),this.$el.data("model",this.model),null!=this.throttledPhotoSelection?this.throttledPhotoSelection:this.throttledPhotoSelection=_.throttle(this._selectPhoto,300,{trailing:!1})},i.prototype.resizeOverlay=function(){var t,e,i;return t=this.$("img"),i=2*Math.round((t.width()-1)/2),e=2*Math.round((t.height()-1)/2),0!==t.width()&&0!==t.height()?this.$(".overlay").width(i).height(e):void 0},i}(Marionette.ItemView),o.SquaredPhotoGrid=function(e){function o(t){this.onMouseClickLockedForm=a(this.onMouseClickLockedForm,this),this.onMouseDownUnlockedForm=a(this.onMouseDownUnlockedForm,this),null==this.behaviors&&(this.behaviors={}),null!=t.collection.fetching&&(this.behaviors.InfiniteScroll={container:function(){return this.$el}}),o.__super__.constructor.apply(this,arguments)}return r(o,e),o.GridItem=i,o.prototype.config={thumbMargin:20,minWidth:140},o.prototype.className="squared_photo_grid",o.prototype.tagName="ul",o.prototype.childView=i,o.prototype.childViewContainer="ul.photos",o.prototype.collectionEvents=function(){return{select:"toggleModelSelection",selectAll:"selectAll","change:selected":"onModelSelected"}},o.prototype._isClickOnScrollbar=function(t){var e,i,o;return i=null!=(o=t.offsetX)?o:t.pageX-this.$el.offset().left,e=this.$el.outerWidth()-i,null==this._scrollbarWidth&&(this._scrollbarWidth=App.Views.Common.Helpers.measureScrollBarWidth()),e<=this._scrollbarWidth},o.prototype.enable=function(){return this.$el.removeClass("disabled")},o.prototype.disable=function(){return this.$el.addClass("disabled")},o.prototype.onMouseDownUnlockedForm=function(t){var e,i,o;if(!this._isClickOnScrollbar(t)&&!t.metaKey&&!t.ctrlKey)return e=$(t.target),e.is("ul.squared_photo_grid")||e.is(".groupDivider")||e.is("h3.fixedheader")?("function"==typeof(i=this.collection).startSelection&&i.startSelection(),this._clearSelection(),"function"==typeof(o=this.collection).finishSelection?o.finishSelection():void 0):void 0},o.prototype.onMouseClickLockedForm=function(t){var e,i,o;if(!this._isClickOnScrollbar(t)&&(e=$(t.target),e.is("ul.squared_photo_grid")||e.is(".groupDivider")||e.is("h3.fixedheader")))return(e.is("ul.squared_photo_grid")||e.is(".groupDivider")||e.is("h3.fixedheader"))&&App.router.lockNavigationConfirmMessage&&confirm(App.router.lockNavigationConfirmMessage)?("function"==typeof(i=this.collection).startSelection&&i.startSelection(),this._clearSelection(),"function"==typeof(o=this.collection).finishSelection&&o.finishSelection(),App.router.unlockNavigation()):void 0},o.prototype.initialize=function(t){var e,i,o,n;return null==t&&(t={}),this._resizeDebounced=_.debounce(function(t){return function(){return t.resize()}}(this)),null!=t.maxFiles&&null==t.multiselect&&(t.multiselect=1!==t.maxFiles),this.multiselect=null!=(e=t.multiselect)?e:!0,this.autoReset=null!=(i=t.autoReset)?i:!1,this.multiselect?this.maxFiles=null!=(o=t.maxFiles)?o:5:(this.autoReset=!0,this.maxFiles=1),this.groupBy=null!=(n=t.groupBy)?n:null,this.$el.on("mousedown",this.onMouseDownUnlockedForm),App.vent.on("unlock-navigation",function(t){return function(){return t.$el.off("click",t.onMouseClickLockedForm),t.$el.on("mousedown",t.onMouseDownUnlockedForm)}}(this)),App.vent.on("lock-navigation",function(t){return function(){return t.$el.on("click",t.onMouseClickLockedForm),t.$el.off("mousedown",t.onMouseDownUnlockedForm)}}(this))},o.prototype.onBeforeAddChild=function(t){var e,i,o;return this._thumbWidth||this._computeThumbWidth(),null!=this.groupBy&&(i=this.groupBy(t.model),e=t.model.collection,o=e.indexOf(t.model),0===o||this.groupBy(e.at(o-1))!==i)?this.$el.append(this.buildSeperatorEl(i)):void 0},o.prototype.buildSeperatorEl=function(t){throw new Error("Implementation missing")},o.prototype._clearSelection=function(t){var e,i,o,n,r,s,a,u,h,p;if(null==t&&(t=null),t instanceof Array){for(s=this.collection.models,h=[],e=0,o=s.length;o>e;e++)r=s[e],!r.get("selected")||(a=r.id,l.call(t,a)>=0)||h.push(r.set("selected",!1));return h}for(u=this.collection.models,p=[],i=0,n=u.length;n>i;i++)r=u[i],r.get("selected")&&r.id!==t&&p.push(r.set("selected",!1));return p},o.prototype.selectAll=function(){var t,e,i,o,n,r;if(this.maxFiles<=0||this.collection.models.length<=this.maxFiles){for("function"==typeof(t=this.collection).startSelection&&t.startSelection(),r=this.collection.models,i=0,o=r.length;o>i;i++)n=r[i],n.get("selected")||n.set("selected",!0);return"function"==typeof(e=this.collection).finishSelection?e.finishSelection():void 0}},o.prototype.toggleModelSelection=function(t,e){var i,o;return"function"==typeof(i=this.collection).startSelection&&i.startSelection(),this.multiselect?this.autoReset?t.get("selected")?(null!=e?e.metaKey:void 0)||(null!=e?e.ctrlKey:void 0)?t.set("selected",!1):this._clearSelection(t.id):((null!=e?e.metaKey:void 0)||(null!=e?e.ctrlKey:void 0)||this._clearSelection(),this.maxFiles<=0||this._getSelected().length<this.maxFiles?t.set("selected",!0):this.collection.trigger("maximum_selection")):t.get("selected")?t.set("selected",!1):this.maxFiles<=0||this._getSelected().length<this.maxFiles?t.set("selected",!0):this.collection.trigger("maximum_selection"):(this._clearSelection(t.id),t.set("selected",!t.get("selected"))),"function"==typeof(o=this.collection).finishSelection?o.finishSelection():void 0},o.prototype.onModelSelected=function(t,e){var i,o;return e&&!this.multiselect&&("function"==typeof(i=this.collection).startSelection&&i.startSelection(),this._clearSelection(t.id),"function"==typeof(o=this.collection).finishSelection&&o.finishSelection()),this.collection.trigger("selection",this._getSelected())},o.prototype.onShow=function(){return t.on("resize",this._resizeDebounced)},o.prototype.onDestroy=function(){return t.off("resize",this._resizeDebounced)},o.prototype.resize=function(){return this.collection.length?(this._computeThumbWidth(),this._scalePhotos()):void 0},o.prototype.addChild=function(){var t;return t=o.__super__.addChild.apply(this,arguments),t.$el.width(this._thumbWidth).height(this._thumbWidth),t},o.prototype._getDefaultGridWidth=function(){},o.prototype._getSelected=function(){var t,e,i,o,n;for(o=this.collection.models,n=[],t=0,e=o.length;e>t;t++)i=o[t],i.get("selected")&&n.push(i);return n},o.prototype._computeThumbWidth=function(){var t,e;return e=(this.$el.width()||this._getDefaultGridWidth())-this._getScrollbarWidth(),e-=this.config.thumbMargin,t=Math.floor(e/(this.config.minWidth+this.config.thumbMargin)),this._thumbWidth=Math.floor(e/t)-this.config.thumbMargin},o.prototype._scalePhotos=function(){return this.children.each(function(t){return function(e){return e.$el.width(t._thumbWidth).height(t._thumbWidth),e.resizeOverlay()}}(this))},o.prototype.thumbWidth=function(){return this._thumbWidth},o.prototype._getScrollbarWidth=function(){var t,e,i,o;return null!=this._scrollbarWidth?this._scrollbarWidth:(e=document.createElement("div"),e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e),i=e.offsetWidth,e.style.overflow="scroll",t=document.createElement("div"),t.style.width="100%",e.appendChild(t),o=t.offsetWidth,e.parentNode.removeChild(e),this._scrollbarWidth=i-o)},o}(Marionette.CollectionView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty,o=[].slice;App.Behaviors.SelectableGrid=function(i){function o(){return this._onKeyDown=t(this._onKeyDown,this),o.__super__.constructor.apply(this,arguments)}return e(o,i),o.prototype.onShow=function(){return this._bindSelectable(),$(document).on("keydown",this._onKeyDown)},o.prototype.onDestroy=function(){return $(document).off("keydown",this._onKeyDown)},o.prototype._bindSelectable=function(){return this.selectable=this.view.$el.selectableScroll({filter:".squared_photo_grid_item",delay:100,stop:function(t){return function(e,i){return t._onLassoSelected()}}(this)})},o.prototype._onKeyDown=function(t){var e;if("TEXTAREA"!==t.target.tagName&&("INPUT"!==t.target.tagName||"text"!==(e=$(t.target).prop("type"))&&"password"!==e)&&(t.metaKey||t.ctrlKey)&&65===t.keyCode){if(t.preventDefault(),App.router.lockNavigationConfirmMessage){if(!confirm(App.router.lockNavigationConfirmMessage))return;App.router.unlockNavigation()}return this.view.collection.trigger("selectAll")}},o.prototype._onLassoSelected=function(){if(App.router.lockNavigationConfirmMessage){if(!confirm(App.router.lockNavigationConfirmMessage))return void this._restoreUISelection();App.router.unlockNavigation()}return this.view.trigger("selectable_grid:selection")},o.prototype._restoreUISelection=function(){return this.view.trigger("selectable_grid:restore_selection")},o}(Marionette.Behavior),App.Behaviors.DragAndDropGrid=function(i){function n(){return this._onKeyDown=t(this._onKeyDown,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.initialize=function(t,e){return this.sortable=t.sortable,this.onSort=t.onSort},n.prototype.onShow=function(){return this.listenTo(this.view,"resize",function(t){return function(){var e;return null!=(e=t.$sortable)?e.sortable("option","cursorAt",t._handleCursorPos()):void 0}}(this)),_.result(this.view,this.sortable)&&this._bindSortable(),$(document).on("keydown",this._onKeyDown)},n.prototype.onDestroy=function(){return $(document).off("keydown",this._onKeyDown)},n.prototype._onKeyDown=function(t){var e,i;if("TEXTAREA"!==t.target.tagName&&("INPUT"!==t.target.tagName||"text"!==(e=$(t.target).prop("type"))&&"password"!==e))return 27===t.keyCode?(this.view._cancelSort=!0,null!=(i=this.$sortable)?i.sortable("cancel"):void 0):void 0},n.prototype.onAddChild=function(t){return this.view.$el.hasClass("ui-sortable")?void 0:t.$el.draggable({appendTo:$("body"),delay:100,helper:function(t){return function(e){return t._buildDragHandle(e)}}(this),cursorAt:this._handleCursorPos()})},n.prototype._bindSortable=function(){return null!=this.$sortable?this.$sortable:this.$sortable=this.view.$el.sortable({placeholder:"placeholder",delay:100,tolerance:"pointer",appendTo:"body",helper:function(t){return function(){var e;return e=1<=arguments.length?o.call(arguments,0):[],t._buildSortHandle.apply(t,e)}}(this),cursorAt:this._handleCursorPos(),scroll:!0,start:function(t){return function(e,i){return _.delay(function(){var e,o;return t.view._cancelSort=!1,$(i.item).hasClass("ui-selected")?(t._$thumbsBeingSorted=t.$(".squared_photo_grid_item.ui-selected"),t._$thumbsBeingSorted.addClass("sorting").hide()):(t.$(".squared_photo_grid_item.ui-seleted").removeClass("ui-selectd"),$(i.item).addClass("selected"),t._$thumbsBeingSorted=$(i.item)),t._orderBefore=function(){var t,i,o,n;for(o=this.$(".squared_photo_grid_item"),n=[],t=0,i=o.length;i>t;t++)e=o[t],n.push($(e).data("model").id);return n}.call(t),o=t.view.thumbWidth(),o?t.$(".placeholder").width(o).height(o):void 0})}}(this),stop:function(t){return function(e,i){var o;return t.view._cancelSort?(null!=(o=t.$sortable)&&o.sortable("cancel"),t.$(".squared_photo_grid_item.ui-selected.sorting").removeClass("sorting").show()):(t.$(".squared_photo_grid_item.ui-selected.sorting").show(),t.view[t.onSort](i,t._orderBefore,t._$thumbsBeingSorted)),t._$thumbsBeingSorted=null,t._orderBefore=null}}(this)})},n.prototype._buildDragHandle=function(t,e){var i;return i=this._buildPhotoStackHandle(t,e),i.addClass("draggable"),i},n.prototype._handleCursorPos=function(){return{top:20,left:20}},n.prototype._buildSortHandle=function(t,e){var i;return i=this._buildPhotoStackHandle(t,e),i.addClass("sortable"),i},n.prototype._buildPhotoStackHandle=function(t,e){var i,o,n,r,s,a,l,u,h,p,c;if(r=$(t.target).closest("li.squared_photo_grid_item"),r.hasClass("ui-selected"))h=this.$(".ui-selected img");else{if(App.router.lockNavigationConfirmMessage){if(!confirm(App.router.lockNavigationConfirmMessage))return;App.router.unlockNavigation()}"function"==typeof(s=this.view.collection).startSelection&&s.startSelection(),this.view._clearSelection(),r.data("model").select(),"function"==typeof(a=this.view.collection).finishSelection&&a.finishSelection(),h=r.children("img")}for(o=$('<li class="ui-draggable-sortable-images-stack"/>'),i=$('<div class="photo-stack-wrapper" />'),o.append(i),l=p=0,c=h.length;c>p&&(u=h[l],3!==l);l=++p)n=$(u).clone().addClass("img-"+(l+1)),i.append(n);return h.length>1&&(o.addClass("multiple"),i.append("<span>"+h.length+"</span>")),o.appendTo(this.$el),o},n}(Marionette.Behavior)}.call(this),function(){var t,e,i,o,n=function(t,e){function i(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty;o=App.module("Uploader.Views"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.className="squared_photo_grid_item uploader_photo_grid_item uploaded_file",e.prototype.template="uploader_photo_grid_item",e.prototype.selectionMode="pick",e.prototype.templateHelpers=function(){return{images:this.model.uploadedPhoto.get("images")}},e.prototype.behaviors={HasButtons:{"a.remove":"clickRemove"},HasProgressBar:!0},e.prototype.ui={nameField:".name input"},e.prototype.events={"input @ui.nameField":"onTextChange"},e.prototype.modelEvents={"change:upload_status":"changeStatus","change:rejected":"changeRejected"},e.prototype.initialize=function(){return e.__super__.initialize.call(this),this.listenTo(this.model,"change:name",this.onNameChange)},e.prototype.onNameChange=function(){return this.ui.nameField.is(":focus")?void 0:this.ui.nameField.val(this.model.get("name"))},e.prototype.onTextChange=function(t){return this.model.set("name",this.ui.nameField.val())},e.prototype._getPhotoModel=function(){return this.model},e.prototype.changeSelected=function(t,i){return e.__super__.changeSelected.call(this),!this.model.get("selected")&&this.ui.nameField.is(":focus")?this.ui.nameField.blur():void 0},e.prototype.clickPhoto=function(t){return"error"!==this.model.get("upload_status")&&"a"!==t.target.tagName.toLowerCase()?e.__super__.clickPhoto.call(this,t):void 0},e.prototype.clickRemove=function(){return this.$el.fadeOut("fast",function(t){return function(){return t.model.abort(),t.model.collection.remove(t.model)}}(this))},e.prototype.changeStatus=function(t,e){return"success"===e?this.$el.addClass("uploaded"):"error"===e?(this.$el.addClass("error"),this.$el.find("input").prop("disabled",!0),this.model.set("selected",!1)):void 0},e.prototype.changeRejected=function(t,e){return e===!0?(this.$el.addClass("reject"),this.$el.find("input").prop("disabled",!0),this.model.set("selected",!1)):void 0},e}(App.Views.SquaredPhotoGrid.GridItem),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.tagName="li",e.prototype.className="uploader_photo_grid_item add_more add_more_grid_item",e.prototype.template="add_more_grid_item",e}(Marionette.LayoutView),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.tagName="li",e.prototype.className="footer",e.prototype.template="grid_footer",e.prototype.onRender=function(){return this.$("p").i18n({count:App.currentUser.get("upload_limit"),html:!0})},e}(Marionette.LayoutView),o.PhotoGrid=function(o){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,o),r.prototype.className="squared_photo_grid uploader_photo_grid",r.prototype.childView=i,r.prototype.behaviors={SelectableGrid:!0},r.prototype.config={thumbMargin:16,minWidth:204},r.prototype.initialize=function(){return r.__super__.initialize.call(this,{maxFiles:-1,multiselect:!0,autoReset:!0}),this.on("selectable_grid:selection",function(t){return function(){var e,i,o,n,r,s,a,l;for(a=t.collection.models,i=0,n=a.length;n>i;i++)s=a[i],s.set("selected",!1);for(l=t.$(".ui-selected"),o=0,r=l.length;r>o;o++)e=l[o],$(e).data("model")&&$(e).data("model").set("selected",!0);return t.collection.finishSelection()}}(this)),this.addMore=new t,this.addMore.render(),this.footer=new e,this.footer.render(),this.$clearEl=$('<li class="clear"></li>')},r.prototype.resize=function(){return r.__super__.resize.call(this),this.addMore.$el.width(this._thumbWidth).height(this._thumbWidth)},r.prototype.onRender=function(){return _.defer(function(t){return function(){return t.resize()}}(this)),this._addTrailingElements()},r.prototype.onAddChild=function(){return this._addTrailingElements()},r.prototype._addTrailingElements=function(){return this.addMore.$el.detach(),this.addMore.$el.appendTo(this.$el),this.$clearEl.detach(),this.$clearEl.appendTo(this.$el),this.footer.$el.detach(),this.footer.$el.appendTo(this.$el)},r}(App.Views.SquaredPhotoGrid)}.call(this),function(){var t,e,i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;e=App.module("Uploader.Views"),t=function(t){function e(){
return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.template="sets_widget_item",e.prototype.tagName="li",e.prototype.triggers={click:"clicked"},e.prototype.toggleSelected=function(){return this.selected=this.partial?!0:!this.selected,this.partial=!1,this.$(".completed_checkmark").toggleClass("checked",this.selected),this.$(".completed_checkmark").removeClass("partial_checked")},e.prototype.select=function(){return this.selected=!0,this.partial=!1,this.$(".completed_checkmark").addClass("checked")},e.prototype.selectPartial=function(){return this.selected=!0,this.partial=!0,this.$(".completed_checkmark").addClass("partial_checked")},e}(Marionette.ItemView),e.SetsWidget=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,e),o.prototype.childView=t,o.prototype.childViewContainer="ul",o.prototype.template="sets_widget_composite",o.prototype.ui={createInput:"input",done:".done"},o.prototype.events={"keyup @ui.createInput":"onCreateKeyup","blur @ui.createInput":"stopCreatingSet","mousedown @ui.done":"onClickDone"},o.prototype.initialize=function(t){return this.photoModel=t.photoModel,this.qTipTarget=t.qTipTarget,this.kind=t.kind},o.prototype.refresh=function(){var t,e,i;e=this.photoModel.editableAttributes.sets;for(t in e)i=e[t],this.children.each(function(e){return e.model.id.toString()===t?i.same?e.select():e.selectPartial():void 0});return!0},o.prototype.onRender=function(){return this.ui.done.i18n("done"),this.ui.createInput.attr("placeholder",this.ui.createInput.i18n(this.kind,{"return":!0}))},o.prototype.getSelectedSets=function(){return this.children.filter(function(t){return t.selected}).map(function(t){return t.model})},o.prototype.selectSetById=function(t){return this.children.each(function(e){return function(i){return i.model.id===t?(i.select(),e._updateSetSelection(t,!0)):void 0}}(this))},o.prototype.onClickDone=function(){return this.creatingSet?this._createSet():this.qTipTarget.qtip().hide()},o.prototype.onChildviewClicked=function(t,e){return t.toggleSelected(),this._updateSetSelection(e.model.id,t.selected)},o.prototype.onCreateKeyup=function(t){return 13===t.keyCode?this._createSet():this.ui.createInput[0].value.length>0?(this.creatingSet=!0,this.ui.done.i18n("create")):this.stopCreatingSet()},o.prototype._createSet=function(){var t,e;return e=this.ui.createInput.val(),e.length>0?(this.ui.createInput.blur(),this.collection.findWhere({title:e})?alert(this.$("input").i18n("duplicate-"+this.kind,{"return":!0})):(t=new App.Uploader.Models.Set({title:e,path:App.Uploader.Models.Set.generatePath(e),kind:this.kind}),t.save(null,{success:function(t){return function(e,i){var o;return t.collection.add(e),t.selectSetById(e.id),o=t.$(".sets_collection")[0],o.scrollTop=o.scrollHeight,t.qTipTarget.qtip("reposition")}}(this)}))):void 0},o.prototype.stopCreatingSet=function(t){return this.ui.createInput[0].value="",this.creatingSet=!1,this.ui.done.i18n("done")},o.prototype._updateSetSelection=function(t,e){return e?this.photoModel.addSet(t):this.photoModel.removeSet(t),this.trigger("changed:sets",this.getSelectedSets())},o}(Marionette.CompositeView)}.call(this),function(){var t,e,i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty,n=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};e=App.module("Collections"),t=200,e.UploadedPhotos=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,e),o.prototype.model=App.Models.UploadedPhoto,o.prototype.acceptedTypes=["image/jpeg"],o.prototype.initialize=function(e,i){var o,n,r,s;return this._autoActivate=null!=(o=i.autoActivate)?o:!0,this._uploadToLocalListingClaim=null!=(n=i.uploadToLocalListingClaim)?n:null,this._listingProjectId=null!=(r=i.listingProjectId)?r:null,null!=i.user_limit&&(this.remainingPhotos=this.userUploadLimit=i.user_limit),this.uploadLimit=null!=(s=i.upload_limit)?s:t,this.maxConcurrentUploads=7,this.on("remove",function(t){return function(){return t._checkCompletion()}}(this)),this.on("change:upload_finished",function(t){return function(e,i){var o;if(i===!0)return t.uploading().length<t.maxConcurrentUploads&&null!=(o=t.notStarted()[0])&&o.beginUpload(),t._checkCompletion()}}(this))},o.prototype.beginUploads=function(){var t,e,i,o,n;for(this._uploading=!0,this.uploadsFinished=!1,o=_.first(this.notStarted(),this.maxConcurrentUploads),n=[],t=0,e=o.length;e>t;t++)i=o[t],n.push(i.beginUpload());return n},o.prototype.addFiles=function(t){var e,i,o,r,s,a,l;for(this._normalizeFiles(t),t=this._limitUploads(t),r=[],e=[],o=0,s=t.length;s>o;o++)i=t[o],l=i.type,n.call(this.acceptedTypes,l)>=0?this.containsFile(i)?e.push(i):(a=new App.Models.UploadedPhoto(i,this._autoActivate,this._uploadToLocalListingClaim,this._listingProjectId),this.push(a)):r.push(i);return r.length>0&&this.trigger("invalid",r),e.length>0&&this.trigger("duplicated",e),this.length>0&&this.trigger("accepted",this.collection),this.uploadsFinished&&this.beginUploads(),null},o.prototype.notStarted=function(){return this.filter(function(t){return"not_started"===t.get("upload_status")})},o.prototype.uploading=function(){return this.filter(function(t){return"in_progress"===t.get("upload_status")})},o.prototype.successful=function(){return this.filter(function(t){return"success"===t.get("upload_status")})},o.prototype.failed=function(){return this.filter(function(t){return"error"===t.get("upload_status")})},o.prototype.containsFile=function(t){var e,i,o,n,r;for(r=this.models,i=0,o=r.length;o>i;i++)if(n=r[i],e=n.file,e.name===t.name&&e.size===t.size)return!0},o.prototype._limitUploads=function(t){var e,i;return null!=this.userUploadLimit&&t.length>this.userUploadLimit-this.length&&(i=$(t).slice(this.userUploadLimit-this.length),t=$(t).slice(0,this.userUploadLimit-this.length),this.trigger("over_user_limit",i)),t.length>this.uploadLimit-this.length&&(e=$(t).slice(this.uploadLimit-this.length),t=$(t).slice(0,this.uploadLimit-this.length),this.trigger("over_upload_limit",e)),t},o.prototype._normalizeFiles=function(t){var e,i,o,n,r,s;for(i=0,n=t.length;n>i;i++)e=t[i],null!=e.mimetype&&(e.type=e.mimetype);for(s=[],o=0,r=t.length;r>o;o++)e=t[o],null!=e.filename&&s.push(e.name=e.filename);return s},o.prototype._checkCompletion=function(){var t,e,i,o;for(o=this.models,t=0,e=o.length;e>t;t++)if(i=o[t],i.get("upload_finished")!==!0)return!1;return this.trigger("upload_complete",this.successful(),this.failed()),this.uploadsFinished=!0},o}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i={}.hasOwnProperty,o=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};t=App.module("Uploader.Views"),t.GridLayout=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.template="uploading_grid_layout",i.prototype.className="uploading_grid_layout",i.prototype.ui={publishOverlay:".publish_overlay"},i.prototype.regions={photoGridRegion:".photo_grid_pane",editPaneRegion:".edit_pane",bottomBarRegion:".uploader_bottom_bar_region"},i.prototype.initialize=function(t){return this.uploadingPhotos=t.collection,this.uploadToLocalListingClaim=t.uploadToLocalListingClaim,this.listingProjectId=t.listingProjectId,this.collection=new App.Uploader.Collections.Photos(this.uploadingPhotos,t.uploadDestination,t.defaultTag,t.quest,t.uploadToLocalListingClaim,this.listingProjectId),this.listenTo(App.vent,"upload:failed",function(t){var e,i,n,r,s,a;if(t instanceof App.Models.UploadedRelease){for(r=this.collection.models,a=[],e=0,i=r.length;i>e;e++)n=r[e],s=t.get("hash"),o.call(n.get("releases"),s)>=0?a.push(n.set("releases",_.without(n.get("releases"),t.get("hash")))):a.push(void 0);return a}})},i.prototype.onShow=function(){return null!==this.uploadToLocalListingClaim?(this.bottomBar=new App.Uploader.Views.UploaderBottomBar({collection:this.collection,listingProjectId:this.listingProjectId}),this.bottomBarRegion.show(this.bottomBar),this.$(".photo_grid_pane").addClass("photo_grid_pane--no_edit"),this.$(".edit_pane").addClass("edit_pane--no_edit")):(this.editPane=new App.Uploader.Views.EditPane({collection:this.collection}),this.editPaneRegion.show(this.editPane)),this.photoGrid=new App.Uploader.Views.PhotoGrid({collection:this.collection}),this.listenTo(App.vent,"uploader:publish",function(){return this.showPublishOverlay()}),this.listenTo(App.vent,"uploader:publishFailed",function(){return this.hidePublishOverlay()}),this.photoGridRegion.show(this.photoGrid),_.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this.collection.parseExif().done(function(t){return function(){return null!=t.uploadToLocalListingClaim&&t.collection.checkRequirements(),t.collection.loadThumbnails(),t.uploadingPhotos.beginUploads(),t.photoGridRegion.currentView.on("add:child",function(e){return e.model.loadExifAndThumbnail().done(function(){return null!=t.uploadToLocalListingClaim?t.collection.checkRequirements():void 0})})}}(this))},i.prototype.showPublishOverlay=function(){return this.photoGrid.disable(),this.ui.publishOverlay.addClass("visible"),this.ui.publishOverlay.find("h2").i18n("uploading"),this.listenTo(this.collection,"change:upload_progress",this.onUploadProgress),this.progressBar=new ProgressBar.Circle(this.$(".publish_overlay .progress_circle")[0],{color:"#0099e5",trailColor:"#66ccff",strokeWidth:9,trailWidth:10,duration:0,from:{width:9},to:{width:10},step:function(t,e){return e.path.setAttribute("stroke-width",t.width)}}),this.onUploadProgress()},i.prototype.hidePublishOverlay=function(){return this.photoGrid.enable(),this.ui.publishOverlay.removeClass("visible")},i.prototype.onUploadProgress=function(){var t;return t=0,this.collection.each(function(e){return null!=e.get("upload_progress")?t+=e.get("upload_progress"):void 0}),t/=100*this.collection.length,1===t&&null==this.collection.uploadToLocalListingClaim&&this.ui.publishOverlay.find("h2").i18n("publishing"),this.progressBar.animate(.9*t)},i}(Marionette.LayoutView)}.call(this),"undefined"==typeof window.AMPLITUDE_LOADED){window.AMPLITUDE_LOADED=!0,function(t,e){function i(t,e){t.prototype[e]=function(){return this._q.push([e].concat(Array.prototype.slice.call(arguments,0))),this}}function o(t){function e(e){t[e]=function(){t._q.push([e].concat(Array.prototype.slice.call(arguments,0)))}}for(var i=0;i<d.length;i++)e(d[i])}var n=t.amplitude||{_q:[],_iq:{}},r=e.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://d24n15hnbwhuhn.cloudfront.net/libs/amplitude-3.0.2-min.gz.js",r.onload=function(){t.amplitude.runQueuedFunctions()};var s=e.getElementsByTagName("script")[0];s.parentNode.insertBefore(r,s);for(var a=function(){return this._q=[],this},l=["add","append","clearAll","prepend","set","setOnce","unset"],u=0;u<l.length;u++)i(a,l[u]);n.Identify=a;for(var h=function(){return this._q=[],this},p=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"],c=0;c<p.length;c++)i(h,p[c]);n.Revenue=h;var d=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId","setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId"];o(n),n.getInstance=function(t){return t=(t&&0!==t.length?t:"$default_instance").toLowerCase(),n._iq.hasOwnProperty(t)||(n._iq[t]={_q:[]},o(n._iq[t])),n._iq[t]},t.amplitude=n}(window,document);var AMPLITUDE_API_KEY="9d249102d4736c5a98373c4526f77ae3";amplitude.getInstance().init(AMPLITUDE_API_KEY)}(function(){var t,e;t=function(t){var e,i,o;return o=document.createElement("a"),o.href=t,i=o.pathname.split("/"),i.length<2?"unknown":(e=null,e=""===i[1]?"LoggedInHome":i[1])},e=function(t,e){var i;if("undefined"!=typeof amplitude&&null!==amplitude)return i=null,i=null!=e?amplitude.getInstance().logEvent(t,e):amplitude.getInstance().logEvent(t)},window.AmplitudeLogger={signup:{visitSignupPage:function(){var i;return i=t(document.referrer),e("Signup - 1 - Signup - View",{ReferralSource:document.referrer,ActionSource:"Web_"+i})},clickedSignup:function(t,i){return e("Signup - 2 - Signup Button - Click",{RegistrationType:t,ActionSource:i})},completedSignup:function(t){return e("Signup - 3 - Signup - Complete",{UserType:t})}},upload:{openedUploadModal:function(){var i;return i=t(window.location),e("Upload - 1 - Upload Button - Click",{ActionSource:i})},fileAdded:function(t){return e("Upload - 2 - Upload - Image Selected",{ImageSource:t})},clickedPublish:function(t){return e("Upload - 3 - Publish Photo Button - Press",{ImageSource:t})},publishComplete:function(){return e("Upload - 4 - Publish Photo - Complete")}}}}).call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=App.module("Uploader.Views"),t.Uploader=function(t){function o(){return this.confirmClose=e(this.confirmClose,this),o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template="uploader_layout",o.prototype.className="uploader_layout",o.prototype.behaviors={ModalDialog:{maxWidth:5e3,padding:100,closeConfirm:"confirmClose"},HasButtons:{".browse.button":"onClickBrowse","li.add_more":"onClickBrowse"},FileDropArea:{onDrop:"onFilesSelected"}},o.prototype.regions={mainRegion:".main_region"},o.prototype.ui={fileForm:"#photo_upload_form"},o.prototype.events={"change @ui.fileForm input":"onPickedFiles"},o.prototype.initialize=function(t){return this.uploadDestination=t.uploadDestination,this.defaultTag=t.defaultTag,this.quest=t.quest,this.redirectToManage=t.redirectToManage,this.uploadToLocalListingClaim=t.uploadToLocalListingClaim,this.listingProjectId=t.listingProjectId,null==this.redirectToManage&&(this.redirectToManage=!0),null==this.uploadToLocalListingClaim&&(this.uploadToLocalListingClaim=null),App.Uploader.sets=new App.Uploader.Collections.Sets,App.Uploader.setsXhr=App.Uploader.sets.fetch(),App.Uploader.portfolios=new App.Uploader.Collections.Portfolios,App.Uploader.portfoliosXhr=App.Uploader.portfolios.fetchAll()},o.prototype.onShow=function(){return this.showFileSelector(),$.fn.qtip.zindex=100100,$(window).on("beforeunload",this.confirmClose)},o.prototype.onDestroy=function(){var t;return $(window).off("beforeunload",this.confirmClose),!this.published&&(null!=(t=this.uploadedFiles)?t.length:void 0)>=1?PxApp.GA.event({category:"Uploader",action:"Photos Abandoned",value:this.uploadedFiles.length}):void 0},o.prototype.showFileSelector=function(){var t,e;return t={},null!=this.uploadToLocalListingClaim&&(t.showLocalListingsRequirements=!0),null!=this.uploadToLocalListingClaim&&(t.listingProjectId=this.listingProjectId),null!=(e=window.AmplitudeLogger)&&e.upload.openedUploadModal(),this.fileSelectorView=new App.Uploader.Views.FileSelectorView(t),this.listenTo(this.fileSelectorView,"filepicker_files_selected",function(t){return function(e){return t.onFilesSelected(e)}}(this)),null!=this.uploadedFiles&&this.stopListening(this.uploadedFiles),this.uploadedFiles=null,App.vent.on("uploader:published",function(t){return function(){var e,i,o;return t.published=!0,t.destroyModal(),null!=(o=window.AmplitudeLogger)&&o.upload.publishComplete(),t.redirectToManage?(i="/manage",null!=t.uploadDestination?(e=t.uploadDestination.get("kind"),3===e?e="portfolio":4===e&&(e="profile"),"marketplace"===e?i+="/all_photos":("library"!==e&&"marketplace"!==e&&(i+="/"+e),i+="/"+t.uploadDestination.get("path"))):i+="/public",window.location.assign(i)):void 0}}(this)),this.mainRegion.show(this.fileSelectorView)},o.prototype.onFilesSelected=function(t){var e,i;return e=[],_.any(t,function(t){return null!=t.url})&&e.push("Web_Filepicker"),_.any(t,function(t){return null==t.url})&&e.push("Web_Computer"),null!=(i=window.AmplitudeLogger)&&i.upload.fileAdded(e),this.uploadedFiles||this._initializeUploaderGrid(),this.uploadedFiles.addFiles(t)},o.prototype.confirmClose=function(){var t;return!this.published&&(null!=(t=this.uploadedFiles)?t.length:void 0)>=1?this.$(".i18n").i18n("confirm",{count:this.uploadedFiles.length,"return":!0}):void 0},o.prototype._initializeUploaderGrid=function(){return this.uploadedFiles=new App.Collections.UploadedPhotos(!1,{autoActivate:!1,uploadToLocalListingClaim:this.uploadToLocalListingClaim,listingProjectId:this.listingProjectId,user_limit:App.currentUser.get("upload_limit")}),this.listenTo(this.uploadedFiles,"invalid",function(t){return function(e){return t._showError(e,t.$(".i18n").i18n("invalid",{"return":!0}))}}(this)),this.listenTo(this.uploadedFiles,"duplicated",function(t){return function(e){return t._showError(e,t.$(".i18n").i18n("duplicated",{"return":!0}))}}(this)),this.listenTo(this.uploadedFiles,"over_user_limit",function(t){return function(e){return t._showError(e,t.$(".i18n").i18n("overuserlimit",{"return":!0}))}}(this)),this.listenTo(this.uploadedFiles,"over_upload_limit",function(t){return function(e){return t._showError(e,t.$(".i18n").i18n("overuploadlimit",{limit:t.uploadedFiles.uploadLimit,"return":!0}))}}(this)),this.listenToOnce(this.uploadedFiles,"accepted",function(t){return function(){return t.showUploads()}}(this))},o.prototype._showError=function(t,e){var i,o;return i=function(){var e,i,n;for(n=[],e=0,i=t.length;i>e;e++)o=t[e],n.push(o.name);return n}().join("\n - "),alert(e+": \n - "+i)},o.prototype.showUploads=function(){return this.listenTo(this.uploadedFiles,"remove",function(t){return function(){return 0===t.uploadedFiles.length?t.showFileSelector():void 0}}(this)),this.mainRegion.show(new App.Uploader.Views.GridLayout({collection:this.uploadedFiles,uploadDestination:this.uploadDestination,defaultTag:this.defaultTag,quest:this.quest,uploadToLocalListingClaim:this.uploadToLocalListingClaim,listingProjectId:this.listingProjectId})),this.listenTo(this.uploadedFiles,"upload_complete",this.reportUploadErrors)},o.prototype.reportUploadErrors=function(t,e){var i;return e.length>0?(i=this.$(".i18n").i18n("error",{count:e.length,total_files:this.uploadedFiles.length,"return":!0}),App.Flash.error(i)):void 0},o.prototype.onPickedFiles=function(t){var e;return this.onFilesSelected(t.target.files),e=this.ui.fileForm.find("input"),e.replaceWith(e.val("").clone(!0))},o.prototype.onClickBrowse=function(){return this.ui.fileForm.find("input").click()},o}(Marionette.LayoutView)}.call(this),function(t,e,i){!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):jQuery&&!jQuery.fn.qtip&&t(jQuery)}(function(o){"use strict";function n(t,e,i,n){this.id=i,this.target=t,this.tooltip=E,this.elements={target:t},this._id=q+"-"+i,this.timers={img:{}},this.options=e,this.plugins={},this.cache={event:{},target:o(),disabled:D,attr:n,onTooltip:D,lastClass:""},this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=D}function r(t){return t===E||"object"!==o.type(t)}function s(t){return!(o.isFunction(t)||t&&t.attr||t.length||"object"===o.type(t)&&(t.jquery||t.then))}function a(t){var e,i,n,a;return r(t)?D:(r(t.metadata)&&(t.metadata={type:t.metadata}),"content"in t&&(e=t.content,r(e)||e.jquery||e.done?e=t.content={text:i=s(e)?D:e}:i=e.text,"ajax"in e&&(n=e.ajax,a=n&&n.once!==D,delete e.ajax,e.text=function(t,e){var r=i||o(this).attr(e.options.content.attr)||"Loading...",s=o.ajax(o.extend({},n,{context:e})).then(n.success,E,n.error).then(function(t){return t&&a&&e.set("content.text",t),t},function(t,i,o){e.destroyed||0===t.status||e.set("content.text",i+": "+o)});return a?r:(e.set("content.text",r),s)}),"title"in e&&(o.isPlainObject(e.title)&&(e.button=e.title.button,e.title=e.title.text),s(e.title||D)&&(e.title=D))),"position"in t&&r(t.position)&&(t.position={my:t.position,at:t.position}),"show"in t&&r(t.show)&&(t.show=t.show.jquery?{target:t.show}:t.show===A?{ready:A}:{event:t.show}),"hide"in t&&r(t.hide)&&(t.hide=t.hide.jquery?{target:t.hide}:{event:t.hide}),"style"in t&&r(t.style)&&(t.style={classes:t.style}),o.each(G,function(){this.sanitize&&this.sanitize(t)}),t)}function l(t,e){for(var i,o=0,n=t,r=e.split(".");n=n[r[o++]];)o<r.length&&(i=n);return[i||t,r.pop()]}function u(t,e){var i,o,n;for(i in this.checks)for(o in this.checks[i])(n=new RegExp(o,"i").exec(t))&&(e.push(n),("builtin"===i||this.plugins[i])&&this.checks[i][o].apply(this.plugins[i]||this,e))}function h(t){return V.concat("").join(t?"-"+t+" ":" ")}function p(t,e){return e>0?setTimeout(o.proxy(t,this),e):void t.call(this)}function c(t){this.tooltip.hasClass(tt)||(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this.timers.show=p.call(this,function(){this.toggle(A,t)},this.options.show.delay))}function d(t){if(!this.tooltip.hasClass(tt)&&!this.destroyed){var e=o(t.relatedTarget),i=e.closest(X)[0]===this.tooltip[0],n=e[0]===this.options.show.target[0];if(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this!==e[0]&&"mouse"===this.options.position.target&&i||this.options.hide.fixed&&/mouse(out|leave|move)/.test(t.type)&&(i||n))try{t.preventDefault(),t.stopImmediatePropagation()}catch(r){}else this.timers.hide=p.call(this,function(){this.toggle(D,t)},this.options.hide.delay,this)}}function f(t){!this.tooltip.hasClass(tt)&&this.options.hide.inactive&&(clearTimeout(this.timers.inactive),this.timers.inactive=p.call(this,function(){this.hide(t)},this.options.hide.inactive))}function g(t){this.rendered&&this.tooltip[0].offsetWidth>0&&this.reposition(t)}function m(t,i,n){o(e.body).delegate(t,(i.split?i:i.join("."+q+" "))+"."+q,function(){var t=S.api[o.attr(this,j)];t&&!t.disabled&&n.apply(t,arguments)})}function _(t,i,r){var s,l,u,h,p,c=o(e.body),d=t[0]===e?c:t,f=t.metadata?t.metadata(r.metadata):E,g="html5"===r.metadata.type&&f?f[r.metadata.name]:E,m=t.data(r.metadata.name||"qtipopts");try{m="string"==typeof m?o.parseJSON(m):m}catch(_){}if(h=o.extend(A,{},S.defaults,r,"object"==typeof m?a(m):E,a(g||f)),l=h.position,h.id=i,"boolean"==typeof h.content.text){if(u=t.attr(h.content.attr),h.content.attr===D||!u)return D;h.content.text=u}if(l.container.length||(l.container=c),l.target===D&&(l.target=d),h.show.target===D&&(h.show.target=d),h.show.solo===A&&(h.show.solo=l.container.closest("body")),h.hide.target===D&&(h.hide.target=d),h.position.viewport===A&&(h.position.viewport=l.container),l.container=l.container.eq(0),l.at=new T(l.at,A),l.my=new T(l.my),t.data(q))if(h.overwrite)t.qtip("destroy",!0);else if(h.overwrite===D)return D;return t.attr(H,i),h.suppress&&(p=t.attr("title"))&&t.removeAttr("title").attr(it,p).attr("title",""),s=new n(t,h,i,!!u),t.data(q,s),s}function v(t){return t.charAt(0).toUpperCase()+t.slice(1)}function y(t,e){var o,n,r=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+_t.join(r+" ")+r).split(" "),a=0;if(mt[e])return t.css(mt[e]);for(;o=s[a++];)if((n=t.css(o))!==i)return mt[e]=o,n}function b(t,e){return Math.ceil(parseFloat(y(t,e)))}function w(t,e){this._ns="tip",this.options=e,this.offset=e.offset,this.size=[e.width,e.height],this.init(this.qtip=t)}function C(t,e){this.options=e,this._ns="-modal",this.init(this.qtip=t)}function P(t,e){this._ns="ie6",this.init(this.qtip=t)}var S,x,T,k,I,A=!0,D=!1,E=null,F="x",M="y",L="width",O="height",$="top",R="left",U="bottom",B="right",N="center",z="flipinvert",W="shift",G={},q="qtip",H="data-hasqtip",j="data-qtip-id",V=["ui-widget","ui-tooltip"],X="."+q,K="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),Y=q+"-fixed",Q=q+"-default",J=q+"-focus",Z=q+"-hover",tt=q+"-disabled",et="_replacedByqTip",it="oldtitle",ot={ie:function(){for(var t=4,i=e.createElement("div");(i.innerHTML="<!--[if gt IE "+t+"]><i></i><![endif]-->")&&i.getElementsByTagName("i")[0];t+=1);return t>4?t:NaN}(),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||D};x=n.prototype,x._when=function(t){return o.when.apply(o,t)},x.render=function(t){if(this.rendered||this.destroyed)return this;var e,i=this,n=this.options,r=this.cache,s=this.elements,a=n.content.text,l=n.content.title,u=n.content.button,h=n.position,p=("."+this._id+" ",[]);return o.attr(this.target[0],"aria-describedby",this._id),r.posClass=this._createPosClass((this.position={my:h.my,at:h.at}).my),this.tooltip=s.tooltip=e=o("<div/>",{id:this._id,"class":[q,Q,n.style.classes,r.posClass].join(" "),width:n.style.width||"",height:n.style.height||"",tracking:"mouse"===h.target&&h.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":D,"aria-describedby":this._id+"-content","aria-hidden":A}).toggleClass(tt,this.disabled).attr(j,this.id).data(q,this).appendTo(h.container).append(s.content=o("<div />",{"class":q+"-content",id:this._id+"-content","aria-atomic":A})),this.rendered=-1,this.positioning=A,l&&(this._createTitle(),o.isFunction(l)||p.push(this._updateTitle(l,D))),u&&this._createButton(),o.isFunction(a)||p.push(this._updateContent(a,D)),this.rendered=A,this._setWidget(),o.each(G,function(t){var e;"render"===this.initialize&&(e=this(i))&&(i.plugins[t]=e)}),this._unassignEvents(),this._assignEvents(),this._when(p).then(function(){i._trigger("render"),i.positioning=D,i.hiddenDuringWait||!n.show.ready&&!t||i.toggle(A,r.event,D),i.hiddenDuringWait=D}),S.api[this.id]=this,this},x.destroy=function(t){function e(){if(!this.destroyed){this.destroyed=A;var t,e=this.target,i=e.attr(it);this.rendered&&this.tooltip.stop(1,0).find("*").remove().end().remove(),o.each(this.plugins,function(t){this.destroy&&this.destroy()});for(t in this.timers)clearTimeout(this.timers[t]);e.removeData(q).removeAttr(j).removeAttr(H).removeAttr("aria-describedby"),this.options.suppress&&i&&e.attr("title",i).removeAttr(it),this._unassignEvents(),this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=E,delete S.api[this.id]}}return this.destroyed?this.target:(t===A&&"hide"!==this.triggering||!this.rendered?e.call(this):(this.tooltip.one("tooltiphidden",o.proxy(e,this)),!this.triggering&&this.hide()),this.target)},k=x.checks={builtin:{"^id$":function(t,e,i,n){var r=i===A?S.nextid:i,s=q+"-"+r;r!==D&&r.length>0&&!o("#"+s).length?(this._id=s,this.rendered&&(this.tooltip[0].id=this._id,this.elements.content[0].id=this._id+"-content",this.elements.title[0].id=this._id+"-title")):t[e]=n},"^prerender":function(t,e,i){i&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(t,e,i){this._updateContent(i)},"^content.attr$":function(t,e,i,o){this.options.content.text===this.target.attr(o)&&this._updateContent(this.target.attr(i))},"^content.title$":function(t,e,i){return i?(i&&!this.elements.title&&this._createTitle(),void this._updateTitle(i)):this._removeTitle()},"^content.button$":function(t,e,i){this._updateButton(i)},"^content.title.(text|button)$":function(t,e,i){this.set("content."+e,i)},"^position.(my|at)$":function(t,e,i){"string"==typeof i&&(this.position[e]=t[e]=new T(i,"at"===e))},"^position.container$":function(t,e,i){this.rendered&&this.tooltip.appendTo(i)},"^show.ready$":function(t,e,i){i&&(!this.rendered&&this.render(A)||this.toggle(A))},"^style.classes$":function(t,e,i,o){this.rendered&&this.tooltip.removeClass(o).addClass(i)},"^style.(width|height)":function(t,e,i){this.rendered&&this.tooltip.css(e,i)},"^style.widget|content.title":function(){this.rendered&&this._setWidget()},"^style.def":function(t,e,i){this.rendered&&this.tooltip.toggleClass(Q,!!i)},"^events.(render|show|move|hide|focus|blur)$":function(t,e,i){this.rendered&&this.tooltip[(o.isFunction(i)?"":"un")+"bind"]("tooltip"+e,i)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){if(this.rendered){var t=this.options.position;this.tooltip.attr("tracking","mouse"===t.target&&t.adjust.mouse),this._unassignEvents(),this._assignEvents()}}}},x.get=function(t){if(this.destroyed)return this;var e=l(this.options,t.toLowerCase()),i=e[0][e[1]];return i.precedance?i.string():i};var nt=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i,rt=/^prerender|show\.ready/i;x.set=function(t,e){if(this.destroyed)return this;var i,n=this.rendered,r=D,s=this.options;this.checks;return"string"==typeof t?(i=t,t={},t[i]=e):t=o.extend({},t),o.each(t,function(e,i){if(n&&rt.test(e))return void delete t[e];var a,u=l(s,e.toLowerCase());a=u[0][u[1]],u[0][u[1]]=i&&i.nodeType?o(i):i,r=nt.test(e)||r,t[e]=[u[0],u[1],i,a]}),a(s),this.positioning=A,o.each(t,o.proxy(u,this)),this.positioning=D,this.rendered&&this.tooltip[0].offsetWidth>0&&r&&this.reposition("mouse"===s.position.target?E:this.cache.event),this},x._update=function(t,e,i){var n=this,r=this.cache;return this.rendered&&t?(o.isFunction(t)&&(t=t.call(this.elements.target,r.event,this)||""),o.isFunction(t.then)?(r.waiting=A,t.then(function(t){return r.waiting=D,n._update(t,e)},E,function(t){return n._update(t,e)})):t===D||!t&&""!==t?D:(t.jquery&&t.length>0?e.empty().append(t.css({display:"block",visibility:"visible"})):e.html(t),this._waitForContent(e).then(function(t){n.rendered&&n.tooltip[0].offsetWidth>0&&n.reposition(r.event,!t.length)}))):D},x._waitForContent=function(t){var e=this.cache;return e.waiting=A,(o.fn.imagesLoaded?t.imagesLoaded():o.Deferred().resolve([])).done(function(){e.waiting=D}).promise()},x._updateContent=function(t,e){this._update(t,this.elements.content,e)},x._updateTitle=function(t,e){this._update(t,this.elements.title,e)===D&&this._removeTitle(D)},x._createTitle=function(){var t=this.elements,e=this._id+"-title";t.titlebar&&this._removeTitle(),t.titlebar=o("<div />",{"class":q+"-titlebar "+(this.options.style.widget?h("header"):"")}).append(t.title=o("<div />",{id:e,"class":q+"-title","aria-atomic":A})).insertBefore(t.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(t){o(this).toggleClass("ui-state-active ui-state-focus","down"===t.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(t){o(this).toggleClass("ui-state-hover","mouseover"===t.type)}),this.options.content.button&&this._createButton()},x._removeTitle=function(t){var e=this.elements;e.title&&(e.titlebar.remove(),e.titlebar=e.title=e.button=E,t!==D&&this.reposition())},x._createPosClass=function(t){return q+"-pos-"+(t||this.options.position.my).abbrev()},x.reposition=function(i,n){if(!this.rendered||this.positioning||this.destroyed)return this;this.positioning=A;var r,s,a,l,u=this.cache,h=this.tooltip,p=this.options.position,c=p.target,d=p.my,f=p.at,g=p.viewport,m=p.container,_=p.adjust,v=_.method.split(" "),y=h.outerWidth(D),b=h.outerHeight(D),w=0,C=0,P=h.css("position"),S={left:0,top:0},x=h[0].offsetWidth>0,T=i&&"scroll"===i.type,k=o(t),I=m[0].ownerDocument,E=this.mouse;if(o.isArray(c)&&2===c.length)f={x:R,y:$},S={left:c[0],top:c[1]};else if("mouse"===c)f={x:R,y:$},(!_.mouse||this.options.hide.distance)&&u.origin&&u.origin.pageX?i=u.origin:!i||i&&("resize"===i.type||"scroll"===i.type)?i=u.event:E&&E.pageX&&(i=E),"static"!==P&&(S=m.offset()),I.body.offsetWidth!==(t.innerWidth||I.documentElement.clientWidth)&&(s=o(e.body).offset()),S={left:i.pageX-S.left+(s&&s.left||0),top:i.pageY-S.top+(s&&s.top||0)},_.mouse&&T&&E&&(S.left-=(E.scrollX||0)-k.scrollLeft(),S.top-=(E.scrollY||0)-k.scrollTop());else{if("event"===c?i&&i.target&&"scroll"!==i.type&&"resize"!==i.type?u.target=o(i.target):i.target||(u.target=this.elements.target):"event"!==c&&(u.target=o(c.jquery?c:this.elements.target)),c=u.target,c=o(c).eq(0),0===c.length)return this;c[0]===e||c[0]===t?(w=ot.iOS?t.innerWidth:c.width(),C=ot.iOS?t.innerHeight:c.height(),c[0]===t&&(S={top:(g||c).scrollTop(),left:(g||c).scrollLeft()})):G.imagemap&&c.is("area")?r=G.imagemap(this,c,f,G.viewport?v:D):G.svg&&c&&c[0].ownerSVGElement?r=G.svg(this,c,f,G.viewport?v:D):(w=c.outerWidth(D),C=c.outerHeight(D),S=c.offset()),r&&(w=r.width,C=r.height,s=r.offset,S=r.position),S=this.reposition.offset(c,S,m),(ot.iOS>3.1&&ot.iOS<4.1||ot.iOS>=4.3&&ot.iOS<4.33||!ot.iOS&&"fixed"===P)&&(S.left-=k.scrollLeft(),S.top-=k.scrollTop()),(!r||r&&r.adjustable!==D)&&(S.left+=f.x===B?w:f.x===N?w/2:0,S.top+=f.y===U?C:f.y===N?C/2:0)}return S.left+=_.x+(d.x===B?-y:d.x===N?-y/2:0),S.top+=_.y+(d.y===U?-b:d.y===N?-b/2:0),G.viewport?(a=S.adjusted=G.viewport(this,S,p,w,C,y,b),s&&a.left&&(S.left+=s.left),s&&a.top&&(S.top+=s.top),a.my&&(this.position.my=a.my)):S.adjusted={left:0,top:0},u.posClass!==(l=this._createPosClass(this.position.my))&&h.removeClass(u.posClass).addClass(u.posClass=l),
this._trigger("move",[S,g.elem||g],i)?(delete S.adjusted,n===D||!x||isNaN(S.left)||isNaN(S.top)||"mouse"===c||!o.isFunction(p.effect)?h.css(S):o.isFunction(p.effect)&&(p.effect.call(h,this,o.extend({},S)),h.queue(function(t){o(this).css({opacity:"",height:""}),ot.ie&&this.style.removeAttribute("filter"),t()})),this.positioning=D,this):this},x.reposition.offset=function(t,i,n){function r(t,e){i.left+=e*t.scrollLeft(),i.top+=e*t.scrollTop()}if(!n[0])return i;var s,a,l,u,h=o(t[0].ownerDocument),p=!!ot.ie&&"CSS1Compat"!==e.compatMode,c=n[0];do"static"!==(a=o.css(c,"position"))&&("fixed"===a?(l=c.getBoundingClientRect(),r(h,-1)):(l=o(c).position(),l.left+=parseFloat(o.css(c,"borderLeftWidth"))||0,l.top+=parseFloat(o.css(c,"borderTopWidth"))||0),i.left-=l.left+(parseFloat(o.css(c,"marginLeft"))||0),i.top-=l.top+(parseFloat(o.css(c,"marginTop"))||0),s||"hidden"===(u=o.css(c,"overflow"))||"visible"===u||(s=o(c)));while(c=c.offsetParent);return s&&(s[0]!==h[0]||p)&&r(s,1),i};var st=(T=x.reposition.Corner=function(t,e){t=(""+t).replace(/([A-Z])/," $1").replace(/middle/gi,N).toLowerCase(),this.x=(t.match(/left|right/i)||t.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(t.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase(),this.forceY=!!e;var i=t.charAt(0);this.precedance="t"===i||"b"===i?M:F}).prototype;st.invert=function(t,e){this[t]=this[t]===R?B:this[t]===B?R:e||this[t]},st.string=function(t){var e=this.x,i=this.y,o=e!==i?"center"===e||"center"!==i&&(this.precedance===M||this.forceY)?[i,e]:[e,i]:[e];return t!==!1?o.join(" "):o},st.abbrev=function(){var t=this.string(!1);return t[0].charAt(0)+(t[1]&&t[1].charAt(0)||"")},st.clone=function(){return new T(this.string(),this.forceY)},x.toggle=function(t,i){var n=this.cache,r=this.options,s=this.tooltip;if(i){if(/over|enter/.test(i.type)&&n.event&&/out|leave/.test(n.event.type)&&r.show.target.add(i.target).length===r.show.target.length&&s.has(i.relatedTarget).length)return this;n.event=o.event.fix(i)}if(this.waiting&&!t&&(this.hiddenDuringWait=A),!this.rendered)return t?this.render(1):this;if(this.destroyed||this.disabled)return this;var a,l,u,h=t?"show":"hide",p=this.options[h],c=(this.options[t?"hide":"show"],this.options.position),d=this.options.content,f=this.tooltip.css("width"),g=this.tooltip.is(":visible"),m=t||1===p.target.length,_=!i||p.target.length<2||n.target[0]===i.target;return(typeof t).search("boolean|number")&&(t=!g),a=!s.is(":animated")&&g===t&&_,l=a?E:!!this._trigger(h,[90]),this.destroyed?this:(l!==D&&t&&this.focus(i),!l||a?this:(o.attr(s[0],"aria-hidden",!t),t?(this.mouse&&(n.origin=o.event.fix(this.mouse)),o.isFunction(d.text)&&this._updateContent(d.text,D),o.isFunction(d.title)&&this._updateTitle(d.title,D),!I&&"mouse"===c.target&&c.adjust.mouse&&(o(e).bind("mousemove."+q,this._storeMouse),I=A),f||s.css("width",s.outerWidth(D)),this.reposition(i,arguments[2]),f||s.css("width",""),p.solo&&("string"==typeof p.solo?o(p.solo):o(X,p.solo)).not(s).not(p.target).qtip("hide",o.Event("tooltipsolo"))):(clearTimeout(this.timers.show),delete n.origin,I&&!o(X+'[tracking="true"]:visible',p.solo).not(s).length&&(o(e).unbind("mousemove."+q),I=D),this.blur(i)),u=o.proxy(function(){t?(ot.ie&&s[0].style.removeAttribute("filter"),s.css("overflow",""),"string"==typeof p.autofocus&&o(this.options.show.autofocus,s).focus(),this.options.show.target.trigger("qtip-"+this.id+"-inactive")):s.css({display:"",visibility:"",opacity:"",left:"",top:""}),this._trigger(t?"visible":"hidden")},this),p.effect===D||m===D?(s[h](),u()):o.isFunction(p.effect)?(s.stop(1,1),p.effect.call(s,this),s.queue("fx",function(t){u(),t()})):s.fadeTo(90,t?1:0,u),t&&p.target.trigger("qtip-"+this.id+"-inactive"),this))},x.show=function(t){return this.toggle(A,t)},x.hide=function(t){return this.toggle(D,t)},x.focus=function(t){if(!this.rendered||this.destroyed)return this;var e=o(X),i=this.tooltip,n=parseInt(i[0].style.zIndex,10),r=S.zindex+e.length;return i.hasClass(J)||this._trigger("focus",[r],t)&&(n!==r&&(e.each(function(){this.style.zIndex>n&&(this.style.zIndex=this.style.zIndex-1)}),e.filter("."+J).qtip("blur",t)),i.addClass(J)[0].style.zIndex=r),this},x.blur=function(t){return!this.rendered||this.destroyed?this:(this.tooltip.removeClass(J),this._trigger("blur",[this.tooltip.css("zIndex")],t),this)},x.disable=function(t){return this.destroyed?this:("toggle"===t?t=!(this.rendered?this.tooltip.hasClass(tt):this.disabled):"boolean"!=typeof t&&(t=A),this.rendered&&this.tooltip.toggleClass(tt,t).attr("aria-disabled",t),this.disabled=!!t,this)},x.enable=function(){return this.disable(D)},x._createButton=function(){var t=this,e=this.elements,i=e.tooltip,n=this.options.content.button,r="string"==typeof n,s=r?n:"Close tooltip";e.button&&e.button.remove(),n.jquery?e.button=n:e.button=o("<a />",{"class":"qtip-close "+(this.options.style.widget?"":q+"-icon"),title:s,"aria-label":s}).prepend(o("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),e.button.appendTo(e.titlebar||i).attr("role","button").click(function(e){return i.hasClass(tt)||t.hide(e),D})},x._updateButton=function(t){if(!this.rendered)return D;var e=this.elements.button;t?this._createButton():e.remove()},x._setWidget=function(){var t=this.options.style.widget,e=this.elements,i=e.tooltip,o=i.hasClass(tt);i.removeClass(tt),tt=t?"ui-state-disabled":"qtip-disabled",i.toggleClass(tt,o),i.toggleClass("ui-helper-reset "+h(),t).toggleClass(Q,this.options.style.def&&!t),e.content&&e.content.toggleClass(h("content"),t),e.titlebar&&e.titlebar.toggleClass(h("header"),t),e.button&&e.button.toggleClass(q+"-icon",!t)},x._storeMouse=function(t){return(this.mouse=o.event.fix(t)).type="mousemove",this},x._bind=function(t,e,i,n,r){if(t&&i&&e.length){var s="."+this._id+(n?"-"+n:"");return o(t).bind((e.split?e:e.join(s+" "))+s,o.proxy(i,r||this)),this}},x._unbind=function(t,e){return t&&o(t).unbind("."+this._id+(e?"-"+e:"")),this},x._trigger=function(t,e,i){var n=o.Event("tooltip"+t);return n.originalEvent=i&&o.extend({},i)||this.cache.event||E,this.triggering=t,this.tooltip.trigger(n,[this].concat(e||[])),this.triggering=D,!n.isDefaultPrevented()},x._bindEvents=function(t,e,i,n,r,s){var a=i.filter(n).add(n.filter(i)),l=[];a.length&&(o.each(e,function(e,i){var n=o.inArray(i,t);n>-1&&l.push(t.splice(n,1)[0])}),l.length&&(this._bind(a,l,function(t){var e=this.rendered?this.tooltip[0].offsetWidth>0:!1;(e?s:r).call(this,t)}),i=i.not(a),n=n.not(a))),this._bind(i,t,r),this._bind(n,e,s)},x._assignInitialEvents=function(t){function e(t){return this.disabled||this.destroyed?D:(this.cache.event=t&&o.event.fix(t),this.cache.target=t&&o(t.target),clearTimeout(this.timers.show),void(this.timers.show=p.call(this,function(){this.render("object"==typeof t||i.show.ready)},i.prerender?0:i.show.delay)))}var i=this.options,n=i.show.target,r=i.hide.target,s=i.show.event?o.trim(""+i.show.event).split(" "):[],a=i.hide.event?o.trim(""+i.hide.event).split(" "):[];this._bind(this.elements.target,["remove","removeqtip"],function(t){this.destroy(!0)},"destroy"),/mouse(over|enter)/i.test(i.show.event)&&!/mouse(out|leave)/i.test(i.hide.event)&&a.push("mouseleave"),this._bind(n,"mousemove",function(t){this._storeMouse(t),this.cache.onTarget=A}),this._bindEvents(s,a,n,r,e,function(){return this.timers?void clearTimeout(this.timers.show):D}),(i.show.ready||i.prerender)&&e.call(this,t)},x._assignEvents=function(){var i=this,n=this.options,r=n.position,s=this.tooltip,a=n.show.target,l=n.hide.target,u=r.container,h=r.viewport,p=o(e),m=(o(e.body),o(t)),_=n.show.event?o.trim(""+n.show.event).split(" "):[],v=n.hide.event?o.trim(""+n.hide.event).split(" "):[];o.each(n.events,function(t,e){i._bind(s,"toggle"===t?["tooltipshow","tooltiphide"]:["tooltip"+t],e,null,s)}),/mouse(out|leave)/i.test(n.hide.event)&&"window"===n.hide.leave&&this._bind(p,["mouseout","blur"],function(t){/select|option/.test(t.target.nodeName)||t.relatedTarget||this.hide(t)}),n.hide.fixed?l=l.add(s.addClass(Y)):/mouse(over|enter)/i.test(n.show.event)&&this._bind(l,"mouseleave",function(){clearTimeout(this.timers.show)}),(""+n.hide.event).indexOf("unfocus")>-1&&this._bind(u.closest("html"),["mousedown","touchstart"],function(t){var e=o(t.target),i=this.rendered&&!this.tooltip.hasClass(tt)&&this.tooltip[0].offsetWidth>0,n=e.parents(X).filter(this.tooltip[0]).length>0;e[0]===this.target[0]||e[0]===this.tooltip[0]||n||this.target.has(e[0]).length||!i||this.hide(t)}),"number"==typeof n.hide.inactive&&(this._bind(a,"qtip-"+this.id+"-inactive",f,"inactive"),this._bind(l.add(s),S.inactiveEvents,f)),this._bindEvents(_,v,a,l,c,d),this._bind(a.add(s),"mousemove",function(t){if("number"==typeof n.hide.distance){var e=this.cache.origin||{},i=this.options.hide.distance,o=Math.abs;(o(t.pageX-e.pageX)>=i||o(t.pageY-e.pageY)>=i)&&this.hide(t)}this._storeMouse(t)}),"mouse"===r.target&&r.adjust.mouse&&(n.hide.event&&this._bind(a,["mouseenter","mouseleave"],function(t){return this.cache?void(this.cache.onTarget="mouseenter"===t.type):D}),this._bind(p,"mousemove",function(t){this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(tt)&&this.tooltip[0].offsetWidth>0&&this.reposition(t)})),(r.adjust.resize||h.length)&&this._bind(o.event.special.resize?h:m,"resize",g),r.adjust.scroll&&this._bind(m.add(r.container),"scroll",g)},x._unassignEvents=function(){var i=this.options,n=i.show.target,r=i.hide.target,s=o.grep([this.elements.target[0],this.rendered&&this.tooltip[0],i.position.container[0],i.position.viewport[0],i.position.container.closest("html")[0],t,e],function(t){return"object"==typeof t});n&&n.toArray&&(s=s.concat(n.toArray())),r&&r.toArray&&(s=s.concat(r.toArray())),this._unbind(s)._unbind(s,"destroy")._unbind(s,"inactive")},o(function(){m(X,["mouseenter","mouseleave"],function(t){var e="mouseenter"===t.type,i=o(t.currentTarget),n=o(t.relatedTarget||t.target),r=this.options;e?(this.focus(t),i.hasClass(Y)&&!i.hasClass(tt)&&clearTimeout(this.timers.hide)):"mouse"===r.position.target&&r.position.adjust.mouse&&r.hide.event&&r.show.target&&!n.closest(r.show.target[0]).length&&this.hide(t),i.toggleClass(Z,e)}),m("["+j+"]",K,f)}),S=o.fn.qtip=function(t,e,n){var r=(""+t).toLowerCase(),s=E,l=o.makeArray(arguments).slice(1),u=l[l.length-1],h=this[0]?o.data(this[0],q):E;return!arguments.length&&h||"api"===r?h:"string"==typeof t?(this.each(function(){var t=o.data(this,q);if(!t)return A;if(u&&u.timeStamp&&(t.cache.event=u),!e||"option"!==r&&"options"!==r)t[r]&&t[r].apply(t,l);else{if(n===i&&!o.isPlainObject(e))return s=t.get(e),D;t.set(e,n)}}),s!==E?s:this):"object"!=typeof t&&arguments.length?void 0:(h=a(o.extend(A,{},t)),this.each(function(t){var e,i;return i=o.isArray(h.id)?h.id[t]:h.id,i=!i||i===D||i.length<1||S.api[i]?S.nextid++:i,e=_(o(this),i,h),e===D?A:(S.api[i]=e,o.each(G,function(){"initialize"===this.initialize&&this(e)}),void e._assignInitialEvents(u))}))},o.qtip=n,S.api={},o.each({attr:function(t,e){if(this.length){var i=this[0],n="title",r=o.data(i,"qtip");if(t===n&&r&&"object"==typeof r&&r.options.suppress)return arguments.length<2?o.attr(i,it):(r&&r.options.content.attr===n&&r.cache.attr&&r.set("content.text",e),this.attr(it,e))}return o.fn["attr"+et].apply(this,arguments)},clone:function(t){var e=(o([]),o.fn["clone"+et].apply(this,arguments));return t||e.filter("["+it+"]").attr("title",function(){return o.attr(this,it)}).removeAttr(it),e}},function(t,e){if(!e||o.fn[t+et])return A;var i=o.fn[t+et]=o.fn[t];o.fn[t]=function(){return e.apply(this,arguments)||i.apply(this,arguments)}}),o.ui||(o["cleanData"+et]=o.cleanData,o.cleanData=function(t){for(var e,i=0;(e=o(t[i])).length;i++)if(e.attr(H))try{e.triggerHandler("removeqtip")}catch(n){}o["cleanData"+et].apply(this,arguments)}),S.version="2.2.1",S.nextid=0,S.inactiveEvents=K,S.zindex=15e3,S.defaults={prerender:D,id:D,overwrite:A,suppress:A,content:{text:A,attr:"title",title:D,button:D},position:{my:"top left",at:"bottom right",target:D,container:D,viewport:D,adjust:{x:0,y:0,mouse:A,scroll:A,resize:A,method:"flipinvert flipinvert"},effect:function(t,e,i){o(this).animate(e,{duration:200,queue:D})}},show:{target:D,event:"mouseenter",effect:A,delay:90,solo:D,ready:D,autofocus:D},hide:{target:D,event:"mouseleave",effect:A,delay:0,fixed:D,inactive:D,leave:"window",distance:D},style:{classes:"",widget:D,width:D,height:D,def:A},events:{render:E,move:E,show:E,hide:E,toggle:E,visible:E,hidden:E,focus:E,blur:E}};var at,lt="margin",ut="border",ht="color",pt="background-color",ct="transparent",dt=" !important",ft=!!e.createElement("canvas").getContext,gt=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,mt={},_t=["Webkit","O","Moz","ms"];if(ft)var vt=t.devicePixelRatio||1,yt=function(){var t=e.createElement("canvas").getContext("2d");return t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||1}(),bt=vt/yt;else var wt=function(t,e,i){return"<qtipvml:"+t+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(e||"")+' style="behavior: url(#default#VML); '+(i||"")+'" />'};o.extend(w.prototype,{init:function(t){var e,i;i=this.element=t.elements.tip=o("<div />",{"class":q+"-tip"}).prependTo(t.tooltip),ft?(e=o("<canvas />").appendTo(this.element)[0].getContext("2d"),e.lineJoin="miter",e.miterLimit=1e5,e.save()):(e=wt("shape",'coordorigin="0,0"',"position:absolute;"),this.element.html(e+e),t._bind(o("*",i).add(i),["click","mousedown"],function(t){t.stopPropagation()},this._ns)),t._bind(t.tooltip,"tooltipmove",this.reposition,this._ns,this),this.create()},_swapDimensions:function(){this.size[0]=this.options.height,this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width,this.size[1]=this.options.height},_useTitle:function(t){var e=this.qtip.elements.titlebar;return e&&(t.y===$||t.y===N&&this.element.position().top+this.size[1]/2+this.options.offset<e.outerHeight(A))},_parseCorner:function(t){var e=this.qtip.options.position.my;return t===D||e===D?t=D:t===A?t=new T(e.string()):t.string||(t=new T(t),t.fixed=A),t},_parseWidth:function(t,e,i){var o=this.qtip.elements,n=ut+v(e)+"Width";return(i?b(i,n):b(o.content,n)||b(this._useTitle(t)&&o.titlebar||o.content,n)||b(o.tooltip,n))||0},_parseRadius:function(t){var e=this.qtip.elements,i=ut+v(t.y)+v(t.x)+"Radius";return ot.ie<9?0:b(this._useTitle(t)&&e.titlebar||e.content,i)||b(e.tooltip,i)||0},_invalidColour:function(t,e,i){var o=t.css(e);return!o||i&&o===t.css(i)||gt.test(o)?D:o},_parseColours:function(t){var e=this.qtip.elements,i=this.element.css("cssText",""),n=ut+v(t[t.precedance])+v(ht),r=this._useTitle(t)&&e.titlebar||e.content,s=this._invalidColour,a=[];return a[0]=s(i,pt)||s(r,pt)||s(e.content,pt)||s(e.tooltip,pt)||i.css(pt),a[1]=s(i,n,ht)||s(r,n,ht)||s(e.content,n,ht)||s(e.tooltip,n,ht)||e.tooltip.css(n),o("*",i).add(i).css("cssText",pt+":"+ct+dt+";"+ut+":0"+dt+";"),a},_calculateSize:function(t){var e,i,o,n=t.precedance===M,r=this.options.width,s=this.options.height,a="c"===t.abbrev(),l=(n?r:s)*(a?.5:1),u=Math.pow,h=Math.round,p=Math.sqrt(u(l,2)+u(s,2)),c=[this.border/l*p,this.border/s*p];return c[2]=Math.sqrt(u(c[0],2)-u(this.border,2)),c[3]=Math.sqrt(u(c[1],2)-u(this.border,2)),e=p+c[2]+c[3]+(a?0:c[0]),i=e/p,o=[h(i*r),h(i*s)],n?o:o.reverse()},_calculateTip:function(t,e,i){i=i||1,e=e||this.size;var o=e[0]*i,n=e[1]*i,r=Math.ceil(o/2),s=Math.ceil(n/2),a={br:[0,0,o,n,o,0],bl:[0,0,o,0,0,n],tr:[0,n,o,0,o,n],tl:[0,0,0,n,o,n],tc:[0,n,r,0,o,n],bc:[0,0,o,0,r,n],rc:[0,0,o,s,0,n],lc:[o,0,o,n,0,s]};return a.lt=a.br,a.rt=a.bl,a.lb=a.tr,a.rb=a.tl,a[t.abbrev()]},_drawCoords:function(t,e){t.beginPath(),t.moveTo(e[0],e[1]),t.lineTo(e[2],e[3]),t.lineTo(e[4],e[5]),t.closePath()},create:function(){var t=this.corner=(ft||ot.ie)&&this._parseCorner(this.options.corner);return(this.enabled=!!this.corner&&"c"!==this.corner.abbrev())&&(this.qtip.cache.corner=t.clone(),this.update()),this.element.toggle(this.enabled),this.corner},update:function(e,i){if(!this.enabled)return this;var n,r,s,a,l,u,h,p,c=this.qtip.elements,d=this.element,f=d.children(),g=this.options,m=this.size,_=g.mimic,v=Math.round;e||(e=this.qtip.cache.corner||this.corner),_===D?_=e:(_=new T(_),_.precedance=e.precedance,"inherit"===_.x?_.x=e.x:"inherit"===_.y?_.y=e.y:_.x===_.y&&(_[e.precedance]=e[e.precedance])),r=_.precedance,e.precedance===F?this._swapDimensions():this._resetDimensions(),n=this.color=this._parseColours(e),n[1]!==ct?(p=this.border=this._parseWidth(e,e[e.precedance]),g.border&&1>p&&!gt.test(n[1])&&(n[0]=n[1]),this.border=p=g.border!==A?g.border:p):this.border=p=0,h=this.size=this._calculateSize(e),d.css({width:h[0],height:h[1],lineHeight:h[1]+"px"}),u=e.precedance===M?[v(_.x===R?p:_.x===B?h[0]-m[0]-p:(h[0]-m[0])/2),v(_.y===$?h[1]-m[1]:0)]:[v(_.x===R?h[0]-m[0]:0),v(_.y===$?p:_.y===U?h[1]-m[1]-p:(h[1]-m[1])/2)],ft?(s=f[0].getContext("2d"),s.restore(),s.save(),s.clearRect(0,0,6e3,6e3),a=this._calculateTip(_,m,bt),l=this._calculateTip(_,this.size,bt),f.attr(L,h[0]*bt).attr(O,h[1]*bt),f.css(L,h[0]).css(O,h[1]),this._drawCoords(s,l),s.fillStyle=n[1],s.fill(),s.translate(u[0]*bt,u[1]*bt),this._drawCoords(s,a),s.fillStyle=n[0],s.fill()):(a=this._calculateTip(_),a="m"+a[0]+","+a[1]+" l"+a[2]+","+a[3]+" "+a[4]+","+a[5]+" xe",u[2]=p&&/^(r|b)/i.test(e.string())?8===ot.ie?2:1:0,f.css({coordsize:h[0]+p+" "+(h[1]+p),antialias:""+(_.string().indexOf(N)>-1),left:u[0]-u[2]*Number(r===F),top:u[1]-u[2]*Number(r===M),width:h[0]+p,height:h[1]+p}).each(function(t){var e=o(this);e[e.prop?"prop":"attr"]({coordsize:h[0]+p+" "+(h[1]+p),path:a,fillcolor:n[0],filled:!!t,stroked:!t}).toggle(!(!p&&!t)),!t&&e.html(wt("stroke",'weight="'+2*p+'px" color="'+n[1]+'" miterlimit="1000" joinstyle="miter"'))})),t.opera&&setTimeout(function(){c.tip.css({display:"inline-block",visibility:"visible"})},1),i!==D&&this.calculate(e,h)},calculate:function(t,e){if(!this.enabled)return D;var i,n,r=this,s=this.qtip.elements,a=this.element,l=this.options.offset,u=(s.tooltip.hasClass("ui-widget"),{});return t=t||this.corner,i=t.precedance,e=e||this._calculateSize(t),n=[t.x,t.y],i===F&&n.reverse(),o.each(n,function(o,n){var a,h,p;n===N?(a=i===M?R:$,u[a]="50%",u[lt+"-"+a]=-Math.round(e[i===M?0:1]/2)+l):(a=r._parseWidth(t,n,s.tooltip),h=r._parseWidth(t,n,s.content),p=r._parseRadius(t),u[n]=Math.max(-r.border,o?h:l+(p>a?p:-a)))}),u[t[i]]-=e[i===F?0:1],a.css({margin:"",top:"",bottom:"",left:"",right:""}).css(u),u},reposition:function(t,e,o,n){function r(t,e,i,o,n){t===W&&h.precedance===e&&p[o]&&h[i]!==N?h.precedance=h.precedance===F?M:F:t!==W&&p[o]&&(h[e]=h[e]===N?p[o]>0?o:n:h[e]===o?n:o)}function s(t,e,n){h[t]===N?m[lt+"-"+e]=g[t]=a[lt+"-"+e]-p[e]:(l=a[n]!==i?[p[e],-a[e]]:[-p[e],a[e]],(g[t]=Math.max(l[0],l[1]))>l[0]&&(o[e]-=p[e],g[e]=D),m[a[n]!==i?n:e]=g[t])}if(this.enabled){var a,l,u=e.cache,h=this.corner.clone(),p=o.adjusted,c=e.options.position.adjust.method.split(" "),d=c[0],f=c[1]||c[0],g={left:D,top:D,x:0,y:0},m={};this.corner.fixed!==A&&(r(d,F,M,R,B),r(f,M,F,$,U),(h.string()!==u.corner.string()||u.cornerTop!==p.top||u.cornerLeft!==p.left)&&this.update(h,D)),a=this.calculate(h),a.right!==i&&(a.left=-a.right),a.bottom!==i&&(a.top=-a.bottom),a.user=this.offset,(g.left=d===W&&!!p.left)&&s(F,R,B),(g.top=f===W&&!!p.top)&&s(M,$,U),this.element.css(m).toggle(!(g.x&&g.y||h.x===N&&g.y||h.y===N&&g.x)),o.left-=a.left.charAt?a.user:d!==W||g.top||!g.left&&!g.top?a.left+this.border:0,o.top-=a.top.charAt?a.user:f!==W||g.left||!g.left&&!g.top?a.top+this.border:0,u.cornerLeft=p.left,u.cornerTop=p.top,u.corner=h.clone()}},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns),this.qtip.elements.tip&&this.qtip.elements.tip.find("*").remove().end().remove()}}),at=G.tip=function(t){return new w(t,t.options.style.tip)},at.initialize="render",at.sanitize=function(t){if(t.style&&"tip"in t.style){var e=t.style.tip;"object"!=typeof e&&(e=t.style.tip={corner:e}),/string|boolean/i.test(typeof e.corner)||(e.corner=A)}},k.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create(),this.qtip.reposition()},"^style.tip.(height|width)$":function(t){this.size=[t.width,t.height],this.update(),this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}},o.extend(A,S.defaults,{style:{tip:{corner:A,mimic:D,width:6,height:6,border:A,offset:0}}});var Ct,Pt,St="qtip-modal",xt="."+St;Pt=function(){function t(t){if(o.expr[":"].focusable)return o.expr[":"].focusable;var e,i,n,r=!isNaN(o.attr(t,"tabindex")),s=t.nodeName&&t.nodeName.toLowerCase();return"area"===s?(e=t.parentNode,i=e.name,t.href&&i&&"map"===e.nodeName.toLowerCase()?(n=o("img[usemap=#"+i+"]")[0],!!n&&n.is(":visible")):!1):/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||r:r}function i(t){h.length<1&&t.length?t.not("body").blur():h.first().focus()}function n(t){if(l.is(":visible")){var e,n=o(t.target),a=r.tooltip,u=n.closest(X);e=u.length<1?D:parseInt(u[0].style.zIndex,10)>parseInt(a[0].style.zIndex,10),e||n.closest(X)[0]===a[0]||i(n),s=t.target===h[h.length-1]}}var r,s,a,l,u=this,h={};o.extend(u,{init:function(){return l=u.elem=o("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return D}}).hide(),o(e.body).bind("focusin"+xt,n),o(e).bind("keydown"+xt,function(t){r&&r.options.show.modal.escape&&27===t.keyCode&&r.hide(t)}),l.bind("click"+xt,function(t){r&&r.options.show.modal.blur&&r.hide(t)}),u},update:function(e){r=e,h=e.options.show.modal.stealfocus!==D?e.tooltip.find("*").filter(function(){return t(this)}):[]},toggle:function(t,n,s){var h=(o(e.body),t.tooltip),p=t.options.show.modal,c=p.effect,d=n?"show":"hide",f=l.is(":visible"),g=o(xt).filter(":visible:not(:animated)").not(h);return u.update(t),n&&p.stealfocus!==D&&i(o(":focus")),l.toggleClass("blurs",p.blur),n&&l.appendTo(e.body),l.is(":animated")&&f===n&&a!==D||!n&&g.length?u:(l.stop(A,D),o.isFunction(c)?c.call(l,n):c===D?l[d]():l.fadeTo(parseInt(s,10)||90,n?1:0,function(){n||l.hide()}),n||l.queue(function(t){l.css({left:"",top:""}),o(xt).length||l.detach(),t()}),a=n,r.destroyed&&(r=E),u)}}),u.init()},Pt=new Pt,o.extend(C.prototype,{init:function(t){var e=t.tooltip;return this.options.on?(t.elements.overlay=Pt.elem,e.addClass(St).css("z-index",S.modal_zindex+o(xt).length),t._bind(e,["tooltipshow","tooltiphide"],function(t,i,n){var r=t.originalEvent;if(t.target===e[0])if(r&&"tooltiphide"===t.type&&/mouse(leave|enter)/.test(r.type)&&o(r.relatedTarget).closest(Pt.elem[0]).length)try{t.preventDefault()}catch(s){}else(!r||r&&"tooltipsolo"!==r.type)&&this.toggle(t,"tooltipshow"===t.type,n)},this._ns,this),t._bind(e,"tooltipfocus",function(t,i){if(!t.isDefaultPrevented()&&t.target===e[0]){var n=o(xt),r=S.modal_zindex+n.length,s=parseInt(e[0].style.zIndex,10);Pt.elem[0].style.zIndex=r-1,n.each(function(){this.style.zIndex>s&&(this.style.zIndex-=1)}),n.filter("."+J).qtip("blur",t.originalEvent),e.addClass(J)[0].style.zIndex=r,Pt.update(i);try{t.preventDefault()}catch(a){}}},this._ns,this),void t._bind(e,"tooltiphide",function(t){t.target===e[0]&&o(xt).filter(":visible").not(e).last().qtip("focus",t)},this._ns,this)):this},toggle:function(t,e,i){return t&&t.isDefaultPrevented()?this:void Pt.toggle(this.qtip,!!e,i)},destroy:function(){this.qtip.tooltip.removeClass(St),this.qtip._unbind(this.qtip.tooltip,this._ns),Pt.toggle(this.qtip,D),delete this.qtip.elements.overlay}}),Ct=G.modal=function(t){return new C(t,t.options.show.modal)},Ct.sanitize=function(t){t.show&&("object"!=typeof t.show.modal?t.show.modal={on:!!t.show.modal}:"undefined"==typeof t.show.modal.on&&(t.show.modal.on=A))},S.modal_zindex=S.zindex-200,Ct.initialize="render",k.modal={"^show.modal.(on|blur)$":function(){this.destroy(),this.init(),this.qtip.elems.overlay.toggle(this.qtip.tooltip[0].offsetWidth>0)}},o.extend(A,S.defaults,{show:{modal:{on:D,effect:A,blur:A,stealfocus:A,escape:A}}}),G.viewport=function(i,o,n,r,s,a,l){function u(t,e,i,n,r,s,a,l,u){var h=o[r],v=b[t],y=w[t],C=i===W,P=v===r?u:v===s?-u:-u/2,S=y===r?l:y===s?-l:-l/2,x=m[r]+_[r]-(d?0:c[r]),T=x-h,k=h+u-(a===L?f:g)-x,I=P-(b.precedance===t||v===b[e]?S:0)-(y===N?l/2:0);return C?(I=(v===r?1:-1)*P,o[r]+=T>0?T:k>0?-k:0,o[r]=Math.max(-c[r]+_[r],h-I,Math.min(Math.max(-c[r]+_[r]+(a===L?f:g),h+I),o[r],"center"===v?h-P:1e9))):(n*=i===z?2:0,T>0&&(v!==r||k>0)?(o[r]-=I+n,p.invert(t,r)):k>0&&(v!==s||T>0)&&(o[r]-=(v===N?-I:I)+n,p.invert(t,s)),o[r]<m&&-o[r]>k&&(o[r]=h,p=b.clone())),o[r]-h}var h,p,c,d,f,g,m,_,v=n.target,y=i.elements.tooltip,b=n.my,w=n.at,C=n.adjust,P=C.method.split(" "),S=P[0],x=P[1]||P[0],T=n.viewport,k=n.container,I=(i.cache,{left:0,top:0});return T.jquery&&v[0]!==t&&v[0]!==e.body&&"none"!==C.method?(c=k.offset()||I,d="static"===k.css("position"),h="fixed"===y.css("position"),f=T[0]===t?T.width():T.outerWidth(D),g=T[0]===t?T.height():T.outerHeight(D),m={left:h?0:T.scrollLeft(),top:h?0:T.scrollTop()},_=T.offset()||I,("shift"!==S||"shift"!==x)&&(p=b.clone()),I={left:"none"!==S?u(F,M,S,C.x,R,B,L,r,a):0,top:"none"!==x?u(M,F,x,C.y,$,U,O,s,l):0,my:p}):I},G.polys={polygon:function(t,e){var i,o,n,r={width:0,height:0,position:{top:1e10,right:0,bottom:0,left:1e10},adjustable:D},s=0,a=[],l=1,u=1,h=0,p=0;for(s=t.length;s--;)i=[parseInt(t[--s],10),parseInt(t[s+1],10)],i[0]>r.position.right&&(r.position.right=i[0]),i[0]<r.position.left&&(r.position.left=i[0]),i[1]>r.position.bottom&&(r.position.bottom=i[1]),i[1]<r.position.top&&(r.position.top=i[1]),a.push(i);if(o=r.width=Math.abs(r.position.right-r.position.left),n=r.height=Math.abs(r.position.bottom-r.position.top),"c"===e.abbrev())r.position={left:r.position.left+r.width/2,top:r.position.top+r.height/2};else{for(;o>0&&n>0&&l>0&&u>0;)for(o=Math.floor(o/2),n=Math.floor(n/2),e.x===R?l=o:e.x===B?l=r.width-o:l+=Math.floor(o/2),e.y===$?u=n:e.y===U?u=r.height-n:u+=Math.floor(n/2),s=a.length;s--&&!(a.length<2);)h=a[s][0]-r.position.left,p=a[s][1]-r.position.top,(e.x===R&&h>=l||e.x===B&&l>=h||e.x===N&&(l>h||h>r.width-l)||e.y===$&&p>=u||e.y===U&&u>=p||e.y===N&&(u>p||p>r.height-u))&&a.splice(s,1);r.position={left:a[0][0],top:a[0][1]}}return r},rect:function(t,e,i,o){return{width:Math.abs(i-t),height:Math.abs(o-e),position:{left:Math.min(t,i),top:Math.min(e,o)}}},_angles:{tc:1.5,tr:7/4,tl:5/4,bc:.5,br:.25,bl:.75,rc:2,lc:1,c:0},ellipse:function(t,e,i,o,n){var r=G.polys._angles[n.abbrev()],s=0===r?0:i*Math.cos(r*Math.PI),a=o*Math.sin(r*Math.PI);return{width:2*i-Math.abs(s),height:2*o-Math.abs(a),position:{left:t+s,top:e+a},adjustable:D}},circle:function(t,e,i,o){return G.polys.ellipse(t,e,i,i,o)}},G.svg=function(t,i,n){for(var r,s,a,l,u,h,p,c,d,f=(o(e),i[0]),g=o(f.ownerSVGElement),m=f.ownerDocument,_=(parseInt(i.css("stroke-width"),10)||0)/2;!f.getBBox;)f=f.parentNode;if(!f.getBBox||!f.parentNode)return D;switch(f.nodeName){case"ellipse":case"circle":c=G.polys.ellipse(f.cx.baseVal.value,f.cy.baseVal.value,(f.rx||f.r).baseVal.value+_,(f.ry||f.r).baseVal.value+_,n);break;case"line":case"polygon":case"polyline":for(p=f.points||[{x:f.x1.baseVal.value,y:f.y1.baseVal.value},{x:f.x2.baseVal.value,y:f.y2.baseVal.value}],c=[],h=-1,l=p.numberOfItems||p.length;++h<l;)u=p.getItem?p.getItem(h):p[h],c.push.apply(c,[u.x,u.y]);c=G.polys.polygon(c,n);break;default:c=f.getBBox(),c={width:c.width,height:c.height,position:{left:c.x,top:c.y}}}return d=c.position,g=g[0],g.createSVGPoint&&(s=f.getScreenCTM(),p=g.createSVGPoint(),p.x=d.left,p.y=d.top,a=p.matrixTransform(s),d.left=a.x,d.top=a.y),m!==e&&"mouse"!==t.position.target&&(r=o((m.defaultView||m.parentWindow).frameElement).offset(),r&&(d.left+=r.left,d.top+=r.top)),m=o(m),d.left+=m.scrollLeft(),d.top+=m.scrollTop(),c},G.imagemap=function(t,e,i,n){e.jquery||(e=o(e));var r,s,a,l,u,h=(e.attr("shape")||"rect").toLowerCase().replace("poly","polygon"),p=o('img[usemap="#'+e.parent("map").attr("name")+'"]'),c=o.trim(e.attr("coords")),d=c.replace(/,$/,"").split(",");if(!p.length)return D;if("polygon"===h)l=G.polys.polygon(d,i);else{if(!G.polys[h])return D;for(a=-1,u=d.length,s=[];++a<u;)s.push(parseInt(d[a],10));l=G.polys[h].apply(this,s.concat(i))}return r=p.offset(),r.left+=Math.ceil((p.outerWidth(D)-p.width())/2),r.top+=Math.ceil((p.outerHeight(D)-p.height())/2),l.position.left+=r.left,l.position.top+=r.top,l};var Tt,kt='<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>';o.extend(P.prototype,{_scroll:function(){var e=this.qtip.elements.overlay;e&&(e[0].style.top=o(t).scrollTop()+"px")},init:function(i){var n=i.tooltip;o("select, object").length<1&&(this.bgiframe=i.elements.bgiframe=o(kt).appendTo(n),i._bind(n,"tooltipmove",this.adjustBGIFrame,this._ns,this)),this.redrawContainer=o("<div/>",{id:q+"-rcontainer"}).appendTo(e.body),i.elements.overlay&&i.elements.overlay.addClass("qtipmodal-ie6fix")&&(i._bind(t,["scroll","resize"],this._scroll,this._ns,this),i._bind(n,["tooltipshow"],this._scroll,this._ns,this)),this.redraw()},adjustBGIFrame:function(){var t,e,i=this.qtip.tooltip,o={height:i.outerHeight(D),width:i.outerWidth(D)},n=this.qtip.plugins.tip,r=this.qtip.elements.tip;e=parseInt(i.css("borderLeftWidth"),10)||0,e={left:-e,top:-e},n&&r&&(t="x"===n.corner.precedance?[L,R]:[O,$],e[t[1]]-=r[t[0]]()),this.bgiframe.css(e).css(o)},redraw:function(){if(this.qtip.rendered<1||this.drawing)return this;var t,e,i,o,n=this.qtip.tooltip,r=this.qtip.options.style,s=this.qtip.options.position.container;return this.qtip.drawing=1,r.height&&n.css(O,r.height),r.width?n.css(L,r.width):(n.css(L,"").appendTo(this.redrawContainer),e=n.width(),1>e%2&&(e+=1),i=n.css("maxWidth")||"",o=n.css("minWidth")||"",t=(i+o).indexOf("%")>-1?s.width()/100:0,i=(i.indexOf("%")>-1?t:1)*parseInt(i,10)||e,o=(o.indexOf("%")>-1?t:1)*parseInt(o,10)||0,e=i+o?Math.min(Math.max(e,o),i):e,n.css(L,Math.round(e)).appendTo(s)),this.drawing=0,this},destroy:function(){this.bgiframe&&this.bgiframe.remove(),this.qtip._unbind([t,this.qtip.tooltip],this._ns)}}),Tt=G.ie6=function(t){return 6===ot.ie?new P(t):D},Tt.initialize="render",k.ie6={"^content|style$":function(){this.redraw()}}})}(window,document),function(){var t,e,i,o=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function i(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r={}.hasOwnProperty;i=App.module("Behaviors"),t=$(window),e=[],i.FileDropArea=function(i){function r(){return this.droppedFile=o(this.droppedFile,this),this.dragLeave=o(this.dragLeave,this),this.dragOver=o(this.dragOver,this),r.__super__.constructor.apply(this,arguments)}return n(r,i),r.prototype.initialize=function(t,e){return this.onDrop=t.onDrop,this.$dropOverlay=$('<div class="dropzone_overlay"></div>'),this.dropTimeout=null},r.prototype.disable=function(){return this.enabled=!1},r.prototype.enable=function(){return this.enabled=!0},r.prototype.onShow=function(){var i;return $("body").append(this.$dropOverlay),window.FileReader&&App.Helpers.BrowserSupport.draganddrop()&&(t.on("dragover",this.dragOver),t.on("drop",this.droppedFile),this.$dropOverlay.on("dragleave",this.dragLeave)),null!=(i=_.last(e))&&i.disable(),e.push(this),this.enable()},r.prototype.onDestroy=function(){var i,o;if(t.off("dragover",this.dragover),t.off("drop",this.droppedFile),this.$dropOverlay.off("dragleave",this.dragleave),i=e.pop(),i!==this)throw new Error("Order of drop-areas has become corrupted");return null!=(o=_.last(e))?o.enable():void 0},r.prototype.dragOver=function(t){return this.enabled?(clearTimeout(this.dropTimeout),t.stopPropagation(),t.preventDefault(),$(this.$dropOverlay).show()):void 0},r.prototype.dragLeave=function(t){return this.enabled?this.dropTimeout=_.delay(function(e){return function(){return t.stopPropagation(),$(e.$dropOverlay).hide()}}(this),300):void 0},r.prototype.droppedFile=function(t){var e;if(this.enabled){if(t.preventDefault(),this.$dropOverlay.hide(),e=t.originalEvent.dataTransfer.files,_.isFunction(this.onDrop))return this.onDrop.call(this.view,e);if(_.isString(this.onDrop)&&_.isFunction(this.view[this.onDrop]))return this.view[this.onDrop](e);throw new Error("Unable to use this onDrop handler:",this.onDrop)}},r}(Marionette.Behavior)}.call(this),function(){var t;t=App.module("Helpers"),t.BrowserSupport=function(){function t(){}return t.draganddrop=function(){var t;return t=document.createElement("div"),"draggable"in t||"ondragstart"in t&&"ondrop"in t},t}()}.call(this),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,o){var n,r,s,a=e.nodeName.toLowerCase();return"area"===a?(n=e.parentNode,r=n.name,e.href&&r&&"map"===n.nodeName.toLowerCase()?(s=t("img[usemap='#"+r+"']")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||o:o)&&i(e);
}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),o="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=t(this);return o&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&r.length?r:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,o){return!!t.data(e,o[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var o=t.attr(i,"tabindex"),n=isNaN(o);return(n||o>=0)&&e(i,!n)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function o(e,i,o,r){return t.each(n,function(){i-=parseFloat(t.css(e,"padding"+this))||0,o&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),r&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],r=i.toLowerCase(),s={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?s["inner"+i].call(this):this.each(function(){t(this).css(r,o(this,e)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?s["outer"+i].call(this,e):this.each(function(){t(this).css(r,o(this,e,!0,n)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,o){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),o&&o.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,o,n=t(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(o=parseInt(n.css("zIndex"),10),!isNaN(o)&&0!==o))return o;n=n.parent()}return 0}}),t.ui.plugin={add:function(e,i,o){var n,r=t.ui[e].prototype;for(n in o)r.plugins[n]=r.plugins[n]||[],r.plugins[n].push([i,o[n]])},call:function(t,e,i,o){var n,r=t.plugins[e];if(r&&(o||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;n<r.length;n++)t.options[r[n][0]]&&r[n][1].apply(t.element,i)}};var o=0,n=Array.prototype.slice;t.cleanData=function(e){return function(i){var o,n,r;for(r=0;null!=(n=i[r]);r++)try{o=t._data(n,"events"),o&&o.remove&&t(n).triggerHandler("remove")}catch(s){}e(i)}}(t.cleanData),t.widget=function(e,i,o){var n,r,s,a,l={},u=e.split(".")[0];return e=e.split(".")[1],n=u+"-"+e,o||(o=i,i=t.Widget),t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)},t[u]=t[u]||{},r=t[u][e],s=t[u][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new s(t,e)},t.extend(s,r,{version:o.version,_proto:t.extend({},o),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(o,function(e,o){return t.isFunction(o)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,r=this._superApply;return this._super=t,this._superApply=n,e=o.apply(this,arguments),this._super=i,this._superApply=r,e}}()):void(l[e]=o)}),s.prototype=t.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix||e:e},l,{constructor:s,namespace:u,widgetName:e,widgetFullName:n}),r?(t.each(r._childConstructors,function(e,i){var o=i.prototype;t.widget(o.namespace+"."+o.widgetName,s,i._proto)}),delete r._childConstructors):i._childConstructors.push(s),t.widget.bridge(e,s),s},t.widget.extend=function(e){for(var i,o,r=n.call(arguments,1),s=0,a=r.length;a>s;s++)for(i in r[s])o=r[s][i],r[s].hasOwnProperty(i)&&void 0!==o&&(t.isPlainObject(o)?e[i]=t.isPlainObject(e[i])?t.widget.extend({},e[i],o):t.widget.extend({},o):e[i]=o);return e},t.widget.bridge=function(e,i){var o=i.prototype.widgetFullName||e;t.fn[e]=function(r){var s="string"==typeof r,a=n.call(arguments,1),l=this;return r=!s&&a.length?t.widget.extend.apply(null,[r].concat(a)):r,s?this.each(function(){var i,n=t.data(this,o);return"instance"===r?(l=n,!1):n?t.isFunction(n[r])&&"_"!==r.charAt(0)?(i=n[r].apply(n,a),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+r+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var e=t.data(this,o);e?(e.option(r||{}),e._init&&e._init()):t.data(this,o,new i(r,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=o++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var o,n,r,s=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(s={},o=e.split("."),e=o.shift(),o.length){for(n=s[e]=t.widget.extend({},this.options[e]),r=0;r<o.length-1;r++)n[o[r]]=n[o[r]]||{},n=n[o[r]];if(e=o.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];s[e]=i}return this._setOptions(s),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,o){var n,r=this;"boolean"!=typeof e&&(o=i,i=e,e=!1),o?(i=n=t(i),this.bindings=this.bindings.add(i)):(o=i,i=this.element,n=this.widget()),t.each(o,function(o,s){function a(){return e||r.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof s?r[s]:s).apply(r,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var l=o.match(/^([\w:-]*)\s*(.*)$/),u=l[1]+r.eventNamespace,h=l[2];h?n.delegate(h,u,a):i.bind(u,a)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?o[t]:t).apply(o,arguments)}var o=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,o){var n,r,s=this.options[e];if(o=o||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],r=i.originalEvent)for(n in r)n in i||(i[n]=r[n]);return this.element.trigger(i,o),!(t.isFunction(s)&&s.apply(this.element[0],[i].concat(o))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(o,n,r){"string"==typeof n&&(n={effect:n});var s,a=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),s=!t.isEmptyObject(n),n.complete=r,n.delay&&o.delay(n.delay),s&&t.effects&&t.effects.effect[a]?o[e](n):a!==e&&o[a]?o[a](n.duration,n.easing,r):o.queue(function(i){t(this)[e](),r&&r.call(o[0]),i()})}});var r=(t.widget,!1);t(document).mouseup(function(){r=!1});t.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!r){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,o=1===e.which,n="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return o&&!n&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),r=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),r=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});t.widget("ui.draggable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(o){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var o=this._uiHash();if(this._trigger("drag",e,o)===!1)return this._mouseUp({}),!1;this.position=o.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,o=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(o=t.ui.ddmanager.drop(this,e)),this.dropped&&(o=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!o||"valid"===this.options.revert&&o||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,o)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,o=t.isFunction(i.helper),n=o?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),o&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,o,n=this.options,r=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,t(r).width()-this.helperProportions.width-this.margins.left,(t(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),o=i[0],void(o&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(o.scrollWidth,o.offsetWidth):o.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(o.scrollHeight,o.offsetHeight):o.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,o=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:o?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:o?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,o,n,r,s=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,u=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(o=this.relativeContainer.offset(),i=[this.containment[0]+o.left,this.containment[1]+o.top,this.containment[2]+o.left,this.containment[3]+o.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(u=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(u=i[3]+this.offset.click.top)),s.grid&&(n=s.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,u=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-s.grid[1]:n+s.grid[1]:n,r=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-s.grid[0]:r+s.grid[0]:r),"y"===s.axis&&(l=this.originalPageX),"x"===s.axis&&(u=this.originalPageY)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,o){return o=o||this._uiHash(),t.ui.plugin.call(this,e,[i,o,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),o.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,o)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,o){var n=t.extend({},i,{item:o.element});o.sortables=[],t(o.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(o.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,n))})},stop:function(e,i,o){var n=t.extend({},i,{item:o.element});o.cancelHelperRemoval=!1,t.each(o.sortables,function(){var t=this;t.isOver?(t.isOver=0,o.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(e,i,o){t.each(o.sortables,function(){var n=!1,r=this;r.positionAbs=o.positionAbs,r.helperProportions=o.helperProportions,r.offset.click=o.offset.click,r._intersectsWith(r.containerCache)&&(n=!0,t.each(o.sortables,function(){return this.positionAbs=o.positionAbs,this.helperProportions=o.helperProportions,this.offset.click=o.offset.click,this!==r&&this._intersectsWith(this.containerCache)&&t.contains(r.element[0],this.element[0])&&(n=!1),n})),n?(r.isOver||(r.isOver=1,r.currentItem=i.helper.appendTo(r.element).data("ui-sortable-item",!0),r.options._helper=r.options.helper,r.options.helper=function(){return i.helper[0]},e.target=r.currentItem[0],r._mouseCapture(e,!0),r._mouseStart(e,!0,!0),r.offset.click.top=o.offset.click.top,r.offset.click.left=o.offset.click.left,r.offset.parent.left-=o.offset.parent.left-r.offset.parent.left,r.offset.parent.top-=o.offset.parent.top-r.offset.parent.top,o._trigger("toSortable",e),o.dropped=r.element,t.each(o.sortables,function(){this.refreshPositions()}),o.currentItem=o.element,r.fromOutside=o),r.currentItem&&(r._mouseDrag(e),i.position=r.position)):r.isOver&&(r.isOver=0,r.cancelHelperRemoval=!0,r.options._revert=r.options.revert,r.options.revert=!1,r._trigger("out",e,r._uiHash(r)),r._mouseStop(e,!0),r.options.revert=r.options._revert,r.options.helper=r.options._helper,r.placeholder&&r.placeholder.remove(),o._refreshOffsets(e),i.position=o._generatePosition(e,!0),o._trigger("fromSortable",e),o.dropped=!1,t.each(o.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,o){var n=t("body"),r=o.options;n.css("cursor")&&(r._cursor=n.css("cursor")),n.css("cursor",r.cursor)},stop:function(e,i,o){var n=o.options;n._cursor&&t("body").css("cursor",n._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,o){var n=t(i.helper),r=o.options;n.css("opacity")&&(r._opacity=n.css("opacity")),n.css("opacity",r.opacity)},stop:function(e,i,o){var n=o.options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,o){var n=o.options,r=!1,s=o.scrollParentNotHidden[0],a=o.document[0];s!==a&&"HTML"!==s.tagName?(n.axis&&"x"===n.axis||(o.overflowOffset.top+s.offsetHeight-e.pageY<n.scrollSensitivity?s.scrollTop=r=s.scrollTop+n.scrollSpeed:e.pageY-o.overflowOffset.top<n.scrollSensitivity&&(s.scrollTop=r=s.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(o.overflowOffset.left+s.offsetWidth-e.pageX<n.scrollSensitivity?s.scrollLeft=r=s.scrollLeft+n.scrollSpeed:e.pageX-o.overflowOffset.left<n.scrollSensitivity&&(s.scrollLeft=r=s.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(a).scrollTop()<n.scrollSensitivity?r=t(a).scrollTop(t(a).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(a).scrollTop())<n.scrollSensitivity&&(r=t(a).scrollTop(t(a).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(a).scrollLeft()<n.scrollSensitivity?r=t(a).scrollLeft(t(a).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(a).scrollLeft())<n.scrollSensitivity&&(r=t(a).scrollLeft(t(a).scrollLeft()+n.scrollSpeed)))),r!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(o,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,o){var n=o.options;o.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!==o.element[0]&&o.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,o){var n,r,s,a,l,u,h,p,c,d,f=o.options,g=f.snapTolerance,m=i.offset.left,_=m+o.helperProportions.width,v=i.offset.top,y=v+o.helperProportions.height;for(c=o.snapElements.length-1;c>=0;c--)l=o.snapElements[c].left-o.margins.left,u=l+o.snapElements[c].width,h=o.snapElements[c].top-o.margins.top,p=h+o.snapElements[c].height,l-g>_||m>u+g||h-g>y||v>p+g||!t.contains(o.snapElements[c].item.ownerDocument,o.snapElements[c].item)?(o.snapElements[c].snapping&&o.options.snap.release&&o.options.snap.release.call(o.element,e,t.extend(o._uiHash(),{snapItem:o.snapElements[c].item})),o.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=Math.abs(h-y)<=g,r=Math.abs(p-v)<=g,s=Math.abs(l-_)<=g,a=Math.abs(u-m)<=g,n&&(i.position.top=o._convertPositionTo("relative",{top:h-o.helperProportions.height,left:0}).top),r&&(i.position.top=o._convertPositionTo("relative",{top:p,left:0}).top),s&&(i.position.left=o._convertPositionTo("relative",{top:0,left:l-o.helperProportions.width}).left),a&&(i.position.left=o._convertPositionTo("relative",{top:0,left:u}).left)),d=n||r||s||a,"outer"!==f.snapMode&&(n=Math.abs(h-v)<=g,r=Math.abs(p-y)<=g,s=Math.abs(l-m)<=g,a=Math.abs(u-_)<=g,n&&(i.position.top=o._convertPositionTo("relative",{top:h,left:0}).top),r&&(i.position.top=o._convertPositionTo("relative",{top:p-o.helperProportions.height,left:0}).top),s&&(i.position.left=o._convertPositionTo("relative",{top:0,left:l}).left),a&&(i.position.left=o._convertPositionTo("relative",{top:0,left:u-o.helperProportions.width}).left)),!o.snapElements[c].snapping&&(n||r||s||a||d)&&o.options.snap.snap&&o.options.snap.snap.call(o.element,e,t.extend(o._uiHash(),{snapItem:o.snapElements[c].item})),o.snapElements[c].snapping=n||r||s||a||d)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,o){var n,r=o.options,s=t.makeArray(t(r.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});s.length&&(n=parseInt(t(s[0]).css("zIndex"),10)||0,t(s).each(function(e){t(this).css("zIndex",n+e)}),this.css("zIndex",n+s.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,o){var n=t(i.helper),r=o.options;n.css("zIndex")&&(r._zIndex=n.css("zIndex")),n.css("zIndex",r.zIndex)},stop:function(e,i,o){var n=o.options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}});t.ui.draggable;t.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,o=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(o)?o:function(t){return t.is(o)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var o=t.ui.ddmanager.droppables[this.options.scope];this._splice(o),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),
i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var o=i||t.ui.ddmanager.current,n=!1;return o&&(o.currentItem||o.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===o.options.scope&&i.accept.call(i.element[0],o.currentItem||o.element)&&t.ui.intersect(o,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],o.currentItem||o.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(o)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,o,n){if(!i.offset)return!1;var r=(e.positionAbs||e.position.absolute).left+e.margins.left,s=(e.positionAbs||e.position.absolute).top+e.margins.top,a=r+e.helperProportions.width,l=s+e.helperProportions.height,u=i.offset.left,h=i.offset.top,p=u+i.proportions().width,c=h+i.proportions().height;switch(o){case"fit":return r>=u&&p>=a&&s>=h&&c>=l;case"intersect":return u<r+e.helperProportions.width/2&&a-e.helperProportions.width/2<p&&h<s+e.helperProportions.height/2&&l-e.helperProportions.height/2<c;case"pointer":return t(n.pageY,h,i.proportions().height)&&t(n.pageX,u,i.proportions().width);case"touch":return(s>=h&&c>=s||l>=h&&c>=l||h>s&&l>c)&&(r>=u&&p>=r||a>=u&&p>=a||u>r&&a>p);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var o,n,r=t.ui.ddmanager.droppables[e.options.scope]||[],s=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(o=0;o<r.length;o++)if(!(r[o].options.disabled||e&&!r[o].accept.call(r[o].element[0],e.currentItem||e.element))){for(n=0;n<a.length;n++)if(a[n]===r[o].element[0]){r[o].proportions().height=0;continue t}r[o].visible="none"!==r[o].element.css("display"),r[o].visible&&("mousedown"===s&&r[o]._activate.call(r[o],i),r[o].offset=r[o].element.offset(),r[o].proportions({width:r[o].element[0].offsetWidth,height:r[o].element[0].offsetHeight}))}},drop:function(e,i){var o=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)&&(o=this._drop.call(this,i)||o),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),o},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var o,n,r,s=t.ui.intersect(e,this,this.options.tolerance,i),a=!s&&this.isover?"isout":s&&!this.isover?"isover":null;a&&(this.options.greedy&&(n=this.options.scope,r=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===n}),r.length&&(o=t(r[0]).droppable("instance"),o.greedyChild="isover"===a)),o&&"isover"===a&&(o.isover=!1,o.isout=!0,o._out.call(o,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),o&&"isout"===a&&(o.isout=!1,o.isover=!0,o._over.call(o,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}};t.ui.droppable,t.widget("ui.selectable",t.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,o=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(o.filter,this.element[0]),this._trigger("start",e),t(o.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),o.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var o=t.data(this,"selectable-item");o.startselected=!0,e.metaKey||e.ctrlKey||(o.$element.removeClass("ui-selected"),o.selected=!1,o.$element.addClass("ui-unselecting"),o.unselecting=!0,i._trigger("unselecting",e,{unselecting:o.element}))}),t(e.target).parents().addBack().each(function(){var o,n=t.data(this,"selectable-item");return n?(o=!e.metaKey&&!e.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(o?"ui-unselecting":"ui-selected").addClass(o?"ui-selecting":"ui-unselecting"),n.unselecting=!o,n.selecting=o,n.selected=o,o?i._trigger("selecting",e,{selecting:n.element}):i._trigger("unselecting",e,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,o=this,n=this.options,r=this.opos[0],s=this.opos[1],a=e.pageX,l=e.pageY;return r>a&&(i=a,a=r,r=i),s>l&&(i=l,l=s,s=i),this.helper.css({left:r,top:s,width:a-r,height:l-s}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),u=!1;i&&i.element!==o.element[0]&&("touch"===n.tolerance?u=!(i.left>a||i.right<r||i.top>l||i.bottom<s):"fit"===n.tolerance&&(u=i.left>r&&i.right<a&&i.top>s&&i.bottom<l),u?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,o._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),o._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,o._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var o=t.data(this,"selectable-item");o.$element.removeClass("ui-unselecting"),o.unselecting=!1,o.startselected=!1,i._trigger("unselected",e,{unselected:o.element})}),t(".ui-selecting",this.element[0]).each(function(){var o=t.data(this,"selectable-item");o.$element.removeClass("ui-selecting").addClass("ui-selected"),o.selecting=!1,o.selected=!0,o.startselected=!0,i._trigger("selected",e,{selected:o.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var o=null,n=!1,r=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,r.widgetName+"-item")===r?(o=t(this),!1):void 0}),t.data(e.target,r.widgetName+"-item")===r&&(o=t(e.target)),o&&(!this.options.handle||i||(t(this.options.handle,o).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n))?(this.currentItem=o,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(e,i,o){var n,r,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&"auto"!==s.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",s.cursor),this.storedStylesheet=t("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(r)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!o)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,o,n,r,s=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+s.scrollSpeed:e.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+s.scrollSpeed:e.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(e.pageY-t(document).scrollTop()<s.scrollSensitivity?a=t(document).scrollTop(t(document).scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<s.scrollSensitivity&&(a=t(document).scrollTop(t(document).scrollTop()+s.scrollSpeed)),e.pageX-t(document).scrollLeft()<s.scrollSensitivity?a=t(document).scrollLeft(t(document).scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<s.scrollSensitivity&&(a=t(document).scrollLeft(t(document).scrollLeft()+s.scrollSpeed))),a!==!1&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(o=this.items[i],n=o.item[0],r=this._intersectsWithPointer(o),r&&o.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(o))break;this._rearrange(e,o),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var o=this,n=this.placeholder.offset(),r=this.options.axis,s={};r&&"x"!==r||(s.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(s.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){o._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),o=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&o.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!o.length&&e.key&&o.push(e.key+"="),o.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),o=[];return e=e||{},i.each(function(){o.push(t(e.item||this).attr(e.attribute||"id")||"")}),o},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,o=this.positionAbs.top,n=o+this.helperProportions.height,r=t.left,s=r+t.width,a=t.top,l=a+t.height,u=this.offset.click.top,h=this.offset.click.left,p="x"===this.options.axis||o+u>a&&l>o+u,c="y"===this.options.axis||e+h>r&&s>e+h,d=p&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?d:r<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<s&&a<o+this.helperProportions.height/2&&n-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=e&&i,n=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return o?this.floating?r&&"right"===r||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),o=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:o&&("down"===o&&e||"up"===o&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){a.push(this)}var o,n,r,s,a=[],l=[],u=this._connectWith();if(u&&e)for(o=u.length-1;o>=0;o--)for(r=t(u[o]),n=r.length-1;n>=0;n--)s=t.data(r[n],this.widgetFullName),s&&s!==this&&!s.options.disabled&&l.push([t.isFunction(s.options.items)?s.options.items.call(s.element):t(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),o=l.length-1;o>=0;o--)l[o][0].each(i);return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,o,n,r,s,a,l,u,h=this.items,p=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=t(c[i]),o=n.length-1;o>=0;o--)r=t.data(n[o],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(p.push([t.isFunction(r.options.items)?r.options.items.call(r.element[0],e,{item:this.currentItem}):t(r.options.items,r.element),r]),this.containers.push(r));for(i=p.length-1;i>=0;i--)for(s=p[i][1],a=p[i][0],o=0,u=a.length;u>o;o++)l=t(a[o]),l.data(this.widgetName+"-item",s),h.push({item:l,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,o,n,r;for(i=this.items.length-1;i>=0;i--)o=this.items[i],o.instance!==this.currentContainer&&this.currentContainer&&o.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,o.item):o.item,e||(o.width=n.outerWidth(),o.height=n.outerHeight()),r=n.offset(),o.left=r.left,o.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)r=this.containers[i].element.offset(),this.containers[i].containerCache.left=r.left,this.containers[i].containerCache.top=r.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,o=e.options;o.placeholder&&o.placeholder.constructor!==String||(i=o.placeholder,o.placeholder={element:function(){var o=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+o+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===o?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)}):"img"===o&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||o.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(o.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),o.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var i,o,n,r,s,a,l,u,h,p,c=null,d=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&t.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],d=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[d].containerCache.over||(this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1);else{for(n=1e4,r=null,h=c.floating||this._isFloating(this.currentItem),s=h?"left":"top",a=h?"width":"height",p=h?"clientX":"clientY",o=this.items.length-1;o>=0;o--)t.contains(this.containers[d].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(l=this.items[o].item.offset()[s],u=!1,e[p]-l>this.items[o][a]/2&&(u=!0),Math.abs(e[p]-l)<n&&(n=Math.abs(e[p]-l),r=this.items[o],this.direction=u?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[d])return void(this.currentContainer.containerCache.over||(this.containers[d]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));r?this._rearrange(e,r,null,!0):this._rearrange(e,null,this.containers[d].element,!0),this._trigger("change",e,this._uiHash()),this.containers[d]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[d],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(e){var i=this.options,o=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return o.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(o[0]),o[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!o[0].style.width||i.forceHelperSize)&&o.width(this.currentItem.width()),(!o[0].style.height||i.forceHelperSize)&&o.height(this.currentItem.height()),o},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,o,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),o="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(o?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(o?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var o="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*o+this.offset.parent.top*o-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:n.scrollTop())*o,left:i.left+this.offset.relative.left*o+this.offset.parent.left*o-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*o}},_generatePosition:function(e){var i,o,n=this.options,r=e.pageX,s=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((s-this.originalPageY)/n.grid[1])*n.grid[1],s=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,o=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0],r=this.containment?o-this.offset.click.left>=this.containment[0]&&o-this.offset.click.left<=this.containment[2]?o:o-this.offset.click.left>=this.containment[0]?o-n.grid[0]:o+n.grid[0]:o)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(t,e,i,o){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!o)})},_clear:function(t,e){function i(t,e,i){return function(o){i._trigger(t,o,e._uiHash(e))}}this.reverting=!1;var o,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(o in this._storedCSS)("auto"===this._storedCSS[o]||"static"===this._storedCSS[o])&&(this._storedCSS[o]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),o=this.containers.length-1;o>=0;o--)e||n.push(i("deactivate",this,this.containers[o])),this.containers[o].containerCache.over&&(n.push(i("out",this,this.containers[o])),this.containers[o].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(o=0;o<n.length;o++)n[o].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}),function(t){"use strict";t.widget("ui.selectableScroll",t.ui.selectable,{options:{scrollElement:null,scrollSnapX:5,scrollSnapY:5,scrollAmount:25,scrollIntervalTime:100},_create:function(){this.element.addClass("ui-selectable"),this.dragged=!1,
this.helperClasses=["no-top","no-right","no-bottom","no-left"],this.scrollElement=this.options.scrollElement||this.element,this.refresh(),this._mouseInit(),this.helper=t('<div class="ui-selectable-helper"></div>')},refresh:function(){var e=this.scrollElement.offset(),i=this.scrollElement.prop("scrollLeft"),o=this.scrollElement.prop("scrollTop");this.selectees=t(this.options.filter,this.scrollElement[0]),this.selectees.addClass("ui-selectee"),this.selectees.each(function(){var n=t(this),r=n.offset();t.data(this,"selectable-item",{element:this,$element:n,left:r.left,top:r.top,right:r.left+n.outerWidth(),bottom:r.top+n.outerHeight(),relative:{left:r.left-e.left+i,top:r.top-e.top+o,right:r.left-e.left+i+n.outerWidth(),bottom:r.top-e.top+o+n.outerHeight()},startselected:!1,selected:n.hasClass("ui-selected"),selecting:n.hasClass("ui-selecting"),unselecting:n.hasClass("ui-unselecting")})})},_mouseStart:function(e){var i=this.scrollElement.offset();if(e.pageX>this.scrollElement.prop("clientWidth")+i.left||e.pageY>this.scrollElement.prop("clientHeight")+i.top)return!1;var o=t.ui.selectable.prototype._mouseStart.call(this,e);return this.lastDragEvent=null,this.scrollInfo={elementOffset:this.scrollElement.offset(),scrollWidth:this.scrollElement.prop("scrollWidth"),scrollHeight:this.scrollElement.prop("scrollHeight"),elementWidth:this.scrollElement.prop("clientWidth"),elementHeight:this.scrollElement.prop("clientHeight")},this.scrollInfo.dragStartXPos=e.pageX-this.scrollInfo.elementOffset.left+this.scrollElement.prop("scrollLeft"),this.scrollInfo.dragStartYPos=e.pageY-this.scrollInfo.elementOffset.top+this.scrollElement.prop("scrollTop"),this.scrollIntervalId=null,o},_updateHelper:function(e){var i,o,n,r,s=[];e.x1-e.scrollLeft<0?(s.push("no-left"),i=this.scrollInfo.elementOffset.left):i=this.scrollInfo.elementOffset.left+e.x1-e.scrollLeft,e.y1-e.scrollTop<0?(s.push("no-top"),o=this.scrollInfo.elementOffset.top):o=this.scrollInfo.elementOffset.top+e.y1-e.scrollTop,e.x2-e.scrollLeft>this.scrollInfo.elementWidth?(s.push("no-right"),n=this.scrollInfo.elementOffset.left+this.scrollInfo.elementWidth):n=this.scrollInfo.elementOffset.left+e.x2-e.scrollLeft,e.y2-e.scrollTop>this.scrollInfo.elementHeight?(s.push("no-bottom"),r=this.scrollInfo.elementOffset.top+this.scrollInfo.elementHeight):r=this.scrollInfo.elementOffset.top+e.y2-e.scrollTop;for(var a=0;a<this.helperClasses.length;a++){var l=this.helperClasses[a];-1!==t.inArray(l,s)?this.helper.addClass(l):this.helper.removeClass(l)}this.helper.css({left:i,top:o,width:n-i,height:r-o})},_scrollIfNeeded:function(t){var e=this.scrollElement.prop("scrollLeft"),i=this.scrollElement.prop("scrollTop"),o=!1;return this.lastDragEvent.pageX-this.scrollInfo.elementOffset.left<this.options.scrollSnapX&&e>0&&(e=e<this.options.scrollAmount?0:e-this.options.scrollAmount,this.scrollElement.prop("scrollLeft",e),o=!0),this.lastDragEvent.pageY-this.scrollInfo.elementOffset.top<this.options.scrollSnapY&&i>0&&(i=i<this.options.scrollAmount?0:i-this.options.scrollAmount,this.scrollElement.prop("scrollTop",i),o=!0),this.lastDragEvent.pageX-this.scrollInfo.elementOffset.left>this.scrollInfo.elementWidth-this.options.scrollSnapX&&this.scrollInfo.scrollWidth>e+this.scrollInfo.elementWidth&&(e=e+this.options.scrollAmount>this.scrollInfo.scrollWidth-this.scrollInfo.elementWidth?this.scrollInfo.scrollWidth-this.scrollInfo.elementWidth:e+this.options.scrollAmount,this.scrollElement.prop("scrollLeft",e),o=!0),this.lastDragEvent.pageY-this.scrollInfo.elementOffset.top>this.scrollInfo.elementHeight-this.options.scrollSnapY&&this.scrollInfo.scrollHeight>e+this.scrollInfo.elementHeight&&(i=i+this.options.scrollAmount>this.scrollInfo.scrollHeight-this.scrollInfo.elementHeight?this.scrollInfo.scrollHeight-this.scrollInfo.elementHeight:i+this.options.scrollAmount,this.scrollElement.prop("scrollTop",i),o=!0),{scrollLeft:e,scrollTop:i,keepScrolling:o}},_calcRelativePosition:function(t){var e=t.x-this.scrollInfo.elementOffset.left+t.scrollLeft,i=t.y-this.scrollInfo.elementOffset.top+t.scrollTop;return{x:e,y:i}},_calcRelativeArea:function(t){var e=t.xPos<this.scrollInfo.dragStartXPos?t.xPos:this.scrollInfo.dragStartXPos,i=t.yPos<this.scrollInfo.dragStartYPos?t.yPos:this.scrollInfo.dragStartYPos,o=t.xPos>this.scrollInfo.dragStartXPos?t.xPos:this.scrollInfo.dragStartXPos,n=t.yPos>this.scrollInfo.dragStartYPos?t.yPos:this.scrollInfo.dragStartYPos;return{x1:e,y1:i,x2:o,y2:n}},_updateSelectees:function(e){var i=this;this.selectees.each(function(){var o=t.data(this,"selectable-item"),n=!1;o&&o.element!==i.element[0]&&("touch"===i.options.tolerance?n=!(o.relative.left>e.x2||o.relative.right<e.x1||o.relative.top>e.y2||o.relative.bottom<e.y1):"fit"===i.options.tolerance&&(n=o.relative.left>e.x1&&o.relative.right<e.x2&&o.relative.top>e.y1&&o.relative.bottom<e.y2),n?(o.selected&&(o.$element.removeClass("ui-selected"),o.selected=!1),o.unselecting&&(o.$element.removeClass("ui-unselecting"),o.unselecting=!1),o.selecting||(o.$element.addClass("ui-selecting"),o.selecting=!0,i._trigger("selecting",i.lastDragEvent,{selecting:o.element}))):(o.selecting&&((i.lastDragEvent.metaKey||i.lastDragEvent.ctrlKey)&&o.startselected?(o.$element.removeClass("ui-selecting"),o.selecting=!1,o.$element.addClass("ui-selected"),o.selected=!0):(o.$element.removeClass("ui-selecting"),o.selecting=!1,o.startselected&&(o.$element.addClass("ui-unselecting"),o.unselecting=!0),i._trigger("unselecting",i.lastDragEvent,{unselecting:o.element}))),o.selected&&(i.lastDragEvent.metaKey||i.lastDragEvent.ctrlKey||o.startselected||(o.$element.removeClass("ui-selected"),o.selected=!1,o.$element.addClass("ui-unselecting"),o.unselecting=!0,i._trigger("unselecting",i.lastDragEvent,{unselecting:o.element})))))})},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){this.lastDragEvent=t;var e=this._scrollIfNeeded();return this._updateIntervals({keepScrolling:e.keepScrolling}),this._updateUi({doUpdateHelper:!0}),!1}},_updateUi:function(t){var e=this._scrollIfNeeded({pageX:this.lastDragEvent.pageX,pageY:this.lastDragEvent.pageY}),i=this._calcRelativePosition({x:this.lastDragEvent.pageX,y:this.lastDragEvent.pageY,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),o=this._calcRelativeArea({xPos:i.x,yPos:i.y});t.doUpdateHelper&&this._updateHelper({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2}),this._updateSelectees({x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2})},_updateIntervals:function(t){var e=this;t.keepScrolling&&!this.scrollIntervalId&&(this.scrollIntervalId=setInterval(function(){e._updateUi({doUpdateHelper:!1})},this.options.scrollIntervalTime)),!t.keepScrolling&&this.scrollIntervalId&&this._clearIntervals()},_clearIntervals:function(){this.scrollIntervalId&&clearInterval(this.scrollIntervalId),this.scrollIntervalId=null},_mouseStop:function(e){this._clearIntervals();var i=t.ui.selectable.prototype._mouseStop.call(this,e);return i}})}(jQuery),function(){var t,e,i,o,n,r;for(t=App.module("Flash"),n=["info","error","success"],e=function(t){return App.Flash[t]=function(e,i){return null==i&&(i={}),i.type=t,i.message=e,new PxApp.Shared.FlashMessage(i).render()}},i=0,o=n.length;o>i;i++)r=n[i],e(r)}.call(this),function(){var t;t=App.module("Uploader"),t.show=function(t){var e;return e=new App.Uploader.Views.Uploader(t),!App.currentUser.is_free()||App.currentUser.get("upload_limit")>0?e.showModal():window.location.href="/upgrade?limit_reached=true"},$(function(){return $("a.upload[data-new-uploader-enabled]").click(function(t){return t.preventDefault(),t.stopPropagation(),App.Uploader.show()})})}.call(this);